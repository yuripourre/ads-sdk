(()=>{var xo=Object.create;var en=Object.defineProperty;var yo=Object.getOwnPropertyDescriptor;var bo=Object.getOwnPropertyNames;var Mo=Object.getPrototypeOf,Ao=Object.prototype.hasOwnProperty;var To=(t,e,n)=>e in t?en(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Y=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),je=(t,e)=>{for(var n in e)en(t,n,{get:e[n],enumerable:!0})},So=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of bo(e))!Ao.call(t,s)&&s!==n&&en(t,s,{get:()=>e[s],enumerable:!(r=yo(e,s))||r.enumerable});return t};var Ze=(t,e,n)=>(n=t!=null?xo(Mo(t)):{},So(e||!t||!t.__esModule?en(n,"default",{value:t,enumerable:!0}):n,t));var M=(t,e,n)=>(To(t,typeof e!="symbol"?e+"":e,n),n);var wr=Y(fn=>{(function(){"use strict";var t=function(){this.init()};t.prototype={init:function(){var i=this||e;return i._counter=1e3,i._html5AudioPool=[],i.html5PoolSize=10,i._codecs={},i._howls=[],i._muted=!1,i._volume=1,i._canPlayEvent="canplaythrough",i._navigator=typeof window<"u"&&window.navigator?window.navigator:null,i.masterGain=null,i.noAudio=!1,i.usingWebAudio=!0,i.autoSuspend=!0,i.ctx=null,i.autoUnlock=!0,i._setup(),i},volume:function(i){var o=this||e;if(i=parseFloat(i),o.ctx||d(),typeof i<"u"&&i>=0&&i<=1){if(o._volume=i,o._muted)return o;o.usingWebAudio&&o.masterGain.gain.setValueAtTime(i,e.ctx.currentTime);for(var _=0;_<o._howls.length;_++)if(!o._howls[_]._webAudio)for(var m=o._howls[_]._getSoundIds(),u=0;u<m.length;u++){var g=o._howls[_]._soundById(m[u]);g&&g._node&&(g._node.volume=g._volume*i)}return o}return o._volume},mute:function(i){var o=this||e;o.ctx||d(),o._muted=i,o.usingWebAudio&&o.masterGain.gain.setValueAtTime(i?0:o._volume,e.ctx.currentTime);for(var _=0;_<o._howls.length;_++)if(!o._howls[_]._webAudio)for(var m=o._howls[_]._getSoundIds(),u=0;u<m.length;u++){var g=o._howls[_]._soundById(m[u]);g&&g._node&&(g._node.muted=i?!0:g._muted)}return o},stop:function(){for(var i=this||e,o=0;o<i._howls.length;o++)i._howls[o].stop();return i},unload:function(){for(var i=this||e,o=i._howls.length-1;o>=0;o--)i._howls[o].unload();return i.usingWebAudio&&i.ctx&&typeof i.ctx.close<"u"&&(i.ctx.close(),i.ctx=null,d()),i},codecs:function(i){return(this||e)._codecs[i.replace(/^x-/,"")]},_setup:function(){var i=this||e;if(i.state=i.ctx&&i.ctx.state||"suspended",i._autoSuspend(),!i.usingWebAudio)if(typeof Audio<"u")try{var o=new Audio;typeof o.oncanplaythrough>"u"&&(i._canPlayEvent="canplay")}catch{i.noAudio=!0}else i.noAudio=!0;try{var o=new Audio;o.muted&&(i.noAudio=!0)}catch{}return i.noAudio||i._setupCodecs(),i},_setupCodecs:function(){var i=this||e,o=null;try{o=typeof Audio<"u"?new Audio:null}catch{return i}if(!o||typeof o.canPlayType!="function")return i;var _=o.canPlayType("audio/mpeg;").replace(/^no$/,""),m=i._navigator?i._navigator.userAgent:"",u=m.match(/OPR\/([0-6].)/g),g=u&&parseInt(u[0].split("/")[1],10)<33,f=m.indexOf("Safari")!==-1&&m.indexOf("Chrome")===-1,w=m.match(/Version\/(.*?) /),v=f&&w&&parseInt(w[1],10)<15;return i._codecs={mp3:!!(!g&&(_||o.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!_,opus:!!o.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!o.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!o.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(o.canPlayType('audio/wav; codecs="1"')||o.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!o.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!o.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(o.canPlayType("audio/x-m4a;")||o.canPlayType("audio/m4a;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(o.canPlayType("audio/x-m4b;")||o.canPlayType("audio/m4b;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(o.canPlayType("audio/x-mp4;")||o.canPlayType("audio/mp4;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!v&&o.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!v&&o.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!o.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(o.canPlayType("audio/x-flac;")||o.canPlayType("audio/flac;")).replace(/^no$/,"")},i},_unlockAudio:function(){var i=this||e;if(!(i._audioUnlocked||!i.ctx)){i._audioUnlocked=!1,i.autoUnlock=!1,!i._mobileUnloaded&&i.ctx.sampleRate!==44100&&(i._mobileUnloaded=!0,i.unload()),i._scratchBuffer=i.ctx.createBuffer(1,1,22050);var o=function(_){for(;i._html5AudioPool.length<i.html5PoolSize;)try{var m=new Audio;m._unlocked=!0,i._releaseHtml5Audio(m)}catch{i.noAudio=!0;break}for(var u=0;u<i._howls.length;u++)if(!i._howls[u]._webAudio)for(var g=i._howls[u]._getSoundIds(),f=0;f<g.length;f++){var w=i._howls[u]._soundById(g[f]);w&&w._node&&!w._node._unlocked&&(w._node._unlocked=!0,w._node.load())}i._autoResume();var v=i.ctx.createBufferSource();v.buffer=i._scratchBuffer,v.connect(i.ctx.destination),typeof v.start>"u"?v.noteOn(0):v.start(0),typeof i.ctx.resume=="function"&&i.ctx.resume(),v.onended=function(){v.disconnect(0),i._audioUnlocked=!0,document.removeEventListener("touchstart",o,!0),document.removeEventListener("touchend",o,!0),document.removeEventListener("click",o,!0),document.removeEventListener("keydown",o,!0);for(var x=0;x<i._howls.length;x++)i._howls[x]._emit("unlock")}};return document.addEventListener("touchstart",o,!0),document.addEventListener("touchend",o,!0),document.addEventListener("click",o,!0),document.addEventListener("keydown",o,!0),i}},_obtainHtml5Audio:function(){var i=this||e;if(i._html5AudioPool.length)return i._html5AudioPool.pop();var o=new Audio().play();return o&&typeof Promise<"u"&&(o instanceof Promise||typeof o.then=="function")&&o.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(i){var o=this||e;return i._unlocked&&o._html5AudioPool.push(i),o},_autoSuspend:function(){var i=this;if(!(!i.autoSuspend||!i.ctx||typeof i.ctx.suspend>"u"||!e.usingWebAudio)){for(var o=0;o<i._howls.length;o++)if(i._howls[o]._webAudio){for(var _=0;_<i._howls[o]._sounds.length;_++)if(!i._howls[o]._sounds[_]._paused)return i}return i._suspendTimer&&clearTimeout(i._suspendTimer),i._suspendTimer=setTimeout(function(){if(i.autoSuspend){i._suspendTimer=null,i.state="suspending";var m=function(){i.state="suspended",i._resumeAfterSuspend&&(delete i._resumeAfterSuspend,i._autoResume())};i.ctx.suspend().then(m,m)}},3e4),i}},_autoResume:function(){var i=this;if(!(!i.ctx||typeof i.ctx.resume>"u"||!e.usingWebAudio))return i.state==="running"&&i.ctx.state!=="interrupted"&&i._suspendTimer?(clearTimeout(i._suspendTimer),i._suspendTimer=null):i.state==="suspended"||i.state==="running"&&i.ctx.state==="interrupted"?(i.ctx.resume().then(function(){i.state="running";for(var o=0;o<i._howls.length;o++)i._howls[o]._emit("resume")}),i._suspendTimer&&(clearTimeout(i._suspendTimer),i._suspendTimer=null)):i.state==="suspending"&&(i._resumeAfterSuspend=!0),i}};var e=new t,n=function(i){var o=this;if(!i.src||i.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}o.init(i)};n.prototype={init:function(i){var o=this;return e.ctx||d(),o._autoplay=i.autoplay||!1,o._format=typeof i.format!="string"?i.format:[i.format],o._html5=i.html5||!1,o._muted=i.mute||!1,o._loop=i.loop||!1,o._pool=i.pool||5,o._preload=typeof i.preload=="boolean"||i.preload==="metadata"?i.preload:!0,o._rate=i.rate||1,o._sprite=i.sprite||{},o._src=typeof i.src!="string"?i.src:[i.src],o._volume=i.volume!==void 0?i.volume:1,o._xhr={method:i.xhr&&i.xhr.method?i.xhr.method:"GET",headers:i.xhr&&i.xhr.headers?i.xhr.headers:null,withCredentials:i.xhr&&i.xhr.withCredentials?i.xhr.withCredentials:!1},o._duration=0,o._state="unloaded",o._sounds=[],o._endTimers={},o._queue=[],o._playLock=!1,o._onend=i.onend?[{fn:i.onend}]:[],o._onfade=i.onfade?[{fn:i.onfade}]:[],o._onload=i.onload?[{fn:i.onload}]:[],o._onloaderror=i.onloaderror?[{fn:i.onloaderror}]:[],o._onplayerror=i.onplayerror?[{fn:i.onplayerror}]:[],o._onpause=i.onpause?[{fn:i.onpause}]:[],o._onplay=i.onplay?[{fn:i.onplay}]:[],o._onstop=i.onstop?[{fn:i.onstop}]:[],o._onmute=i.onmute?[{fn:i.onmute}]:[],o._onvolume=i.onvolume?[{fn:i.onvolume}]:[],o._onrate=i.onrate?[{fn:i.onrate}]:[],o._onseek=i.onseek?[{fn:i.onseek}]:[],o._onunlock=i.onunlock?[{fn:i.onunlock}]:[],o._onresume=[],o._webAudio=e.usingWebAudio&&!o._html5,typeof e.ctx<"u"&&e.ctx&&e.autoUnlock&&e._unlockAudio(),e._howls.push(o),o._autoplay&&o._queue.push({event:"play",action:function(){o.play()}}),o._preload&&o._preload!=="none"&&o.load(),o},load:function(){var i=this,o=null;if(e.noAudio){i._emit("loaderror",null,"No audio support.");return}typeof i._src=="string"&&(i._src=[i._src]);for(var _=0;_<i._src.length;_++){var m,u;if(i._format&&i._format[_])m=i._format[_];else{if(u=i._src[_],typeof u!="string"){i._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}m=/^data:audio\/([^;,]+);/i.exec(u),m||(m=/\.([^.]+)$/.exec(u.split("?",1)[0])),m&&(m=m[1].toLowerCase())}if(m||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),m&&e.codecs(m)){o=i._src[_];break}}if(!o){i._emit("loaderror",null,"No codec support for selected audio sources.");return}return i._src=o,i._state="loading",window.location.protocol==="https:"&&o.slice(0,5)==="http:"&&(i._html5=!0,i._webAudio=!1),new r(i),i._webAudio&&a(i),i},play:function(i,o){var _=this,m=null;if(typeof i=="number")m=i,i=null;else{if(typeof i=="string"&&_._state==="loaded"&&!_._sprite[i])return null;if(typeof i>"u"&&(i="__default",!_._playLock)){for(var u=0,g=0;g<_._sounds.length;g++)_._sounds[g]._paused&&!_._sounds[g]._ended&&(u++,m=_._sounds[g]._id);u===1?i=null:m=null}}var f=m?_._soundById(m):_._inactiveSound();if(!f)return null;if(m&&!i&&(i=f._sprite||"__default"),_._state!=="loaded"){f._sprite=i,f._ended=!1;var w=f._id;return _._queue.push({event:"play",action:function(){_.play(w)}}),w}if(m&&!f._paused)return o||_._loadQueue("play"),f._id;_._webAudio&&e._autoResume();var v=Math.max(0,f._seek>0?f._seek:_._sprite[i][0]/1e3),x=Math.max(0,(_._sprite[i][0]+_._sprite[i][1])/1e3-v),T=x*1e3/Math.abs(f._rate),A=_._sprite[i][0]/1e3,S=(_._sprite[i][0]+_._sprite[i][1])/1e3;f._sprite=i,f._ended=!1;var F=function(){f._paused=!1,f._seek=v,f._start=A,f._stop=S,f._loop=!!(f._loop||_._sprite[i][2])};if(v>=S){_._ended(f);return}var E=f._node;if(_._webAudio){var D=function(){_._playLock=!1,F(),_._refreshBuffer(f);var L=f._muted||_._muted?0:f._volume;E.gain.setValueAtTime(L,e.ctx.currentTime),f._playStart=e.ctx.currentTime,typeof E.bufferSource.start>"u"?f._loop?E.bufferSource.noteGrainOn(0,v,86400):E.bufferSource.noteGrainOn(0,v,x):f._loop?E.bufferSource.start(0,v,86400):E.bufferSource.start(0,v,x),T!==1/0&&(_._endTimers[f._id]=setTimeout(_._ended.bind(_,f),T)),o||setTimeout(function(){_._emit("play",f._id),_._loadQueue()},0)};e.state==="running"&&e.ctx.state!=="interrupted"?D():(_._playLock=!0,_.once("resume",D),_._clearTimer(f._id))}else{var z=function(){E.currentTime=v,E.muted=f._muted||_._muted||e._muted||E.muted,E.volume=f._volume*e.volume(),E.playbackRate=f._rate;try{var L=E.play();if(L&&typeof Promise<"u"&&(L instanceof Promise||typeof L.then=="function")?(_._playLock=!0,F(),L.then(function(){_._playLock=!1,E._unlocked=!0,o?_._loadQueue():_._emit("play",f._id)}).catch(function(){_._playLock=!1,_._emit("playerror",f._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),f._ended=!0,f._paused=!0})):o||(_._playLock=!1,F(),_._emit("play",f._id)),E.playbackRate=f._rate,E.paused){_._emit("playerror",f._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}i!=="__default"||f._loop?_._endTimers[f._id]=setTimeout(_._ended.bind(_,f),T):(_._endTimers[f._id]=function(){_._ended(f),E.removeEventListener("ended",_._endTimers[f._id],!1)},E.addEventListener("ended",_._endTimers[f._id],!1))}catch(I){_._emit("playerror",f._id,I)}};E.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(E.src=_._src,E.load());var V=window&&window.ejecta||!E.readyState&&e._navigator.isCocoonJS;if(E.readyState>=3||V)z();else{_._playLock=!0,_._state="loading";var U=function(){_._state="loaded",z(),E.removeEventListener(e._canPlayEvent,U,!1)};E.addEventListener(e._canPlayEvent,U,!1),_._clearTimer(f._id)}}return f._id},pause:function(i){var o=this;if(o._state!=="loaded"||o._playLock)return o._queue.push({event:"pause",action:function(){o.pause(i)}}),o;for(var _=o._getSoundIds(i),m=0;m<_.length;m++){o._clearTimer(_[m]);var u=o._soundById(_[m]);if(u&&!u._paused&&(u._seek=o.seek(_[m]),u._rateSeek=0,u._paused=!0,o._stopFade(_[m]),u._node))if(o._webAudio){if(!u._node.bufferSource)continue;typeof u._node.bufferSource.stop>"u"?u._node.bufferSource.noteOff(0):u._node.bufferSource.stop(0),o._cleanBuffer(u._node)}else(!isNaN(u._node.duration)||u._node.duration===1/0)&&u._node.pause();arguments[1]||o._emit("pause",u?u._id:null)}return o},stop:function(i,o){var _=this;if(_._state!=="loaded"||_._playLock)return _._queue.push({event:"stop",action:function(){_.stop(i)}}),_;for(var m=_._getSoundIds(i),u=0;u<m.length;u++){_._clearTimer(m[u]);var g=_._soundById(m[u]);g&&(g._seek=g._start||0,g._rateSeek=0,g._paused=!0,g._ended=!0,_._stopFade(m[u]),g._node&&(_._webAudio?g._node.bufferSource&&(typeof g._node.bufferSource.stop>"u"?g._node.bufferSource.noteOff(0):g._node.bufferSource.stop(0),_._cleanBuffer(g._node)):(!isNaN(g._node.duration)||g._node.duration===1/0)&&(g._node.currentTime=g._start||0,g._node.pause(),g._node.duration===1/0&&_._clearSound(g._node))),o||_._emit("stop",g._id))}return _},mute:function(i,o){var _=this;if(_._state!=="loaded"||_._playLock)return _._queue.push({event:"mute",action:function(){_.mute(i,o)}}),_;if(typeof o>"u")if(typeof i=="boolean")_._muted=i;else return _._muted;for(var m=_._getSoundIds(o),u=0;u<m.length;u++){var g=_._soundById(m[u]);g&&(g._muted=i,g._interval&&_._stopFade(g._id),_._webAudio&&g._node?g._node.gain.setValueAtTime(i?0:g._volume,e.ctx.currentTime):g._node&&(g._node.muted=e._muted?!0:i),_._emit("mute",g._id))}return _},volume:function(){var i=this,o=arguments,_,m;if(o.length===0)return i._volume;if(o.length===1||o.length===2&&typeof o[1]>"u"){var u=i._getSoundIds(),g=u.indexOf(o[0]);g>=0?m=parseInt(o[0],10):_=parseFloat(o[0])}else o.length>=2&&(_=parseFloat(o[0]),m=parseInt(o[1],10));var f;if(typeof _<"u"&&_>=0&&_<=1){if(i._state!=="loaded"||i._playLock)return i._queue.push({event:"volume",action:function(){i.volume.apply(i,o)}}),i;typeof m>"u"&&(i._volume=_),m=i._getSoundIds(m);for(var w=0;w<m.length;w++)f=i._soundById(m[w]),f&&(f._volume=_,o[2]||i._stopFade(m[w]),i._webAudio&&f._node&&!f._muted?f._node.gain.setValueAtTime(_,e.ctx.currentTime):f._node&&!f._muted&&(f._node.volume=_*e.volume()),i._emit("volume",f._id))}else return f=m?i._soundById(m):i._sounds[0],f?f._volume:0;return i},fade:function(i,o,_,m){var u=this;if(u._state!=="loaded"||u._playLock)return u._queue.push({event:"fade",action:function(){u.fade(i,o,_,m)}}),u;i=Math.min(Math.max(0,parseFloat(i)),1),o=Math.min(Math.max(0,parseFloat(o)),1),_=parseFloat(_),u.volume(i,m);for(var g=u._getSoundIds(m),f=0;f<g.length;f++){var w=u._soundById(g[f]);if(w){if(m||u._stopFade(g[f]),u._webAudio&&!w._muted){var v=e.ctx.currentTime,x=v+_/1e3;w._volume=i,w._node.gain.setValueAtTime(i,v),w._node.gain.linearRampToValueAtTime(o,x)}u._startFadeInterval(w,i,o,_,g[f],typeof m>"u")}}return u},_startFadeInterval:function(i,o,_,m,u,g){var f=this,w=o,v=_-o,x=Math.abs(v/.01),T=Math.max(4,x>0?m/x:m),A=Date.now();i._fadeTo=_,i._interval=setInterval(function(){var S=(Date.now()-A)/m;A=Date.now(),w+=v*S,w=Math.round(w*100)/100,v<0?w=Math.max(_,w):w=Math.min(_,w),f._webAudio?i._volume=w:f.volume(w,i._id,!0),g&&(f._volume=w),(_<o&&w<=_||_>o&&w>=_)&&(clearInterval(i._interval),i._interval=null,i._fadeTo=null,f.volume(_,i._id),f._emit("fade",i._id))},T)},_stopFade:function(i){var o=this,_=o._soundById(i);return _&&_._interval&&(o._webAudio&&_._node.gain.cancelScheduledValues(e.ctx.currentTime),clearInterval(_._interval),_._interval=null,o.volume(_._fadeTo,i),_._fadeTo=null,o._emit("fade",i)),o},loop:function(){var i=this,o=arguments,_,m,u;if(o.length===0)return i._loop;if(o.length===1)if(typeof o[0]=="boolean")_=o[0],i._loop=_;else return u=i._soundById(parseInt(o[0],10)),u?u._loop:!1;else o.length===2&&(_=o[0],m=parseInt(o[1],10));for(var g=i._getSoundIds(m),f=0;f<g.length;f++)u=i._soundById(g[f]),u&&(u._loop=_,i._webAudio&&u._node&&u._node.bufferSource&&(u._node.bufferSource.loop=_,_&&(u._node.bufferSource.loopStart=u._start||0,u._node.bufferSource.loopEnd=u._stop,i.playing(g[f])&&(i.pause(g[f],!0),i.play(g[f],!0)))));return i},rate:function(){var i=this,o=arguments,_,m;if(o.length===0)m=i._sounds[0]._id;else if(o.length===1){var u=i._getSoundIds(),g=u.indexOf(o[0]);g>=0?m=parseInt(o[0],10):_=parseFloat(o[0])}else o.length===2&&(_=parseFloat(o[0]),m=parseInt(o[1],10));var f;if(typeof _=="number"){if(i._state!=="loaded"||i._playLock)return i._queue.push({event:"rate",action:function(){i.rate.apply(i,o)}}),i;typeof m>"u"&&(i._rate=_),m=i._getSoundIds(m);for(var w=0;w<m.length;w++)if(f=i._soundById(m[w]),f){i.playing(m[w])&&(f._rateSeek=i.seek(m[w]),f._playStart=i._webAudio?e.ctx.currentTime:f._playStart),f._rate=_,i._webAudio&&f._node&&f._node.bufferSource?f._node.bufferSource.playbackRate.setValueAtTime(_,e.ctx.currentTime):f._node&&(f._node.playbackRate=_);var v=i.seek(m[w]),x=(i._sprite[f._sprite][0]+i._sprite[f._sprite][1])/1e3-v,T=x*1e3/Math.abs(f._rate);(i._endTimers[m[w]]||!f._paused)&&(i._clearTimer(m[w]),i._endTimers[m[w]]=setTimeout(i._ended.bind(i,f),T)),i._emit("rate",f._id)}}else return f=i._soundById(m),f?f._rate:i._rate;return i},seek:function(){var i=this,o=arguments,_,m;if(o.length===0)i._sounds.length&&(m=i._sounds[0]._id);else if(o.length===1){var u=i._getSoundIds(),g=u.indexOf(o[0]);g>=0?m=parseInt(o[0],10):i._sounds.length&&(m=i._sounds[0]._id,_=parseFloat(o[0]))}else o.length===2&&(_=parseFloat(o[0]),m=parseInt(o[1],10));if(typeof m>"u")return 0;if(typeof _=="number"&&(i._state!=="loaded"||i._playLock))return i._queue.push({event:"seek",action:function(){i.seek.apply(i,o)}}),i;var f=i._soundById(m);if(f)if(typeof _=="number"&&_>=0){var w=i.playing(m);w&&i.pause(m,!0),f._seek=_,f._ended=!1,i._clearTimer(m),!i._webAudio&&f._node&&!isNaN(f._node.duration)&&(f._node.currentTime=_);var v=function(){w&&i.play(m,!0),i._emit("seek",m)};if(w&&!i._webAudio){var x=function(){i._playLock?setTimeout(x,0):v()};setTimeout(x,0)}else v()}else if(i._webAudio){var T=i.playing(m)?e.ctx.currentTime-f._playStart:0,A=f._rateSeek?f._rateSeek-f._seek:0;return f._seek+(A+T*Math.abs(f._rate))}else return f._node.currentTime;return i},playing:function(i){var o=this;if(typeof i=="number"){var _=o._soundById(i);return _?!_._paused:!1}for(var m=0;m<o._sounds.length;m++)if(!o._sounds[m]._paused)return!0;return!1},duration:function(i){var o=this,_=o._duration,m=o._soundById(i);return m&&(_=o._sprite[m._sprite][1]/1e3),_},state:function(){return this._state},unload:function(){for(var i=this,o=i._sounds,_=0;_<o.length;_++)o[_]._paused||i.stop(o[_]._id),i._webAudio||(i._clearSound(o[_]._node),o[_]._node.removeEventListener("error",o[_]._errorFn,!1),o[_]._node.removeEventListener(e._canPlayEvent,o[_]._loadFn,!1),o[_]._node.removeEventListener("ended",o[_]._endFn,!1),e._releaseHtml5Audio(o[_]._node)),delete o[_]._node,i._clearTimer(o[_]._id);var m=e._howls.indexOf(i);m>=0&&e._howls.splice(m,1);var u=!0;for(_=0;_<e._howls.length;_++)if(e._howls[_]._src===i._src||i._src.indexOf(e._howls[_]._src)>=0){u=!1;break}return s&&u&&delete s[i._src],e.noAudio=!1,i._state="unloaded",i._sounds=[],i=null,null},on:function(i,o,_,m){var u=this,g=u["_on"+i];return typeof o=="function"&&g.push(m?{id:_,fn:o,once:m}:{id:_,fn:o}),u},off:function(i,o,_){var m=this,u=m["_on"+i],g=0;if(typeof o=="number"&&(_=o,o=null),o||_)for(g=0;g<u.length;g++){var f=_===u[g].id;if(o===u[g].fn&&f||!o&&f){u.splice(g,1);break}}else if(i)m["_on"+i]=[];else{var w=Object.keys(m);for(g=0;g<w.length;g++)w[g].indexOf("_on")===0&&Array.isArray(m[w[g]])&&(m[w[g]]=[])}return m},once:function(i,o,_){var m=this;return m.on(i,o,_,1),m},_emit:function(i,o,_){for(var m=this,u=m["_on"+i],g=u.length-1;g>=0;g--)(!u[g].id||u[g].id===o||i==="load")&&(setTimeout(function(f){f.call(this,o,_)}.bind(m,u[g].fn),0),u[g].once&&m.off(i,u[g].fn,u[g].id));return m._loadQueue(i),m},_loadQueue:function(i){var o=this;if(o._queue.length>0){var _=o._queue[0];_.event===i&&(o._queue.shift(),o._loadQueue()),i||_.action()}return o},_ended:function(i){var o=this,_=i._sprite;if(!o._webAudio&&i._node&&!i._node.paused&&!i._node.ended&&i._node.currentTime<i._stop)return setTimeout(o._ended.bind(o,i),100),o;var m=!!(i._loop||o._sprite[_][2]);if(o._emit("end",i._id),!o._webAudio&&m&&o.stop(i._id,!0).play(i._id),o._webAudio&&m){o._emit("play",i._id),i._seek=i._start||0,i._rateSeek=0,i._playStart=e.ctx.currentTime;var u=(i._stop-i._start)*1e3/Math.abs(i._rate);o._endTimers[i._id]=setTimeout(o._ended.bind(o,i),u)}return o._webAudio&&!m&&(i._paused=!0,i._ended=!0,i._seek=i._start||0,i._rateSeek=0,o._clearTimer(i._id),o._cleanBuffer(i._node),e._autoSuspend()),!o._webAudio&&!m&&o.stop(i._id,!0),o},_clearTimer:function(i){var o=this;if(o._endTimers[i]){if(typeof o._endTimers[i]!="function")clearTimeout(o._endTimers[i]);else{var _=o._soundById(i);_&&_._node&&_._node.removeEventListener("ended",o._endTimers[i],!1)}delete o._endTimers[i]}return o},_soundById:function(i){for(var o=this,_=0;_<o._sounds.length;_++)if(i===o._sounds[_]._id)return o._sounds[_];return null},_inactiveSound:function(){var i=this;i._drain();for(var o=0;o<i._sounds.length;o++)if(i._sounds[o]._ended)return i._sounds[o].reset();return new r(i)},_drain:function(){var i=this,o=i._pool,_=0,m=0;if(!(i._sounds.length<o)){for(m=0;m<i._sounds.length;m++)i._sounds[m]._ended&&_++;for(m=i._sounds.length-1;m>=0;m--){if(_<=o)return;i._sounds[m]._ended&&(i._webAudio&&i._sounds[m]._node&&i._sounds[m]._node.disconnect(0),i._sounds.splice(m,1),_--)}}},_getSoundIds:function(i){var o=this;if(typeof i>"u"){for(var _=[],m=0;m<o._sounds.length;m++)_.push(o._sounds[m]._id);return _}else return[i]},_refreshBuffer:function(i){var o=this;return i._node.bufferSource=e.ctx.createBufferSource(),i._node.bufferSource.buffer=s[o._src],i._panner?i._node.bufferSource.connect(i._panner):i._node.bufferSource.connect(i._node),i._node.bufferSource.loop=i._loop,i._loop&&(i._node.bufferSource.loopStart=i._start||0,i._node.bufferSource.loopEnd=i._stop||0),i._node.bufferSource.playbackRate.setValueAtTime(i._rate,e.ctx.currentTime),o},_cleanBuffer:function(i){var o=this,_=e._navigator&&e._navigator.vendor.indexOf("Apple")>=0;if(e._scratchBuffer&&i.bufferSource&&(i.bufferSource.onended=null,i.bufferSource.disconnect(0),_))try{i.bufferSource.buffer=e._scratchBuffer}catch{}return i.bufferSource=null,o},_clearSound:function(i){var o=/MSIE |Trident\//.test(e._navigator&&e._navigator.userAgent);o||(i.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var r=function(i){this._parent=i,this.init()};r.prototype={init:function(){var i=this,o=i._parent;return i._muted=o._muted,i._loop=o._loop,i._volume=o._volume,i._rate=o._rate,i._seek=0,i._paused=!0,i._ended=!0,i._sprite="__default",i._id=++e._counter,o._sounds.push(i),i.create(),i},create:function(){var i=this,o=i._parent,_=e._muted||i._muted||i._parent._muted?0:i._volume;return o._webAudio?(i._node=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),i._node.gain.setValueAtTime(_,e.ctx.currentTime),i._node.paused=!0,i._node.connect(e.masterGain)):e.noAudio||(i._node=e._obtainHtml5Audio(),i._errorFn=i._errorListener.bind(i),i._node.addEventListener("error",i._errorFn,!1),i._loadFn=i._loadListener.bind(i),i._node.addEventListener(e._canPlayEvent,i._loadFn,!1),i._endFn=i._endListener.bind(i),i._node.addEventListener("ended",i._endFn,!1),i._node.src=o._src,i._node.preload=o._preload===!0?"auto":o._preload,i._node.volume=_*e.volume(),i._node.load()),i},reset:function(){var i=this,o=i._parent;return i._muted=o._muted,i._loop=o._loop,i._volume=o._volume,i._rate=o._rate,i._seek=0,i._rateSeek=0,i._paused=!0,i._ended=!0,i._sprite="__default",i._id=++e._counter,i},_errorListener:function(){var i=this;i._parent._emit("loaderror",i._id,i._node.error?i._node.error.code:0),i._node.removeEventListener("error",i._errorFn,!1)},_loadListener:function(){var i=this,o=i._parent;o._duration=Math.ceil(i._node.duration*10)/10,Object.keys(o._sprite).length===0&&(o._sprite={__default:[0,o._duration*1e3]}),o._state!=="loaded"&&(o._state="loaded",o._emit("load"),o._loadQueue()),i._node.removeEventListener(e._canPlayEvent,i._loadFn,!1)},_endListener:function(){var i=this,o=i._parent;o._duration===1/0&&(o._duration=Math.ceil(i._node.duration*10)/10,o._sprite.__default[1]===1/0&&(o._sprite.__default[1]=o._duration*1e3),o._ended(i)),i._node.removeEventListener("ended",i._endFn,!1)}};var s={},a=function(i){var o=i._src;if(s[o]){i._duration=s[o].duration,h(i);return}if(/^data:[^;]+;base64,/.test(o)){for(var _=atob(o.split(",")[1]),m=new Uint8Array(_.length),u=0;u<_.length;++u)m[u]=_.charCodeAt(u);c(m.buffer,i)}else{var g=new XMLHttpRequest;g.open(i._xhr.method,o,!0),g.withCredentials=i._xhr.withCredentials,g.responseType="arraybuffer",i._xhr.headers&&Object.keys(i._xhr.headers).forEach(function(f){g.setRequestHeader(f,i._xhr.headers[f])}),g.onload=function(){var f=(g.status+"")[0];if(f!=="0"&&f!=="2"&&f!=="3"){i._emit("loaderror",null,"Failed loading audio file with status: "+g.status+".");return}c(g.response,i)},g.onerror=function(){i._webAudio&&(i._html5=!0,i._webAudio=!1,i._sounds=[],delete s[o],i.load())},l(g)}},l=function(i){try{i.send()}catch{i.onerror()}},c=function(i,o){var _=function(){o._emit("loaderror",null,"Decoding audio data failed.")},m=function(u){u&&o._sounds.length>0?(s[o._src]=u,h(o,u)):_()};typeof Promise<"u"&&e.ctx.decodeAudioData.length===1?e.ctx.decodeAudioData(i).then(m).catch(_):e.ctx.decodeAudioData(i,m,_)},h=function(i,o){o&&!i._duration&&(i._duration=o.duration),Object.keys(i._sprite).length===0&&(i._sprite={__default:[0,i._duration*1e3]}),i._state!=="loaded"&&(i._state="loaded",i._emit("load"),i._loadQueue())},d=function(){if(e.usingWebAudio){try{typeof AudioContext<"u"?e.ctx=new AudioContext:typeof webkitAudioContext<"u"?e.ctx=new webkitAudioContext:e.usingWebAudio=!1}catch{e.usingWebAudio=!1}e.ctx||(e.usingWebAudio=!1);var i=/iP(hone|od|ad)/.test(e._navigator&&e._navigator.platform),o=e._navigator&&e._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),_=o?parseInt(o[1],10):null;if(i&&_&&_<9){var m=/safari/.test(e._navigator&&e._navigator.userAgent.toLowerCase());e._navigator&&!m&&(e.usingWebAudio=!1)}e.usingWebAudio&&(e.masterGain=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),e.masterGain.gain.setValueAtTime(e._muted?0:e._volume,e.ctx.currentTime),e.masterGain.connect(e.ctx.destination)),e._setup()}};typeof define=="function"&&define.amd&&define([],function(){return{Howler:e,Howl:n}}),typeof fn<"u"&&(fn.Howler=e,fn.Howl=n),typeof global<"u"?(global.HowlerGlobal=t,global.Howler=e,global.Howl=n,global.Sound=r):typeof window<"u"&&(window.HowlerGlobal=t,window.Howler=e,window.Howl=n,window.Sound=r)})();(function(){"use strict";HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var n=this;if(!n.ctx||!n.ctx.listener)return n;for(var r=n._howls.length-1;r>=0;r--)n._howls[r].stereo(e);return n},HowlerGlobal.prototype.pos=function(e,n,r){var s=this;if(!s.ctx||!s.ctx.listener)return s;if(n=typeof n!="number"?s._pos[1]:n,r=typeof r!="number"?s._pos[2]:r,typeof e=="number")s._pos=[e,n,r],typeof s.ctx.listener.positionX<"u"?(s.ctx.listener.positionX.setTargetAtTime(s._pos[0],Howler.ctx.currentTime,.1),s.ctx.listener.positionY.setTargetAtTime(s._pos[1],Howler.ctx.currentTime,.1),s.ctx.listener.positionZ.setTargetAtTime(s._pos[2],Howler.ctx.currentTime,.1)):s.ctx.listener.setPosition(s._pos[0],s._pos[1],s._pos[2]);else return s._pos;return s},HowlerGlobal.prototype.orientation=function(e,n,r,s,a,l){var c=this;if(!c.ctx||!c.ctx.listener)return c;var h=c._orientation;if(n=typeof n!="number"?h[1]:n,r=typeof r!="number"?h[2]:r,s=typeof s!="number"?h[3]:s,a=typeof a!="number"?h[4]:a,l=typeof l!="number"?h[5]:l,typeof e=="number")c._orientation=[e,n,r,s,a,l],typeof c.ctx.listener.forwardX<"u"?(c.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),c.ctx.listener.forwardY.setTargetAtTime(n,Howler.ctx.currentTime,.1),c.ctx.listener.forwardZ.setTargetAtTime(r,Howler.ctx.currentTime,.1),c.ctx.listener.upX.setTargetAtTime(s,Howler.ctx.currentTime,.1),c.ctx.listener.upY.setTargetAtTime(a,Howler.ctx.currentTime,.1),c.ctx.listener.upZ.setTargetAtTime(l,Howler.ctx.currentTime,.1)):c.ctx.listener.setOrientation(e,n,r,s,a,l);else return h;return c},Howl.prototype.init=function(e){return function(n){var r=this;return r._orientation=n.orientation||[1,0,0],r._stereo=n.stereo||null,r._pos=n.pos||null,r._pannerAttr={coneInnerAngle:typeof n.coneInnerAngle<"u"?n.coneInnerAngle:360,coneOuterAngle:typeof n.coneOuterAngle<"u"?n.coneOuterAngle:360,coneOuterGain:typeof n.coneOuterGain<"u"?n.coneOuterGain:0,distanceModel:typeof n.distanceModel<"u"?n.distanceModel:"inverse",maxDistance:typeof n.maxDistance<"u"?n.maxDistance:1e4,panningModel:typeof n.panningModel<"u"?n.panningModel:"HRTF",refDistance:typeof n.refDistance<"u"?n.refDistance:1,rolloffFactor:typeof n.rolloffFactor<"u"?n.rolloffFactor:1},r._onstereo=n.onstereo?[{fn:n.onstereo}]:[],r._onpos=n.onpos?[{fn:n.onpos}]:[],r._onorientation=n.onorientation?[{fn:n.onorientation}]:[],e.call(this,n)}}(Howl.prototype.init),Howl.prototype.stereo=function(e,n){var r=this;if(!r._webAudio)return r;if(r._state!=="loaded")return r._queue.push({event:"stereo",action:function(){r.stereo(e,n)}}),r;var s=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof n>"u")if(typeof e=="number")r._stereo=e,r._pos=[e,0,0];else return r._stereo;for(var a=r._getSoundIds(n),l=0;l<a.length;l++){var c=r._soundById(a[l]);if(c)if(typeof e=="number")c._stereo=e,c._pos=[e,0,0],c._node&&(c._pannerAttr.panningModel="equalpower",(!c._panner||!c._panner.pan)&&t(c,s),s==="spatial"?typeof c._panner.positionX<"u"?(c._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),c._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),c._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):c._panner.setPosition(e,0,0):c._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),r._emit("stereo",c._id);else return c._stereo}return r},Howl.prototype.pos=function(e,n,r,s){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"pos",action:function(){a.pos(e,n,r,s)}}),a;if(n=typeof n!="number"?0:n,r=typeof r!="number"?-.5:r,typeof s>"u")if(typeof e=="number")a._pos=[e,n,r];else return a._pos;for(var l=a._getSoundIds(s),c=0;c<l.length;c++){var h=a._soundById(l[c]);if(h)if(typeof e=="number")h._pos=[e,n,r],h._node&&((!h._panner||h._panner.pan)&&t(h,"spatial"),typeof h._panner.positionX<"u"?(h._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),h._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),h._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime)):h._panner.setPosition(e,n,r)),a._emit("pos",h._id);else return h._pos}return a},Howl.prototype.orientation=function(e,n,r,s){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"orientation",action:function(){a.orientation(e,n,r,s)}}),a;if(n=typeof n!="number"?a._orientation[1]:n,r=typeof r!="number"?a._orientation[2]:r,typeof s>"u")if(typeof e=="number")a._orientation=[e,n,r];else return a._orientation;for(var l=a._getSoundIds(s),c=0;c<l.length;c++){var h=a._soundById(l[c]);if(h)if(typeof e=="number")h._orientation=[e,n,r],h._node&&(h._panner||(h._pos||(h._pos=a._pos||[0,0,-.5]),t(h,"spatial")),typeof h._panner.orientationX<"u"?(h._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),h._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),h._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime)):h._panner.setOrientation(e,n,r)),a._emit("orientation",h._id);else return h._orientation}return a},Howl.prototype.pannerAttr=function(){var e=this,n=arguments,r,s,a;if(!e._webAudio)return e;if(n.length===0)return e._pannerAttr;if(n.length===1)if(typeof n[0]=="object")r=n[0],typeof s>"u"&&(r.pannerAttr||(r.pannerAttr={coneInnerAngle:r.coneInnerAngle,coneOuterAngle:r.coneOuterAngle,coneOuterGain:r.coneOuterGain,distanceModel:r.distanceModel,maxDistance:r.maxDistance,refDistance:r.refDistance,rolloffFactor:r.rolloffFactor,panningModel:r.panningModel}),e._pannerAttr={coneInnerAngle:typeof r.pannerAttr.coneInnerAngle<"u"?r.pannerAttr.coneInnerAngle:e._coneInnerAngle,coneOuterAngle:typeof r.pannerAttr.coneOuterAngle<"u"?r.pannerAttr.coneOuterAngle:e._coneOuterAngle,coneOuterGain:typeof r.pannerAttr.coneOuterGain<"u"?r.pannerAttr.coneOuterGain:e._coneOuterGain,distanceModel:typeof r.pannerAttr.distanceModel<"u"?r.pannerAttr.distanceModel:e._distanceModel,maxDistance:typeof r.pannerAttr.maxDistance<"u"?r.pannerAttr.maxDistance:e._maxDistance,refDistance:typeof r.pannerAttr.refDistance<"u"?r.pannerAttr.refDistance:e._refDistance,rolloffFactor:typeof r.pannerAttr.rolloffFactor<"u"?r.pannerAttr.rolloffFactor:e._rolloffFactor,panningModel:typeof r.pannerAttr.panningModel<"u"?r.pannerAttr.panningModel:e._panningModel});else return a=e._soundById(parseInt(n[0],10)),a?a._pannerAttr:e._pannerAttr;else n.length===2&&(r=n[0],s=parseInt(n[1],10));for(var l=e._getSoundIds(s),c=0;c<l.length;c++)if(a=e._soundById(l[c]),a){var h=a._pannerAttr;h={coneInnerAngle:typeof r.coneInnerAngle<"u"?r.coneInnerAngle:h.coneInnerAngle,coneOuterAngle:typeof r.coneOuterAngle<"u"?r.coneOuterAngle:h.coneOuterAngle,coneOuterGain:typeof r.coneOuterGain<"u"?r.coneOuterGain:h.coneOuterGain,distanceModel:typeof r.distanceModel<"u"?r.distanceModel:h.distanceModel,maxDistance:typeof r.maxDistance<"u"?r.maxDistance:h.maxDistance,refDistance:typeof r.refDistance<"u"?r.refDistance:h.refDistance,rolloffFactor:typeof r.rolloffFactor<"u"?r.rolloffFactor:h.rolloffFactor,panningModel:typeof r.panningModel<"u"?r.panningModel:h.panningModel};var d=a._panner;d?(d.coneInnerAngle=h.coneInnerAngle,d.coneOuterAngle=h.coneOuterAngle,d.coneOuterGain=h.coneOuterGain,d.distanceModel=h.distanceModel,d.maxDistance=h.maxDistance,d.refDistance=h.refDistance,d.rolloffFactor=h.rolloffFactor,d.panningModel=h.panningModel):(a._pos||(a._pos=e._pos||[0,0,-.5]),t(a,"spatial"))}return e},Sound.prototype.init=function(e){return function(){var n=this,r=n._parent;n._orientation=r._orientation,n._stereo=r._stereo,n._pos=r._pos,n._pannerAttr=r._pannerAttr,e.call(this),n._stereo?r.stereo(n._stereo):n._pos&&r.pos(n._pos[0],n._pos[1],n._pos[2],n._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var n=this,r=n._parent;return n._orientation=r._orientation,n._stereo=r._stereo,n._pos=r._pos,n._pannerAttr=r._pannerAttr,n._stereo?r.stereo(n._stereo):n._pos?r.pos(n._pos[0],n._pos[1],n._pos[2],n._id):n._panner&&(n._panner.disconnect(0),n._panner=void 0,r._refreshBuffer(n)),e.call(this)}}(Sound.prototype.reset);var t=function(e,n){n=n||"spatial",n==="spatial"?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,typeof e._panner.positionX<"u"?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),typeof e._panner.orientationX<"u"?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}})()});var vr=Y((Du,es)=>{"use strict";es.exports=function(e,n){return function(){for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];return e.apply(n,s)}}});var K=Y((zu,rs)=>{"use strict";var __=vr(),yr=Object.prototype.toString,br=function(t){return function(e){var n=yr.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())}}(Object.create(null));function We(t){return t=t.toLowerCase(),function(n){return br(n)===t}}function Mr(t){return Array.isArray(t)}function wn(t){return typeof t>"u"}function h_(t){return t!==null&&!wn(t)&&t.constructor!==null&&!wn(t.constructor)&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)}var ts=We("ArrayBuffer");function p_(t){var e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&ts(t.buffer),e}function d_(t){return typeof t=="string"}function m_(t){return typeof t=="number"}function ns(t){return t!==null&&typeof t=="object"}function gn(t){if(br(t)!=="object")return!1;var e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}var f_=We("Date"),u_=We("File"),g_=We("Blob"),w_=We("FileList");function Ar(t){return yr.call(t)==="[object Function]"}function v_(t){return ns(t)&&Ar(t.pipe)}function x_(t){var e="[object FormData]";return t&&(typeof FormData=="function"&&t instanceof FormData||yr.call(t)===e||Ar(t.toString)&&t.toString()===e)}var y_=We("URLSearchParams");function b_(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function M_(){return typeof navigator<"u"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window<"u"&&typeof document<"u"}function Tr(t,e){if(!(t===null||typeof t>"u"))if(typeof t!="object"&&(t=[t]),Mr(t))for(var n=0,r=t.length;n<r;n++)e.call(null,t[n],n,t);else for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.call(null,t[s],s,t)}function xr(){var t={};function e(s,a){gn(t[a])&&gn(s)?t[a]=xr(t[a],s):gn(s)?t[a]=xr({},s):Mr(s)?t[a]=s.slice():t[a]=s}for(var n=0,r=arguments.length;n<r;n++)Tr(arguments[n],e);return t}function A_(t,e,n){return Tr(e,function(s,a){n&&typeof s=="function"?t[a]=__(s,n):t[a]=s}),t}function T_(t){return t.charCodeAt(0)===65279&&(t=t.slice(1)),t}function S_(t,e,n,r){t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,n&&Object.assign(t.prototype,n)}function j_(t,e,n){var r,s,a,l={};e=e||{};do{for(r=Object.getOwnPropertyNames(t),s=r.length;s-- >0;)a=r[s],l[a]||(e[a]=t[a],l[a]=!0);t=Object.getPrototypeOf(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e}function P_(t,e,n){t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;var r=t.indexOf(e,n);return r!==-1&&r===n}function E_(t){if(!t)return null;var e=t.length;if(wn(e))return null;for(var n=new Array(e);e-- >0;)n[e]=t[e];return n}var I_=function(t){return function(e){return t&&e instanceof t}}(typeof Uint8Array<"u"&&Object.getPrototypeOf(Uint8Array));rs.exports={isArray:Mr,isArrayBuffer:ts,isBuffer:h_,isFormData:x_,isArrayBufferView:p_,isString:d_,isNumber:m_,isObject:ns,isPlainObject:gn,isUndefined:wn,isDate:f_,isFile:u_,isBlob:g_,isFunction:Ar,isStream:v_,isURLSearchParams:y_,isStandardBrowserEnv:M_,forEach:Tr,merge:xr,extend:A_,trim:b_,stripBOM:T_,inherits:S_,toFlatObject:j_,kindOf:br,kindOfTest:We,endsWith:P_,toArray:E_,isTypedArray:I_,isFileList:w_}});var Sr=Y((Uu,ss)=>{"use strict";var At=K();function is(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}ss.exports=function(e,n,r){if(!n)return e;var s;if(r)s=r(n);else if(At.isURLSearchParams(n))s=n.toString();else{var a=[];At.forEach(n,function(h,d){h===null||typeof h>"u"||(At.isArray(h)?d=d+"[]":h=[h],At.forEach(h,function(o){At.isDate(o)?o=o.toISOString():At.isObject(o)&&(o=JSON.stringify(o)),a.push(is(d)+"="+is(o))}))}),s=a.join("&")}if(s){var l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}});var os=Y((Nu,as)=>{"use strict";var F_=K();function vn(){this.handlers=[]}vn.prototype.use=function(e,n,r){return this.handlers.push({fulfilled:e,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1};vn.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)};vn.prototype.forEach=function(e){F_.forEach(this.handlers,function(r){r!==null&&e(r)})};as.exports=vn});var cs=Y((qu,ls)=>{"use strict";var R_=K();ls.exports=function(e,n){R_.forEach(e,function(s,a){a!==n&&a.toUpperCase()===n.toUpperCase()&&(e[n]=s,delete e[a])})}});var Xe=Y((Vu,ds)=>{"use strict";var _s=K();function Tt(t,e,n,r,s){Error.call(this),this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),r&&(this.request=r),s&&(this.response=s)}_s.inherits(Tt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var hs=Tt.prototype,ps={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach(function(t){ps[t]={value:t}});Object.defineProperties(Tt,ps);Object.defineProperty(hs,"isAxiosError",{value:!0});Tt.from=function(t,e,n,r,s,a){var l=Object.create(hs);return _s.toFlatObject(t,l,function(h){return h!==Error.prototype}),Tt.call(l,t.message,e,n,r,s),l.name=t.name,a&&Object.assign(l,a),l};ds.exports=Tt});var jr=Y((Hu,ms)=>{"use strict";ms.exports={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1}});var Pr=Y((Bu,fs)=>{"use strict";var ue=K();function C_(t,e){e=e||new FormData;var n=[];function r(a){return a===null?"":ue.isDate(a)?a.toISOString():ue.isArrayBuffer(a)||ue.isTypedArray(a)?typeof Blob=="function"?new Blob([a]):Buffer.from(a):a}function s(a,l){if(ue.isPlainObject(a)||ue.isArray(a)){if(n.indexOf(a)!==-1)throw Error("Circular reference detected in "+l);n.push(a),ue.forEach(a,function(h,d){if(!ue.isUndefined(h)){var i=l?l+"."+d:d,o;if(h&&!l&&typeof h=="object"){if(ue.endsWith(d,"{}"))h=JSON.stringify(h);else if(ue.endsWith(d,"[]")&&(o=ue.toArray(h))){o.forEach(function(_){!ue.isUndefined(_)&&e.append(i,r(_))});return}}s(h,i)}}),n.pop()}else e.append(l,r(a))}return s(t),e}fs.exports=C_});var gs=Y((Wu,us)=>{"use strict";var Er=Xe();us.exports=function(e,n,r){var s=r.config.validateStatus;!r.status||!s||s(r.status)?e(r):n(new Er("Request failed with status code "+r.status,[Er.ERR_BAD_REQUEST,Er.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}});var vs=Y((Xu,ws)=>{"use strict";var xn=K();ws.exports=xn.isStandardBrowserEnv()?function(){return{write:function(n,r,s,a,l,c){var h=[];h.push(n+"="+encodeURIComponent(r)),xn.isNumber(s)&&h.push("expires="+new Date(s).toGMTString()),xn.isString(a)&&h.push("path="+a),xn.isString(l)&&h.push("domain="+l),c===!0&&h.push("secure"),document.cookie=h.join("; ")},read:function(n){var r=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove:function(n){this.write(n,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()});var ys=Y((Yu,xs)=>{"use strict";xs.exports=function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}});var Ms=Y((Gu,bs)=>{"use strict";bs.exports=function(e,n){return n?e.replace(/\/+$/,"")+"/"+n.replace(/^\/+/,""):e}});var Ir=Y((Qu,As)=>{"use strict";var O_=ys(),k_=Ms();As.exports=function(e,n){return e&&!O_(n)?k_(e,n):n}});var Ss=Y(($u,Ts)=>{"use strict";var Fr=K(),L_=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];Ts.exports=function(e){var n={},r,s,a;return e&&Fr.forEach(e.split(`
`),function(c){if(a=c.indexOf(":"),r=Fr.trim(c.substr(0,a)).toLowerCase(),s=Fr.trim(c.substr(a+1)),r){if(n[r]&&L_.indexOf(r)>=0)return;r==="set-cookie"?n[r]=(n[r]?n[r]:[]).concat([s]):n[r]=n[r]?n[r]+", "+s:s}}),n}});var Es=Y((Zu,Ps)=>{"use strict";var js=K();Ps.exports=js.isStandardBrowserEnv()?function(){var e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a"),r;function s(a){var l=a;return e&&(n.setAttribute("href",l),l=n.href),n.setAttribute("href",l),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return r=s(window.location.href),function(l){var c=js.isString(l)?s(l):l;return c.protocol===r.protocol&&c.host===r.host}}():function(){return function(){return!0}}()});var Wt=Y((Ju,Fs)=>{"use strict";var Rr=Xe(),D_=K();function Is(t){Rr.call(this,t??"canceled",Rr.ERR_CANCELED),this.name="CanceledError"}D_.inherits(Is,Rr,{__CANCEL__:!0});Fs.exports=Is});var Cs=Y((Ku,Rs)=>{"use strict";Rs.exports=function(e){var n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return n&&n[1]||""}});var Cr=Y((e0,Os)=>{"use strict";var Xt=K(),z_=gs(),U_=vs(),N_=Sr(),q_=Ir(),V_=Ss(),H_=Es(),B_=jr(),Ae=Xe(),W_=Wt(),X_=Cs();Os.exports=function(e){return new Promise(function(r,s){var a=e.data,l=e.headers,c=e.responseType,h;function d(){e.cancelToken&&e.cancelToken.unsubscribe(h),e.signal&&e.signal.removeEventListener("abort",h)}Xt.isFormData(a)&&Xt.isStandardBrowserEnv()&&delete l["Content-Type"];var i=new XMLHttpRequest;if(e.auth){var o=e.auth.username||"",_=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";l.Authorization="Basic "+btoa(o+":"+_)}var m=q_(e.baseURL,e.url);i.open(e.method.toUpperCase(),N_(m,e.params,e.paramsSerializer),!0),i.timeout=e.timeout;function u(){if(i){var w="getAllResponseHeaders"in i?V_(i.getAllResponseHeaders()):null,v=!c||c==="text"||c==="json"?i.responseText:i.response,x={data:v,status:i.status,statusText:i.statusText,headers:w,config:e,request:i};z_(function(A){r(A),d()},function(A){s(A),d()},x),i=null}}if("onloadend"in i?i.onloadend=u:i.onreadystatechange=function(){!i||i.readyState!==4||i.status===0&&!(i.responseURL&&i.responseURL.indexOf("file:")===0)||setTimeout(u)},i.onabort=function(){i&&(s(new Ae("Request aborted",Ae.ECONNABORTED,e,i)),i=null)},i.onerror=function(){s(new Ae("Network Error",Ae.ERR_NETWORK,e,i,i)),i=null},i.ontimeout=function(){var v=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",x=e.transitional||B_;e.timeoutErrorMessage&&(v=e.timeoutErrorMessage),s(new Ae(v,x.clarifyTimeoutError?Ae.ETIMEDOUT:Ae.ECONNABORTED,e,i)),i=null},Xt.isStandardBrowserEnv()){var g=(e.withCredentials||H_(m))&&e.xsrfCookieName?U_.read(e.xsrfCookieName):void 0;g&&(l[e.xsrfHeaderName]=g)}"setRequestHeader"in i&&Xt.forEach(l,function(v,x){typeof a>"u"&&x.toLowerCase()==="content-type"?delete l[x]:i.setRequestHeader(x,v)}),Xt.isUndefined(e.withCredentials)||(i.withCredentials=!!e.withCredentials),c&&c!=="json"&&(i.responseType=e.responseType),typeof e.onDownloadProgress=="function"&&i.addEventListener("progress",e.onDownloadProgress),typeof e.onUploadProgress=="function"&&i.upload&&i.upload.addEventListener("progress",e.onUploadProgress),(e.cancelToken||e.signal)&&(h=function(w){i&&(s(!w||w&&w.type?new W_:w),i.abort(),i=null)},e.cancelToken&&e.cancelToken.subscribe(h),e.signal&&(e.signal.aborted?h():e.signal.addEventListener("abort",h))),a||(a=null);var f=X_(m);if(f&&["http","https","file"].indexOf(f)===-1){s(new Ae("Unsupported protocol "+f+":",Ae.ERR_BAD_REQUEST,e));return}i.send(a)})}});var Ls=Y((t0,ks)=>{ks.exports=null});var bn=Y((n0,Ns)=>{"use strict";var ee=K(),Ds=cs(),zs=Xe(),Y_=jr(),G_=Pr(),Q_={"Content-Type":"application/x-www-form-urlencoded"};function Us(t,e){!ee.isUndefined(t)&&ee.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}function $_(){var t;return typeof XMLHttpRequest<"u"?t=Cr():typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]"&&(t=Cr()),t}function Z_(t,e,n){if(ee.isString(t))try{return(e||JSON.parse)(t),ee.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(t)}var yn={transitional:Y_,adapter:$_(),transformRequest:[function(e,n){if(Ds(n,"Accept"),Ds(n,"Content-Type"),ee.isFormData(e)||ee.isArrayBuffer(e)||ee.isBuffer(e)||ee.isStream(e)||ee.isFile(e)||ee.isBlob(e))return e;if(ee.isArrayBufferView(e))return e.buffer;if(ee.isURLSearchParams(e))return Us(n,"application/x-www-form-urlencoded;charset=utf-8"),e.toString();var r=ee.isObject(e),s=n&&n["Content-Type"],a;if((a=ee.isFileList(e))||r&&s==="multipart/form-data"){var l=this.env&&this.env.FormData;return G_(a?{"files[]":e}:e,l&&new l)}else if(r||s==="application/json")return Us(n,"application/json"),Z_(e);return e}],transformResponse:[function(e){var n=this.transitional||yn.transitional,r=n&&n.silentJSONParsing,s=n&&n.forcedJSONParsing,a=!r&&this.responseType==="json";if(a||s&&ee.isString(e)&&e.length)try{return JSON.parse(e)}catch(l){if(a)throw l.name==="SyntaxError"?zs.from(l,zs.ERR_BAD_RESPONSE,this,null,this.response):l}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ls()},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};ee.forEach(["delete","get","head"],function(e){yn.headers[e]={}});ee.forEach(["post","put","patch"],function(e){yn.headers[e]=ee.merge(Q_)});Ns.exports=yn});var Vs=Y((r0,qs)=>{"use strict";var J_=K(),K_=bn();qs.exports=function(e,n,r){var s=this||K_;return J_.forEach(r,function(l){e=l.call(s,e,n)}),e}});var Or=Y((i0,Hs)=>{"use strict";Hs.exports=function(e){return!!(e&&e.__CANCEL__)}});var Xs=Y((s0,Ws)=>{"use strict";var Bs=K(),kr=Vs(),eh=Or(),th=bn(),nh=Wt();function Lr(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new nh}Ws.exports=function(e){Lr(e),e.headers=e.headers||{},e.data=kr.call(e,e.data,e.headers,e.transformRequest),e.headers=Bs.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),Bs.forEach(["delete","get","head","post","put","patch","common"],function(s){delete e.headers[s]});var n=e.adapter||th.adapter;return n(e).then(function(s){return Lr(e),s.data=kr.call(e,s.data,s.headers,e.transformResponse),s},function(s){return eh(s)||(Lr(e),s&&s.response&&(s.response.data=kr.call(e,s.response.data,s.response.headers,e.transformResponse))),Promise.reject(s)})}});var Dr=Y((a0,Ys)=>{"use strict";var ae=K();Ys.exports=function(e,n){n=n||{};var r={};function s(i,o){return ae.isPlainObject(i)&&ae.isPlainObject(o)?ae.merge(i,o):ae.isPlainObject(o)?ae.merge({},o):ae.isArray(o)?o.slice():o}function a(i){if(ae.isUndefined(n[i])){if(!ae.isUndefined(e[i]))return s(void 0,e[i])}else return s(e[i],n[i])}function l(i){if(!ae.isUndefined(n[i]))return s(void 0,n[i])}function c(i){if(ae.isUndefined(n[i])){if(!ae.isUndefined(e[i]))return s(void 0,e[i])}else return s(void 0,n[i])}function h(i){if(i in n)return s(e[i],n[i]);if(i in e)return s(void 0,e[i])}var d={url:l,method:l,data:l,baseURL:c,transformRequest:c,transformResponse:c,paramsSerializer:c,timeout:c,timeoutMessage:c,withCredentials:c,adapter:c,responseType:c,xsrfCookieName:c,xsrfHeaderName:c,onUploadProgress:c,onDownloadProgress:c,decompress:c,maxContentLength:c,maxBodyLength:c,beforeRedirect:c,transport:c,httpAgent:c,httpsAgent:c,cancelToken:c,socketPath:c,responseEncoding:c,validateStatus:h};return ae.forEach(Object.keys(e).concat(Object.keys(n)),function(o){var _=d[o]||a,m=_(o);ae.isUndefined(m)&&_!==h||(r[o]=m)}),r}});var zr=Y((o0,Gs)=>{Gs.exports={version:"0.27.2"}});var Zs=Y((l0,$s)=>{"use strict";var rh=zr().version,Ce=Xe(),Ur={};["object","boolean","number","function","string","symbol"].forEach(function(t,e){Ur[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});var Qs={};Ur.transitional=function(e,n,r){function s(a,l){return"[Axios v"+rh+"] Transitional option '"+a+"'"+l+(r?". "+r:"")}return function(a,l,c){if(e===!1)throw new Ce(s(l," has been removed"+(n?" in "+n:"")),Ce.ERR_DEPRECATED);return n&&!Qs[l]&&(Qs[l]=!0,console.warn(s(l," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(a,l,c):!0}};function ih(t,e,n){if(typeof t!="object")throw new Ce("options must be an object",Ce.ERR_BAD_OPTION_VALUE);for(var r=Object.keys(t),s=r.length;s-- >0;){var a=r[s],l=e[a];if(l){var c=t[a],h=c===void 0||l(c,a,t);if(h!==!0)throw new Ce("option "+a+" must be "+h,Ce.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Ce("Unknown option "+a,Ce.ERR_BAD_OPTION)}}$s.exports={assertOptions:ih,validators:Ur}});var ra=Y((c0,na)=>{"use strict";var ea=K(),sh=Sr(),Js=os(),Ks=Xs(),Mn=Dr(),ah=Ir(),ta=Zs(),St=ta.validators;function jt(t){this.defaults=t,this.interceptors={request:new Js,response:new Js}}jt.prototype.request=function(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=Mn(this.defaults,n),n.method?n.method=n.method.toLowerCase():this.defaults.method?n.method=this.defaults.method.toLowerCase():n.method="get";var r=n.transitional;r!==void 0&&ta.assertOptions(r,{silentJSONParsing:St.transitional(St.boolean),forcedJSONParsing:St.transitional(St.boolean),clarifyTimeoutError:St.transitional(St.boolean)},!1);var s=[],a=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(n)===!1||(a=a&&m.synchronous,s.unshift(m.fulfilled,m.rejected))});var l=[];this.interceptors.response.forEach(function(m){l.push(m.fulfilled,m.rejected)});var c;if(!a){var h=[Ks,void 0];for(Array.prototype.unshift.apply(h,s),h=h.concat(l),c=Promise.resolve(n);h.length;)c=c.then(h.shift(),h.shift());return c}for(var d=n;s.length;){var i=s.shift(),o=s.shift();try{d=i(d)}catch(_){o(_);break}}try{c=Ks(d)}catch(_){return Promise.reject(_)}for(;l.length;)c=c.then(l.shift(),l.shift());return c};jt.prototype.getUri=function(e){e=Mn(this.defaults,e);var n=ah(e.baseURL,e.url);return sh(n,e.params,e.paramsSerializer)};ea.forEach(["delete","get","head","options"],function(e){jt.prototype[e]=function(n,r){return this.request(Mn(r||{},{method:e,url:n,data:(r||{}).data}))}});ea.forEach(["post","put","patch"],function(e){function n(r){return function(a,l,c){return this.request(Mn(c||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:a,data:l}))}}jt.prototype[e]=n(),jt.prototype[e+"Form"]=n(!0)});na.exports=jt});var sa=Y((_0,ia)=>{"use strict";var oh=Wt();function Pt(t){if(typeof t!="function")throw new TypeError("executor must be a function.");var e;this.promise=new Promise(function(s){e=s});var n=this;this.promise.then(function(r){if(n._listeners){var s,a=n._listeners.length;for(s=0;s<a;s++)n._listeners[s](r);n._listeners=null}}),this.promise.then=function(r){var s,a=new Promise(function(l){n.subscribe(l),s=l}).then(r);return a.cancel=function(){n.unsubscribe(s)},a},t(function(s){n.reason||(n.reason=new oh(s),e(n.reason))})}Pt.prototype.throwIfRequested=function(){if(this.reason)throw this.reason};Pt.prototype.subscribe=function(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]};Pt.prototype.unsubscribe=function(e){if(this._listeners){var n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}};Pt.source=function(){var e,n=new Pt(function(s){e=s});return{token:n,cancel:e}};ia.exports=Pt});var oa=Y((h0,aa)=>{"use strict";aa.exports=function(e){return function(r){return e.apply(null,r)}}});var ca=Y((p0,la)=>{"use strict";var lh=K();la.exports=function(e){return lh.isObject(e)&&e.isAxiosError===!0}});var pa=Y((d0,Nr)=>{"use strict";var _a=K(),ch=vr(),An=ra(),_h=Dr(),hh=bn();function ha(t){var e=new An(t),n=ch(An.prototype.request,e);return _a.extend(n,An.prototype,e),_a.extend(n,e),n.create=function(s){return ha(_h(t,s))},n}var re=ha(hh);re.Axios=An;re.CanceledError=Wt();re.CancelToken=sa();re.isCancel=Or();re.VERSION=zr().version;re.toFormData=Pr();re.AxiosError=Xe();re.Cancel=re.CanceledError;re.all=function(e){return Promise.all(e)};re.spread=oa();re.isAxiosError=ca();Nr.exports=re;Nr.exports.default=re});var qr=Y((m0,da)=>{da.exports=pa()});var ni=Y(Wn=>{(function(){"use strict";var t=function(){this.init()};t.prototype={init:function(){var i=this||e;return i._counter=1e3,i._html5AudioPool=[],i.html5PoolSize=10,i._codecs={},i._howls=[],i._muted=!1,i._volume=1,i._canPlayEvent="canplaythrough",i._navigator=typeof window<"u"&&window.navigator?window.navigator:null,i.masterGain=null,i.noAudio=!1,i.usingWebAudio=!0,i.autoSuspend=!0,i.ctx=null,i.autoUnlock=!0,i._setup(),i},volume:function(i){var o=this||e;if(i=parseFloat(i),o.ctx||d(),typeof i<"u"&&i>=0&&i<=1){if(o._volume=i,o._muted)return o;o.usingWebAudio&&o.masterGain.gain.setValueAtTime(i,e.ctx.currentTime);for(var _=0;_<o._howls.length;_++)if(!o._howls[_]._webAudio)for(var m=o._howls[_]._getSoundIds(),u=0;u<m.length;u++){var g=o._howls[_]._soundById(m[u]);g&&g._node&&(g._node.volume=g._volume*i)}return o}return o._volume},mute:function(i){var o=this||e;o.ctx||d(),o._muted=i,o.usingWebAudio&&o.masterGain.gain.setValueAtTime(i?0:o._volume,e.ctx.currentTime);for(var _=0;_<o._howls.length;_++)if(!o._howls[_]._webAudio)for(var m=o._howls[_]._getSoundIds(),u=0;u<m.length;u++){var g=o._howls[_]._soundById(m[u]);g&&g._node&&(g._node.muted=i?!0:g._muted)}return o},stop:function(){for(var i=this||e,o=0;o<i._howls.length;o++)i._howls[o].stop();return i},unload:function(){for(var i=this||e,o=i._howls.length-1;o>=0;o--)i._howls[o].unload();return i.usingWebAudio&&i.ctx&&typeof i.ctx.close<"u"&&(i.ctx.close(),i.ctx=null,d()),i},codecs:function(i){return(this||e)._codecs[i.replace(/^x-/,"")]},_setup:function(){var i=this||e;if(i.state=i.ctx&&i.ctx.state||"suspended",i._autoSuspend(),!i.usingWebAudio)if(typeof Audio<"u")try{var o=new Audio;typeof o.oncanplaythrough>"u"&&(i._canPlayEvent="canplay")}catch{i.noAudio=!0}else i.noAudio=!0;try{var o=new Audio;o.muted&&(i.noAudio=!0)}catch{}return i.noAudio||i._setupCodecs(),i},_setupCodecs:function(){var i=this||e,o=null;try{o=typeof Audio<"u"?new Audio:null}catch{return i}if(!o||typeof o.canPlayType!="function")return i;var _=o.canPlayType("audio/mpeg;").replace(/^no$/,""),m=i._navigator?i._navigator.userAgent:"",u=m.match(/OPR\/([0-6].)/g),g=u&&parseInt(u[0].split("/")[1],10)<33,f=m.indexOf("Safari")!==-1&&m.indexOf("Chrome")===-1,w=m.match(/Version\/(.*?) /),v=f&&w&&parseInt(w[1],10)<15;return i._codecs={mp3:!!(!g&&(_||o.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!_,opus:!!o.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!o.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!o.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(o.canPlayType('audio/wav; codecs="1"')||o.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!o.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!o.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(o.canPlayType("audio/x-m4a;")||o.canPlayType("audio/m4a;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(o.canPlayType("audio/x-m4b;")||o.canPlayType("audio/m4b;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(o.canPlayType("audio/x-mp4;")||o.canPlayType("audio/mp4;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!v&&o.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!v&&o.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!o.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(o.canPlayType("audio/x-flac;")||o.canPlayType("audio/flac;")).replace(/^no$/,"")},i},_unlockAudio:function(){var i=this||e;if(!(i._audioUnlocked||!i.ctx)){i._audioUnlocked=!1,i.autoUnlock=!1,!i._mobileUnloaded&&i.ctx.sampleRate!==44100&&(i._mobileUnloaded=!0,i.unload()),i._scratchBuffer=i.ctx.createBuffer(1,1,22050);var o=function(_){for(;i._html5AudioPool.length<i.html5PoolSize;)try{var m=new Audio;m._unlocked=!0,i._releaseHtml5Audio(m)}catch{i.noAudio=!0;break}for(var u=0;u<i._howls.length;u++)if(!i._howls[u]._webAudio)for(var g=i._howls[u]._getSoundIds(),f=0;f<g.length;f++){var w=i._howls[u]._soundById(g[f]);w&&w._node&&!w._node._unlocked&&(w._node._unlocked=!0,w._node.load())}i._autoResume();var v=i.ctx.createBufferSource();v.buffer=i._scratchBuffer,v.connect(i.ctx.destination),typeof v.start>"u"?v.noteOn(0):v.start(0),typeof i.ctx.resume=="function"&&i.ctx.resume(),v.onended=function(){v.disconnect(0),i._audioUnlocked=!0,document.removeEventListener("touchstart",o,!0),document.removeEventListener("touchend",o,!0),document.removeEventListener("click",o,!0),document.removeEventListener("keydown",o,!0);for(var x=0;x<i._howls.length;x++)i._howls[x]._emit("unlock")}};return document.addEventListener("touchstart",o,!0),document.addEventListener("touchend",o,!0),document.addEventListener("click",o,!0),document.addEventListener("keydown",o,!0),i}},_obtainHtml5Audio:function(){var i=this||e;if(i._html5AudioPool.length)return i._html5AudioPool.pop();var o=new Audio().play();return o&&typeof Promise<"u"&&(o instanceof Promise||typeof o.then=="function")&&o.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(i){var o=this||e;return i._unlocked&&o._html5AudioPool.push(i),o},_autoSuspend:function(){var i=this;if(!(!i.autoSuspend||!i.ctx||typeof i.ctx.suspend>"u"||!e.usingWebAudio)){for(var o=0;o<i._howls.length;o++)if(i._howls[o]._webAudio){for(var _=0;_<i._howls[o]._sounds.length;_++)if(!i._howls[o]._sounds[_]._paused)return i}return i._suspendTimer&&clearTimeout(i._suspendTimer),i._suspendTimer=setTimeout(function(){if(i.autoSuspend){i._suspendTimer=null,i.state="suspending";var m=function(){i.state="suspended",i._resumeAfterSuspend&&(delete i._resumeAfterSuspend,i._autoResume())};i.ctx.suspend().then(m,m)}},3e4),i}},_autoResume:function(){var i=this;if(!(!i.ctx||typeof i.ctx.resume>"u"||!e.usingWebAudio))return i.state==="running"&&i.ctx.state!=="interrupted"&&i._suspendTimer?(clearTimeout(i._suspendTimer),i._suspendTimer=null):i.state==="suspended"||i.state==="running"&&i.ctx.state==="interrupted"?(i.ctx.resume().then(function(){i.state="running";for(var o=0;o<i._howls.length;o++)i._howls[o]._emit("resume")}),i._suspendTimer&&(clearTimeout(i._suspendTimer),i._suspendTimer=null)):i.state==="suspending"&&(i._resumeAfterSuspend=!0),i}};var e=new t,n=function(i){var o=this;if(!i.src||i.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}o.init(i)};n.prototype={init:function(i){var o=this;return e.ctx||d(),o._autoplay=i.autoplay||!1,o._format=typeof i.format!="string"?i.format:[i.format],o._html5=i.html5||!1,o._muted=i.mute||!1,o._loop=i.loop||!1,o._pool=i.pool||5,o._preload=typeof i.preload=="boolean"||i.preload==="metadata"?i.preload:!0,o._rate=i.rate||1,o._sprite=i.sprite||{},o._src=typeof i.src!="string"?i.src:[i.src],o._volume=i.volume!==void 0?i.volume:1,o._xhr={method:i.xhr&&i.xhr.method?i.xhr.method:"GET",headers:i.xhr&&i.xhr.headers?i.xhr.headers:null,withCredentials:i.xhr&&i.xhr.withCredentials?i.xhr.withCredentials:!1},o._duration=0,o._state="unloaded",o._sounds=[],o._endTimers={},o._queue=[],o._playLock=!1,o._onend=i.onend?[{fn:i.onend}]:[],o._onfade=i.onfade?[{fn:i.onfade}]:[],o._onload=i.onload?[{fn:i.onload}]:[],o._onloaderror=i.onloaderror?[{fn:i.onloaderror}]:[],o._onplayerror=i.onplayerror?[{fn:i.onplayerror}]:[],o._onpause=i.onpause?[{fn:i.onpause}]:[],o._onplay=i.onplay?[{fn:i.onplay}]:[],o._onstop=i.onstop?[{fn:i.onstop}]:[],o._onmute=i.onmute?[{fn:i.onmute}]:[],o._onvolume=i.onvolume?[{fn:i.onvolume}]:[],o._onrate=i.onrate?[{fn:i.onrate}]:[],o._onseek=i.onseek?[{fn:i.onseek}]:[],o._onunlock=i.onunlock?[{fn:i.onunlock}]:[],o._onresume=[],o._webAudio=e.usingWebAudio&&!o._html5,typeof e.ctx<"u"&&e.ctx&&e.autoUnlock&&e._unlockAudio(),e._howls.push(o),o._autoplay&&o._queue.push({event:"play",action:function(){o.play()}}),o._preload&&o._preload!=="none"&&o.load(),o},load:function(){var i=this,o=null;if(e.noAudio){i._emit("loaderror",null,"No audio support.");return}typeof i._src=="string"&&(i._src=[i._src]);for(var _=0;_<i._src.length;_++){var m,u;if(i._format&&i._format[_])m=i._format[_];else{if(u=i._src[_],typeof u!="string"){i._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}m=/^data:audio\/([^;,]+);/i.exec(u),m||(m=/\.([^.]+)$/.exec(u.split("?",1)[0])),m&&(m=m[1].toLowerCase())}if(m||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),m&&e.codecs(m)){o=i._src[_];break}}if(!o){i._emit("loaderror",null,"No codec support for selected audio sources.");return}return i._src=o,i._state="loading",window.location.protocol==="https:"&&o.slice(0,5)==="http:"&&(i._html5=!0,i._webAudio=!1),new r(i),i._webAudio&&a(i),i},play:function(i,o){var _=this,m=null;if(typeof i=="number")m=i,i=null;else{if(typeof i=="string"&&_._state==="loaded"&&!_._sprite[i])return null;if(typeof i>"u"&&(i="__default",!_._playLock)){for(var u=0,g=0;g<_._sounds.length;g++)_._sounds[g]._paused&&!_._sounds[g]._ended&&(u++,m=_._sounds[g]._id);u===1?i=null:m=null}}var f=m?_._soundById(m):_._inactiveSound();if(!f)return null;if(m&&!i&&(i=f._sprite||"__default"),_._state!=="loaded"){f._sprite=i,f._ended=!1;var w=f._id;return _._queue.push({event:"play",action:function(){_.play(w)}}),w}if(m&&!f._paused)return o||_._loadQueue("play"),f._id;_._webAudio&&e._autoResume();var v=Math.max(0,f._seek>0?f._seek:_._sprite[i][0]/1e3),x=Math.max(0,(_._sprite[i][0]+_._sprite[i][1])/1e3-v),T=x*1e3/Math.abs(f._rate),A=_._sprite[i][0]/1e3,S=(_._sprite[i][0]+_._sprite[i][1])/1e3;f._sprite=i,f._ended=!1;var F=function(){f._paused=!1,f._seek=v,f._start=A,f._stop=S,f._loop=!!(f._loop||_._sprite[i][2])};if(v>=S){_._ended(f);return}var E=f._node;if(_._webAudio){var D=function(){_._playLock=!1,F(),_._refreshBuffer(f);var L=f._muted||_._muted?0:f._volume;E.gain.setValueAtTime(L,e.ctx.currentTime),f._playStart=e.ctx.currentTime,typeof E.bufferSource.start>"u"?f._loop?E.bufferSource.noteGrainOn(0,v,86400):E.bufferSource.noteGrainOn(0,v,x):f._loop?E.bufferSource.start(0,v,86400):E.bufferSource.start(0,v,x),T!==1/0&&(_._endTimers[f._id]=setTimeout(_._ended.bind(_,f),T)),o||setTimeout(function(){_._emit("play",f._id),_._loadQueue()},0)};e.state==="running"&&e.ctx.state!=="interrupted"?D():(_._playLock=!0,_.once("resume",D),_._clearTimer(f._id))}else{var z=function(){E.currentTime=v,E.muted=f._muted||_._muted||e._muted||E.muted,E.volume=f._volume*e.volume(),E.playbackRate=f._rate;try{var L=E.play();if(L&&typeof Promise<"u"&&(L instanceof Promise||typeof L.then=="function")?(_._playLock=!0,F(),L.then(function(){_._playLock=!1,E._unlocked=!0,o?_._loadQueue():_._emit("play",f._id)}).catch(function(){_._playLock=!1,_._emit("playerror",f._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),f._ended=!0,f._paused=!0})):o||(_._playLock=!1,F(),_._emit("play",f._id)),E.playbackRate=f._rate,E.paused){_._emit("playerror",f._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}i!=="__default"||f._loop?_._endTimers[f._id]=setTimeout(_._ended.bind(_,f),T):(_._endTimers[f._id]=function(){_._ended(f),E.removeEventListener("ended",_._endTimers[f._id],!1)},E.addEventListener("ended",_._endTimers[f._id],!1))}catch(I){_._emit("playerror",f._id,I)}};E.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(E.src=_._src,E.load());var V=window&&window.ejecta||!E.readyState&&e._navigator.isCocoonJS;if(E.readyState>=3||V)z();else{_._playLock=!0,_._state="loading";var U=function(){_._state="loaded",z(),E.removeEventListener(e._canPlayEvent,U,!1)};E.addEventListener(e._canPlayEvent,U,!1),_._clearTimer(f._id)}}return f._id},pause:function(i){var o=this;if(o._state!=="loaded"||o._playLock)return o._queue.push({event:"pause",action:function(){o.pause(i)}}),o;for(var _=o._getSoundIds(i),m=0;m<_.length;m++){o._clearTimer(_[m]);var u=o._soundById(_[m]);if(u&&!u._paused&&(u._seek=o.seek(_[m]),u._rateSeek=0,u._paused=!0,o._stopFade(_[m]),u._node))if(o._webAudio){if(!u._node.bufferSource)continue;typeof u._node.bufferSource.stop>"u"?u._node.bufferSource.noteOff(0):u._node.bufferSource.stop(0),o._cleanBuffer(u._node)}else(!isNaN(u._node.duration)||u._node.duration===1/0)&&u._node.pause();arguments[1]||o._emit("pause",u?u._id:null)}return o},stop:function(i,o){var _=this;if(_._state!=="loaded"||_._playLock)return _._queue.push({event:"stop",action:function(){_.stop(i)}}),_;for(var m=_._getSoundIds(i),u=0;u<m.length;u++){_._clearTimer(m[u]);var g=_._soundById(m[u]);g&&(g._seek=g._start||0,g._rateSeek=0,g._paused=!0,g._ended=!0,_._stopFade(m[u]),g._node&&(_._webAudio?g._node.bufferSource&&(typeof g._node.bufferSource.stop>"u"?g._node.bufferSource.noteOff(0):g._node.bufferSource.stop(0),_._cleanBuffer(g._node)):(!isNaN(g._node.duration)||g._node.duration===1/0)&&(g._node.currentTime=g._start||0,g._node.pause(),g._node.duration===1/0&&_._clearSound(g._node))),o||_._emit("stop",g._id))}return _},mute:function(i,o){var _=this;if(_._state!=="loaded"||_._playLock)return _._queue.push({event:"mute",action:function(){_.mute(i,o)}}),_;if(typeof o>"u")if(typeof i=="boolean")_._muted=i;else return _._muted;for(var m=_._getSoundIds(o),u=0;u<m.length;u++){var g=_._soundById(m[u]);g&&(g._muted=i,g._interval&&_._stopFade(g._id),_._webAudio&&g._node?g._node.gain.setValueAtTime(i?0:g._volume,e.ctx.currentTime):g._node&&(g._node.muted=e._muted?!0:i),_._emit("mute",g._id))}return _},volume:function(){var i=this,o=arguments,_,m;if(o.length===0)return i._volume;if(o.length===1||o.length===2&&typeof o[1]>"u"){var u=i._getSoundIds(),g=u.indexOf(o[0]);g>=0?m=parseInt(o[0],10):_=parseFloat(o[0])}else o.length>=2&&(_=parseFloat(o[0]),m=parseInt(o[1],10));var f;if(typeof _<"u"&&_>=0&&_<=1){if(i._state!=="loaded"||i._playLock)return i._queue.push({event:"volume",action:function(){i.volume.apply(i,o)}}),i;typeof m>"u"&&(i._volume=_),m=i._getSoundIds(m);for(var w=0;w<m.length;w++)f=i._soundById(m[w]),f&&(f._volume=_,o[2]||i._stopFade(m[w]),i._webAudio&&f._node&&!f._muted?f._node.gain.setValueAtTime(_,e.ctx.currentTime):f._node&&!f._muted&&(f._node.volume=_*e.volume()),i._emit("volume",f._id))}else return f=m?i._soundById(m):i._sounds[0],f?f._volume:0;return i},fade:function(i,o,_,m){var u=this;if(u._state!=="loaded"||u._playLock)return u._queue.push({event:"fade",action:function(){u.fade(i,o,_,m)}}),u;i=Math.min(Math.max(0,parseFloat(i)),1),o=Math.min(Math.max(0,parseFloat(o)),1),_=parseFloat(_),u.volume(i,m);for(var g=u._getSoundIds(m),f=0;f<g.length;f++){var w=u._soundById(g[f]);if(w){if(m||u._stopFade(g[f]),u._webAudio&&!w._muted){var v=e.ctx.currentTime,x=v+_/1e3;w._volume=i,w._node.gain.setValueAtTime(i,v),w._node.gain.linearRampToValueAtTime(o,x)}u._startFadeInterval(w,i,o,_,g[f],typeof m>"u")}}return u},_startFadeInterval:function(i,o,_,m,u,g){var f=this,w=o,v=_-o,x=Math.abs(v/.01),T=Math.max(4,x>0?m/x:m),A=Date.now();i._fadeTo=_,i._interval=setInterval(function(){var S=(Date.now()-A)/m;A=Date.now(),w+=v*S,w=Math.round(w*100)/100,v<0?w=Math.max(_,w):w=Math.min(_,w),f._webAudio?i._volume=w:f.volume(w,i._id,!0),g&&(f._volume=w),(_<o&&w<=_||_>o&&w>=_)&&(clearInterval(i._interval),i._interval=null,i._fadeTo=null,f.volume(_,i._id),f._emit("fade",i._id))},T)},_stopFade:function(i){var o=this,_=o._soundById(i);return _&&_._interval&&(o._webAudio&&_._node.gain.cancelScheduledValues(e.ctx.currentTime),clearInterval(_._interval),_._interval=null,o.volume(_._fadeTo,i),_._fadeTo=null,o._emit("fade",i)),o},loop:function(){var i=this,o=arguments,_,m,u;if(o.length===0)return i._loop;if(o.length===1)if(typeof o[0]=="boolean")_=o[0],i._loop=_;else return u=i._soundById(parseInt(o[0],10)),u?u._loop:!1;else o.length===2&&(_=o[0],m=parseInt(o[1],10));for(var g=i._getSoundIds(m),f=0;f<g.length;f++)u=i._soundById(g[f]),u&&(u._loop=_,i._webAudio&&u._node&&u._node.bufferSource&&(u._node.bufferSource.loop=_,_&&(u._node.bufferSource.loopStart=u._start||0,u._node.bufferSource.loopEnd=u._stop,i.playing(g[f])&&(i.pause(g[f],!0),i.play(g[f],!0)))));return i},rate:function(){var i=this,o=arguments,_,m;if(o.length===0)m=i._sounds[0]._id;else if(o.length===1){var u=i._getSoundIds(),g=u.indexOf(o[0]);g>=0?m=parseInt(o[0],10):_=parseFloat(o[0])}else o.length===2&&(_=parseFloat(o[0]),m=parseInt(o[1],10));var f;if(typeof _=="number"){if(i._state!=="loaded"||i._playLock)return i._queue.push({event:"rate",action:function(){i.rate.apply(i,o)}}),i;typeof m>"u"&&(i._rate=_),m=i._getSoundIds(m);for(var w=0;w<m.length;w++)if(f=i._soundById(m[w]),f){i.playing(m[w])&&(f._rateSeek=i.seek(m[w]),f._playStart=i._webAudio?e.ctx.currentTime:f._playStart),f._rate=_,i._webAudio&&f._node&&f._node.bufferSource?f._node.bufferSource.playbackRate.setValueAtTime(_,e.ctx.currentTime):f._node&&(f._node.playbackRate=_);var v=i.seek(m[w]),x=(i._sprite[f._sprite][0]+i._sprite[f._sprite][1])/1e3-v,T=x*1e3/Math.abs(f._rate);(i._endTimers[m[w]]||!f._paused)&&(i._clearTimer(m[w]),i._endTimers[m[w]]=setTimeout(i._ended.bind(i,f),T)),i._emit("rate",f._id)}}else return f=i._soundById(m),f?f._rate:i._rate;return i},seek:function(){var i=this,o=arguments,_,m;if(o.length===0)i._sounds.length&&(m=i._sounds[0]._id);else if(o.length===1){var u=i._getSoundIds(),g=u.indexOf(o[0]);g>=0?m=parseInt(o[0],10):i._sounds.length&&(m=i._sounds[0]._id,_=parseFloat(o[0]))}else o.length===2&&(_=parseFloat(o[0]),m=parseInt(o[1],10));if(typeof m>"u")return 0;if(typeof _=="number"&&(i._state!=="loaded"||i._playLock))return i._queue.push({event:"seek",action:function(){i.seek.apply(i,o)}}),i;var f=i._soundById(m);if(f)if(typeof _=="number"&&_>=0){var w=i.playing(m);w&&i.pause(m,!0),f._seek=_,f._ended=!1,i._clearTimer(m),!i._webAudio&&f._node&&!isNaN(f._node.duration)&&(f._node.currentTime=_);var v=function(){w&&i.play(m,!0),i._emit("seek",m)};if(w&&!i._webAudio){var x=function(){i._playLock?setTimeout(x,0):v()};setTimeout(x,0)}else v()}else if(i._webAudio){var T=i.playing(m)?e.ctx.currentTime-f._playStart:0,A=f._rateSeek?f._rateSeek-f._seek:0;return f._seek+(A+T*Math.abs(f._rate))}else return f._node.currentTime;return i},playing:function(i){var o=this;if(typeof i=="number"){var _=o._soundById(i);return _?!_._paused:!1}for(var m=0;m<o._sounds.length;m++)if(!o._sounds[m]._paused)return!0;return!1},duration:function(i){var o=this,_=o._duration,m=o._soundById(i);return m&&(_=o._sprite[m._sprite][1]/1e3),_},state:function(){return this._state},unload:function(){for(var i=this,o=i._sounds,_=0;_<o.length;_++)o[_]._paused||i.stop(o[_]._id),i._webAudio||(i._clearSound(o[_]._node),o[_]._node.removeEventListener("error",o[_]._errorFn,!1),o[_]._node.removeEventListener(e._canPlayEvent,o[_]._loadFn,!1),o[_]._node.removeEventListener("ended",o[_]._endFn,!1),e._releaseHtml5Audio(o[_]._node)),delete o[_]._node,i._clearTimer(o[_]._id);var m=e._howls.indexOf(i);m>=0&&e._howls.splice(m,1);var u=!0;for(_=0;_<e._howls.length;_++)if(e._howls[_]._src===i._src||i._src.indexOf(e._howls[_]._src)>=0){u=!1;break}return s&&u&&delete s[i._src],e.noAudio=!1,i._state="unloaded",i._sounds=[],i=null,null},on:function(i,o,_,m){var u=this,g=u["_on"+i];return typeof o=="function"&&g.push(m?{id:_,fn:o,once:m}:{id:_,fn:o}),u},off:function(i,o,_){var m=this,u=m["_on"+i],g=0;if(typeof o=="number"&&(_=o,o=null),o||_)for(g=0;g<u.length;g++){var f=_===u[g].id;if(o===u[g].fn&&f||!o&&f){u.splice(g,1);break}}else if(i)m["_on"+i]=[];else{var w=Object.keys(m);for(g=0;g<w.length;g++)w[g].indexOf("_on")===0&&Array.isArray(m[w[g]])&&(m[w[g]]=[])}return m},once:function(i,o,_){var m=this;return m.on(i,o,_,1),m},_emit:function(i,o,_){for(var m=this,u=m["_on"+i],g=u.length-1;g>=0;g--)(!u[g].id||u[g].id===o||i==="load")&&(setTimeout(function(f){f.call(this,o,_)}.bind(m,u[g].fn),0),u[g].once&&m.off(i,u[g].fn,u[g].id));return m._loadQueue(i),m},_loadQueue:function(i){var o=this;if(o._queue.length>0){var _=o._queue[0];_.event===i&&(o._queue.shift(),o._loadQueue()),i||_.action()}return o},_ended:function(i){var o=this,_=i._sprite;if(!o._webAudio&&i._node&&!i._node.paused&&!i._node.ended&&i._node.currentTime<i._stop)return setTimeout(o._ended.bind(o,i),100),o;var m=!!(i._loop||o._sprite[_][2]);if(o._emit("end",i._id),!o._webAudio&&m&&o.stop(i._id,!0).play(i._id),o._webAudio&&m){o._emit("play",i._id),i._seek=i._start||0,i._rateSeek=0,i._playStart=e.ctx.currentTime;var u=(i._stop-i._start)*1e3/Math.abs(i._rate);o._endTimers[i._id]=setTimeout(o._ended.bind(o,i),u)}return o._webAudio&&!m&&(i._paused=!0,i._ended=!0,i._seek=i._start||0,i._rateSeek=0,o._clearTimer(i._id),o._cleanBuffer(i._node),e._autoSuspend()),!o._webAudio&&!m&&o.stop(i._id,!0),o},_clearTimer:function(i){var o=this;if(o._endTimers[i]){if(typeof o._endTimers[i]!="function")clearTimeout(o._endTimers[i]);else{var _=o._soundById(i);_&&_._node&&_._node.removeEventListener("ended",o._endTimers[i],!1)}delete o._endTimers[i]}return o},_soundById:function(i){for(var o=this,_=0;_<o._sounds.length;_++)if(i===o._sounds[_]._id)return o._sounds[_];return null},_inactiveSound:function(){var i=this;i._drain();for(var o=0;o<i._sounds.length;o++)if(i._sounds[o]._ended)return i._sounds[o].reset();return new r(i)},_drain:function(){var i=this,o=i._pool,_=0,m=0;if(!(i._sounds.length<o)){for(m=0;m<i._sounds.length;m++)i._sounds[m]._ended&&_++;for(m=i._sounds.length-1;m>=0;m--){if(_<=o)return;i._sounds[m]._ended&&(i._webAudio&&i._sounds[m]._node&&i._sounds[m]._node.disconnect(0),i._sounds.splice(m,1),_--)}}},_getSoundIds:function(i){var o=this;if(typeof i>"u"){for(var _=[],m=0;m<o._sounds.length;m++)_.push(o._sounds[m]._id);return _}else return[i]},_refreshBuffer:function(i){var o=this;return i._node.bufferSource=e.ctx.createBufferSource(),i._node.bufferSource.buffer=s[o._src],i._panner?i._node.bufferSource.connect(i._panner):i._node.bufferSource.connect(i._node),i._node.bufferSource.loop=i._loop,i._loop&&(i._node.bufferSource.loopStart=i._start||0,i._node.bufferSource.loopEnd=i._stop||0),i._node.bufferSource.playbackRate.setValueAtTime(i._rate,e.ctx.currentTime),o},_cleanBuffer:function(i){var o=this,_=e._navigator&&e._navigator.vendor.indexOf("Apple")>=0;if(e._scratchBuffer&&i.bufferSource&&(i.bufferSource.onended=null,i.bufferSource.disconnect(0),_))try{i.bufferSource.buffer=e._scratchBuffer}catch{}return i.bufferSource=null,o},_clearSound:function(i){var o=/MSIE |Trident\//.test(e._navigator&&e._navigator.userAgent);o||(i.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var r=function(i){this._parent=i,this.init()};r.prototype={init:function(){var i=this,o=i._parent;return i._muted=o._muted,i._loop=o._loop,i._volume=o._volume,i._rate=o._rate,i._seek=0,i._paused=!0,i._ended=!0,i._sprite="__default",i._id=++e._counter,o._sounds.push(i),i.create(),i},create:function(){var i=this,o=i._parent,_=e._muted||i._muted||i._parent._muted?0:i._volume;return o._webAudio?(i._node=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),i._node.gain.setValueAtTime(_,e.ctx.currentTime),i._node.paused=!0,i._node.connect(e.masterGain)):e.noAudio||(i._node=e._obtainHtml5Audio(),i._errorFn=i._errorListener.bind(i),i._node.addEventListener("error",i._errorFn,!1),i._loadFn=i._loadListener.bind(i),i._node.addEventListener(e._canPlayEvent,i._loadFn,!1),i._endFn=i._endListener.bind(i),i._node.addEventListener("ended",i._endFn,!1),i._node.src=o._src,i._node.preload=o._preload===!0?"auto":o._preload,i._node.volume=_*e.volume(),i._node.load()),i},reset:function(){var i=this,o=i._parent;return i._muted=o._muted,i._loop=o._loop,i._volume=o._volume,i._rate=o._rate,i._seek=0,i._rateSeek=0,i._paused=!0,i._ended=!0,i._sprite="__default",i._id=++e._counter,i},_errorListener:function(){var i=this;i._parent._emit("loaderror",i._id,i._node.error?i._node.error.code:0),i._node.removeEventListener("error",i._errorFn,!1)},_loadListener:function(){var i=this,o=i._parent;o._duration=Math.ceil(i._node.duration*10)/10,Object.keys(o._sprite).length===0&&(o._sprite={__default:[0,o._duration*1e3]}),o._state!=="loaded"&&(o._state="loaded",o._emit("load"),o._loadQueue()),i._node.removeEventListener(e._canPlayEvent,i._loadFn,!1)},_endListener:function(){var i=this,o=i._parent;o._duration===1/0&&(o._duration=Math.ceil(i._node.duration*10)/10,o._sprite.__default[1]===1/0&&(o._sprite.__default[1]=o._duration*1e3),o._ended(i)),i._node.removeEventListener("ended",i._endFn,!1)}};var s={},a=function(i){var o=i._src;if(s[o]){i._duration=s[o].duration,h(i);return}if(/^data:[^;]+;base64,/.test(o)){for(var _=atob(o.split(",")[1]),m=new Uint8Array(_.length),u=0;u<_.length;++u)m[u]=_.charCodeAt(u);c(m.buffer,i)}else{var g=new XMLHttpRequest;g.open(i._xhr.method,o,!0),g.withCredentials=i._xhr.withCredentials,g.responseType="arraybuffer",i._xhr.headers&&Object.keys(i._xhr.headers).forEach(function(f){g.setRequestHeader(f,i._xhr.headers[f])}),g.onload=function(){var f=(g.status+"")[0];if(f!=="0"&&f!=="2"&&f!=="3"){i._emit("loaderror",null,"Failed loading audio file with status: "+g.status+".");return}c(g.response,i)},g.onerror=function(){i._webAudio&&(i._html5=!0,i._webAudio=!1,i._sounds=[],delete s[o],i.load())},l(g)}},l=function(i){try{i.send()}catch{i.onerror()}},c=function(i,o){var _=function(){o._emit("loaderror",null,"Decoding audio data failed.")},m=function(u){u&&o._sounds.length>0?(s[o._src]=u,h(o,u)):_()};typeof Promise<"u"&&e.ctx.decodeAudioData.length===1?e.ctx.decodeAudioData(i).then(m).catch(_):e.ctx.decodeAudioData(i,m,_)},h=function(i,o){o&&!i._duration&&(i._duration=o.duration),Object.keys(i._sprite).length===0&&(i._sprite={__default:[0,i._duration*1e3]}),i._state!=="loaded"&&(i._state="loaded",i._emit("load"),i._loadQueue())},d=function(){if(e.usingWebAudio){try{typeof AudioContext<"u"?e.ctx=new AudioContext:typeof webkitAudioContext<"u"?e.ctx=new webkitAudioContext:e.usingWebAudio=!1}catch{e.usingWebAudio=!1}e.ctx||(e.usingWebAudio=!1);var i=/iP(hone|od|ad)/.test(e._navigator&&e._navigator.platform),o=e._navigator&&e._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),_=o?parseInt(o[1],10):null;if(i&&_&&_<9){var m=/safari/.test(e._navigator&&e._navigator.userAgent.toLowerCase());e._navigator&&!m&&(e.usingWebAudio=!1)}e.usingWebAudio&&(e.masterGain=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),e.masterGain.gain.setValueAtTime(e._muted?0:e._volume,e.ctx.currentTime),e.masterGain.connect(e.ctx.destination)),e._setup()}};typeof define=="function"&&define.amd&&define([],function(){return{Howler:e,Howl:n}}),typeof Wn<"u"&&(Wn.Howler=e,Wn.Howl=n),typeof global<"u"?(global.HowlerGlobal=t,global.Howler=e,global.Howl=n,global.Sound=r):typeof window<"u"&&(window.HowlerGlobal=t,window.Howler=e,window.Howl=n,window.Sound=r)})();(function(){"use strict";HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var n=this;if(!n.ctx||!n.ctx.listener)return n;for(var r=n._howls.length-1;r>=0;r--)n._howls[r].stereo(e);return n},HowlerGlobal.prototype.pos=function(e,n,r){var s=this;if(!s.ctx||!s.ctx.listener)return s;if(n=typeof n!="number"?s._pos[1]:n,r=typeof r!="number"?s._pos[2]:r,typeof e=="number")s._pos=[e,n,r],typeof s.ctx.listener.positionX<"u"?(s.ctx.listener.positionX.setTargetAtTime(s._pos[0],Howler.ctx.currentTime,.1),s.ctx.listener.positionY.setTargetAtTime(s._pos[1],Howler.ctx.currentTime,.1),s.ctx.listener.positionZ.setTargetAtTime(s._pos[2],Howler.ctx.currentTime,.1)):s.ctx.listener.setPosition(s._pos[0],s._pos[1],s._pos[2]);else return s._pos;return s},HowlerGlobal.prototype.orientation=function(e,n,r,s,a,l){var c=this;if(!c.ctx||!c.ctx.listener)return c;var h=c._orientation;if(n=typeof n!="number"?h[1]:n,r=typeof r!="number"?h[2]:r,s=typeof s!="number"?h[3]:s,a=typeof a!="number"?h[4]:a,l=typeof l!="number"?h[5]:l,typeof e=="number")c._orientation=[e,n,r,s,a,l],typeof c.ctx.listener.forwardX<"u"?(c.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),c.ctx.listener.forwardY.setTargetAtTime(n,Howler.ctx.currentTime,.1),c.ctx.listener.forwardZ.setTargetAtTime(r,Howler.ctx.currentTime,.1),c.ctx.listener.upX.setTargetAtTime(s,Howler.ctx.currentTime,.1),c.ctx.listener.upY.setTargetAtTime(a,Howler.ctx.currentTime,.1),c.ctx.listener.upZ.setTargetAtTime(l,Howler.ctx.currentTime,.1)):c.ctx.listener.setOrientation(e,n,r,s,a,l);else return h;return c},Howl.prototype.init=function(e){return function(n){var r=this;return r._orientation=n.orientation||[1,0,0],r._stereo=n.stereo||null,r._pos=n.pos||null,r._pannerAttr={coneInnerAngle:typeof n.coneInnerAngle<"u"?n.coneInnerAngle:360,coneOuterAngle:typeof n.coneOuterAngle<"u"?n.coneOuterAngle:360,coneOuterGain:typeof n.coneOuterGain<"u"?n.coneOuterGain:0,distanceModel:typeof n.distanceModel<"u"?n.distanceModel:"inverse",maxDistance:typeof n.maxDistance<"u"?n.maxDistance:1e4,panningModel:typeof n.panningModel<"u"?n.panningModel:"HRTF",refDistance:typeof n.refDistance<"u"?n.refDistance:1,rolloffFactor:typeof n.rolloffFactor<"u"?n.rolloffFactor:1},r._onstereo=n.onstereo?[{fn:n.onstereo}]:[],r._onpos=n.onpos?[{fn:n.onpos}]:[],r._onorientation=n.onorientation?[{fn:n.onorientation}]:[],e.call(this,n)}}(Howl.prototype.init),Howl.prototype.stereo=function(e,n){var r=this;if(!r._webAudio)return r;if(r._state!=="loaded")return r._queue.push({event:"stereo",action:function(){r.stereo(e,n)}}),r;var s=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof n>"u")if(typeof e=="number")r._stereo=e,r._pos=[e,0,0];else return r._stereo;for(var a=r._getSoundIds(n),l=0;l<a.length;l++){var c=r._soundById(a[l]);if(c)if(typeof e=="number")c._stereo=e,c._pos=[e,0,0],c._node&&(c._pannerAttr.panningModel="equalpower",(!c._panner||!c._panner.pan)&&t(c,s),s==="spatial"?typeof c._panner.positionX<"u"?(c._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),c._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),c._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):c._panner.setPosition(e,0,0):c._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),r._emit("stereo",c._id);else return c._stereo}return r},Howl.prototype.pos=function(e,n,r,s){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"pos",action:function(){a.pos(e,n,r,s)}}),a;if(n=typeof n!="number"?0:n,r=typeof r!="number"?-.5:r,typeof s>"u")if(typeof e=="number")a._pos=[e,n,r];else return a._pos;for(var l=a._getSoundIds(s),c=0;c<l.length;c++){var h=a._soundById(l[c]);if(h)if(typeof e=="number")h._pos=[e,n,r],h._node&&((!h._panner||h._panner.pan)&&t(h,"spatial"),typeof h._panner.positionX<"u"?(h._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),h._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),h._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime)):h._panner.setPosition(e,n,r)),a._emit("pos",h._id);else return h._pos}return a},Howl.prototype.orientation=function(e,n,r,s){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"orientation",action:function(){a.orientation(e,n,r,s)}}),a;if(n=typeof n!="number"?a._orientation[1]:n,r=typeof r!="number"?a._orientation[2]:r,typeof s>"u")if(typeof e=="number")a._orientation=[e,n,r];else return a._orientation;for(var l=a._getSoundIds(s),c=0;c<l.length;c++){var h=a._soundById(l[c]);if(h)if(typeof e=="number")h._orientation=[e,n,r],h._node&&(h._panner||(h._pos||(h._pos=a._pos||[0,0,-.5]),t(h,"spatial")),typeof h._panner.orientationX<"u"?(h._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),h._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),h._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime)):h._panner.setOrientation(e,n,r)),a._emit("orientation",h._id);else return h._orientation}return a},Howl.prototype.pannerAttr=function(){var e=this,n=arguments,r,s,a;if(!e._webAudio)return e;if(n.length===0)return e._pannerAttr;if(n.length===1)if(typeof n[0]=="object")r=n[0],typeof s>"u"&&(r.pannerAttr||(r.pannerAttr={coneInnerAngle:r.coneInnerAngle,coneOuterAngle:r.coneOuterAngle,coneOuterGain:r.coneOuterGain,distanceModel:r.distanceModel,maxDistance:r.maxDistance,refDistance:r.refDistance,rolloffFactor:r.rolloffFactor,panningModel:r.panningModel}),e._pannerAttr={coneInnerAngle:typeof r.pannerAttr.coneInnerAngle<"u"?r.pannerAttr.coneInnerAngle:e._coneInnerAngle,coneOuterAngle:typeof r.pannerAttr.coneOuterAngle<"u"?r.pannerAttr.coneOuterAngle:e._coneOuterAngle,coneOuterGain:typeof r.pannerAttr.coneOuterGain<"u"?r.pannerAttr.coneOuterGain:e._coneOuterGain,distanceModel:typeof r.pannerAttr.distanceModel<"u"?r.pannerAttr.distanceModel:e._distanceModel,maxDistance:typeof r.pannerAttr.maxDistance<"u"?r.pannerAttr.maxDistance:e._maxDistance,refDistance:typeof r.pannerAttr.refDistance<"u"?r.pannerAttr.refDistance:e._refDistance,rolloffFactor:typeof r.pannerAttr.rolloffFactor<"u"?r.pannerAttr.rolloffFactor:e._rolloffFactor,panningModel:typeof r.pannerAttr.panningModel<"u"?r.pannerAttr.panningModel:e._panningModel});else return a=e._soundById(parseInt(n[0],10)),a?a._pannerAttr:e._pannerAttr;else n.length===2&&(r=n[0],s=parseInt(n[1],10));for(var l=e._getSoundIds(s),c=0;c<l.length;c++)if(a=e._soundById(l[c]),a){var h=a._pannerAttr;h={coneInnerAngle:typeof r.coneInnerAngle<"u"?r.coneInnerAngle:h.coneInnerAngle,coneOuterAngle:typeof r.coneOuterAngle<"u"?r.coneOuterAngle:h.coneOuterAngle,coneOuterGain:typeof r.coneOuterGain<"u"?r.coneOuterGain:h.coneOuterGain,distanceModel:typeof r.distanceModel<"u"?r.distanceModel:h.distanceModel,maxDistance:typeof r.maxDistance<"u"?r.maxDistance:h.maxDistance,refDistance:typeof r.refDistance<"u"?r.refDistance:h.refDistance,rolloffFactor:typeof r.rolloffFactor<"u"?r.rolloffFactor:h.rolloffFactor,panningModel:typeof r.panningModel<"u"?r.panningModel:h.panningModel};var d=a._panner;d?(d.coneInnerAngle=h.coneInnerAngle,d.coneOuterAngle=h.coneOuterAngle,d.coneOuterGain=h.coneOuterGain,d.distanceModel=h.distanceModel,d.maxDistance=h.maxDistance,d.refDistance=h.refDistance,d.rolloffFactor=h.rolloffFactor,d.panningModel=h.panningModel):(a._pos||(a._pos=e._pos||[0,0,-.5]),t(a,"spatial"))}return e},Sound.prototype.init=function(e){return function(){var n=this,r=n._parent;n._orientation=r._orientation,n._stereo=r._stereo,n._pos=r._pos,n._pannerAttr=r._pannerAttr,e.call(this),n._stereo?r.stereo(n._stereo):n._pos&&r.pos(n._pos[0],n._pos[1],n._pos[2],n._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var n=this,r=n._parent;return n._orientation=r._orientation,n._stereo=r._stereo,n._pos=r._pos,n._pannerAttr=r._pannerAttr,n._stereo?r.stereo(n._stereo):n._pos?r.pos(n._pos[0],n._pos[1],n._pos[2],n._id):n._panner&&(n._panner.disconnect(0),n._panner=void 0,r._refreshBuffer(n)),e.call(this)}}(Sound.prototype.reset);var t=function(e,n){n=n||"spatial",n==="spatial"?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,typeof e._panner.positionX<"u"?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),typeof e._panner.orientationX<"u"?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}})()});var j;(function(t){t[t.Native=1]="Native",t[t.Bool=2]="Bool",t[t.Int=4]="Int",t[t.Float=8]="Float",t[t.String=16]="String",t[t.Enum=32]="Enum",t[t.Object=64]="Object",t[t.Mesh=128]="Mesh",t[t.Texture=256]="Texture",t[t.Material=512]="Material",t[t.Animation=1024]="Animation",t[t.Skin=2048]="Skin",t[t.Color=4096]="Color"})(j||(j={}));var ar={bool(t=!1){return{type:j.Bool,default:t}},int(t=0){return{type:j.Int,default:t}},float(t=0){return{type:j.Float,default:t}},string(t=""){return{type:j.String,default:t}},enum(t,e){return{type:j.Enum,values:t,default:e}},object(){return{type:j.Object,default:null}},mesh(){return{type:j.Mesh,default:null}},texture(){return{type:j.Texture,default:null}},material(){return{type:j.Material,default:null}},animation(){return{type:j.Animation,default:null}},skin(){return{type:j.Skin,default:null}},color(t=0,e=0,n=0,r=1){return{type:j.Color,default:[t,e,n,r]}}};function ri(t){return function(e,n){let r=e.constructor;r.Properties=r.Properties??{},r.Properties[n]=t}}function Je(){return function(t,e,n){n.enumerable=!0}}function H(){return function(t,e,n){Je()(t,e,n),ri({type:j.Native})(t,e)}}var or={};for(let t in ar)or[t]=(...e)=>{let n=ar[t];return ri(n(...e))};function tn(t){return t===""?!0:t&&(typeof t=="string"||t.constructor===String)}function ii(t){return t==null?!1:typeof t=="number"||t.constructor===Number}var pe=class{_listeners=[];_event=void 0;_autoResolve;constructor(e=!1){this._autoResolve=e}add(e,n={}){let{once:r=!1,id:s=void 0}=n;return this._event!==void 0&&(e(...this._event),r)?this:(this._listeners.push({id:s,once:r,callback:e}),this)}push(...e){for(let n of e)this.add(n);return this}once(e){return this.add(e,{once:!0})}remove(e){let n=this._find(e);return n!==null&&this._listeners.splice(n,1),this}has(e){return this._find(e)!==null}notify(...e){let n=this._listeners;this._autoResolve&&(this._event=e);for(let r=0;r<n.length;++r){let s=n[r];s.once&&n.splice(r--,1);try{s.callback(...e)}catch(a){console.error(a)}}}notifyUnsafe(...e){let n=this._listeners;this._autoResolve&&(this._event=e);for(let r=0;r<n.length;++r){let s=n[r];s.once&&n.splice(r--,1),s.callback(...e)}}promise(){return new Promise((e,n)=>{this.once((...r)=>{r.length>1?e(r):e(r[0])})})}_find(e){let n=this._listeners;if(tn(e)){for(let r=0;r<n.length;++r)if(n[r].id===e)return r;return null}for(let r=0;r<n.length;++r)if(n[r].callback===e)return r;return null}};var N=function(t,e,n,r){var s=arguments.length,a=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(l=t[c])&&(a=(s<3?l(a):s>3?l(e,n,a):l(e,n))||a);return s>3&&a&&Object.defineProperty(e,n,a),a},si;(function(t){t[t.Sphere=0]="Sphere",t[t.AxisAlignedBox=1]="AxisAlignedBox",t[t.Box=2]="Box"})(si||(si={}));var ai;(function(t){t[t.Left=0]="Left",t[t.Center=1]="Center",t[t.Right=2]="Right"})(ai||(ai={}));var oi;(function(t){t[t.Line=0]="Line",t[t.Middle=1]="Middle",t[t.Top=2]="Top",t[t.Bottom=3]="Bottom"})(oi||(oi={}));var li;(function(t){t[t.None=0]="None",t[t.Outline=1]="Outline"})(li||(li={}));var Pe;(function(t){t[t.Head=0]="Head",t[t.EyeLeft=1]="EyeLeft",t[t.EyeRight=2]="EyeRight",t[t.ControllerLeft=3]="ControllerLeft",t[t.ControllerRight=4]="ControllerRight",t[t.RayLeft=5]="RayLeft",t[t.RayRight=6]="RayRight"})(Pe||(Pe={}));var ci;(function(t){t[t.Point=0]="Point",t[t.Spot=1]="Spot",t[t.Sun=2]="Sun"})(ci||(ci={}));var _i;(function(t){t[t.Playing=0]="Playing",t[t.Paused=1]="Paused",t[t.Stopped=2]="Stopped"})(_i||(_i={}));var nn;(function(t){t[t.Force=0]="Force",t[t.Impulse=1]="Impulse",t[t.VelocityChange=2]="VelocityChange",t[t.Acceleration=3]="Acceleration"})(nn||(nn={}));var hi;(function(t){t[t.Touch=0]="Touch",t[t.TouchLost=1]="TouchLost",t[t.TriggerTouch=2]="TriggerTouch",t[t.TriggerTouchLost=3]="TriggerTouchLost"})(hi||(hi={}));var rn;(function(t){t[t.None=0]="None",t[t.Sphere=1]="Sphere",t[t.Capsule=2]="Capsule",t[t.Box=3]="Box",t[t.Plane=4]="Plane",t[t.ConvexMesh=5]="ConvexMesh",t[t.TriangleMesh=6]="TriangleMesh"})(rn||(rn={}));var Ve;(function(t){t[t.Position=0]="Position",t[t.Tangent=1]="Tangent",t[t.Normal=2]="Normal",t[t.TextureCoordinate=3]="TextureCoordinate",t[t.Color=4]="Color",t[t.JointId=5]="JointId",t[t.JointWeight=6]="JointWeight"})(Ve||(Ve={}));var de;(function(t){t[t.UnsignedInt=0]="UnsignedInt",t[t.Int=1]="Int",t[t.Float=2]="Float",t[t.Sampler=3]="Sampler",t[t.Font=4]="Font"})(de||(de={}));function pi(t){return t===rn.ConvexMesh||t===rn.TriangleMesh}var R=class{_manager;_id;_object;_engine;constructor(e,n=-1,r=-1){this._engine=e,this._manager=n,this._id=r,this._object=null}get engine(){return this._engine}get type(){return this.constructor.TypeName??this._engine.wasm._typeNameFor(this._manager)}get object(){if(!this._object){let e=this._engine.wasm._wl_component_get_object(this._manager,this._id);this._object=this._engine.wrapObject(e)}return this._object}set active(e){this._engine.wasm._wl_component_setActive(this._manager,this._id,e)}get active(){return this._engine.wasm._wl_component_isActive(this._manager,this._id)!=0}destroy(){this._engine.wasm._wl_component_remove(this._manager,this._id),this._manager=-1,this._id=-1}equals(e){return e?this._manager==e._manager&&this._id==e._id:!1}};M(R,"TypeName"),M(R,"Properties"),M(R,"Dependencies");var cr=class extends R{get collider(){return this._engine.wasm._wl_collision_component_get_collider(this._id)}set collider(e){this._engine.wasm._wl_collision_component_set_collider(this._id,e)}get extents(){let e=this._engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_collision_component_get_extents(this._id),3)}set extents(e){this.extents.set(e)}get group(){return this._engine.wasm._wl_collision_component_get_group(this._id)}set group(e){this._engine.wasm._wl_collision_component_set_group(this._id,e)}queryOverlaps(){let e=this._engine.wasm._wl_collision_component_query_overlaps(this._id,this._engine.wasm._tempMem,this._engine.wasm._tempMemSize>>1),n=new Array(e);for(let r=0;r<e;++r)n[r]=new cr(this._engine,this._manager,this._engine.wasm._tempMemUint16[r]);return n}},Ue=cr;M(Ue,"TypeName","collision");N([H()],Ue.prototype,"collider",null);N([H()],Ue.prototype,"extents",null);N([H()],Ue.prototype,"group",null);var fe=class extends R{get alignment(){return this._engine.wasm._wl_text_component_get_horizontal_alignment(this._id)}set alignment(e){this._engine.wasm._wl_text_component_set_horizontal_alignment(this._id,e)}get justification(){return this._engine.wasm._wl_text_component_get_vertical_alignment(this._id)}set justification(e){this._engine.wasm._wl_text_component_set_vertical_alignment(this._id,e)}get characterSpacing(){return this._engine.wasm._wl_text_component_get_character_spacing(this._id)}set characterSpacing(e){this._engine.wasm._wl_text_component_set_character_spacing(this._id,e)}get lineSpacing(){return this._engine.wasm._wl_text_component_get_line_spacing(this._id)}set lineSpacing(e){this._engine.wasm._wl_text_component_set_line_spacing(this._id,e)}get effect(){return this._engine.wasm._wl_text_component_get_effect(this._id)}set effect(e){this._engine.wasm._wl_text_component_set_effect(this._id,e)}get text(){let e=this._engine.wasm,n=e._wl_text_component_get_text(this._id);return e.UTF8ToString(n)}set text(e){let n=this._engine.wasm;n._wl_text_component_set_text(this._id,n.tempUTF8(e))}set material(e){let n=e?e._index:0;this._engine.wasm._wl_text_component_set_material(this._id,n)}get material(){let e=this._engine.wasm._wl_text_component_get_material(this._id);return e>0?new Ie(this._engine,e):null}};M(fe,"TypeName","text");N([H()],fe.prototype,"alignment",null);N([H()],fe.prototype,"justification",null);N([H()],fe.prototype,"characterSpacing",null);N([H()],fe.prototype,"lineSpacing",null);N([H()],fe.prototype,"effect",null);N([H()],fe.prototype,"text",null);N([H()],fe.prototype,"material",null);var ye=class extends R{get projectionMatrix(){let e=this._engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_view_component_get_projection_matrix(this._id),16)}get near(){return this._engine.wasm._wl_view_component_get_near(this._id)}set near(e){this._engine.wasm._wl_view_component_set_near(this._id,e)}get far(){return this._engine.wasm._wl_view_component_get_far(this._id)}set far(e){this._engine.wasm._wl_view_component_set_far(this._id,e)}get fov(){return this._engine.wasm._wl_view_component_get_fov(this._id)}set fov(e){this._engine.wasm._wl_view_component_set_fov(this._id,e)}};M(ye,"TypeName","view");N([Je()],ye.prototype,"projectionMatrix",null);N([H()],ye.prototype,"near",null);N([H()],ye.prototype,"far",null);N([H()],ye.prototype,"fov",null);var Ne=class extends R{get inputType(){return this._engine.wasm._wl_input_component_get_type(this._id)}set inputType(e){this._engine.wasm._wl_input_component_set_type(this._id,e)}get xrInputSource(){let e=this._engine.xrSession;if(e){for(let n of e.inputSources)if(n.handedness==this.handedness)return n}return null}get handedness(){let e=this.inputType;return e==Pe.ControllerRight||e==Pe.RayRight||e==Pe.EyeRight?"right":e==Pe.ControllerLeft||e==Pe.RayLeft||e==Pe.EyeLeft?"left":null}};M(Ne,"TypeName","input");N([H()],Ne.prototype,"inputType",null);N([Je()],Ne.prototype,"xrInputSource",null);N([Je()],Ne.prototype,"handedness",null);var et=class extends R{get color(){let e=this._engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_light_component_get_color(this._id),4)}set color(e){this.color.set(e)}get lightType(){return this._engine.wasm._wl_light_component_get_type(this._id)}set lightType(e){this._engine.wasm._wl_light_component_set_type(this._id,e)}};M(et,"TypeName","light");N([H()],et.prototype,"color",null);N([H()],et.prototype,"lightType",null);var Ee=class extends R{set animation(e){this._engine.wasm._wl_animation_component_set_animation(this._id,e?e._index:0)}get animation(){let e=this._engine.wasm._wl_animation_component_get_animation(this._id);return e>0?new Be(this._engine,e):null}set playCount(e){this._engine.wasm._wl_animation_component_set_playCount(this._id,e)}get playCount(){return this._engine.wasm._wl_animation_component_get_playCount(this._id)}set speed(e){this._engine.wasm._wl_animation_component_set_speed(this._id,e)}get speed(){return this._engine.wasm._wl_animation_component_get_speed(this._id)}get state(){return this._engine.wasm._wl_animation_component_state(this._id)}play(){this._engine.wasm._wl_animation_component_play(this._id)}stop(){this._engine.wasm._wl_animation_component_stop(this._id)}pause(){this._engine.wasm._wl_animation_component_pause(this._id)}};M(Ee,"TypeName","animation");N([H()],Ee.prototype,"animation",null);N([H()],Ee.prototype,"playCount",null);N([H()],Ee.prototype,"speed",null);N([Je()],Ee.prototype,"state",null);var qe=class extends R{set material(e){this._engine.wasm._wl_mesh_component_set_material(this._id,e?e._index:0)}get material(){let e=this._engine.wasm._wl_mesh_component_get_material(this._id);return e>0?new Ie(this._engine,e):null}get mesh(){let e=this._engine.wasm._wl_mesh_component_get_mesh(this._id);return e>0?new tt(this._engine,e):null}set mesh(e){this._engine.wasm._wl_mesh_component_set_mesh(this._id,e?e._index:0)}get skin(){let e=this._engine.wasm._wl_mesh_component_get_skin(this._id);return e>0?new zt(this._engine,e):null}set skin(e){this._engine.wasm._wl_mesh_component_set_skin(this._id,e?e._index:0)}};M(qe,"TypeName","mesh");N([H()],qe.prototype,"material",null);N([H()],qe.prototype,"mesh",null);N([H()],qe.prototype,"skin",null);var di;(function(t){t[t.None=0]="None",t[t.X=1]="X",t[t.Y=2]="Y",t[t.Z=4]="Z"})(di||(di={}));var $=class extends R{set static(e){this._engine.wasm._wl_physx_component_set_static(this._id,e)}get static(){return!!this._engine.wasm._wl_physx_component_get_static(this._id)}set kinematic(e){this._engine.wasm._wl_physx_component_set_kinematic(this._id,e)}get kinematic(){return!!this._engine.wasm._wl_physx_component_get_kinematic(this._id)}set gravity(e){this._engine.wasm._wl_physx_component_set_gravity(this._id,e)}get gravity(){return!!this._engine.wasm._wl_physx_component_get_gravity(this._id)}set simulate(e){this._engine.wasm._wl_physx_component_set_simulate(this._id,e)}get simulate(){return!!this._engine.wasm._wl_physx_component_get_simulate(this._id)}set allowSimulation(e){this._engine.wasm._wl_physx_component_set_allowSimulation(this._id,e)}get allowSimulation(){return!!this._engine.wasm._wl_physx_component_get_allowSimulation(this._id)}set allowQuery(e){this._engine.wasm._wl_physx_component_set_allowQuery(this._id,e)}get allowQuery(){return!!this._engine.wasm._wl_physx_component_get_allowQuery(this._id)}set trigger(e){this._engine.wasm._wl_physx_component_set_trigger(this._id,e)}get trigger(){return!!this._engine.wasm._wl_physx_component_get_trigger(this._id)}set shape(e){this._engine.wasm._wl_physx_component_set_shape(this._id,e)}get shape(){return this._engine.wasm._wl_physx_component_get_shape(this._id)}set shapeData(e){e==null||!pi(this.shape)||this._engine.wasm._wl_physx_component_set_shape_data(this._id,e.index)}get shapeData(){return pi(this.shape)?{index:this._engine.wasm._wl_physx_component_get_shape_data(this._id)}:null}set extents(e){this.extents.set(e)}get extents(){let e=this._engine.wasm,n=e._wl_physx_component_get_extents(this._id);return new Float32Array(e.HEAPF32.buffer,n,3)}get staticFriction(){return this._engine.wasm._wl_physx_component_get_staticFriction(this._id)}set staticFriction(e){this._engine.wasm._wl_physx_component_set_staticFriction(this._id,e)}get dynamicFriction(){return this._engine.wasm._wl_physx_component_get_dynamicFriction(this._id)}set dynamicFriction(e){this._engine.wasm._wl_physx_component_set_dynamicFriction(this._id,e)}get bounciness(){return this._engine.wasm._wl_physx_component_get_bounciness(this._id)}set bounciness(e){this._engine.wasm._wl_physx_component_set_bounciness(this._id,e)}get linearDamping(){return this._engine.wasm._wl_physx_component_get_linearDamping(this._id)}set linearDamping(e){this._engine.wasm._wl_physx_component_set_linearDamping(this._id,e)}get angularDamping(){return this._engine.wasm._wl_physx_component_get_angularDamping(this._id)}set angularDamping(e){this._engine.wasm._wl_physx_component_set_angularDamping(this._id,e)}set linearVelocity(e){this._engine.wasm._wl_physx_component_set_linearVelocity(this._id,e[0],e[1],e[2])}get linearVelocity(){let e=this._engine.wasm;return e._wl_physx_component_get_linearVelocity(this._id,e._tempMem),new Float32Array(e.HEAPF32.buffer,e._tempMem,3)}set angularVelocity(e){this._engine.wasm._wl_physx_component_set_angularVelocity(this._id,e[0],e[1],e[2])}get angularVelocity(){let e=this._engine.wasm;return e._wl_physx_component_get_angularVelocity(this._id,e._tempMem),new Float32Array(e.HEAPF32.buffer,e._tempMem,3)}set groupsMask(e){this._engine.wasm._wl_physx_component_set_groupsMask(this._id,e)}get groupsMask(){return this._engine.wasm._wl_physx_component_get_groupsMask(this._id)}set blocksMask(e){this._engine.wasm._wl_physx_component_set_blocksMask(this._id,e)}get blocksMask(){return this._engine.wasm._wl_physx_component_get_blocksMask(this._id)}set linearLockAxis(e){this._engine.wasm._wl_physx_component_set_linearLockAxis(this._id,e)}get linearLockAxis(){return this._engine.wasm._wl_physx_component_get_linearLockAxis(this._id)}set angularLockAxis(e){this._engine.wasm._wl_physx_component_set_angularLockAxis(this._id,e)}get angularLockAxis(){return this._engine.wasm._wl_physx_component_get_angularLockAxis(this._id)}set mass(e){this._engine.wasm._wl_physx_component_set_mass(this._id,e)}get mass(){return this._engine.wasm._wl_physx_component_get_mass(this._id)}set massSpaceInteriaTensor(e){this._engine.wasm._wl_physx_component_set_massSpaceInertiaTensor(this._id,e[0],e[1],e[2])}addForce(e,n=nn.Force,r=!1,s,a=!1){let l=this._engine.wasm;if(!s){l._wl_physx_component_addForce(this._id,e[0],e[1],e[2],n,r);return}l._wl_physx_component_addForceAt(this._id,e[0],e[1],e[2],n,r,s[0],s[1],s[2],a)}addTorque(e,n=nn.Force){this._engine.wasm._wl_physx_component_addTorque(this._id,e[0],e[1],e[2],n)}onCollision(e){return this.onCollisionWith(this,e)}onCollisionWith(e,n){let r=this._engine.physics;return r._callbacks[this._id]=r._callbacks[this._id]||[],r._callbacks[this._id].push(n),this._engine.wasm._wl_physx_component_addCallback(this._id,e._id||this._id)}removeCollisionCallback(e){let n=this._engine.physics,r=this._engine.wasm._wl_physx_component_removeCallback(this._id,e);r&&n._callbacks[this._id].splice(-r)}};M($,"TypeName","physx");N([H()],$.prototype,"static",null);N([H()],$.prototype,"kinematic",null);N([H()],$.prototype,"gravity",null);N([H()],$.prototype,"simulate",null);N([H()],$.prototype,"allowSimulation",null);N([H()],$.prototype,"allowQuery",null);N([H()],$.prototype,"trigger",null);N([H()],$.prototype,"shape",null);N([H()],$.prototype,"shapeData",null);N([H()],$.prototype,"extents",null);N([H()],$.prototype,"staticFriction",null);N([H()],$.prototype,"dynamicFriction",null);N([H()],$.prototype,"bounciness",null);N([H()],$.prototype,"linearDamping",null);N([H()],$.prototype,"angularDamping",null);N([H()],$.prototype,"linearVelocity",null);N([H()],$.prototype,"angularVelocity",null);N([H()],$.prototype,"groupsMask",null);N([H()],$.prototype,"blocksMask",null);N([H()],$.prototype,"linearLockAxis",null);N([H()],$.prototype,"angularLockAxis",null);N([H()],$.prototype,"mass",null);var me;(function(t){t[t.UnsignedByte=1]="UnsignedByte",t[t.UnsignedShort=2]="UnsignedShort",t[t.UnsignedInt=4]="UnsignedInt"})(me||(me={}));var tt=class{_index=-1;_engine;constructor(e,n){if(this._engine=e??WL,this._index=-1,ii(n)){this._index=n;return}if(!n.vertexCount)throw new Error("Missing parameter 'vertexCount'");let r=this._engine.wasm,s=0,a=0,l=0;if(n.indexData)switch(a=n.indexType||me.UnsignedShort,l=n.indexData.length*a,s=r._malloc(l),a){case me.UnsignedByte:r.HEAPU8.set(n.indexData,s);break;case me.UnsignedShort:r.HEAPU16.set(n.indexData,s>>1);break;case me.UnsignedInt:r.HEAPU32.set(n.indexData,s>>2);break}let{skinned:c=!1}=n;this._index=r._wl_mesh_create(s,l,a,n.vertexCount,c)}get vertexCount(){return this._engine.wasm._wl_mesh_get_vertexCount(this._index)}get indexData(){let e=this._engine.wasm,n=e._tempMem,r=e._wl_mesh_get_indexData(this._index,n,n+4);if(r===null)return null;let s=e.HEAPU32[n/4];switch(e.HEAPU32[n/4+1]){case me.UnsignedByte:return new Uint8Array(e.HEAPU8.buffer,r,s);case me.UnsignedShort:return new Uint16Array(e.HEAPU16.buffer,r,s);case me.UnsignedInt:return new Uint32Array(e.HEAPU32.buffer,r,s)}return null}get engine(){return this._engine}update(){this._engine.wasm._wl_mesh_update(this._index)}getBoundingSphere(e=new Float32Array(4)){let n=this._engine.wasm._tempMemFloat;return this._engine.wasm._wl_mesh_get_boundingSphere(this._index,this._engine.wasm._tempMem),e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e}attribute(e){if(typeof e!="number")throw new TypeError("Expected number, but got "+typeof e);let n=this._engine.wasm._tempMemUint32;if(this._engine.wasm._wl_mesh_get_attribute(this._index,e,this._engine.wasm._tempMem),n[0]==255)return null;let r=n[5];return new lr(this._engine,{attribute:n[0],offset:n[1],stride:n[2],formatSize:n[3],componentCount:n[4],arraySize:r||1,length:this.vertexCount,bufferType:e!==Ve.JointId?Float32Array:Uint16Array})}destroy(){this._engine.wasm._wl_mesh_destroy(this._index)}equals(e){return e?this._index===e._index:!1}},lr=class{length=0;_engine;_attribute=-1;_offset=0;_stride=0;_formatSize=0;_componentCount=0;_arraySize=1;_bufferType;_tempBufferGetter;constructor(e,n){this._engine=e;let r=this._engine.wasm;this._attribute=n.attribute,this._offset=n.offset,this._stride=n.stride,this._formatSize=n.formatSize,this._componentCount=n.componentCount,this._arraySize=n.arraySize,this._bufferType=n.bufferType,this.length=n.length,this._tempBufferGetter=this._bufferType===Float32Array?r.getTempBufferF32.bind(r):r.getTempBufferU16.bind(r)}createArray(e=1){return e=e>this.length?this.length:e,new this._bufferType(e*this._componentCount*this._arraySize)}get(e,n=this.createArray()){if(n.length%this._componentCount!==0)throw new Error(`out.length, ${n.length} is not a multiple of the attribute vector components, ${this._componentCount}`);let r=this._tempBufferGetter(n.length),s=this._bufferType.BYTES_PER_ELEMENT,a=s*n.length,l=this._formatSize*this._arraySize,c=this._componentCount*s*this._arraySize;this._engine.wasm._wl_mesh_get_attribute_values(this._attribute,l,this._offset+e*this._stride,this._stride,c,r.byteOffset,a);for(let h=0;h<n.length;++h)n[h]=r[h];return n}set(e,n){if(n.length%this._componentCount!==0)throw new Error(`out.length, ${n.length} is not a multiple of the attribute vector components, ${this._componentCount}`);let r=this._bufferType.BYTES_PER_ELEMENT,s=r*n.length,a=this._componentCount*r*this._arraySize,l=this._formatSize*this._arraySize,c=this._engine.wasm;if(n.buffer!=c.HEAPU8.buffer){let h=this._tempBufferGetter(n.length);h.set(n),n=h}return c._wl_mesh_set_attribute_values(this._attribute,a,n.byteOffset,s,l,this._offset+e*this._stride,this._stride),this}},Ie=class{_index;_definition;_engine;constructor(e,n){if(this._engine=e,typeof n!="number"){if(!n?.pipeline)throw new Error("Missing parameter 'pipeline'");let r=this._engine.wasm,s=n.pipeline;if(this._index=r._wl_material_create(r.tempUTF8(s)),this._index<0)throw new Error(`No such pipeline '${s}'`)}else this._index=n;if(this._definition=this._engine.wasm._wl_material_get_definition(this._index),!this._engine.wasm._materialDefinitions[this._definition])throw new Error(`Material Definition ${this._definition} not found for material with index ${this._index}`);return new Proxy(this,{get(r,s){let a=e.wasm,c=a._materialDefinitions[r._definition].get(s);if(!c)return r[s];if(a._wl_material_get_param_value(r._index,c.index,a._tempMem)){let h=c.type;switch(h.type){case de.UnsignedInt:return h.componentCount==1?a._tempMemUint32[0]:new Uint32Array(a.HEAPU32.buffer,a._tempMem,h.componentCount);case de.Int:return h.componentCount==1?a._tempMemInt[0]:new Int32Array(a.HEAP32.buffer,a._tempMem,h.componentCount);case de.Float:return h.componentCount==1?a._tempMemFloat[0]:new Float32Array(a.HEAPF32.buffer,a._tempMem,h.componentCount);case de.Sampler:return new He(e,a._tempMemInt[0]);default:throw new Error(`Invalid type ${h} on parameter ${c.index} for material ${r._index}`)}}},set(r,s,a){let l=e.wasm,h=l._materialDefinitions[r._definition].get(s);if(!h)return r[s]=a,!0;switch(h.type.type){case de.UnsignedInt:case de.Int:case de.Sampler:let i=a.id??a;l._wl_material_set_param_value_uint(r._index,h.index,i);break;case de.Float:let o=1;if(typeof a=="number")l._tempMemFloat[0]=a;else{o=a.length;for(let _=0;_<o;++_)l._tempMemFloat[_]=a[_]}l._wl_material_set_param_value_float(r._index,h.index,l._tempMem,o);break;case de.Font:throw new Error("Setting font properties is currently unsupported.")}return!0}})}get shader(){return this.pipeline}get pipeline(){let e=this._engine.wasm;return e.UTF8ToString((e._wl_material_get_pipeline||e._wl_material_get_shader)(this._index))}get engine(){return this._engine}clone(){let e=this._engine.wasm._wl_material_clone(this._index);return e>0?new Ie(this._engine,e):null}equals(e){return e?this._index===e._index:!1}static wrap(e,n){return n>0?new Ie(e,n):null}},Ke=null,He=class{_engine;_id=0;_imageIndex=null;constructor(e,n){this._engine=e??WL;let r=e.wasm;if(n instanceof HTMLImageElement||n instanceof HTMLVideoElement||n instanceof HTMLCanvasElement){let s=r._images.length;r._images.push(n),this._imageIndex=s,this._id=this._engine.wasm._wl_renderer_addImage(s)}else this._id=n;this._engine.textures[this._id]=this}get valid(){return this._id>=0}get id(){return this._id}update(){!this.valid||this._imageIndex===null||this._engine.wasm._wl_renderer_updateImage(this._id,this._imageIndex)}get width(){return this._engine.wasm._wl_texture_width(this._id)}get height(){return this._engine.wasm._wl_texture_height(this._id)}get engine(){return this._engine}updateSubImage(e,n,r,s){if(!this.valid||this._imageIndex===null)return;if(!Ke){let h=document.createElement("canvas"),d=h.getContext("2d");if(!d)throw new Error("Texture.updateSubImage(): Failed to obtain CanvasRenderingContext2D.");Ke={canvas:h,ctx:d}}let a=this._engine.wasm,l=a._images[this._imageIndex];if(!l)return;Ke.canvas.width=r,Ke.canvas.height=s,Ke.ctx.drawImage(l,e,n,r,s,0,0,r,s);let c=(l.videoHeight??l.height)-n-s;a._images[this._imageIndex]=Ke.canvas,a._wl_renderer_updateImage(this._id,this._imageIndex,e,c),a._images[this._imageIndex]=l}destroy(){this._engine.wasm._wl_texture_destroy(this._id),this._imageIndex!==null&&(this._engine.wasm._images[this._imageIndex]=null,this._imageIndex=void 0)}equals(e){return e?this._id===e._id:!1}},Be=class{_index;_engine;constructor(e=WL,n){this._engine=e,this._index=n}get duration(){return this._engine.wasm._wl_animation_get_duration(this._index)}get trackCount(){return this._engine.wasm._wl_animation_get_trackCount(this._index)}retarget(e){let n=this._engine.wasm;if(e instanceof zt){let a=n._wl_animation_retargetToSkin(this._index,e._index);return new Be(this._engine,a)}if(e.length!=this.trackCount)throw Error("Expected "+this.trackCount.toString()+" targets, but got "+e.length.toString());let r=n._malloc(2*e.length);for(let a=0;a<e.length;++a)n.HEAPU16[r>>1+a]=e[a].objectId;let s=n._wl_animation_retarget(this._index,r);return n._free(r),new Be(this._engine,s)}equals(e){return e?this._index===e._index:!1}};var zt=class{_index;_engine;constructor(e,n){this._engine=e,this._index=n}get jointCount(){return this._engine.wasm._wl_skin_get_joint_count(this._index)}get jointIds(){let e=this._engine.wasm;return new Uint16Array(e.HEAPU16.buffer,e._wl_skin_joint_ids(this._index),this.jointCount)}get inverseBindTransforms(){let e=this._engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_skin_inverse_bind_transforms(this._index),8*this.jointCount)}get inverseBindScalings(){let e=this._engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_skin_inverse_bind_scalings(this._index),3*this.jointCount)}equals(e){return e?this._index===e._index:!1}};var ym=new Map([[j.Bool,!1],[j.Int,0],[j.Float,0],[j.String,""],[j.Enum,void 0],[j.Object,null],[j.Mesh,null],[j.Texture,null],[j.Material,null],[j.Animation,null],[j.Skin,null],[j.Color,[0,0,0,1]]]);var nt=class extends R{name="wonderland-engine-8thwall-camera";started=!1;view=null;position=[0,0,0];rotation=[0,0,0,-1];glTextureRenderer=null;promptForDeviceMotion(){return new Promise(async(e,n)=>{window.dispatchEvent(new Event("8thwall-request-user-interaction")),window.addEventListener("8thwall-safe-to-request-permissions",async()=>{try{let r=await DeviceMotionEvent.requestPermission();e(r)}catch(r){n(r)}})})}async getPermissions(){if(DeviceMotionEvent&&DeviceMotionEvent.requestPermission)try{if(await DeviceMotionEvent.requestPermission()!=="granted")throw new Error("MotionEvent")}catch(e){if(e.name==="NotAllowedError"){if(await this.promptForDeviceMotion()!=="granted")throw new Error("MotionEvent")}else throw new Error("MotionEvent")}try{(await navigator.mediaDevices.getUserMedia({video:!0,audio:!0})).getTracks().forEach(n=>{n.stop()})}catch{throw new Error("Camera")}}init(){this.view=this.object.getComponent("view"),this.onUpdate=this.onUpdate.bind(this),this.onAttach=this.onAttach.bind(this),this.onException=this.onException.bind(this),this.onCameraStatusChange=this.onCameraStatusChange.bind(this)}async start(){this.view=this.object.getComponent("view"),this.useCustomUIOverlays||jo.init();try{await this.getPermissions()}catch(n){window.dispatchEvent(new CustomEvent("8thwall-permission-fail",{detail:n}));return}await this.waitForXR8(),XR8.XrController.configure({disableWorldTracking:!1}),this.glTextureRenderer=XR8.GlTextureRenderer.pipelineModule(),XR8.addCameraPipelineModules([this.glTextureRenderer,XR8.XrController.pipelineModule(),this]);let e={cameraConfig:{direction:XR8.XrConfig.camera().BACK},canvas:Module.canvas,allowedDevices:XR8.XrConfig.device().ANY,ownRunLoop:!1};XR8.run(e)}onAttach(e){this.started=!0,this.engine.scene.colorClearEnabled=!1;let n=Module.ctx,r=this.object.rotationWorld,s=this.object.getTranslationWorld([]);this.position=Array.from(s),this.rotation=Array.from(r),XR8.XrController.updateCameraProjectionMatrix({origin:{x:s[0],y:s[1],z:s[2]},facing:{x:r[0],y:r[1],z:r[2],w:r[3]},cam:{pixelRectWidth:Module.canvas.width,pixelRectHeight:Module.canvas.height,nearClipPlane:this.view.near,farClipPlane:this.view.far}}),this.engine.scene.onPreRender.push(()=>{n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),XR8.runPreRender(Date.now()),XR8.runRender()}),this.engine.scene.onPostRender.push(()=>{XR8.runPostRender(Date.now())})}onCameraStatusChange(e){e&&e.status==="failed"&&this.onException(new Error(`Camera failed with status: ${e.status}`))}onUpdate(e){if(!e.processCpuResult.reality)return;let{rotation:n,position:r,intrinsics:s}=e.processCpuResult.reality;if(this.rotation[0]=n.x,this.rotation[1]=n.y,this.rotation[2]=n.z,this.rotation[3]=n.w,this.position[0]=r.x,this.position[1]=r.y,this.position[2]=r.z,s){let a=this.view.projectionMatrix;for(let l=0;l<16;l++)Number.isFinite(s[l])&&(a[l]=s[l])}r&&n&&(this.object.rotationWorld=this.rotation,this.object.setTranslationWorld(this.position))}onException(e){console.error("8thwall exception:",e),window.dispatchEvent(new CustomEvent("8thwall-error",{detail:e}))}waitForXR8(){return new Promise((e,n)=>{window.XR8?e():window.addEventListener("xrloaded",()=>e())})}};M(nt,"TypeName","8thwall-camera"),M(nt,"Properties",{useCustomUIOverlays:{type:j.Bool,default:!1}});var jo={init:function(){this.handleRequestUserInteraction=this.handleRequestUserInteraction.bind(this),this.handlePermissionFail=this.handlePermissionFail.bind(this),this.handleError=this.handleError.bind(this),window.addEventListener("8thwall-request-user-interaction",this.handleRequestUserInteraction),window.addEventListener("8thwall-permission-fail",this.handlePermissionFail),window.addEventListener("8thwall-error",this.handleError)},handleRequestUserInteraction:function(){let t=this.showOverlay(Po);window.addEventListener("8thwall-safe-to-request-permissions",()=>{t.remove()})},handlePermissionFail:function(t){this.showOverlay(Eo)},handleError:function(t){this.showOverlay(Io)},showOverlay:function(t){let e=document.createElement("div");return e.innerHTML=t,document.body.appendChild(e),e}},Po=`
<style>
  #request-permission-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 999;
    color: #fff;
    background-color: rgba(0, 0, 0, 0.5);
    text-align: center;
    font-family: sans-serif;
  }

  .request-permission-overlay_title {
    margin: 30px;
    font-size: 32px;
  }

  .request-permission-overlay_button {
    background-color: #e80086;
    font-size: 22px;
    padding: 10px 30px;
    color: #fff;
    border-radius: 15px;
    border: none;
  }
</style>

<div id="request-permission-overlay">
  <div class="request-permission-overlay_title">This app requires to use your camera and motion sensors</div>

  <button class="request-permission-overlay_button" onclick="window.dispatchEvent(new Event('8thwall-safe-to-request-permissions'))">OK</button>
</div>`,Eo=`
<style>
  #failed-permission-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 999;
    color: #fff;
    background-color: rgba(0, 0, 0, 0.5);
    text-align: center;
    font-family: sans-serif;
  }

  .failed-permission-overlay_title {
    margin: 30px;
    font-size: 32px;
  }

  .failed-permission-overlay_button {
    background-color: #e80086;
    font-size: 22px;
    padding: 10px 30px;
    color: #fff;
    border-radius: 15px;
    border: none;
  }
</style>

<div id="failed-permission-overlay">
  <div class="failed-permission-overlay_title">Failed to grant permissions. Reset the the permissions and refresh the page.</div>

  <button class="failed-permission-overlay_button" onclick="window.location.reload()">Refresh the page</button>
</div>`,Io=`
<style>
  #wall-error-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 999;
    color: #fff;
    background-color: rgba(0, 0, 0, 0.5);
    text-align: center;
    font-family: sans-serif;
  }

  .wall-error-overlay_title {
    margin: 30px;
    font-size: 32px;
  }

  .wall-error-overlay_button {
    background-color: #e80086;
    font-size: 22px;
    padding: 10px 30px;
    color: #fff;
    border-radius: 15px;
    border: none;
  }
</style>

<div id="wall-error-overlay">
  <div class="wall-error-overlay_title">Error has occurred. Please reload the page</div>

  <button class="wall-error-overlay_button" onclick="window.location.reload()">Reload</button>
</div>`;var se=class extends R{onHover=new pe;onUnhover=new pe;onClick=new pe;onMove=new pe;onDown=new pe;onUp=new pe;addHoverFunction(e){this.onHover.add(e)}removeHoverFunction(e){this.onHover.remove(e)}addUnHoverFunction(e){this.onUnhover.add(e)}removeUnHoverFunction(e){this.onUnhover.remove(e)}addClickFunction(e){this.onClick.add(e)}removeClickFunction(e){this.onClick.remove(e)}addMoveFunction(e){this.onMove.add(e)}removeMoveFunction(e){this.onMove.remove(e)}addDownFunction(e){this.onDown.add(e)}removeDownFunction(e){this.onDown.remove(e)}addUpFunction(e){this.onUp.add(e)}removeUpFunction(e){this.onUp.remove(e)}};M(se,"TypeName","cursor-target"),M(se,"Properties",{});var B=1e-6,G=typeof Float32Array<"u"?Float32Array:Array,Fe=Math.random;var Vm=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function mi(){var t=new G(9);return G!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}var Re={};je(Re,{add:()=>dl,adjoint:()=>Uo,clone:()=>Co,copy:()=>Oo,create:()=>Ro,determinant:()=>No,equals:()=>gl,exactEquals:()=>ul,frob:()=>pl,fromQuat:()=>nl,fromQuat2:()=>Ko,fromRotation:()=>Qo,fromRotationTranslation:()=>gi,fromRotationTranslationScale:()=>el,fromRotationTranslationScaleOrigin:()=>tl,fromScaling:()=>Go,fromTranslation:()=>Yo,fromValues:()=>ko,fromXRotation:()=>$o,fromYRotation:()=>Zo,fromZRotation:()=>Jo,frustum:()=>rl,getRotation:()=>hr,getScaling:()=>wi,getTranslation:()=>_r,identity:()=>fi,invert:()=>zo,lookAt:()=>cl,mul:()=>wl,multiply:()=>ui,multiplyScalar:()=>ml,multiplyScalarAndAdd:()=>fl,ortho:()=>ol,orthoNO:()=>xi,orthoZO:()=>ll,perspective:()=>il,perspectiveFromFieldOfView:()=>al,perspectiveNO:()=>vi,perspectiveZO:()=>sl,rotate:()=>Ho,rotateX:()=>Bo,rotateY:()=>Wo,rotateZ:()=>Xo,scale:()=>Vo,set:()=>Lo,str:()=>hl,sub:()=>vl,subtract:()=>yi,targetTo:()=>_l,translate:()=>qo,transpose:()=>Do});function Ro(){var t=new G(16);return G!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Co(t){var e=new G(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Oo(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function ko(t,e,n,r,s,a,l,c,h,d,i,o,_,m,u,g){var f=new G(16);return f[0]=t,f[1]=e,f[2]=n,f[3]=r,f[4]=s,f[5]=a,f[6]=l,f[7]=c,f[8]=h,f[9]=d,f[10]=i,f[11]=o,f[12]=_,f[13]=m,f[14]=u,f[15]=g,f}function Lo(t,e,n,r,s,a,l,c,h,d,i,o,_,m,u,g,f){return t[0]=e,t[1]=n,t[2]=r,t[3]=s,t[4]=a,t[5]=l,t[6]=c,t[7]=h,t[8]=d,t[9]=i,t[10]=o,t[11]=_,t[12]=m,t[13]=u,t[14]=g,t[15]=f,t}function fi(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Do(t,e){if(t===e){var n=e[1],r=e[2],s=e[3],a=e[6],l=e[7],c=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=a,t[11]=e[14],t[12]=s,t[13]=l,t[14]=c}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function zo(t,e){var n=e[0],r=e[1],s=e[2],a=e[3],l=e[4],c=e[5],h=e[6],d=e[7],i=e[8],o=e[9],_=e[10],m=e[11],u=e[12],g=e[13],f=e[14],w=e[15],v=n*c-r*l,x=n*h-s*l,T=n*d-a*l,A=r*h-s*c,S=r*d-a*c,F=s*d-a*h,E=i*g-o*u,D=i*f-_*u,z=i*w-m*u,V=o*f-_*g,U=o*w-m*g,L=_*w-m*f,I=v*L-x*U+T*V+A*z-S*D+F*E;return I?(I=1/I,t[0]=(c*L-h*U+d*V)*I,t[1]=(s*U-r*L-a*V)*I,t[2]=(g*F-f*S+w*A)*I,t[3]=(_*S-o*F-m*A)*I,t[4]=(h*z-l*L-d*D)*I,t[5]=(n*L-s*z+a*D)*I,t[6]=(f*T-u*F-w*x)*I,t[7]=(i*F-_*T+m*x)*I,t[8]=(l*U-c*z+d*E)*I,t[9]=(r*z-n*U-a*E)*I,t[10]=(u*S-g*T+w*v)*I,t[11]=(o*T-i*S-m*v)*I,t[12]=(c*D-l*V-h*E)*I,t[13]=(n*V-r*D+s*E)*I,t[14]=(g*x-u*A-f*v)*I,t[15]=(i*A-o*x+_*v)*I,t):null}function Uo(t,e){var n=e[0],r=e[1],s=e[2],a=e[3],l=e[4],c=e[5],h=e[6],d=e[7],i=e[8],o=e[9],_=e[10],m=e[11],u=e[12],g=e[13],f=e[14],w=e[15];return t[0]=c*(_*w-m*f)-o*(h*w-d*f)+g*(h*m-d*_),t[1]=-(r*(_*w-m*f)-o*(s*w-a*f)+g*(s*m-a*_)),t[2]=r*(h*w-d*f)-c*(s*w-a*f)+g*(s*d-a*h),t[3]=-(r*(h*m-d*_)-c*(s*m-a*_)+o*(s*d-a*h)),t[4]=-(l*(_*w-m*f)-i*(h*w-d*f)+u*(h*m-d*_)),t[5]=n*(_*w-m*f)-i*(s*w-a*f)+u*(s*m-a*_),t[6]=-(n*(h*w-d*f)-l*(s*w-a*f)+u*(s*d-a*h)),t[7]=n*(h*m-d*_)-l*(s*m-a*_)+i*(s*d-a*h),t[8]=l*(o*w-m*g)-i*(c*w-d*g)+u*(c*m-d*o),t[9]=-(n*(o*w-m*g)-i*(r*w-a*g)+u*(r*m-a*o)),t[10]=n*(c*w-d*g)-l*(r*w-a*g)+u*(r*d-a*c),t[11]=-(n*(c*m-d*o)-l*(r*m-a*o)+i*(r*d-a*c)),t[12]=-(l*(o*f-_*g)-i*(c*f-h*g)+u*(c*_-h*o)),t[13]=n*(o*f-_*g)-i*(r*f-s*g)+u*(r*_-s*o),t[14]=-(n*(c*f-h*g)-l*(r*f-s*g)+u*(r*h-s*c)),t[15]=n*(c*_-h*o)-l*(r*_-s*o)+i*(r*h-s*c),t}function No(t){var e=t[0],n=t[1],r=t[2],s=t[3],a=t[4],l=t[5],c=t[6],h=t[7],d=t[8],i=t[9],o=t[10],_=t[11],m=t[12],u=t[13],g=t[14],f=t[15],w=e*l-n*a,v=e*c-r*a,x=e*h-s*a,T=n*c-r*l,A=n*h-s*l,S=r*h-s*c,F=d*u-i*m,E=d*g-o*m,D=d*f-_*m,z=i*g-o*u,V=i*f-_*u,U=o*f-_*g;return w*U-v*V+x*z+T*D-A*E+S*F}function ui(t,e,n){var r=e[0],s=e[1],a=e[2],l=e[3],c=e[4],h=e[5],d=e[6],i=e[7],o=e[8],_=e[9],m=e[10],u=e[11],g=e[12],f=e[13],w=e[14],v=e[15],x=n[0],T=n[1],A=n[2],S=n[3];return t[0]=x*r+T*c+A*o+S*g,t[1]=x*s+T*h+A*_+S*f,t[2]=x*a+T*d+A*m+S*w,t[3]=x*l+T*i+A*u+S*v,x=n[4],T=n[5],A=n[6],S=n[7],t[4]=x*r+T*c+A*o+S*g,t[5]=x*s+T*h+A*_+S*f,t[6]=x*a+T*d+A*m+S*w,t[7]=x*l+T*i+A*u+S*v,x=n[8],T=n[9],A=n[10],S=n[11],t[8]=x*r+T*c+A*o+S*g,t[9]=x*s+T*h+A*_+S*f,t[10]=x*a+T*d+A*m+S*w,t[11]=x*l+T*i+A*u+S*v,x=n[12],T=n[13],A=n[14],S=n[15],t[12]=x*r+T*c+A*o+S*g,t[13]=x*s+T*h+A*_+S*f,t[14]=x*a+T*d+A*m+S*w,t[15]=x*l+T*i+A*u+S*v,t}function qo(t,e,n){var r=n[0],s=n[1],a=n[2],l,c,h,d,i,o,_,m,u,g,f,w;return e===t?(t[12]=e[0]*r+e[4]*s+e[8]*a+e[12],t[13]=e[1]*r+e[5]*s+e[9]*a+e[13],t[14]=e[2]*r+e[6]*s+e[10]*a+e[14],t[15]=e[3]*r+e[7]*s+e[11]*a+e[15]):(l=e[0],c=e[1],h=e[2],d=e[3],i=e[4],o=e[5],_=e[6],m=e[7],u=e[8],g=e[9],f=e[10],w=e[11],t[0]=l,t[1]=c,t[2]=h,t[3]=d,t[4]=i,t[5]=o,t[6]=_,t[7]=m,t[8]=u,t[9]=g,t[10]=f,t[11]=w,t[12]=l*r+i*s+u*a+e[12],t[13]=c*r+o*s+g*a+e[13],t[14]=h*r+_*s+f*a+e[14],t[15]=d*r+m*s+w*a+e[15]),t}function Vo(t,e,n){var r=n[0],s=n[1],a=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Ho(t,e,n,r){var s=r[0],a=r[1],l=r[2],c=Math.hypot(s,a,l),h,d,i,o,_,m,u,g,f,w,v,x,T,A,S,F,E,D,z,V,U,L,I,J;return c<B?null:(c=1/c,s*=c,a*=c,l*=c,h=Math.sin(n),d=Math.cos(n),i=1-d,o=e[0],_=e[1],m=e[2],u=e[3],g=e[4],f=e[5],w=e[6],v=e[7],x=e[8],T=e[9],A=e[10],S=e[11],F=s*s*i+d,E=a*s*i+l*h,D=l*s*i-a*h,z=s*a*i-l*h,V=a*a*i+d,U=l*a*i+s*h,L=s*l*i+a*h,I=a*l*i-s*h,J=l*l*i+d,t[0]=o*F+g*E+x*D,t[1]=_*F+f*E+T*D,t[2]=m*F+w*E+A*D,t[3]=u*F+v*E+S*D,t[4]=o*z+g*V+x*U,t[5]=_*z+f*V+T*U,t[6]=m*z+w*V+A*U,t[7]=u*z+v*V+S*U,t[8]=o*L+g*I+x*J,t[9]=_*L+f*I+T*J,t[10]=m*L+w*I+A*J,t[11]=u*L+v*I+S*J,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function Bo(t,e,n){var r=Math.sin(n),s=Math.cos(n),a=e[4],l=e[5],c=e[6],h=e[7],d=e[8],i=e[9],o=e[10],_=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*s+d*r,t[5]=l*s+i*r,t[6]=c*s+o*r,t[7]=h*s+_*r,t[8]=d*s-a*r,t[9]=i*s-l*r,t[10]=o*s-c*r,t[11]=_*s-h*r,t}function Wo(t,e,n){var r=Math.sin(n),s=Math.cos(n),a=e[0],l=e[1],c=e[2],h=e[3],d=e[8],i=e[9],o=e[10],_=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*s-d*r,t[1]=l*s-i*r,t[2]=c*s-o*r,t[3]=h*s-_*r,t[8]=a*r+d*s,t[9]=l*r+i*s,t[10]=c*r+o*s,t[11]=h*r+_*s,t}function Xo(t,e,n){var r=Math.sin(n),s=Math.cos(n),a=e[0],l=e[1],c=e[2],h=e[3],d=e[4],i=e[5],o=e[6],_=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*s+d*r,t[1]=l*s+i*r,t[2]=c*s+o*r,t[3]=h*s+_*r,t[4]=d*s-a*r,t[5]=i*s-l*r,t[6]=o*s-c*r,t[7]=_*s-h*r,t}function Yo(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function Go(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Qo(t,e,n){var r=n[0],s=n[1],a=n[2],l=Math.hypot(r,s,a),c,h,d;return l<B?null:(l=1/l,r*=l,s*=l,a*=l,c=Math.sin(e),h=Math.cos(e),d=1-h,t[0]=r*r*d+h,t[1]=s*r*d+a*c,t[2]=a*r*d-s*c,t[3]=0,t[4]=r*s*d-a*c,t[5]=s*s*d+h,t[6]=a*s*d+r*c,t[7]=0,t[8]=r*a*d+s*c,t[9]=s*a*d-r*c,t[10]=a*a*d+h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function $o(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Zo(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Jo(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function gi(t,e,n){var r=e[0],s=e[1],a=e[2],l=e[3],c=r+r,h=s+s,d=a+a,i=r*c,o=r*h,_=r*d,m=s*h,u=s*d,g=a*d,f=l*c,w=l*h,v=l*d;return t[0]=1-(m+g),t[1]=o+v,t[2]=_-w,t[3]=0,t[4]=o-v,t[5]=1-(i+g),t[6]=u+f,t[7]=0,t[8]=_+w,t[9]=u-f,t[10]=1-(i+m),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function Ko(t,e){var n=new G(3),r=-e[0],s=-e[1],a=-e[2],l=e[3],c=e[4],h=e[5],d=e[6],i=e[7],o=r*r+s*s+a*a+l*l;return o>0?(n[0]=(c*l+i*r+h*a-d*s)*2/o,n[1]=(h*l+i*s+d*r-c*a)*2/o,n[2]=(d*l+i*a+c*s-h*r)*2/o):(n[0]=(c*l+i*r+h*a-d*s)*2,n[1]=(h*l+i*s+d*r-c*a)*2,n[2]=(d*l+i*a+c*s-h*r)*2),gi(t,e,n),t}function _r(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function wi(t,e){var n=e[0],r=e[1],s=e[2],a=e[4],l=e[5],c=e[6],h=e[8],d=e[9],i=e[10];return t[0]=Math.hypot(n,r,s),t[1]=Math.hypot(a,l,c),t[2]=Math.hypot(h,d,i),t}function hr(t,e){var n=new G(3);wi(n,e);var r=1/n[0],s=1/n[1],a=1/n[2],l=e[0]*r,c=e[1]*s,h=e[2]*a,d=e[4]*r,i=e[5]*s,o=e[6]*a,_=e[8]*r,m=e[9]*s,u=e[10]*a,g=l+i+u,f=0;return g>0?(f=Math.sqrt(g+1)*2,t[3]=.25*f,t[0]=(o-m)/f,t[1]=(_-h)/f,t[2]=(c-d)/f):l>i&&l>u?(f=Math.sqrt(1+l-i-u)*2,t[3]=(o-m)/f,t[0]=.25*f,t[1]=(c+d)/f,t[2]=(_+h)/f):i>u?(f=Math.sqrt(1+i-l-u)*2,t[3]=(_-h)/f,t[0]=(c+d)/f,t[1]=.25*f,t[2]=(o+m)/f):(f=Math.sqrt(1+u-l-i)*2,t[3]=(c-d)/f,t[0]=(_+h)/f,t[1]=(o+m)/f,t[2]=.25*f),t}function el(t,e,n,r){var s=e[0],a=e[1],l=e[2],c=e[3],h=s+s,d=a+a,i=l+l,o=s*h,_=s*d,m=s*i,u=a*d,g=a*i,f=l*i,w=c*h,v=c*d,x=c*i,T=r[0],A=r[1],S=r[2];return t[0]=(1-(u+f))*T,t[1]=(_+x)*T,t[2]=(m-v)*T,t[3]=0,t[4]=(_-x)*A,t[5]=(1-(o+f))*A,t[6]=(g+w)*A,t[7]=0,t[8]=(m+v)*S,t[9]=(g-w)*S,t[10]=(1-(o+u))*S,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function tl(t,e,n,r,s){var a=e[0],l=e[1],c=e[2],h=e[3],d=a+a,i=l+l,o=c+c,_=a*d,m=a*i,u=a*o,g=l*i,f=l*o,w=c*o,v=h*d,x=h*i,T=h*o,A=r[0],S=r[1],F=r[2],E=s[0],D=s[1],z=s[2],V=(1-(g+w))*A,U=(m+T)*A,L=(u-x)*A,I=(m-T)*S,J=(1-(_+w))*S,_e=(f+v)*S,he=(u+x)*F,Lt=(f-v)*F,Dt=(1-(_+g))*F;return t[0]=V,t[1]=U,t[2]=L,t[3]=0,t[4]=I,t[5]=J,t[6]=_e,t[7]=0,t[8]=he,t[9]=Lt,t[10]=Dt,t[11]=0,t[12]=n[0]+E-(V*E+I*D+he*z),t[13]=n[1]+D-(U*E+J*D+Lt*z),t[14]=n[2]+z-(L*E+_e*D+Dt*z),t[15]=1,t}function nl(t,e){var n=e[0],r=e[1],s=e[2],a=e[3],l=n+n,c=r+r,h=s+s,d=n*l,i=r*l,o=r*c,_=s*l,m=s*c,u=s*h,g=a*l,f=a*c,w=a*h;return t[0]=1-o-u,t[1]=i+w,t[2]=_-f,t[3]=0,t[4]=i-w,t[5]=1-d-u,t[6]=m+g,t[7]=0,t[8]=_+f,t[9]=m-g,t[10]=1-d-o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function rl(t,e,n,r,s,a,l){var c=1/(n-e),h=1/(s-r),d=1/(a-l);return t[0]=a*2*c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a*2*h,t[6]=0,t[7]=0,t[8]=(n+e)*c,t[9]=(s+r)*h,t[10]=(l+a)*d,t[11]=-1,t[12]=0,t[13]=0,t[14]=l*a*2*d,t[15]=0,t}function vi(t,e,n,r,s){var a=1/Math.tan(e/2),l;return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==1/0?(l=1/(r-s),t[10]=(s+r)*l,t[14]=2*s*r*l):(t[10]=-1,t[14]=-2*r),t}var il=vi;function sl(t,e,n,r,s){var a=1/Math.tan(e/2),l;return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==1/0?(l=1/(r-s),t[10]=s*l,t[14]=s*r*l):(t[10]=-1,t[14]=-r),t}function al(t,e,n,r){var s=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),l=Math.tan(e.leftDegrees*Math.PI/180),c=Math.tan(e.rightDegrees*Math.PI/180),h=2/(l+c),d=2/(s+a);return t[0]=h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=d,t[6]=0,t[7]=0,t[8]=-((l-c)*h*.5),t[9]=(s-a)*d*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function xi(t,e,n,r,s,a,l){var c=1/(e-n),h=1/(r-s),d=1/(a-l);return t[0]=-2*c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*d,t[11]=0,t[12]=(e+n)*c,t[13]=(s+r)*h,t[14]=(l+a)*d,t[15]=1,t}var ol=xi;function ll(t,e,n,r,s,a,l){var c=1/(e-n),h=1/(r-s),d=1/(a-l);return t[0]=-2*c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=d,t[11]=0,t[12]=(e+n)*c,t[13]=(s+r)*h,t[14]=a*d,t[15]=1,t}function cl(t,e,n,r){var s,a,l,c,h,d,i,o,_,m,u=e[0],g=e[1],f=e[2],w=r[0],v=r[1],x=r[2],T=n[0],A=n[1],S=n[2];return Math.abs(u-T)<B&&Math.abs(g-A)<B&&Math.abs(f-S)<B?fi(t):(i=u-T,o=g-A,_=f-S,m=1/Math.hypot(i,o,_),i*=m,o*=m,_*=m,s=v*_-x*o,a=x*i-w*_,l=w*o-v*i,m=Math.hypot(s,a,l),m?(m=1/m,s*=m,a*=m,l*=m):(s=0,a=0,l=0),c=o*l-_*a,h=_*s-i*l,d=i*a-o*s,m=Math.hypot(c,h,d),m?(m=1/m,c*=m,h*=m,d*=m):(c=0,h=0,d=0),t[0]=s,t[1]=c,t[2]=i,t[3]=0,t[4]=a,t[5]=h,t[6]=o,t[7]=0,t[8]=l,t[9]=d,t[10]=_,t[11]=0,t[12]=-(s*u+a*g+l*f),t[13]=-(c*u+h*g+d*f),t[14]=-(i*u+o*g+_*f),t[15]=1,t)}function _l(t,e,n,r){var s=e[0],a=e[1],l=e[2],c=r[0],h=r[1],d=r[2],i=s-n[0],o=a-n[1],_=l-n[2],m=i*i+o*o+_*_;m>0&&(m=1/Math.sqrt(m),i*=m,o*=m,_*=m);var u=h*_-d*o,g=d*i-c*_,f=c*o-h*i;return m=u*u+g*g+f*f,m>0&&(m=1/Math.sqrt(m),u*=m,g*=m,f*=m),t[0]=u,t[1]=g,t[2]=f,t[3]=0,t[4]=o*f-_*g,t[5]=_*u-i*f,t[6]=i*g-o*u,t[7]=0,t[8]=i,t[9]=o,t[10]=_,t[11]=0,t[12]=s,t[13]=a,t[14]=l,t[15]=1,t}function hl(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function pl(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function dl(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function yi(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function ml(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function fl(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function ul(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function gl(t,e){var n=t[0],r=t[1],s=t[2],a=t[3],l=t[4],c=t[5],h=t[6],d=t[7],i=t[8],o=t[9],_=t[10],m=t[11],u=t[12],g=t[13],f=t[14],w=t[15],v=e[0],x=e[1],T=e[2],A=e[3],S=e[4],F=e[5],E=e[6],D=e[7],z=e[8],V=e[9],U=e[10],L=e[11],I=e[12],J=e[13],_e=e[14],he=e[15];return Math.abs(n-v)<=B*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(r-x)<=B*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(s-T)<=B*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(a-A)<=B*Math.max(1,Math.abs(a),Math.abs(A))&&Math.abs(l-S)<=B*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(c-F)<=B*Math.max(1,Math.abs(c),Math.abs(F))&&Math.abs(h-E)<=B*Math.max(1,Math.abs(h),Math.abs(E))&&Math.abs(d-D)<=B*Math.max(1,Math.abs(d),Math.abs(D))&&Math.abs(i-z)<=B*Math.max(1,Math.abs(i),Math.abs(z))&&Math.abs(o-V)<=B*Math.max(1,Math.abs(o),Math.abs(V))&&Math.abs(_-U)<=B*Math.max(1,Math.abs(_),Math.abs(U))&&Math.abs(m-L)<=B*Math.max(1,Math.abs(m),Math.abs(L))&&Math.abs(u-I)<=B*Math.max(1,Math.abs(u),Math.abs(I))&&Math.abs(g-J)<=B*Math.max(1,Math.abs(g),Math.abs(J))&&Math.abs(f-_e)<=B*Math.max(1,Math.abs(f),Math.abs(_e))&&Math.abs(w-he)<=B*Math.max(1,Math.abs(w),Math.abs(he))}var wl=ui,vl=yi;var C={};je(C,{add:()=>uc,calculateW:()=>ac,clone:()=>dc,conjugate:()=>_c,copy:()=>cn,create:()=>Nt,dot:()=>_n,equals:()=>bc,exactEquals:()=>yc,exp:()=>Bi,fromEuler:()=>hc,fromMat3:()=>Xi,fromValues:()=>mc,getAngle:()=>sc,getAxisAngle:()=>ic,identity:()=>rc,invert:()=>cc,len:()=>vc,length:()=>hn,lerp:()=>wc,ln:()=>Wi,mul:()=>gc,multiply:()=>Hi,normalize:()=>gr,pow:()=>oc,random:()=>lc,rotateX:()=>mr,rotateY:()=>fr,rotateZ:()=>ur,rotationTo:()=>Mc,scale:()=>Yi,set:()=>fc,setAxes:()=>Tc,setAxisAngle:()=>Vi,slerp:()=>ln,sqlerp:()=>Ac,sqrLen:()=>xc,squaredLength:()=>pn,str:()=>pc});var y={};je(y,{add:()=>Ml,angle:()=>Hl,bezier:()=>kl,ceil:()=>Al,clone:()=>xl,copy:()=>yl,create:()=>sn,cross:()=>Ut,dist:()=>Zl,distance:()=>Si,div:()=>$l,divide:()=>Ti,dot:()=>on,equals:()=>Yl,exactEquals:()=>Xl,floor:()=>Tl,forEach:()=>ec,fromValues:()=>an,hermite:()=>Ol,inverse:()=>Rl,len:()=>dr,length:()=>bi,lerp:()=>Cl,max:()=>jl,min:()=>Sl,mul:()=>Ql,multiply:()=>Ai,negate:()=>Fl,normalize:()=>pr,random:()=>Ll,rotateX:()=>Nl,rotateY:()=>ql,rotateZ:()=>Vl,round:()=>Pl,scale:()=>El,scaleAndAdd:()=>Il,set:()=>bl,sqrDist:()=>Jl,sqrLen:()=>Kl,squaredDistance:()=>ji,squaredLength:()=>Pi,str:()=>Wl,sub:()=>Gl,subtract:()=>Mi,transformMat3:()=>zl,transformMat4:()=>Dl,transformQuat:()=>Ul,zero:()=>Bl});function sn(){var t=new G(3);return G!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function xl(t){var e=new G(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function bi(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function an(t,e,n){var r=new G(3);return r[0]=t,r[1]=e,r[2]=n,r}function yl(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function bl(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function Ml(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Mi(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Ai(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function Ti(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function Al(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function Tl(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function Sl(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function jl(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function Pl(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function El(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function Il(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function Si(t,e){var n=e[0]-t[0],r=e[1]-t[1],s=e[2]-t[2];return Math.hypot(n,r,s)}function ji(t,e){var n=e[0]-t[0],r=e[1]-t[1],s=e[2]-t[2];return n*n+r*r+s*s}function Pi(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function Fl(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Rl(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function pr(t,e){var n=e[0],r=e[1],s=e[2],a=n*n+r*r+s*s;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}function on(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Ut(t,e,n){var r=e[0],s=e[1],a=e[2],l=n[0],c=n[1],h=n[2];return t[0]=s*h-a*c,t[1]=a*l-r*h,t[2]=r*c-s*l,t}function Cl(t,e,n,r){var s=e[0],a=e[1],l=e[2];return t[0]=s+r*(n[0]-s),t[1]=a+r*(n[1]-a),t[2]=l+r*(n[2]-l),t}function Ol(t,e,n,r,s,a){var l=a*a,c=l*(2*a-3)+1,h=l*(a-2)+a,d=l*(a-1),i=l*(3-2*a);return t[0]=e[0]*c+n[0]*h+r[0]*d+s[0]*i,t[1]=e[1]*c+n[1]*h+r[1]*d+s[1]*i,t[2]=e[2]*c+n[2]*h+r[2]*d+s[2]*i,t}function kl(t,e,n,r,s,a){var l=1-a,c=l*l,h=a*a,d=c*l,i=3*a*c,o=3*h*l,_=h*a;return t[0]=e[0]*d+n[0]*i+r[0]*o+s[0]*_,t[1]=e[1]*d+n[1]*i+r[1]*o+s[1]*_,t[2]=e[2]*d+n[2]*i+r[2]*o+s[2]*_,t}function Ll(t,e){e=e||1;var n=Fe()*2*Math.PI,r=Fe()*2-1,s=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*s,t[1]=Math.sin(n)*s,t[2]=r*e,t}function Dl(t,e,n){var r=e[0],s=e[1],a=e[2],l=n[3]*r+n[7]*s+n[11]*a+n[15];return l=l||1,t[0]=(n[0]*r+n[4]*s+n[8]*a+n[12])/l,t[1]=(n[1]*r+n[5]*s+n[9]*a+n[13])/l,t[2]=(n[2]*r+n[6]*s+n[10]*a+n[14])/l,t}function zl(t,e,n){var r=e[0],s=e[1],a=e[2];return t[0]=r*n[0]+s*n[3]+a*n[6],t[1]=r*n[1]+s*n[4]+a*n[7],t[2]=r*n[2]+s*n[5]+a*n[8],t}function Ul(t,e,n){var r=n[0],s=n[1],a=n[2],l=n[3],c=e[0],h=e[1],d=e[2],i=s*d-a*h,o=a*c-r*d,_=r*h-s*c,m=s*_-a*o,u=a*i-r*_,g=r*o-s*i,f=l*2;return i*=f,o*=f,_*=f,m*=2,u*=2,g*=2,t[0]=c+i+m,t[1]=h+o+u,t[2]=d+_+g,t}function Nl(t,e,n,r){var s=[],a=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],a[0]=s[0],a[1]=s[1]*Math.cos(r)-s[2]*Math.sin(r),a[2]=s[1]*Math.sin(r)+s[2]*Math.cos(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function ql(t,e,n,r){var s=[],a=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],a[0]=s[2]*Math.sin(r)+s[0]*Math.cos(r),a[1]=s[1],a[2]=s[2]*Math.cos(r)-s[0]*Math.sin(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function Vl(t,e,n,r){var s=[],a=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],a[0]=s[0]*Math.cos(r)-s[1]*Math.sin(r),a[1]=s[0]*Math.sin(r)+s[1]*Math.cos(r),a[2]=s[2],t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function Hl(t,e){var n=t[0],r=t[1],s=t[2],a=e[0],l=e[1],c=e[2],h=Math.sqrt(n*n+r*r+s*s),d=Math.sqrt(a*a+l*l+c*c),i=h*d,o=i&&on(t,e)/i;return Math.acos(Math.min(Math.max(o,-1),1))}function Bl(t){return t[0]=0,t[1]=0,t[2]=0,t}function Wl(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Xl(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function Yl(t,e){var n=t[0],r=t[1],s=t[2],a=e[0],l=e[1],c=e[2];return Math.abs(n-a)<=B*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-l)<=B*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(s-c)<=B*Math.max(1,Math.abs(s),Math.abs(c))}var Gl=Mi,Ql=Ai,$l=Ti,Zl=Si,Jl=ji,dr=bi,Kl=Pi,ec=function(){var t=sn();return function(e,n,r,s,a,l){var c,h;for(n||(n=3),r||(r=0),s?h=Math.min(s*n+r,e.length):h=e.length,c=r;c<h;c+=n)t[0]=e[c],t[1]=e[c+1],t[2]=e[c+2],a(t,t,l),e[c]=t[0],e[c+1]=t[1],e[c+2]=t[2];return e}}();function tc(){var t=new G(4);return G!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Ei(t){var e=new G(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Ii(t,e,n,r){var s=new G(4);return s[0]=t,s[1]=e,s[2]=n,s[3]=r,s}function Fi(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Ri(t,e,n,r,s){return t[0]=e,t[1]=n,t[2]=r,t[3]=s,t}function Ci(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function Oi(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function ki(t){var e=t[0],n=t[1],r=t[2],s=t[3];return Math.hypot(e,n,r,s)}function Li(t){var e=t[0],n=t[1],r=t[2],s=t[3];return e*e+n*n+r*r+s*s}function Di(t,e){var n=e[0],r=e[1],s=e[2],a=e[3],l=n*n+r*r+s*s+a*a;return l>0&&(l=1/Math.sqrt(l)),t[0]=n*l,t[1]=r*l,t[2]=s*l,t[3]=a*l,t}function zi(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function Ui(t,e,n,r){var s=e[0],a=e[1],l=e[2],c=e[3];return t[0]=s+r*(n[0]-s),t[1]=a+r*(n[1]-a),t[2]=l+r*(n[2]-l),t[3]=c+r*(n[3]-c),t}function Ni(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function qi(t,e){var n=t[0],r=t[1],s=t[2],a=t[3],l=e[0],c=e[1],h=e[2],d=e[3];return Math.abs(n-l)<=B*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(r-c)<=B*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(s-h)<=B*Math.max(1,Math.abs(s),Math.abs(h))&&Math.abs(a-d)<=B*Math.max(1,Math.abs(a),Math.abs(d))}var Hm=function(){var t=tc();return function(e,n,r,s,a,l){var c,h;for(n||(n=4),r||(r=0),s?h=Math.min(s*n+r,e.length):h=e.length,c=r;c<h;c+=n)t[0]=e[c],t[1]=e[c+1],t[2]=e[c+2],t[3]=e[c+3],a(t,t,l),e[c]=t[0],e[c+1]=t[1],e[c+2]=t[2],e[c+3]=t[3];return e}}();function Nt(){var t=new G(4);return G!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function rc(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Vi(t,e,n){n=n*.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function ic(t,e){var n=Math.acos(e[3])*2,r=Math.sin(n/2);return r>B?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function sc(t,e){var n=_n(t,e);return Math.acos(2*n*n-1)}function Hi(t,e,n){var r=e[0],s=e[1],a=e[2],l=e[3],c=n[0],h=n[1],d=n[2],i=n[3];return t[0]=r*i+l*c+s*d-a*h,t[1]=s*i+l*h+a*c-r*d,t[2]=a*i+l*d+r*h-s*c,t[3]=l*i-r*c-s*h-a*d,t}function mr(t,e,n){n*=.5;var r=e[0],s=e[1],a=e[2],l=e[3],c=Math.sin(n),h=Math.cos(n);return t[0]=r*h+l*c,t[1]=s*h+a*c,t[2]=a*h-s*c,t[3]=l*h-r*c,t}function fr(t,e,n){n*=.5;var r=e[0],s=e[1],a=e[2],l=e[3],c=Math.sin(n),h=Math.cos(n);return t[0]=r*h-a*c,t[1]=s*h+l*c,t[2]=a*h+r*c,t[3]=l*h-s*c,t}function ur(t,e,n){n*=.5;var r=e[0],s=e[1],a=e[2],l=e[3],c=Math.sin(n),h=Math.cos(n);return t[0]=r*h+s*c,t[1]=s*h-r*c,t[2]=a*h+l*c,t[3]=l*h-a*c,t}function ac(t,e){var n=e[0],r=e[1],s=e[2];return t[0]=n,t[1]=r,t[2]=s,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-s*s)),t}function Bi(t,e){var n=e[0],r=e[1],s=e[2],a=e[3],l=Math.sqrt(n*n+r*r+s*s),c=Math.exp(a),h=l>0?c*Math.sin(l)/l:0;return t[0]=n*h,t[1]=r*h,t[2]=s*h,t[3]=c*Math.cos(l),t}function Wi(t,e){var n=e[0],r=e[1],s=e[2],a=e[3],l=Math.sqrt(n*n+r*r+s*s),c=l>0?Math.atan2(l,a)/l:0;return t[0]=n*c,t[1]=r*c,t[2]=s*c,t[3]=.5*Math.log(n*n+r*r+s*s+a*a),t}function oc(t,e,n){return Wi(t,e),Yi(t,t,n),Bi(t,t),t}function ln(t,e,n,r){var s=e[0],a=e[1],l=e[2],c=e[3],h=n[0],d=n[1],i=n[2],o=n[3],_,m,u,g,f;return m=s*h+a*d+l*i+c*o,m<0&&(m=-m,h=-h,d=-d,i=-i,o=-o),1-m>B?(_=Math.acos(m),u=Math.sin(_),g=Math.sin((1-r)*_)/u,f=Math.sin(r*_)/u):(g=1-r,f=r),t[0]=g*s+f*h,t[1]=g*a+f*d,t[2]=g*l+f*i,t[3]=g*c+f*o,t}function lc(t){var e=Fe(),n=Fe(),r=Fe(),s=Math.sqrt(1-e),a=Math.sqrt(e);return t[0]=s*Math.sin(2*Math.PI*n),t[1]=s*Math.cos(2*Math.PI*n),t[2]=a*Math.sin(2*Math.PI*r),t[3]=a*Math.cos(2*Math.PI*r),t}function cc(t,e){var n=e[0],r=e[1],s=e[2],a=e[3],l=n*n+r*r+s*s+a*a,c=l?1/l:0;return t[0]=-n*c,t[1]=-r*c,t[2]=-s*c,t[3]=a*c,t}function _c(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function Xi(t,e){var n=e[0]+e[4]+e[8],r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var s=0;e[4]>e[0]&&(s=1),e[8]>e[s*3+s]&&(s=2);var a=(s+1)%3,l=(s+2)%3;r=Math.sqrt(e[s*3+s]-e[a*3+a]-e[l*3+l]+1),t[s]=.5*r,r=.5/r,t[3]=(e[a*3+l]-e[l*3+a])*r,t[a]=(e[a*3+s]+e[s*3+a])*r,t[l]=(e[l*3+s]+e[s*3+l])*r}return t}function hc(t,e,n,r){var s=.5*Math.PI/180;e*=s,n*=s,r*=s;var a=Math.sin(e),l=Math.cos(e),c=Math.sin(n),h=Math.cos(n),d=Math.sin(r),i=Math.cos(r);return t[0]=a*h*i-l*c*d,t[1]=l*c*i+a*h*d,t[2]=l*h*d-a*c*i,t[3]=l*h*i+a*c*d,t}function pc(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var dc=Ei,mc=Ii,cn=Fi,fc=Ri,uc=Ci,gc=Hi,Yi=Oi,_n=zi,wc=Ui,hn=ki,vc=hn,pn=Li,xc=pn,gr=Di,yc=Ni,bc=qi,Mc=function(){var t=sn(),e=an(1,0,0),n=an(0,1,0);return function(r,s,a){var l=on(s,a);return l<-.999999?(Ut(t,e,s),dr(t)<1e-6&&Ut(t,n,s),pr(t,t),Vi(r,t,Math.PI),r):l>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(Ut(t,s,a),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+l,gr(r,r))}}(),Ac=function(){var t=Nt(),e=Nt();return function(n,r,s,a,l,c){return ln(t,r,l,c),ln(e,s,a,c),ln(n,t,e,2*c*(1-c)),n}}(),Tc=function(){var t=mi();return function(e,n,r,s){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=s[0],t[4]=s[1],t[7]=s[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],gr(e,Xi(e,t))}}();var te={};je(te,{add:()=>Yc,clone:()=>jc,conjugate:()=>Jc,copy:()=>Qi,create:()=>Sc,dot:()=>Zi,equals:()=>i_,exactEquals:()=>r_,fromMat4:()=>Rc,fromRotation:()=>Fc,fromRotationTranslation:()=>Gi,fromRotationTranslationValues:()=>Ec,fromTranslation:()=>Ic,fromValues:()=>Pc,getDual:()=>Lc,getReal:()=>kc,getTranslation:()=>Uc,identity:()=>Cc,invert:()=>Zc,len:()=>Kc,length:()=>Ji,lerp:()=>$c,mul:()=>Gc,multiply:()=>$i,normalize:()=>t_,rotateAroundAxis:()=>Xc,rotateByQuatAppend:()=>Bc,rotateByQuatPrepend:()=>Wc,rotateX:()=>qc,rotateY:()=>Vc,rotateZ:()=>Hc,scale:()=>Qc,set:()=>Oc,setDual:()=>zc,setReal:()=>Dc,sqrLen:()=>e_,squaredLength:()=>dn,str:()=>n_,translate:()=>Nc});function Sc(){var t=new G(8);return G!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t}function jc(t){var e=new G(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function Pc(t,e,n,r,s,a,l,c){var h=new G(8);return h[0]=t,h[1]=e,h[2]=n,h[3]=r,h[4]=s,h[5]=a,h[6]=l,h[7]=c,h}function Ec(t,e,n,r,s,a,l){var c=new G(8);c[0]=t,c[1]=e,c[2]=n,c[3]=r;var h=s*.5,d=a*.5,i=l*.5;return c[4]=h*r+d*n-i*e,c[5]=d*r+i*t-h*n,c[6]=i*r+h*e-d*t,c[7]=-h*t-d*e-i*n,c}function Gi(t,e,n){var r=n[0]*.5,s=n[1]*.5,a=n[2]*.5,l=e[0],c=e[1],h=e[2],d=e[3];return t[0]=l,t[1]=c,t[2]=h,t[3]=d,t[4]=r*d+s*h-a*c,t[5]=s*d+a*l-r*h,t[6]=a*d+r*c-s*l,t[7]=-r*l-s*c-a*h,t}function Ic(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0]*.5,t[5]=e[1]*.5,t[6]=e[2]*.5,t[7]=0,t}function Fc(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function Rc(t,e){var n=Nt();hr(n,e);var r=new G(3);return _r(r,e),Gi(t,n,r),t}function Qi(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function Cc(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function Oc(t,e,n,r,s,a,l,c,h){return t[0]=e,t[1]=n,t[2]=r,t[3]=s,t[4]=a,t[5]=l,t[6]=c,t[7]=h,t}var kc=cn;function Lc(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t}var Dc=cn;function zc(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t}function Uc(t,e){var n=e[4],r=e[5],s=e[6],a=e[7],l=-e[0],c=-e[1],h=-e[2],d=e[3];return t[0]=(n*d+a*l+r*h-s*c)*2,t[1]=(r*d+a*c+s*l-n*h)*2,t[2]=(s*d+a*h+n*c-r*l)*2,t}function Nc(t,e,n){var r=e[0],s=e[1],a=e[2],l=e[3],c=n[0]*.5,h=n[1]*.5,d=n[2]*.5,i=e[4],o=e[5],_=e[6],m=e[7];return t[0]=r,t[1]=s,t[2]=a,t[3]=l,t[4]=l*c+s*d-a*h+i,t[5]=l*h+a*c-r*d+o,t[6]=l*d+r*h-s*c+_,t[7]=-r*c-s*h-a*d+m,t}function qc(t,e,n){var r=-e[0],s=-e[1],a=-e[2],l=e[3],c=e[4],h=e[5],d=e[6],i=e[7],o=c*l+i*r+h*a-d*s,_=h*l+i*s+d*r-c*a,m=d*l+i*a+c*s-h*r,u=i*l-c*r-h*s-d*a;return mr(t,e,n),r=t[0],s=t[1],a=t[2],l=t[3],t[4]=o*l+u*r+_*a-m*s,t[5]=_*l+u*s+m*r-o*a,t[6]=m*l+u*a+o*s-_*r,t[7]=u*l-o*r-_*s-m*a,t}function Vc(t,e,n){var r=-e[0],s=-e[1],a=-e[2],l=e[3],c=e[4],h=e[5],d=e[6],i=e[7],o=c*l+i*r+h*a-d*s,_=h*l+i*s+d*r-c*a,m=d*l+i*a+c*s-h*r,u=i*l-c*r-h*s-d*a;return fr(t,e,n),r=t[0],s=t[1],a=t[2],l=t[3],t[4]=o*l+u*r+_*a-m*s,t[5]=_*l+u*s+m*r-o*a,t[6]=m*l+u*a+o*s-_*r,t[7]=u*l-o*r-_*s-m*a,t}function Hc(t,e,n){var r=-e[0],s=-e[1],a=-e[2],l=e[3],c=e[4],h=e[5],d=e[6],i=e[7],o=c*l+i*r+h*a-d*s,_=h*l+i*s+d*r-c*a,m=d*l+i*a+c*s-h*r,u=i*l-c*r-h*s-d*a;return ur(t,e,n),r=t[0],s=t[1],a=t[2],l=t[3],t[4]=o*l+u*r+_*a-m*s,t[5]=_*l+u*s+m*r-o*a,t[6]=m*l+u*a+o*s-_*r,t[7]=u*l-o*r-_*s-m*a,t}function Bc(t,e,n){var r=n[0],s=n[1],a=n[2],l=n[3],c=e[0],h=e[1],d=e[2],i=e[3];return t[0]=c*l+i*r+h*a-d*s,t[1]=h*l+i*s+d*r-c*a,t[2]=d*l+i*a+c*s-h*r,t[3]=i*l-c*r-h*s-d*a,c=e[4],h=e[5],d=e[6],i=e[7],t[4]=c*l+i*r+h*a-d*s,t[5]=h*l+i*s+d*r-c*a,t[6]=d*l+i*a+c*s-h*r,t[7]=i*l-c*r-h*s-d*a,t}function Wc(t,e,n){var r=e[0],s=e[1],a=e[2],l=e[3],c=n[0],h=n[1],d=n[2],i=n[3];return t[0]=r*i+l*c+s*d-a*h,t[1]=s*i+l*h+a*c-r*d,t[2]=a*i+l*d+r*h-s*c,t[3]=l*i-r*c-s*h-a*d,c=n[4],h=n[5],d=n[6],i=n[7],t[4]=r*i+l*c+s*d-a*h,t[5]=s*i+l*h+a*c-r*d,t[6]=a*i+l*d+r*h-s*c,t[7]=l*i-r*c-s*h-a*d,t}function Xc(t,e,n,r){if(Math.abs(r)<B)return Qi(t,e);var s=Math.hypot(n[0],n[1],n[2]);r=r*.5;var a=Math.sin(r),l=a*n[0]/s,c=a*n[1]/s,h=a*n[2]/s,d=Math.cos(r),i=e[0],o=e[1],_=e[2],m=e[3];t[0]=i*d+m*l+o*h-_*c,t[1]=o*d+m*c+_*l-i*h,t[2]=_*d+m*h+i*c-o*l,t[3]=m*d-i*l-o*c-_*h;var u=e[4],g=e[5],f=e[6],w=e[7];return t[4]=u*d+w*l+g*h-f*c,t[5]=g*d+w*c+f*l-u*h,t[6]=f*d+w*h+u*c-g*l,t[7]=w*d-u*l-g*c-f*h,t}function Yc(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t}function $i(t,e,n){var r=e[0],s=e[1],a=e[2],l=e[3],c=n[4],h=n[5],d=n[6],i=n[7],o=e[4],_=e[5],m=e[6],u=e[7],g=n[0],f=n[1],w=n[2],v=n[3];return t[0]=r*v+l*g+s*w-a*f,t[1]=s*v+l*f+a*g-r*w,t[2]=a*v+l*w+r*f-s*g,t[3]=l*v-r*g-s*f-a*w,t[4]=r*i+l*c+s*d-a*h+o*v+u*g+_*w-m*f,t[5]=s*i+l*h+a*c-r*d+_*v+u*f+m*g-o*w,t[6]=a*i+l*d+r*h-s*c+m*v+u*w+o*f-_*g,t[7]=l*i-r*c-s*h-a*d+u*v-o*g-_*f-m*w,t}var Gc=$i;function Qc(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t}var Zi=_n;function $c(t,e,n,r){var s=1-r;return Zi(e,n)<0&&(r=-r),t[0]=e[0]*s+n[0]*r,t[1]=e[1]*s+n[1]*r,t[2]=e[2]*s+n[2]*r,t[3]=e[3]*s+n[3]*r,t[4]=e[4]*s+n[4]*r,t[5]=e[5]*s+n[5]*r,t[6]=e[6]*s+n[6]*r,t[7]=e[7]*s+n[7]*r,t}function Zc(t,e){var n=dn(e);return t[0]=-e[0]/n,t[1]=-e[1]/n,t[2]=-e[2]/n,t[3]=e[3]/n,t[4]=-e[4]/n,t[5]=-e[5]/n,t[6]=-e[6]/n,t[7]=e[7]/n,t}function Jc(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t}var Ji=hn,Kc=Ji,dn=pn,e_=dn;function t_(t,e){var n=dn(e);if(n>0){n=Math.sqrt(n);var r=e[0]/n,s=e[1]/n,a=e[2]/n,l=e[3]/n,c=e[4],h=e[5],d=e[6],i=e[7],o=r*c+s*h+a*d+l*i;t[0]=r,t[1]=s,t[2]=a,t[3]=l,t[4]=(c-r*o)/n,t[5]=(h-s*o)/n,t[6]=(d-a*o)/n,t[7]=(i-l*o)/n}return t}function n_(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function r_(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]}function i_(t,e){var n=t[0],r=t[1],s=t[2],a=t[3],l=t[4],c=t[5],h=t[6],d=t[7],i=e[0],o=e[1],_=e[2],m=e[3],u=e[4],g=e[5],f=e[6],w=e[7];return Math.abs(n-i)<=B*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-o)<=B*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(s-_)<=B*Math.max(1,Math.abs(s),Math.abs(_))&&Math.abs(a-m)<=B*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(l-u)<=B*Math.max(1,Math.abs(l),Math.abs(u))&&Math.abs(c-g)<=B*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(h-f)<=B*Math.max(1,Math.abs(h),Math.abs(f))&&Math.abs(d-w)<=B*Math.max(1,Math.abs(d),Math.abs(w))}var it=class extends R{collisionMask=0;maxDistance=100;onDestroyCallbacks=[];input=null;origin=new Float32Array(3);cursorObjScale=new Float32Array(3);direction=new Float32Array(3);tempVec=new Float32Array(3);projectionMatrix=new Float32Array(16);viewComponent=null;visible=!0;isDown=!1;lastIsDown=!1;arTouchDown=!1;cursorPos=new Float32Array(3);lastCursorPosOnTarget=new Float32Array(3);hoveringObject=null;hoveringObjectTarget=null;cursorRayScale=new Float32Array(3);globalTarget=null;collisionGroup=1;cursorRayObject=null;cursorRayScalingAxis=2;cursorObject=null;handedness=0;rayCastMode=0;styleCursor=!0;start(){if(this.collisionMask=1<<this.collisionGroup,this.handedness==0){let n=this.object.getComponent("input");n?(this.handedness=n.handedness||"none",this.input=n):console.warn("cursor component on object",this.object.name,'was configured with handedness "input component", but object has no input component.')}else this.handedness=["left","right","none"][this.handedness-1];if(this.globalTarget=this.object.addComponent(se),this.viewComponent=this.object.getComponent(ye),this.viewComponent!=null){let n=this.onClick.bind(this);this.engine.canvas.addEventListener("click",n);let r=this.onPointerMove.bind(this);this.engine.canvas.addEventListener("pointermove",r);let s=this.onPointerDown.bind(this);this.engine.canvas.addEventListener("pointerdown",s);let a=this.onPointerUp.bind(this);this.engine.canvas.addEventListener("pointerup",a),Re.invert(this.projectionMatrix,this.viewComponent.projectionMatrix);let l=this.onViewportResize.bind(this);window.addEventListener("resize",l),this.onDestroyCallbacks.push(()=>{this.engine.canvas.removeEventListener("click",n),this.engine.canvas.removeEventListener("pointermove",r),this.engine.canvas.removeEventListener("pointerdown",s),this.engine.canvas.removeEventListener("pointerup",a),window.removeEventListener("resize",l)})}let e=this.setupVREvents.bind(this);this.engine.onXRSessionStart.add(e),this.onDestroyCallbacks.push(()=>{this.engine.onXRSessionStart.remove(e)}),this.cursorRayObject&&(this.cursorRayScale.set(this.cursorRayObject.scalingLocal),this.object.getTranslationWorld(this.origin),this.object.getForward(this.direction),this._setCursorRayTransform(y.add(this.tempVec,this.origin,this.direction)))}onViewportResize(){this.viewComponent&&Re.invert(this.projectionMatrix,this.viewComponent.projectionMatrix)}_setCursorRayTransform(e){if(!this.cursorRayObject)return;let n=y.dist(this.origin,e);this.cursorRayObject.setTranslationLocal([0,0,-n/2]),this.cursorRayScalingAxis!=4&&(this.cursorRayObject.resetScaling(),this.cursorRayScale[this.cursorRayScalingAxis]=n/2,this.cursorRayObject.scale(this.cursorRayScale))}_setCursorVisibility(e){this.visible!=e&&(this.visible=e,this.cursorObject&&(e?(this.cursorObject.resetScaling(),this.cursorObject.scale(this.cursorObjScale)):(this.cursorObjScale.set(this.cursorObject.scalingLocal),this.cursorObject.scale([0,0,0]))))}update(){this.doUpdate(!1)}doUpdate(e){if(this.engine.xrSession)if(this.arTouchDown&&this.input&&this.engine.xrSession.inputSources[0].handedness==="none"&&this.engine.xrSession.inputSources[0].gamepad){let r=this.engine.xrSession.inputSources[0].gamepad.axes;this.direction[0]=r[0],this.direction[1]=-r[1],this.direction[2]=-1,this.updateDirection()}else this.object.getTranslationWorld(this.origin),this.object.getForward(this.direction);let n=this.rayCastMode==0?this.engine.scene.rayCast(this.origin,this.direction,this.collisionMask):this.engine.physics.rayCast(this.origin,this.direction,this.collisionMask,this.maxDistance);n.hitCount>0?this.cursorPos.set(n.locations[0]):this.cursorPos.fill(0),this.hoverBehaviour(n,e),this.cursorObject&&(this.hoveringObject&&(this.cursorPos[0]!=0||this.cursorPos[1]!=0||this.cursorPos[2]!=0)?(this._setCursorVisibility(!0),this.cursorObject.setTranslationWorld(this.cursorPos),this._setCursorRayTransform(this.cursorPos)):this._setCursorVisibility(!1))}hoverBehaviour(e,n){if(e.hitCount>0){if(!this.hoveringObject||!this.hoveringObject.equals(e.objects[0])){if(this.hoveringObject){let a=this.hoveringObject.getComponent(se);a&&a.onUnhover.notify(this.hoveringObject,this),this.globalTarget.onUnhover.notify(this.hoveringObject,this)}this.hoveringObject=e.objects[0],this.styleCursor&&(this.engine.canvas.style.cursor="pointer");let s=this.hoveringObject.getComponent(se);s&&(this.hoveringObjectTarget=s,s.onHover.notify(this.hoveringObject,this)),this.globalTarget.onHover.notify(this.hoveringObject,this)}this.hoveringObjectTarget&&(this.hoveringObject.toLocalSpaceTransform(this.tempVec,this.cursorPos),(this.lastCursorPosOnTarget[0]!=this.tempVec[0]||this.lastCursorPosOnTarget[1]!=this.tempVec[1]||this.lastCursorPosOnTarget[2]!=this.tempVec[2])&&(this.hoveringObjectTarget.onMove.notify(this.hoveringObject,this),this.lastCursorPosOnTarget.set(this.tempVec)));let r=this.hoveringObject.getComponent(se);this.isDown!==this.lastIsDown&&(this.isDown?(r&&r.onDown.notify(this.hoveringObject,this),this.globalTarget.onDown.notify(this.hoveringObject,this)):(r&&r.onUp.notify(this.hoveringObject,this),this.globalTarget.onUp.notify(this.hoveringObject,this))),n&&(r&&r.onClick.notify(this.hoveringObject,this),this.globalTarget.onClick.notify(this.hoveringObject,this))}else if(this.hoveringObject&&e.hitCount==0){let r=this.hoveringObject.getComponent(se);r&&r.onUnhover.notify(this.hoveringObject,this),this.globalTarget.onUnhover.notify(this.hoveringObject,this),this.hoveringObject=null,this.hoveringObjectTarget=null,this.styleCursor&&(this.engine.canvas.style.cursor="default")}this.lastIsDown=this.isDown}setupVREvents(e){let n=this.onSelect.bind(this);e.addEventListener("select",n);let r=this.onSelectStart.bind(this);e.addEventListener("selectstart",r);let s=this.onSelectEnd.bind(this);e.addEventListener("selectend",s),this.onDestroyCallbacks.push(()=>{this.engine.xrSession&&(e.removeEventListener("select",n),e.removeEventListener("selectstart",r),e.removeEventListener("selectend",s))}),this.onViewportResize()}onSelect(e){e.inputSource.handedness==this.handedness&&this.doUpdate(!0)}onSelectStart(e){this.arTouchDown=!0,e.inputSource.handedness==this.handedness&&(this.isDown=!0)}onSelectEnd(e){this.arTouchDown=!1,e.inputSource.handedness==this.handedness&&(this.isDown=!1)}onPointerMove(e){if(!e.isPrimary)return;let n=this.engine.canvas.getBoundingClientRect(),r=this.updateMousePos(e.clientX,e.clientY,n.width,n.height);this.hoverBehaviour(r,!1)}onClick(e){let n=this.engine.canvas.getBoundingClientRect(),r=this.updateMousePos(e.clientX,e.clientY,n.width,n.height);this.hoverBehaviour(r,!0)}onPointerDown(e){if(!e.isPrimary||e.button!==0)return;let n=this.engine.canvas.getBoundingClientRect(),r=this.updateMousePos(e.clientX,e.clientY,n.width,n.height);this.isDown=!0,this.hoverBehaviour(r,!1)}onPointerUp(e){if(!e.isPrimary||e.button!==0)return;let n=this.engine.canvas.getBoundingClientRect(),r=this.updateMousePos(e.clientX,e.clientY,n.width,n.height);this.isDown=!1,this.hoverBehaviour(r,!1)}updateMousePos(e,n,r,s){let a=e/r,l=n/s;return this.direction[0]=a*2-1,this.direction[1]=-l*2+1,this.direction[2]=-1,this.updateDirection()}updateDirection(){this.object.getTranslationWorld(this.origin),y.transformMat4(this.direction,this.direction,this.projectionMatrix),y.normalize(this.direction,this.direction),y.transformQuat(this.direction,this.direction,this.object.transformWorld);let e=this.rayCastMode==0?this.engine.scene.rayCast(this.origin,this.direction,this.collisionMask):this.engine.physics.rayCast(this.origin,this.direction,this.collisionMask,this.maxDistance);return e.hitCount>0?this.cursorPos.set(e.locations[0]):this.cursorPos.fill(0),e}onDeactivate(){if(this._setCursorVisibility(!1),this.hoveringObject){let e=this.hoveringObject.getComponent(se);e&&e.onUnhover.notify(this.hoveringObject,this),this.globalTarget.onUnhover.notify(this.hoveringObject,this)}this.cursorRayObject&&this.cursorRayObject.scale([0,0,0])}onActivate(){this._setCursorVisibility(!0)}onDestroy(){for(let e of this.onDestroyCallbacks)e()}};M(it,"TypeName","cursor"),M(it,"Properties",{collisionGroup:{type:j.Int,default:1},cursorRayObject:{type:j.Object},cursorRayScalingAxis:{type:j.Enum,values:["x","y","z","none"],default:"z"},cursorObject:{type:j.Object},handedness:{type:j.Enum,values:["input component","left","right","none"],default:"input component"},rayCastMode:{type:j.Enum,values:["collision","physx"],default:"collision"},styleCursor:{type:j.Bool,default:!0}});var s_=function(t,e,n,r){var s=arguments.length,a=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(l=t[c])&&(a=(s<3?l(a):s>3?l(e,n,a):l(e,n))||a);return s>3&&a&&Object.defineProperty(e,n,a),a},st=class extends R{obj=null;start(){let e=new Float32Array(3);te.getTranslation(e,this.object.transformWorld),console.log("Debug object:",this.object.name),console.log("Other object:",this.obj?.name),console.log("	translation",e),console.log("	transformWorld",this.object.transformWorld),console.log("	transformLocal",this.object.transformLocal)}};M(st,"TypeName","debug-object");s_([or.object()],st.prototype,"obj",void 0);function a_(t,e,n,r){let s=Math.cos(e/2),a=Math.cos(n/2),l=Math.cos(r/2),c=Math.sin(e/2),h=Math.sin(n/2),d=Math.sin(r/2);t[0]=c*a*l+s*h*d,t[1]=s*h*l-c*a*d,t[2]=s*a*d-c*h*l,t[3]=s*a*l+c*h*d}var at=class extends R{start(){this.rotationX=0,this.rotationY=0,this.lastClientX=-1,this.lastClientY=-1}init(){this.deviceOrientation=[0,0,0,1],this.screenOrientation=window.innerHeight>window.innerWidth?0:90,this._origin=[0,0,0],window.addEventListener("deviceorientation",function(e){let n=e.alpha||0,r=e.beta||0,s=e.gamma||0,a=Math.PI/180;a_(this.deviceOrientation,r*a,n*a,-s*a)}.bind(this)),window.addEventListener("orientationchange",function(e){this.screenOrientation=window.orientation||0}.bind(this),!1)}update(){Module.webxr_session==null&&(this.object.getTranslationLocal(this._origin),this.object.resetTransform(),this.screenOrientation!=0&&this.object.rotateAxisAngleDeg([0,0,-1],this.screenOrientation),this.object.rotate([-Math.sqrt(.5),0,0,Math.sqrt(.5)]),this.object.rotate(this.deviceOrientation),this.object.translate(this._origin))}};M(at,"TypeName","device-orientation-look"),M(at,"Properties",{});var ot=class extends R{init(){this.lastTarget=null}start(){this.tip=this.object.getComponent("collision")}update(){let e=this.tip.queryOverlaps(),n=null;for(let r=0;r<e.length;++r){let s=e[r].object,a=s.getComponent("cursor-target");if(a){a.equals(this.lastTarget)||(a.onHover(s,this),a.onClick(s,this)),n=a;break}}if(n)this.lastTarget=n;else{this.lastTarget&&this.lastTarget.onUnhover(this.lastTarget.object,this),this.lastTarget=null;return}}};M(ot,"TypeName","finger-cursor"),M(ot,"Properties",{});var lt=class extends R{start(){this.engine.xr?this.setFixedFoveation():this.engine.onXRSessionStart.push(this.setFixedFoveation.bind(this))}setFixedFoveation(){this.engine.xr.baseLayer.fixedFoveation=this.fixedFoveation}};M(lt,"TypeName","fixed-foveation"),M(lt,"Properties",{fixedFoveation:{type:j.Float,default:.5}});var mn=new Float32Array(3),qt=new Float32Array(4);function Vt(t,e){let n=e.orientation;qt[0]=n.x,qt[1]=n.y,qt[2]=n.z,qt[3]=n.w;let r=e.position;mn[0]=r.x,mn[1]=r.y,mn[2]=r.z,t.resetTranslationRotation(),t.transformLocal.set(qt),t.translate(mn)}var Ht=["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"],ct=class extends R{init(){this.handedness=["left","right"][this.handedness]}start(){if(this.joints=[],this.session=null,this.hasPose=!1,this._childrenActive=!0,!("XRHand"in window)){console.warn("WebXR Hand Tracking not supported by this browser."),this.active=!1;return}if(this.handSkin){let n=this.handSkin.jointIds;this.joints[Ht[0]]=this.engine.wrapObject(n[0]);for(let r=0;r<n.length;++r){let s=this.engine.wrapObject(n[r]);this.joints[s.name]=s}return}for(let e=0;e<=Ht.length;++e){let n=this.engine.scene.addObject(this.object.parent),r=n.addComponent("mesh");r.mesh=this.jointMesh,r.material=this.jointMaterial,this.joints[Ht[e]]=n}}update(e){if(this.session||this.engine.xr&&this.setupVREvents(this.engine.xr.session),!!this.session){if(this.hasPose=!1,this.session&&this.session.inputSources)for(let n=0;n<=this.session.inputSources.length;++n){let r=this.session.inputSources[n];if(!r||!r.hand||r.handedness!=this.handedness)continue;if(this.hasPose=!0,r.hand.get("wrist")!==null){let l=Module.webxr_frame.getJointPose(r.hand.get("wrist"),this.engine.xr.currentReferenceSpace);l&&Vt(this.object,l.transform)}let s=new Float32Array(3),a=new Float32Array(4);C.invert(a,this.object.transformLocal),this.object.getTranslationLocal(s);for(let l=0;l<Ht.length;++l){let c=Ht[l],h=this.joints[c];if(h==null)continue;let d=null;if(r.hand.get(c)!==null&&(d=this.engine.xr.frame.getJointPose(r.hand.get(c),this.engine.xr.currentReferenceSpace)),d!==null)if(this.handSkin)h.resetTranslationRotation(),h.translate([d.transform.position.x-s[0],d.transform.position.y-s[1],d.transform.position.z-s[2]]),h.rotate(a),h.rotateObject([d.transform.orientation.x,d.transform.orientation.y,d.transform.orientation.z,d.transform.orientation.w]);else{Vt(this.object,p.transform);let i=d.radius||.007;h.scale([i,i,i])}else this.handSkin||h.scale([0,0,0])}}!this.hasPose&&this._childrenActive?(this._childrenActive=!1,this.deactivateChildrenWithoutPose&&this.setChildrenActive(!1),this.controllerToDeactivate&&(this.controllerToDeactivate.active=!0,this.setChildrenActive(!0,this.controllerToDeactivate))):this.hasPose&&!this._childrenActive&&(this._childrenActive=!0,this.deactivateChildrenWithoutPose&&this.setChildrenActive(!0),this.controllerToDeactivate&&(this.controllerToDeactivate.active=!1,this.setChildrenActive(!1,this.controllerToDeactivate)))}}setChildrenActive(e,n){n=n||this.object;let r=n.children;for(let s of r)s.active=e,this.setChildrenActive(e,s)}isGrabbing(){let e=[0,0,0];te.getTranslation(e,this.joints["index-finger-tip"].transformLocal);let n=[0,0,0];return te.getTranslation(n,this.joints["thumb-tip"].transformLocal),y.sqrDist(n,e)<.001}setupVREvents(e){this.session=e}};M(ct,"TypeName","hand-tracking"),M(ct,"Properties",{handedness:{type:j.Enum,default:"left",values:["left","right"]},jointMesh:{type:j.Mesh,default:null},jointMaterial:{type:j.Material,default:null},handSkin:{type:j.Skin,default:null},deactivateChildrenWithoutPose:{type:j.Bool,default:!0},controllerToDeactivate:{type:j.Object}});var _t=class extends R{tempScaling=new Float32Array(3);visible=!1;xrHitTestSource=null;start(){this.engine.onXRSessionStart.add(this.xrSessionStart.bind(this)),this.engine.onXRSessionEnd.add(this.xrSessionEnd.bind(this)),this.tempScaling.set(this.object.scalingLocal),this.object.scale([0,0,0])}update(){let e=this.visible;if(this.xrHitTestSource){let n=this.engine.xrFrame;if(!n)return;let r=n.getHitTestResults(this.xrHitTestSource);if(r.length>0){let s=r[0].getPose(this.engine.xr.referenceSpaceForType("viewer"));this.visible=!!s,s&&Vt(this.object,s.transform)}else this.visible=!1}this.visible!=e&&(this.visible?(this.object.scalingLocal.set(this.tempScaling),this.object.setDirty()):(this.tempScaling.set(this.object.scalingLocal),this.object.scale([0,0,0])))}getHitTestResults(){return this.engine.xr?.frame?this.xrHitTestSource?this.engine.xr.frame.getHitTestResults(this.xrHitTestSource):[]:[]}xrSessionStart(e){if(e.requestHitTestSource===void 0){console.error("hit-test-location: hit test feature not available. Deactivating component."),this.active=!1;return}let n=this.engine.xr.referenceSpaceForType("viewer");e.requestHitTestSource({space:n}).then(r=>{this.xrHitTestSource=r}).catch(console.error)}xrSessionEnd(){this.xrHitTestSource&&(this.xrHitTestSource.cancel(),this.xrHitTestSource=null)}};M(_t,"TypeName","hit-test-location"),M(_t,"Properties",{});var Mf=Ze(wr(),1);var ht=class extends R{init(){this.origin=new Float32Array(3),this.fwd=new Float32Array(3),this.up=new Float32Array(3)}update(){this.spatial&&(this.object.getTranslationWorld(this.origin),this.object.getForward(this.fwd),this.object.getUp(this.up),Howler.pos(this.origin[0],this.origin[1],this.origin[2]),Howler.orientation(this.fwd[0],this.fwd[1],this.fwd[2],this.up[0],this.up[1],this.up[2]))}};M(ht,"TypeName","howler-audio-listener"),M(ht,"Properties",{spatial:{type:j.Bool,default:!0}});var Ki=Ze(wr(),1);var pt=class extends R{start(){this.audio=new Ki.Howl({src:[this.src],loop:this.loop,volume:this.volume,autoplay:this.autoplay}),this.lastPlayedAudioId=null,this.origin=new Float32Array(3),this.lastOrigin=new Float32Array(3),this.spatial&&this.autoplay&&(this.updatePosition(),this.play())}update(){!this.spatial||!this.lastPlayedAudioId||(this.object.getTranslationWorld(this.origin),(Math.abs(this.lastOrigin[0]-this.origin[0])>.005||Math.abs(this.lastOrigin[1]-this.origin[1])>.005||Math.abs(this.lastOrigin[2]-this.origin[2])>.005)&&this.updatePosition())}updatePosition(){this.audio.pos(this.origin[0],this.origin[1],this.origin[2],this.lastPlayedAudioId),this.lastOrigin.set(this.origin)}play(){this.lastPlayedAudioId&&this.audio.stop(this.lastPlayedAudioId),this.lastPlayedAudioId=this.audio.play(),this.spatial&&this.updatePosition()}stop(){this.lastPlayedAudioId&&(this.audio.stop(this.lastPlayedAudioId),this.lastPlayedAudioId=null)}onDeactivate(){this.stop()}};M(pt,"TypeName","howler-audio-source"),M(pt,"Properties",{volume:{type:j.Float,default:1},spatial:{type:j.Bool,default:!0},loop:{type:j.Bool,default:!1},autoplay:{type:j.Bool,default:!1},src:{type:j.String,default:""}});var dt=class extends R{start(){if(!this.material)throw Error("image-texture: material property not set");this.engine.textures.load(this.url,"anonymous").then(e=>{let n=this.material,r=n.shader;r==="Flat Opaque Textured"?n.flatTexture=e:r==="Phong Opaque Textured"||r==="Foliage"?n.diffuseTexture=e:r==="Background"?n.texture=e:r==="Physical Opaque Textured"?n.albedoTexture=e:console.error("Shader",r,"not supported by image-texture")}).catch(console.err)}};M(dt,"TypeName","image-texture"),M(dt,"Properties",{url:{type:j.String},material:{type:j.Material}});var mt=class extends R{init(){this.currentRotationY=0,this.currentRotationX=0,this.origin=new Float32Array(3),this.parentOrigin=new Float32Array(3),this.rotationX=0,this.rotationY=0}start(){document.addEventListener("mousemove",n=>{if(this.active&&(this.mouseDown||!this.requireMouseDown)){this.rotationY=-this.sensitity*n.movementX/100,this.rotationX=-this.sensitity*n.movementY/100,this.currentRotationX+=this.rotationX,this.currentRotationY+=this.rotationY,this.currentRotationX=Math.min(1.507,this.currentRotationX),this.currentRotationX=Math.max(-1.507,this.currentRotationX),this.object.getTranslationWorld(this.origin);let r=this.object.parent;r!==null&&(r.getTranslationWorld(this.parentOrigin),y.sub(this.origin,this.origin,this.parentOrigin)),this.object.resetTranslationRotation(),this.object.rotateAxisAngleRad([1,0,0],this.currentRotationX),this.object.rotateAxisAngleRad([0,1,0],this.currentRotationY),this.object.translate(this.origin)}});let e=this.engine.canvas;this.pointerLockOnClick&&e.addEventListener("mousedown",()=>{e.requestPointerLock=e.requestPointerLock||e.mozRequestPointerLock||e.webkitRequestPointerLock,e.requestPointerLock()}),this.requireMouseDown&&(this.mouseButtonIndex==2&&e.addEventListener("contextmenu",n=>{n.preventDefault()},!1),e.addEventListener("mousedown",n=>{if(n.button==this.mouseButtonIndex&&(this.mouseDown=!0,document.body.style.cursor="grabbing",n.button==1))return n.preventDefault(),!1}),e.addEventListener("mouseup",n=>{n.button==this.mouseButtonIndex&&(this.mouseDown=!1,document.body.style.cursor="initial")}))}};M(mt,"TypeName","mouse-look"),M(mt,"Properties",{sensitity:{type:j.Float,default:.25},requireMouseDown:{type:j.Bool,default:!0},mouseButtonIndex:{type:j.Int},pointerLockOnClick:{type:j.Bool,default:!1}});var ft=class extends R{start(){this.object.resetTranslationRotation(),this.object.translate([0,this.height,0]),this.onSessionStartCallback=this.onXRSessionStart.bind(this),this.onSessionEndCallback=this.onXRSessionEnd.bind(this)}onActivate(){this.engine.onXRSessionStart.add(this.onSessionStartCallback),this.engine.onXRSessionEnd.add(this.onSessionStartCallback)}onDeactivate(){this.engine.onXRSessionStart.remove(this.onSessionEndCallback),this.engine.onXRSessionEnd.remove(this.onSessionEndCallback)}onXRSessionStart(){["local","viewer"].includes(this.engine.xr.currentReferenceSpace)||this.object.resetTranslationRotation()}onXRSessionEnd(){["local","viewer"].includes(this.engine.xr.currentReferenceSpace)||(this.object.resetTranslationRotation(),this.object.translate([0,this.height,0]))}};M(ft,"TypeName","player-height"),M(ft,"Properties",{height:{type:j.Float,default:1.75}});var ut=class extends R{start(){this.engine.xrSession?this.setTargetFramerate(this.engine.xrSession):this.engine.onXRSessionStart.push(this.setTargetFramerate.bind(this))}setTargetFramerate(e){if(e.supportedFrameRates&&e.updateTargetFrameRate){let n=this.engine.xrSession.supportedFrameRates;n.sort((r,s)=>Math.abs(r-this.framerate)-Math.abs(s-this.framerate)),this.engine.xrSession.updateTargetFrameRate(n[0])}}};M(ut,"TypeName","target-framerate"),M(ut,"Properties",{framerate:{type:j.Float,default:90}});var gt=class extends R{init(){if(this._prevThumbstickAxis=new Float32Array(2),this._tempVec=new Float32Array(3),this._tempVec0=new Float32Array(3),this._currentIndicatorRotation=0,this.input=this.object.getComponent("input"),!this.input){console.error(this.object.name,"generic-teleport-component.js: input component is required on the object");return}if(!this.teleportIndicatorMeshObject){console.error(this.object.name,"generic-teleport-component.js: Teleport indicator mesh is missing");return}if(!this.camRoot){console.error(this.object.name,"generic-teleport-component.js: camRoot not set");return}this.isIndicating=!1,this.indicatorHidden=!0,this.hitSpot=new Float32Array(3),this._hasHit=!1,this._extraRotation=0,this._currentStickAxes=new Float32Array(2)}start(){if(this.cam&&(this.isMouseIndicating=!1,canvas.addEventListener("mousedown",this.onMouseDown.bind(this)),canvas.addEventListener("mouseup",this.onMouseUp.bind(this))),this.handedness==0){let e=this.object.getComponent("input");e?(this.handedness=e.handedness,this.input=e):console.warn("teleport component on object",this.object.name,'was configured with handedness "input component", but object has no input component.')}else this.handedness=["left","right"][this.handedness-1];this.engine.onXRSessionStart.push(this.setupVREvents.bind(this)),this.teleportIndicatorMeshObject.active=!1}_getCamRotation(){return this.eyeLeft.getForward(this._tempVec),this._tempVec[1]=0,y.normalize(this._tempVec,this._tempVec),Math.atan2(this._tempVec[0],this._tempVec[2])}update(){let e=0;if(this.gamepad&&this.gamepad.axes&&(this._currentStickAxes[0]=this.gamepad.axes[2],this._currentStickAxes[1]=this.gamepad.axes[3],e=Math.abs(this._currentStickAxes[0])+Math.abs(this._currentStickAxes[1])),!this.isIndicating&&this._prevThumbstickAxis[1]>=this.thumbstickActivationThreshhold&&this._currentStickAxes[1]<this.thumbstickActivationThreshhold?this.isIndicating=!0:this.isIndicating&&e<this.thumbstickDeactivationThreshhold&&(this.isIndicating=!1,this.teleportIndicatorMeshObject.active=!1,this._hasHit&&this._teleportPlayer(this.hitSpot,this._extraRotation)),this.isIndicating&&this.teleportIndicatorMeshObject&&this.input){let n=this._tempVec0;te.getTranslation(n,this.object.transformWorld);let r=this.object.getForward(this._tempVec),s=this.rayHit=this.rayCastMode==0?this.engine.scene.rayCast(n,r,1<<this.floorGroup):this.engine.physics.rayCast(n,r,1<<this.floorGroup,this.maxDistance);s.hitCount>0?(this.indicatorHidden=!1,this._extraRotation=Math.PI+Math.atan2(this._currentStickAxes[0],this._currentStickAxes[1]),this._currentIndicatorRotation=this._getCamRotation()+(this._extraRotation-Math.PI),this.teleportIndicatorMeshObject.resetTranslationRotation(),this.teleportIndicatorMeshObject.rotateAxisAngleRad([0,1,0],this._currentIndicatorRotation),this.teleportIndicatorMeshObject.translate(s.locations[0]),this.teleportIndicatorMeshObject.translate([0,this.indicatorYOffset,0]),this.teleportIndicatorMeshObject.active=!0,this.hitSpot.set(s.locations[0]),this._hasHit=!0):(this.indicatorHidden||(this.teleportIndicatorMeshObject.active=!1,this.indicatorHidden=!0),this._hasHit=!1)}else this.teleportIndicatorMeshObject&&this.isMouseIndicating&&this.onMousePressed();this._prevThumbstickAxis.set(this._currentStickAxes)}setupVREvents(e){if(this.session=e,e.addEventListener("end",function(){this.gamepad=null,this.session=null}.bind(this)),e.inputSources&&e.inputSources.length)for(let n=0;n<e.inputSources.length;n++){let r=e.inputSources[n];r.handedness==this.handedness&&(this.gamepad=r.gamepad)}e.addEventListener("inputsourceschange",function(n){if(n.added&&n.added.length)for(let r=0;r<n.added.length;r++){let s=n.added[r];s.handedness==this.handedness&&(this.gamepad=s.gamepad)}}.bind(this))}onMouseDown(){this.isMouseIndicating=!0}onMouseUp(){this.isMouseIndicating=!1,this.teleportIndicatorMeshObject.active=!1,this._hasHit&&this._teleportPlayer(this.hitSpot,0)}onMousePressed(){let e=[0,0,0];te.getTranslation(e,this.cam.transformWorld);let n=this.cam.getForward(this._tempVec),r=this.rayHit=this.rayCastMode==0?this.engine.scene.rayCast(e,n,1<<this.floorGroup):this.engine.physics.rayCast(e,n,1<<this.floorGroup,this.maxDistance);r.hitCount>0?(this.indicatorHidden=!1,n[1]=0,y.normalize(n,n),this._currentIndicatorRotation=-Math.sign(n[2])*Math.acos(n[0])-Math.PI*.5,this.teleportIndicatorMeshObject.resetTranslationRotation(),this.teleportIndicatorMeshObject.rotateAxisAngleRad([0,1,0],this._currentIndicatorRotation),this.teleportIndicatorMeshObject.translate(r.locations[0]),this.teleportIndicatorMeshObject.active=!0,this.hitSpot=r.locations[0],this._hasHit=!0):(this.indicatorHidden||(this.teleportIndicatorMeshObject.active=!1,this.indicatorHidden=!0),this._hasHit=!1)}_teleportPlayer(e,n){this.camRoot.rotateAxisAngleRad([0,1,0],n);let r=this._tempVec,s=this._tempVec0;this.session?(this.eyeLeft.getTranslationWorld(r),this.eyeRight.getTranslationWorld(s),y.add(r,r,s),y.scale(r,r,.5)):this.cam.getTranslationWorld(r),this.camRoot.getTranslationWorld(s),y.sub(r,s,r),r[0]+=e[0],r[1]=e[1],r[2]+=e[2],this.camRoot.setTranslationWorld(r)}};M(gt,"TypeName","teleport"),M(gt,"Properties",{teleportIndicatorMeshObject:{type:j.Object},camRoot:{type:j.Object},cam:{type:j.Object},eyeLeft:{type:j.Object},eyeRight:{type:j.Object},handedness:{type:j.Enum,values:["input component","left","right","none"],default:"input component"},floorGroup:{type:j.Int,default:1},thumbstickActivationThreshhold:{type:j.Float,default:-.7},thumbstickDeactivationThreshhold:{type:j.Float,default:.3},indicatorYOffset:{type:j.Float,default:.01},rayCastMode:{type:j.Enum,values:["collision","physx"],default:"collision"},maxDistance:{type:j.Float,default:100}});var un=y.create(),le=y.create(),Bt=y.create(),wt=class extends R{init(){this.points=new Array(this.segments+1);for(let e=0;e<this.points.length;++e)this.points[e]=y.create();this.currentPointOffset=0,this.up=[0,1,0],this.timeTillNext=this.interval}start(){this.trailContainer=this.engine.scene.addObject(),this.meshComp=this.trailContainer.addComponent("mesh"),this.meshComp.material=this.material;let e=2*this.points.length;this.indexData=new Uint32Array(6*this.segments);for(let n=0,r=0;n<e-2;n+=2,r+=6)this.indexData.subarray(r,r+6).set([n+1,n+0,n+2,n+2,n+3,n+1]);this.mesh=new tt(this.engine,{vertexCount:e,indexData:this.indexData,indexType:me.UnsignedInt}),this.meshComp.mesh=this.mesh}updateVertices(){let e=this.mesh.attribute(Ve.Position),n=this.mesh.attribute(Ve.TextureCoordinate),r=this.mesh.attribute(Ve.Normal);y.set(un,0,0,0);for(let s=0;s<this.points.length;++s){let a=this.points[(this.currentPointIndex+s+1)%this.points.length],l=this.points[(this.currentPointIndex+s+2)%this.points.length];s!==this.points.length-1&&y.sub(un,l,a),y.cross(le,this.up,un),y.normalize(le,le);let c=1-this.timeTillNext/this.interval,h=(s-c)/this.segments;y.scale(le,le,(this.taper?h:1)*this.width/2),e.set(s*2,[a[0]-le[0],a[1]-le[1],a[2]-le[2]]),e.set(s*2+1,[a[0]+le[0],a[1]+le[1],a[2]+le[2]]),r&&(y.cross(Bt,un,le),y.normalize(Bt,Bt),r.set(s*2,Bt),r.set(s*2+1,Bt)),n&&(n.set(s*2,[0,h]),n.set(s*2+1,[1,h]))}this.mesh.update()}resetTrail(){this.object.getTranslationWorld(this.points[0]);for(let e=1;e<this.points.length;++e)y.copy(this.points[e],this.points[0]);this.currentPointIndex=0,this.timeTillNext=this.interval}update(e){this.timeTillNext-=e,e>this.resetThreshold&&this.resetTrail(),this.timeTillNext<0&&(this.currentPointIndex=(this.currentPointIndex+1)%this.points.length,this.timeTillNext=this.timeTillNext%this.interval+this.interval),this.object.getTranslationWorld(this.points[this.currentPointIndex]),this.updateVertices()}onActivate(){this.resetTrail()}onDestroy(){this.trailContainer.destroy(),this.mesh.destroy()}};M(wt,"TypeName","trail"),M(wt,"Properties",{material:{type:j.Material},segments:{type:j.Int,default:50},interval:{type:j.Float,default:.1},width:{type:j.Float,default:1},taper:{type:j.Bool,default:!0},resetThreshold:{type:j.Float,default:.5}});Math.clamp=function(t,e,n){return Math.max(e,Math.min(t,n))};var o_=function(){let t=new Float32Array(3),e=new Float32Array(3),n=new Float32Array(3),r=new Float32Array(3),s=new Float32Array(3),a=new Float32Array(3),l=new Float32Array(3),c=new Float32Array(4),h=new Float32Array(4),d=new Float32Array(4),i=new Float32Array(4);return function(o,_,m,u,g,f,w,v,x,T){y.sub(n,u,m);let A=y.length(n);y.sub(t,u,g);let S=y.length(t);y.sub(t,f,m);let F=Math.clamp(y.length(t),w,A+S-w);y.sub(e,g,m),y.sub(r,m,u),y.sub(s,g,u),y.normalize(e,e),y.normalize(n,n),y.normalize(r,r),y.normalize(s,s),y.normalize(t,t);let E=Math.acos(Math.clamp(y.dot(e,n),-1,1)),D=Math.acos(Math.clamp(y.dot(r,s),-1,1)),z=Math.acos(Math.clamp(y.dot(e,t),-1,1)),V=Math.acos(Math.clamp((S*S-A*A-F*F)/(-2*A*F),-1,1)),U=Math.acos(Math.clamp((F*F-A*A-S*S)/(-2*A*S),-1,1));y.sub(e,g,m),y.sub(n,u,m),y.sub(t,f,m),y.cross(a,e,n),y.cross(l,e,t),T?(y.sub(n,T,u),y.transformQuat(n,[0,0,-1],x)):y.sub(n,u,m);let L=y.length(a);L==0?a.set([1,0,0]):y.scale(a,a,1/L),y.normalize(l,l),C.conjugate(v,v),C.setAxisAngle(h,y.transformQuat(c,a,v),V-E),C.setAxisAngle(i,y.transformQuat(c,l,v),z),C.mul(o,o,C.mul(c,h,i)),C.normalize(o,o),C.conjugate(x,x),C.setAxisAngle(d,y.transformQuat(c,a,x),U-D),C.mul(_,_,d),C.normalize(_,_)}}(),vt=class extends R{init(){this.pos=new Float32Array(3*7),this.p=[this.pos.subarray(0,3),this.pos.subarray(3,6),this.pos.subarray(6,9),this.pos.subarray(9,12),this.pos.subarray(12,15),this.pos.subarray(15,18),this.pos.subarray(18,21)]}update(){let e=this.p;this.root.getTranslationWorld(e[0]),this.middle.getTranslationWorld(e[1]),this.end.getTranslationWorld(e[2]),this.target.getTranslationWorld(e[3]);let n=e[4],r=e[5];this.root.getTranslationLocal(n),this.middle.getTranslationLocal(r),this.helper&&this.helper.getTranslationWorld(e[6]),o_(this.root.transformLocal,this.middle.transformLocal,e[0],e[1],e[2],e[3],.01,this.root.transformWorld.subarray(0,4),this.middle.transformWorld.subarray(0,4),this.helper?e[6]:null),this.root.setTranslationLocal(n),this.middle.setTranslationLocal(r),this.root.setDirty(),this.middle.setDirty()}};M(vt,"TypeName","two-joint-ik-solver"),M(vt,"Properties",{root:{type:j.Object},middle:{type:j.Object},end:{type:j.Object},target:{type:j.Object},helper:{type:j.Object}});var xt=class extends R{init(){if(!this.material)throw Error("video-texture: material property not set");this.loaded=!1,this.frameUpdateRequested=!0}start(){if(this.video=document.createElement("video"),this.video.src=this.url,this.video.crossOrigin="anonymous",this.video.playsInline=!0,this.video.loop=this.loop,this.video.muted=this.muted,this.video.addEventListener("playing",()=>{this.loaded=!0}),this.autoplay){let e=()=>{this.video.play(),window.removeEventListener("click",e),window.removeEventListener("touchstart",e)};window.addEventListener("click",e),window.addEventListener("touchstart",e)}}applyTexture(){let e=this.material,n=e.shader,r=this.texture=new He(this.engine,this.video);n==="Flat Opaque Textured"?e.flatTexture=r:n==="Phong Opaque Textured"||n==="Foliage"?e.diffuseTexture=r:n==="Background"?e.texture=r:n==="Physical Opaque Textured"?e.albedoTexture=r:console.error("Shader",n,"not supported by video-texture"),"requestVideoFrameCallback"in this.video?this.video.requestVideoFrameCallback(this.updateVideo.bind(this)):this.video.addEventListener("timeupdate",()=>{this.frameUpdateRequested=!0})}update(e){this.loaded&&this.frameUpdateRequested&&(this.texture?this.texture.update():this.applyTexture(),this.frameUpdateRequested=!1)}updateVideo(){this.frameUpdateRequested=!0,this.video.requestVideoFrameCallback(this.updateVideo.bind(this))}};M(xt,"TypeName","video-texture"),M(xt,"Properties",{url:{type:j.String},material:{type:j.Material},loop:{type:j.Bool,default:!0},autoplay:{type:j.Bool,default:!0},muted:{type:j.Bool,default:!0}});var yt=class extends R{start(){this.components=[],this.getComponents(this.object),this.onXRSessionEnd(),this.engine.onXRSessionStart.push(this.onXRSessionStart.bind(this)),this.engine.onXRSessionEnd.push(this.onXRSessionEnd.bind(this))}getComponents(e){let n=e.getComponents().filter(r=>r.type!=="vr-mode-active-switch");if(this.components=this.components.concat(n),this.affectChildren){let r=e.children;for(let s=0;s<r.length;++s)this.getComponents(r[s])}}setComponentsActive(e){let n=this.components;for(let r=0;r<n.length;++r)n[r].active=e}onXRSessionStart(){this.active&&this.setComponentsActive(this.activateComponents==0)}onXRSessionEnd(){this.active&&this.setComponentsActive(this.activateComponents!=0)}};M(yt,"TypeName","vr-mode-active-switch"),M(yt,"Properties",{activateComponents:{type:j.Enum,values:["in VR","in non-VR"],default:"in VR"},affectChildren:{type:j.Bool,default:!0}});var l_={X:[1,0,0],Y:[0,1,0],Z:[0,0,1]},c_={PositiveX:[1,0,0],NegativeX:[-1,0,0],PositiveY:[0,1,0],NegativeY:[0,-1,0],PositiveZ:[0,0,1],NegativeZ:[0,0,-1]},bt=class extends R{meta=null;bones={hips:null,spine:null,chest:null,upperChest:null,neck:null,head:null,leftEye:null,rightEye:null,jaw:null,leftUpperLeg:null,leftLowerLeg:null,leftFoot:null,leftToes:null,rightUpperLeg:null,rightLowerLeg:null,rightFoot:null,rightToes:null,leftShoulder:null,leftUpperArm:null,leftLowerArm:null,leftHand:null,rightShoulder:null,rightUpperArm:null,rightLowerArm:null,rightHand:null,leftThumbMetacarpal:null,leftThumbProximal:null,leftThumbDistal:null,leftIndexProximal:null,leftIndexIntermediate:null,leftIndexDistal:null,leftMiddleProximal:null,leftMiddleIntermediate:null,leftMiddleDistal:null,leftRingProximal:null,leftRingIntermediate:null,leftRingDistal:null,leftLittleProximal:null,leftLittleIntermediate:null,leftLittleDistal:null,rightThumbMetacarpal:null,rightThumbProximal:null,rightThumbDistal:null,rightIndexProximal:null,rightIndexIntermediate:null,rightIndexDistal:null,rightMiddleProximal:null,rightMiddleIntermediate:null,rightMiddleDistal:null,rightRingProximal:null,rightRingIntermediate:null,rightRingDistal:null,rightLittleProximal:null,rightLittleIntermediate:null,rightLittleDistal:null};restPose={};_nodeConstraints=[];_springChains=[];_sphereColliders=[];_capsuleColliders=[];_firstPersonAnnotations=[];_lookAt=null;_initialized=!1;init(){this._tempV3=y.create(),this._tempV3A=y.create(),this._tempV3B=y.create(),this._tempQuat=C.create(),this._tempQuatA=C.create(),this._tempQuatB=C.create(),this._tempMat4A=Re.create(),this._tempQuat2=te.create(),this._tailToShape=y.create(),this._headToTail=y.create(),this._inertia=y.create(),this._stiffness=y.create(),this._external=y.create(),this._rightVector=y.set(y.create(),1,0,0),this._upVector=y.set(y.create(),0,1,0),this._forwardVector=y.set(y.create(),0,0,1),this._identityQuat=C.identity(C.create()),this._rad2deg=180/Math.PI}start(){if(!this.src){console.error("vrm: src property not set");return}this.engine.scene.append(this.src,{loadGltfExtensions:!0}).then(({root:e,extensions:n})=>{e.children.forEach(r=>r.parent=this.object),this._initializeVrm(n),e.destroy()})}_initializeVrm(e){if(this._initialized)throw Error("VRM component has already been initialized");let n=e.root.VRMC_vrm;if(!n)throw Error("Missing VRM extensions");if(n.specVersion!=="1.0")throw Error(`Unsupported VRM version, only 1.0 is supported, but encountered '${n.specVersion}'`);this.meta=n.meta,this._parseHumanoid(n.humanoid,e),n.firstPerson&&this._parseFirstPerson(n.firstPerson,e),n.lookAt&&this._parseLookAt(n.lookAt),this._findAndParseNodeConstraints(e);let r=e.root.VRMC_springBone;r&&this._parseAndInitializeSpringBones(r,e),this._initialized=!0}_parseHumanoid(e,n){for(let r in e.humanBones){if(!(r in this.bones)){console.warn(`Unrecognized bone '${r}'`);continue}let s=e.humanBones[r].node,a=n.idMapping[s];this.bones[r]=this.engine.wrapObject(a),this.restPose[r]=C.copy(C.create(),this.bones[r].rotationLocal)}}_parseFirstPerson(e,n){for(let r of e.meshAnnotations){let s={node:this.engine.wrapObject(n.idMapping[r.node]),firstPerson:!0,thirdPerson:!0};switch(r.type){case"firstPersonOnly":s.thirdPerson=!1;break;case"thirdPersonOnly":s.firstPerson=!1;break;case"both":break;case"auto":console.warn("First person mesh annotation type 'auto' is not supported, treating as 'both'!");break;default:console.error(`Invalid mesh annotation type '${r.type}'`);break}this._firstPersonAnnotations.push(s)}}_parseLookAt(e){if(e.type!=="bone"){console.warn(`Unsupported lookAt type '${e.type}', only 'bone' is supported`);return}let n=r=>({inputMaxValue:r.inputMaxValue,outputScale:r.outputScale});this._lookAt={offsetFromHeadBone:e.offsetFromHeadBone||[0,0,0],horizontalInner:n(e.rangeMapHorizontalInner),horizontalOuter:n(e.rangeMapHorizontalOuter),verticalDown:n(e.rangeMapVerticalDown),verticalUp:n(e.rangeMapVerticalUp)}}_findAndParseNodeConstraints(e){let n=r=>{let s=e.node[r.objectId];if(s&&"VRMC_node_constraint"in s){let l=s.VRMC_node_constraint.constraint,c,h;if("roll"in l?(c="roll",h=l_[l.roll.rollAxis]):"aim"in l?(c="aim",h=c_[l.aim.aimAxis]):"rotation"in l&&(c="rotation"),c){let d=this.engine.wrapObject(e.idMapping[l[c].source]);this._nodeConstraints.push({type:c,source:d,destination:r,axis:h,weight:l[c].weight,destinationRestLocalRotation:C.copy(C.create(),r.rotationLocal),sourceRestLocalRotation:C.copy(C.create(),d.rotationLocal),sourceRestLocalRotationInv:C.invert(C.create(),d.rotationLocal)})}else console.warn("Unrecognized or invalid VRMC_node_constraint, ignoring it")}for(let a of r.children)n(a)};n(this.object)}_parseAndInitializeSpringBones(e,n){let r=(e.colliders||[]).map((a,l)=>{let c="capsule"in a.shape?"capsule":"sphere";return{id:l,object:this.engine.wrapObject(n.idMapping[a.node]),shape:{isCapsule:c==="capsule",radius:a.shape[c].radius,offset:a.shape[c].offset,tail:a.shape[c].tail},cache:{head:y.create(),tail:y.create()}}});this._sphereColliders=r.filter(a=>!a.shape.isCapsule),this._capsuleColliders=r.filter(a=>a.shape.isCapsule);let s=(e.colliderGroups||[]).map(a=>({name:a.name,colliders:a.colliders.map(l=>r[l])}));for(let a of e.springs){let l=[];for(let h of a.joints){let d={hitRadius:0,stiffness:1,gravityPower:0,gravityDir:[0,-1,0],dragForce:.5,node:null,state:null};Object.assign(d,h),d.node=this.engine.wrapObject(n.idMapping[d.node]),l.push(d)}let c=(a.colliderGroups||[]).flatMap(h=>s[h].colliders);this._springChains.push({name:a.name,center:a.center?this.engine.wrapObject(n.idMapping[a.center]):null,joints:l,sphereColliders:c.filter(h=>!h.shape.isCapsule),capsuleColliders:c.filter(h=>h.shape.isCapsule)})}for(let a of this._springChains)for(let l=0;l<a.joints.length-1;++l){let c=a.joints[l],h=a.joints[l+1],d=c.node.getTranslationWorld(y.create()),i=h.node.getTranslationWorld(y.create()),o=y.subtract(this._tempV3A,d,i),_={prevTail:i,currentTail:y.copy(y.create(),i),initialLocalRotation:C.copy(C.create(),c.node.rotationLocal),initialLocalTransformInvert:te.invert(te.create(),c.node.transformLocal),boneAxis:y.normalize(y.create(),h.node.getTranslationLocal(this._tempV3)),boneLength:Math.max(.01,y.length(o)),prevTailCenter:null,currentTailCenter:null};a.center&&(_.prevTailCenter=a.center.transformPointInverseWorld(y.create(),i),_.currentTailCenter=y.copy(y.create(),i)),c.state=_}}update(e){this._initialized&&(this._resolveLookAt(),this._resolveConstraints(),this._updateSpringBones(e))}_rangeMap(e,n){let r=e.inputMaxValue,s=e.outputScale;return Math.min(n,r)/r*s}_resolveLookAt(){if(!this._lookAt||!this.lookAtTarget)return;let e=this.bones.head.transformPointWorld(this._tempV3A,this._lookAt.offsetFromHeadBone),n=this.lookAtTarget.getTranslationWorld(this._tempV3B),r=y.sub(this._tempV3A,n,e);y.normalize(r,r),this.bones.head.parent.transformVectorInverseWorld(r);let s=y.dot(r,this._forwardVector),a=y.dot(r,this._rightVector),l=Math.atan2(a,s)*this._rad2deg,c=Math.sqrt(a*a+s*s),h=y.dot(r,this._upVector),d=Math.atan2(-h,c)*this._rad2deg;if(d>0?d=this._rangeMap(this._lookAt.verticalDown,d):d=-this._rangeMap(this._lookAt.verticalUp,-d),this.bones.leftEye){let i=l;i>0?i=this._rangeMap(this._lookAt.horizontalInner,i):i=-this._rangeMap(this._lookAt.horizontalOuter,-i);let o=C.fromEuler(this._tempQuatA,d,i,0);this.bones.leftEye.rotationLocal=C.multiply(o,this.restPose.leftEye,o)}if(this.bones.rightEye){let i=l;i>0?i=this._rangeMap(this._lookAt.horizontalOuter,i):i=-this._rangeMap(this._lookAt.horizontalInner,-i);let o=C.fromEuler(this._tempQuatA,d,i,0);this.bones.rightEye.rotationLocal=C.multiply(o,this.restPose.rightEye,o)}}_resolveConstraints(){for(let e of this._nodeConstraints)this._resolveConstraint(e)}_resolveConstraint(e){let n=e.destinationRestLocalRotation,r=e.sourceRestLocalRotationInv,s=C.identity(this._tempQuatA);switch(e.type){case"roll":{let a=C.multiply(this._tempQuatA,r,e.source.rotationLocal),l=C.multiply(this._tempQuatA,e.sourceRestLocalRotation,a);C.mul(l,l,r);let c=C.invert(this._tempQuatB,n),h=C.multiply(this._tempQuatB,c,l);C.multiply(h,h,n);let d=y.transformQuat(this._tempV3A,e.axis,h),i=C.rotationTo(this._tempQuatA,e.axis,d);C.mul(s,n,C.invert(this._tempQuat,i)),C.mul(s,s,h)}break;case"aim":{let a=e.destination.parent.rotationWorld,l=y.transformQuat(this._tempV3A,e.axis,n);y.transformQuat(l,l,a);let c=e.source.getTranslationWorld(this._tempV3B);y.sub(c,c,e.destination.getTranslationWorld(this._tempV3)),y.normalize(c,c);let h=C.rotationTo(this._tempQuatA,l,c);C.mul(s,C.invert(this._tempQuat,a),h),C.mul(s,s,a),C.mul(s,s,n)}break;case"rotation":{let a=C.mul(s,r,e.source.rotationLocal);C.mul(s,n,a)}break}C.slerp(s,n,s,e.weight),e.destination.rotationLocal=s}_updateSpringBones(e){this._sphereColliders.forEach(({object:n,shape:r,cache:s})=>{let a=y.copy(s.head,r.offset);n.transformVectorWorld(a),y.add(s.head,n.getTranslationWorld(this._tempV3),a)}),this._capsuleColliders.forEach(({object:n,shape:r,cache:s})=>{let a=n.getTranslationWorld(this._tempV3A),l=y.copy(s.head,r.offset);n.transformVectorWorld(l),y.add(s.head,a,l);let c=y.copy(s.tail,r.tail);n.transformVectorWorld(c),y.add(s.tail,a,c)}),this._springChains.forEach(n=>{for(let r=0;r<n.joints.length-1;++r){let s=n.joints[r],a=s.node.parent?s.node.parent.rotationWorld:this._identityQuat,l=this._inertia;n.center?(y.sub(l,s.state.currentTailCenter,s.state.prevTailCenter),n.center.transformVectorWorld(l)):y.sub(l,s.state.currentTail,s.state.prevTail),y.scale(l,l,1-s.dragForce);let c=y.copy(this._stiffness,s.state.boneAxis);y.transformQuat(c,c,s.state.initialLocalRotation),y.transformQuat(c,c,a),y.scale(c,c,e*s.stiffness);let h=y.scale(this._external,s.gravityDir,e*s.gravityPower),d=y.copy(this._tempV3A,s.state.currentTail);y.add(d,d,l),y.add(d,d,c),y.add(d,d,h);let i=s.node.getTranslationWorld(this._tempV3B);y.sub(d,d,i),y.normalize(d,d),y.scaleAndAdd(d,i,d,s.state.boneLength);for(let{shape:m,cache:u}of n.sphereColliders){let g=this._tailToShape,f=u.head;g=y.sub(g,d,f);let w=m.radius+s.hitRadius,v=y.length(g)-w;v<0&&(y.normalize(g,g),y.scaleAndAdd(d,d,g,-v),y.sub(d,d,i),y.normalize(d,d),y.scaleAndAdd(d,i,d,s.state.boneLength))}for(let{shape:m,cache:u}of n.capsuleColliders){let g=this._tailToShape,f=u.head,w=u.tail;g=y.sub(g,d,f);let v=y.sub(this._headToTail,w,f),x=y.dot(v,g);y.squaredLength(v)<=x?y.sub(g,d,w):x>0&&(y.scale(v,v,x/y.squaredLength(v)),y.sub(g,g,v));let T=m.radius+s.hitRadius,A=y.length(g)-T;A<0&&(y.normalize(g,g),y.scaleAndAdd(d,d,g,-A),y.sub(d,d,i),y.normalize(d,d),y.scaleAndAdd(d,i,d,s.state.boneLength))}y.copy(s.state.prevTail,s.state.currentTail),y.copy(s.state.currentTail,d),n.center&&(y.copy(s.state.prevTailCenter,s.state.currentTailCenter),y.copy(s.state.currentTailCenter,d),n.center.transformPointInverseWorld(s.state.currentTailCenter)),s.node.parent.transformPointInverseWorld(d);let o=te.fromTranslation(this._tempQuat2,d);te.multiply(o,s.state.initialLocalTransformInvert,o),te.getTranslation(d,o),y.normalize(d,d);let _=C.rotationTo(this._tempQuatA,s.state.boneAxis,d);s.node.rotationLocal=C.mul(this._tempQuatA,s.state.initialLocalRotation,_)}})}set firstPerson(e){this._firstPersonAnnotations.forEach(n=>{let r=e==n.firstPerson||e!=n.thirdPerson;n.node.getComponents("mesh").forEach(s=>{s.active=r})})}};M(bt,"TypeName","vrm"),M(bt,"Properties",{src:{type:j.String},lookAtTarget:{type:j.Object}});var Mt=class extends R{init(){this.up=!1,this.right=!1,this.down=!1,this.left=!1,window.addEventListener("keydown",this.press.bind(this)),window.addEventListener("keyup",this.release.bind(this))}start(){this.headObject=this.headObject||this.object}update(){let e=[0,0,0];this.up&&(e[2]-=1),this.down&&(e[2]+=1),this.left&&(e[0]-=1),this.right&&(e[0]+=1),y.normalize(e,e),e[0]*=this.speed,e[2]*=this.speed,y.transformQuat(e,e,this.headObject.transformWorld),this.object.translate(e)}press(e){e.keyCode===38||e.keyCode===87||e.keyCode===90?this.up=!0:e.keyCode===39||e.keyCode===68?this.right=!0:e.keyCode===40||e.keyCode===83?this.down=!0:(e.keyCode===37||e.keyCode===65||e.keyCode===81)&&(this.left=!0)}release(e){e.keyCode===38||e.keyCode===87||e.keyCode===90?this.up=!1:e.keyCode===39||e.keyCode===68?this.right=!1:e.keyCode===40||e.keyCode===83?this.down=!1:(e.keyCode===37||e.keyCode===65||e.keyCode===81)&&(this.left=!1)}};M(Mt,"TypeName","wasd-controls"),M(Mt,"Properties",{speed:{type:j.Float,default:.1},headObject:{type:j.Object}});WL.registerComponent("expose-banners",{banner1Object:{type:WL.Type.Object},banner2Object:{type:WL.Type.Object},banner3Object:{type:WL.Type.Object},banner4Object:{type:WL.Type.Object},banner5Object:{type:WL.Type.Object},banner6Object:{type:WL.Type.Object},banner7Object:{type:WL.Type.Object},banner8Object:{type:WL.Type.Object},banner9Object:{type:WL.Type.Object}},{start:function(){this.banner1=this.banner1Object.getComponent("zesty-banner"),this.banner2=this.banner2Object.getComponent("zesty-banner"),this.banner3=this.banner3Object.getComponent("zesty-banner"),this.banner4=this.banner4Object.getComponent("zesty-banner"),this.banner5=this.banner5Object.getComponent("zesty-banner"),this.banner6=this.banner6Object.getComponent("zesty-banner"),this.banner7=this.banner7Object.getComponent("zesty-banner"),this.banner8=this.banner8Object.getComponent("zesty-banner"),this.banner9=this.banner9Object.getComponent("zesty-banner"),window.testBanners=[this.banner1,this.banner2,this.banner3,this.banner4,this.banner5,this.banner6,this.banner7,this.banner8,this.banner9]}});var Et=Ze(qr(),1);var Te="https://zesty-storage-prod.s3.amazonaws.com/images/zesty",Yt={tall:{width:.75,height:1,style:{standard:`${Te}/zesty-banner-tall.png`,minimal:`${Te}/zesty-banner-tall-minimal.png`,transparent:`${Te}/zesty-banner-tall-transparent.png`}},wide:{width:4,height:1,style:{standard:`${Te}/zesty-banner-wide.png`,minimal:`${Te}/zesty-banner-wide-minimal.png`,transparent:`${Te}/zesty-banner-wide-transparent.png`}},square:{width:1,height:1,style:{standard:`${Te}/zesty-banner-square.png`,minimal:`${Te}/zesty-banner-square-minimal.png`,transparent:`${Te}/zesty-banner-square-transparent.png`}}};var ph=Ze(qr(),1);var Vr=()=>{let t=window.XRHand!=null&&window.XRMediaBinding!=null,e=navigator.userAgent.includes("OculusBrowser"),n=t&&e?"Full":t||e?"Partial":"None";return{match:n!=="None",confidence:n}},Hr=()=>{let t=window.mozInnerScreenX!=null&&window.speechSynthesis==null,e=navigator.userAgent.includes("Mobile VR")&&!navigator.userAgent.includes("OculusBrowser"),n=t&&e?"Full":t||e?"Partial":"None";return{match:n!=="None",confidence:n}},ma=async()=>{let t=navigator.xr&&await navigator.xr.isSessionSupported("immersive-vr")&&await navigator.xr.isSessionSupported("immersive-ar"),e=navigator.userAgent.includes("Pico Neo 3 Link"),n=t&&e?"Full":t||e?"Partial":"None";return{match:n!=="None",confidence:n}},fa=()=>{let t=navigator.maxTouchPoints===0||navigator.msMaxTouchPoints===0,e=!navigator.userAgent.includes("Android")&&!navigator.userAgent.includes("Mobile"),n=t&&e?"Full":t||e?"Partial":"None";return{match:n!=="None",confidence:n}},Br=async()=>{let t={platform:"",confidence:""};return Vr().match?t={platform:"Oculus",confidence:Vr().confidence}:Hr().match?t={platform:"Wolvic",confidence:Hr().confidence}:await ma().match?t={platform:"Pico",confidence:await ma().confidence}:fa().match?t={platform:"Desktop",confidence:fa().confidence}:t={platform:"Unknown",confidence:"None"},t},ua=t=>{if(t){if(Vr().match){if(t.includes("https://www.oculus.com/experiences/quest/")){setTimeout(()=>{window.open(t,"_blank")},1e3);return}}else if(Hr().match){let e=document.createElement("div"),n=document.createElement("div"),r=document.createElement("p"),s=document.createElement("button"),a=document.createElement("button");e.style.backgroundColor="rgb(0, 0, 0, 0.75)",e.style.color="white",e.style.textAlign="center",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.padding="5%",e.style.borderRadius="5%",e.style.transform="translate(-50%, -50%)",r.innerHTML=`<b>This billboard leads to ${t}. Continue?</b>`,s.innerText="Move cursor back into window.",s.style.width="100vw",s.style.height="100vh",s.onmouseenter=()=>{s.style.width="auto",s.style.height="auto",s.innerText="Yes"},s.onclick=()=>{window.open(t,"_blank"),e.remove()},a.innerText="No",a.onclick=()=>{e.remove()},e.append(n),n.append(r),n.append(s),n.append(a),document.body.append(e);return}window.open(t,"_blank")}};var ga="https://beacon.zesty.market",wa="https://beacon2.zesty.market/zgraphql",dh="https://api.zesty.market/api";var va=async(t,e="tall",n="standard")=>{try{let r=encodeURI(window.top.location.href).replace(/\/$/,""),s=await Et.default.get(`${dh}/ad?ad_unit_id=${t}&url=${r}`);return console.log("test"),s.data}catch{return console.warn("No active campaign banner could be located. Displaying default banner."),{Ads:[{asset_url:Yt[e].style[n],cta_url:"https://www.zesty.market"}],CampaignId:"TestCampaign"}}},xa=async(t,e=null)=>{let{platform:n,confidence:r}=await Br();try{let s=ga+`/api/v1/space/${t}`;await Et.default.put(s),await Et.default.post(wa,{query:`mutation { increment(eventType: visits, spaceId: "${t}", campaignId: "${e}", platform: { name: ${n}, confidence: ${r} }) { message } }`},{headers:{"Content-Type":"application/json"}})}catch(s){console.log("Failed to emit onload event",s.message)}},ya=async(t,e=null)=>{let{platform:n,confidence:r}=await Br();try{let s=ga+`/api/v1/space/click/${t}`;await Et.default.put(s),await Et.default.post(wa,{query:`mutation { increment(eventType: clicks, spaceId: "${t}", campaignId: "${e}", platform: { name: ${n}, confidence: ${r} }) { message } }`},{headers:{"Content-Type":"application/json"}})}catch(s){console.log("Failed to emit onclick event",s.message)}};var ba="2.0.0";var P;(function(t){t[t.Native=1]="Native",t[t.Bool=2]="Bool",t[t.Int=4]="Int",t[t.Float=8]="Float",t[t.String=16]="String",t[t.Enum=32]="Enum",t[t.Object=64]="Object",t[t.Mesh=128]="Mesh",t[t.Texture=256]="Texture",t[t.Material=512]="Material",t[t.Animation=1024]="Animation",t[t.Skin=2048]="Skin",t[t.Color=4096]="Color"})(P||(P={}));var oe={bool(t=!1){return{type:P.Bool,default:t}},int(t=0){return{type:P.Int,default:t}},float(t=0){return{type:P.Float,default:t}},string(t=""){return{type:P.String,default:t}},enum(t,e){return{type:P.Enum,values:t,default:e}},object(){return{type:P.Object,default:null}},mesh(){return{type:P.Mesh,default:null}},texture(){return{type:P.Texture,default:null}},material(){return{type:P.Material,default:null}},animation(){return{type:P.Animation,default:null}},skin(){return{type:P.Skin,default:null}},color(t=0,e=0,n=0,r=1){return{type:P.Color,default:[t,e,n,r]}}};function Ma(t){return function(e,n){let r=e.constructor;r.Properties=r.Properties??{},r.Properties[n]=t}}function It(){return function(t,e,n){n.enumerable=!0}}function W(){return function(t,e,n){It()(t,e,n),Ma({type:P.Native})(t,e)}}var Wr={};for(let t in oe)Wr[t]=(...e)=>{let n=oe[t];return Ma(n(...e))};function Tn(t){return t===""?!0:t&&(typeof t=="string"||t.constructor===String)}function Aa(t){return t==null?!1:typeof t=="number"||t.constructor===Number}var ge=class{_listeners=[];_event=void 0;_autoResolve;constructor(e=!1){this._autoResolve=e}add(e,n={}){let{once:r=!1,id:s=void 0}=n;return this._event!==void 0&&(e(...this._event),r)?this:(this._listeners.push({id:s,once:r,callback:e}),this)}push(...e){for(let n of e)this.add(n);return this}once(e){return this.add(e,{once:!0})}remove(e){let n=this._find(e);return n!==null&&this._listeners.splice(n,1),this}has(e){return this._find(e)!==null}notify(...e){let n=this._listeners;this._autoResolve&&(this._event=e);for(let r=0;r<n.length;++r){let s=n[r];s.once&&n.splice(r--,1);try{s.callback(...e)}catch(a){console.error(a)}}}notifyUnsafe(...e){let n=this._listeners;this._autoResolve&&(this._event=e);for(let r=0;r<n.length;++r){let s=n[r];s.once&&n.splice(r--,1),s.callback(...e)}}promise(){return new Promise((e,n)=>{this.once((...r)=>{r.length>1?e(r):e(r[0])})})}_find(e){let n=this._listeners;if(Tn(e)){for(let r=0;r<n.length;++r)if(n[r].id===e)return r;return null}for(let r=0;r<n.length;++r)if(n[r].callback===e)return r;return null}};var q=function(t,e,n,r){var s=arguments.length,a=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(l=t[c])&&(a=(s<3?l(a):s>3?l(e,n,a):l(e,n))||a);return s>3&&a&&Object.defineProperty(e,n,a),a},Sn;(function(t){t[t.Sphere=0]="Sphere",t[t.AxisAlignedBox=1]="AxisAlignedBox",t[t.Box=2]="Box"})(Sn||(Sn={}));var Ta;(function(t){t[t.Left=0]="Left",t[t.Center=1]="Center",t[t.Right=2]="Right"})(Ta||(Ta={}));var Sa;(function(t){t[t.Line=0]="Line",t[t.Middle=1]="Middle",t[t.Top=2]="Top",t[t.Bottom=3]="Bottom"})(Sa||(Sa={}));var ja;(function(t){t[t.None=0]="None",t[t.Outline=1]="Outline"})(ja||(ja={}));var Oe;(function(t){t[t.Head=0]="Head",t[t.EyeLeft=1]="EyeLeft",t[t.EyeRight=2]="EyeRight",t[t.ControllerLeft=3]="ControllerLeft",t[t.ControllerRight=4]="ControllerRight",t[t.RayLeft=5]="RayLeft",t[t.RayRight=6]="RayRight"})(Oe||(Oe={}));var Pa;(function(t){t[t.Point=0]="Point",t[t.Spot=1]="Spot",t[t.Sun=2]="Sun"})(Pa||(Pa={}));var Ea;(function(t){t[t.Playing=0]="Playing",t[t.Paused=1]="Paused",t[t.Stopped=2]="Stopped"})(Ea||(Ea={}));var jn;(function(t){t[t.Force=0]="Force",t[t.Impulse=1]="Impulse",t[t.VelocityChange=2]="VelocityChange",t[t.Acceleration=3]="Acceleration"})(jn||(jn={}));var Ia;(function(t){t[t.Touch=0]="Touch",t[t.TouchLost=1]="TouchLost",t[t.TriggerTouch=2]="TriggerTouch",t[t.TriggerTouchLost=3]="TriggerTouchLost"})(Ia||(Ia={}));var Pn;(function(t){t[t.None=0]="None",t[t.Sphere=1]="Sphere",t[t.Capsule=2]="Capsule",t[t.Box=3]="Box",t[t.Plane=4]="Plane",t[t.ConvexMesh=5]="ConvexMesh",t[t.TriangleMesh=6]="TriangleMesh"})(Pn||(Pn={}));var Ge;(function(t){t[t.Position=0]="Position",t[t.Tangent=1]="Tangent",t[t.Normal=2]="Normal",t[t.TextureCoordinate=3]="TextureCoordinate",t[t.Color=4]="Color",t[t.JointId=5]="JointId",t[t.JointWeight=6]="JointWeight"})(Ge||(Ge={}));var we;(function(t){t[t.UnsignedInt=0]="UnsignedInt",t[t.Int=1]="Int",t[t.Float=2]="Float",t[t.Sampler=3]="Sampler",t[t.Font=4]="Font"})(we||(we={}));function Fa(t){return t===Pn.ConvexMesh||t===Pn.TriangleMesh}var O=class{_manager;_id;_object;_engine;constructor(e,n=-1,r=-1){this._engine=e,this._manager=n,this._id=r,this._object=null}get engine(){return this._engine}get type(){return this.constructor.TypeName??this._engine.wasm._typeNameFor(this._manager)}get object(){if(!this._object){let e=this._engine.wasm._wl_component_get_object(this._manager,this._id);this._object=this._engine.wrapObject(e)}return this._object}set active(e){this._engine.wasm._wl_component_setActive(this._manager,this._id,e)}get active(){return this._engine.wasm._wl_component_isActive(this._manager,this._id)!=0}destroy(){this._engine.wasm._wl_component_remove(this._manager,this._id),this._manager=-1,this._id=-1}equals(e){return e?this._manager==e._manager&&this._id==e._id:!1}};M(O,"TypeName"),M(O,"Properties"),M(O,"Dependencies");var Yr=class extends O{get collider(){return this._engine.wasm._wl_collision_component_get_collider(this._id)}set collider(e){this._engine.wasm._wl_collision_component_set_collider(this._id,e)}get extents(){let e=this._engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_collision_component_get_extents(this._id),3)}set extents(e){this.extents.set(e)}get group(){return this._engine.wasm._wl_collision_component_get_group(this._id)}set group(e){this._engine.wasm._wl_collision_component_set_group(this._id,e)}queryOverlaps(){let e=this._engine.wasm._wl_collision_component_query_overlaps(this._id,this._engine.wasm._tempMem,this._engine.wasm._tempMemSize>>1),n=new Array(e);for(let r=0;r<e;++r)n[r]=new Yr(this._engine,this._manager,this._engine.wasm._tempMemUint16[r]);return n}},be=Yr;M(be,"TypeName","collision");q([W()],be.prototype,"collider",null);q([W()],be.prototype,"extents",null);q([W()],be.prototype,"group",null);var xe=class extends O{get alignment(){return this._engine.wasm._wl_text_component_get_horizontal_alignment(this._id)}set alignment(e){this._engine.wasm._wl_text_component_set_horizontal_alignment(this._id,e)}get justification(){return this._engine.wasm._wl_text_component_get_vertical_alignment(this._id)}set justification(e){this._engine.wasm._wl_text_component_set_vertical_alignment(this._id,e)}get characterSpacing(){return this._engine.wasm._wl_text_component_get_character_spacing(this._id)}set characterSpacing(e){this._engine.wasm._wl_text_component_set_character_spacing(this._id,e)}get lineSpacing(){return this._engine.wasm._wl_text_component_get_line_spacing(this._id)}set lineSpacing(e){this._engine.wasm._wl_text_component_set_line_spacing(this._id,e)}get effect(){return this._engine.wasm._wl_text_component_get_effect(this._id)}set effect(e){this._engine.wasm._wl_text_component_set_effect(this._id,e)}get text(){let e=this._engine.wasm,n=e._wl_text_component_get_text(this._id);return e.UTF8ToString(n)}set text(e){let n=this._engine.wasm;n._wl_text_component_set_text(this._id,n.tempUTF8(e))}set material(e){let n=e?e._index:0;this._engine.wasm._wl_text_component_set_material(this._id,n)}get material(){let e=this._engine.wasm._wl_text_component_get_material(this._id);return e>0?new Le(this._engine,e):null}};M(xe,"TypeName","text");q([W()],xe.prototype,"alignment",null);q([W()],xe.prototype,"justification",null);q([W()],xe.prototype,"characterSpacing",null);q([W()],xe.prototype,"lineSpacing",null);q([W()],xe.prototype,"effect",null);q([W()],xe.prototype,"text",null);q([W()],xe.prototype,"material",null);var Me=class extends O{get projectionMatrix(){let e=this._engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_view_component_get_projection_matrix(this._id),16)}get near(){return this._engine.wasm._wl_view_component_get_near(this._id)}set near(e){this._engine.wasm._wl_view_component_set_near(this._id,e)}get far(){return this._engine.wasm._wl_view_component_get_far(this._id)}set far(e){this._engine.wasm._wl_view_component_set_far(this._id,e)}get fov(){return this._engine.wasm._wl_view_component_get_fov(this._id)}set fov(e){this._engine.wasm._wl_view_component_set_fov(this._id,e)}};M(Me,"TypeName","view");q([It()],Me.prototype,"projectionMatrix",null);q([W()],Me.prototype,"near",null);q([W()],Me.prototype,"far",null);q([W()],Me.prototype,"fov",null);var Ye=class extends O{get inputType(){return this._engine.wasm._wl_input_component_get_type(this._id)}set inputType(e){this._engine.wasm._wl_input_component_set_type(this._id,e)}get xrInputSource(){let e=this._engine.xrSession;if(e){for(let n of e.inputSources)if(n.handedness==this.handedness)return n}return null}get handedness(){let e=this.inputType;return e==Oe.ControllerRight||e==Oe.RayRight||e==Oe.EyeRight?"right":e==Oe.ControllerLeft||e==Oe.RayLeft||e==Oe.EyeLeft?"left":null}};M(Ye,"TypeName","input");q([W()],Ye.prototype,"inputType",null);q([It()],Ye.prototype,"xrInputSource",null);q([It()],Ye.prototype,"handedness",null);var Rt=class extends O{get color(){let e=this._engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_light_component_get_color(this._id),4)}set color(e){this.color.set(e)}get lightType(){return this._engine.wasm._wl_light_component_get_type(this._id)}set lightType(e){this._engine.wasm._wl_light_component_set_type(this._id,e)}};M(Rt,"TypeName","light");q([W()],Rt.prototype,"color",null);q([W()],Rt.prototype,"lightType",null);var ke=class extends O{set animation(e){this._engine.wasm._wl_animation_component_set_animation(this._id,e?e._index:0)}get animation(){let e=this._engine.wasm._wl_animation_component_get_animation(this._id);return e>0?new $e(this._engine,e):null}set playCount(e){this._engine.wasm._wl_animation_component_set_playCount(this._id,e)}get playCount(){return this._engine.wasm._wl_animation_component_get_playCount(this._id)}set speed(e){this._engine.wasm._wl_animation_component_set_speed(this._id,e)}get speed(){return this._engine.wasm._wl_animation_component_get_speed(this._id)}get state(){return this._engine.wasm._wl_animation_component_state(this._id)}play(){this._engine.wasm._wl_animation_component_play(this._id)}stop(){this._engine.wasm._wl_animation_component_stop(this._id)}pause(){this._engine.wasm._wl_animation_component_pause(this._id)}};M(ke,"TypeName","animation");q([W()],ke.prototype,"animation",null);q([W()],ke.prototype,"playCount",null);q([W()],ke.prototype,"speed",null);q([It()],ke.prototype,"state",null);var Se=class extends O{set material(e){this._engine.wasm._wl_mesh_component_set_material(this._id,e?e._index:0)}get material(){let e=this._engine.wasm._wl_mesh_component_get_material(this._id);return e>0?new Le(this._engine,e):null}get mesh(){let e=this._engine.wasm._wl_mesh_component_get_mesh(this._id);return e>0?new Ct(this._engine,e):null}set mesh(e){this._engine.wasm._wl_mesh_component_set_mesh(this._id,e?e._index:0)}get skin(){let e=this._engine.wasm._wl_mesh_component_get_skin(this._id);return e>0?new Gt(this._engine,e):null}set skin(e){this._engine.wasm._wl_mesh_component_set_skin(this._id,e?e._index:0)}};M(Se,"TypeName","mesh");q([W()],Se.prototype,"material",null);q([W()],Se.prototype,"mesh",null);q([W()],Se.prototype,"skin",null);var Ra;(function(t){t[t.None=0]="None",t[t.X=1]="X",t[t.Y=2]="Y",t[t.Z=4]="Z"})(Ra||(Ra={}));var Z=class extends O{set static(e){this._engine.wasm._wl_physx_component_set_static(this._id,e)}get static(){return!!this._engine.wasm._wl_physx_component_get_static(this._id)}set kinematic(e){this._engine.wasm._wl_physx_component_set_kinematic(this._id,e)}get kinematic(){return!!this._engine.wasm._wl_physx_component_get_kinematic(this._id)}set gravity(e){this._engine.wasm._wl_physx_component_set_gravity(this._id,e)}get gravity(){return!!this._engine.wasm._wl_physx_component_get_gravity(this._id)}set simulate(e){this._engine.wasm._wl_physx_component_set_simulate(this._id,e)}get simulate(){return!!this._engine.wasm._wl_physx_component_get_simulate(this._id)}set allowSimulation(e){this._engine.wasm._wl_physx_component_set_allowSimulation(this._id,e)}get allowSimulation(){return!!this._engine.wasm._wl_physx_component_get_allowSimulation(this._id)}set allowQuery(e){this._engine.wasm._wl_physx_component_set_allowQuery(this._id,e)}get allowQuery(){return!!this._engine.wasm._wl_physx_component_get_allowQuery(this._id)}set trigger(e){this._engine.wasm._wl_physx_component_set_trigger(this._id,e)}get trigger(){return!!this._engine.wasm._wl_physx_component_get_trigger(this._id)}set shape(e){this._engine.wasm._wl_physx_component_set_shape(this._id,e)}get shape(){return this._engine.wasm._wl_physx_component_get_shape(this._id)}set shapeData(e){e==null||!Fa(this.shape)||this._engine.wasm._wl_physx_component_set_shape_data(this._id,e.index)}get shapeData(){return Fa(this.shape)?{index:this._engine.wasm._wl_physx_component_get_shape_data(this._id)}:null}set extents(e){this.extents.set(e)}get extents(){let e=this._engine.wasm,n=e._wl_physx_component_get_extents(this._id);return new Float32Array(e.HEAPF32.buffer,n,3)}get staticFriction(){return this._engine.wasm._wl_physx_component_get_staticFriction(this._id)}set staticFriction(e){this._engine.wasm._wl_physx_component_set_staticFriction(this._id,e)}get dynamicFriction(){return this._engine.wasm._wl_physx_component_get_dynamicFriction(this._id)}set dynamicFriction(e){this._engine.wasm._wl_physx_component_set_dynamicFriction(this._id,e)}get bounciness(){return this._engine.wasm._wl_physx_component_get_bounciness(this._id)}set bounciness(e){this._engine.wasm._wl_physx_component_set_bounciness(this._id,e)}get linearDamping(){return this._engine.wasm._wl_physx_component_get_linearDamping(this._id)}set linearDamping(e){this._engine.wasm._wl_physx_component_set_linearDamping(this._id,e)}get angularDamping(){return this._engine.wasm._wl_physx_component_get_angularDamping(this._id)}set angularDamping(e){this._engine.wasm._wl_physx_component_set_angularDamping(this._id,e)}set linearVelocity(e){this._engine.wasm._wl_physx_component_set_linearVelocity(this._id,e[0],e[1],e[2])}get linearVelocity(){let e=this._engine.wasm;return e._wl_physx_component_get_linearVelocity(this._id,e._tempMem),new Float32Array(e.HEAPF32.buffer,e._tempMem,3)}set angularVelocity(e){this._engine.wasm._wl_physx_component_set_angularVelocity(this._id,e[0],e[1],e[2])}get angularVelocity(){let e=this._engine.wasm;return e._wl_physx_component_get_angularVelocity(this._id,e._tempMem),new Float32Array(e.HEAPF32.buffer,e._tempMem,3)}set groupsMask(e){this._engine.wasm._wl_physx_component_set_groupsMask(this._id,e)}get groupsMask(){return this._engine.wasm._wl_physx_component_get_groupsMask(this._id)}set blocksMask(e){this._engine.wasm._wl_physx_component_set_blocksMask(this._id,e)}get blocksMask(){return this._engine.wasm._wl_physx_component_get_blocksMask(this._id)}set linearLockAxis(e){this._engine.wasm._wl_physx_component_set_linearLockAxis(this._id,e)}get linearLockAxis(){return this._engine.wasm._wl_physx_component_get_linearLockAxis(this._id)}set angularLockAxis(e){this._engine.wasm._wl_physx_component_set_angularLockAxis(this._id,e)}get angularLockAxis(){return this._engine.wasm._wl_physx_component_get_angularLockAxis(this._id)}set mass(e){this._engine.wasm._wl_physx_component_set_mass(this._id,e)}get mass(){return this._engine.wasm._wl_physx_component_get_mass(this._id)}set massSpaceInteriaTensor(e){this._engine.wasm._wl_physx_component_set_massSpaceInertiaTensor(this._id,e[0],e[1],e[2])}addForce(e,n=jn.Force,r=!1,s,a=!1){let l=this._engine.wasm;if(!s){l._wl_physx_component_addForce(this._id,e[0],e[1],e[2],n,r);return}l._wl_physx_component_addForceAt(this._id,e[0],e[1],e[2],n,r,s[0],s[1],s[2],a)}addTorque(e,n=jn.Force){this._engine.wasm._wl_physx_component_addTorque(this._id,e[0],e[1],e[2],n)}onCollision(e){return this.onCollisionWith(this,e)}onCollisionWith(e,n){let r=this._engine.physics;return r._callbacks[this._id]=r._callbacks[this._id]||[],r._callbacks[this._id].push(n),this._engine.wasm._wl_physx_component_addCallback(this._id,e._id||this._id)}removeCollisionCallback(e){let n=this._engine.physics,r=this._engine.wasm._wl_physx_component_removeCallback(this._id,e);r&&n._callbacks[this._id].splice(-r)}};M(Z,"TypeName","physx");q([W()],Z.prototype,"static",null);q([W()],Z.prototype,"kinematic",null);q([W()],Z.prototype,"gravity",null);q([W()],Z.prototype,"simulate",null);q([W()],Z.prototype,"allowSimulation",null);q([W()],Z.prototype,"allowQuery",null);q([W()],Z.prototype,"trigger",null);q([W()],Z.prototype,"shape",null);q([W()],Z.prototype,"shapeData",null);q([W()],Z.prototype,"extents",null);q([W()],Z.prototype,"staticFriction",null);q([W()],Z.prototype,"dynamicFriction",null);q([W()],Z.prototype,"bounciness",null);q([W()],Z.prototype,"linearDamping",null);q([W()],Z.prototype,"angularDamping",null);q([W()],Z.prototype,"linearVelocity",null);q([W()],Z.prototype,"angularVelocity",null);q([W()],Z.prototype,"groupsMask",null);q([W()],Z.prototype,"blocksMask",null);q([W()],Z.prototype,"linearLockAxis",null);q([W()],Z.prototype,"angularLockAxis",null);q([W()],Z.prototype,"mass",null);var ve;(function(t){t[t.UnsignedByte=1]="UnsignedByte",t[t.UnsignedShort=2]="UnsignedShort",t[t.UnsignedInt=4]="UnsignedInt"})(ve||(ve={}));var Ct=class{_index=-1;_engine;constructor(e,n){if(this._engine=e??WL,this._index=-1,Aa(n)){this._index=n;return}if(!n.vertexCount)throw new Error("Missing parameter 'vertexCount'");let r=this._engine.wasm,s=0,a=0,l=0;if(n.indexData)switch(a=n.indexType||ve.UnsignedShort,l=n.indexData.length*a,s=r._malloc(l),a){case ve.UnsignedByte:r.HEAPU8.set(n.indexData,s);break;case ve.UnsignedShort:r.HEAPU16.set(n.indexData,s>>1);break;case ve.UnsignedInt:r.HEAPU32.set(n.indexData,s>>2);break}let{skinned:c=!1}=n;this._index=r._wl_mesh_create(s,l,a,n.vertexCount,c)}get vertexCount(){return this._engine.wasm._wl_mesh_get_vertexCount(this._index)}get indexData(){let e=this._engine.wasm,n=e._tempMem,r=e._wl_mesh_get_indexData(this._index,n,n+4);if(r===null)return null;let s=e.HEAPU32[n/4];switch(e.HEAPU32[n/4+1]){case ve.UnsignedByte:return new Uint8Array(e.HEAPU8.buffer,r,s);case ve.UnsignedShort:return new Uint16Array(e.HEAPU16.buffer,r,s);case ve.UnsignedInt:return new Uint32Array(e.HEAPU32.buffer,r,s)}return null}get engine(){return this._engine}update(){this._engine.wasm._wl_mesh_update(this._index)}getBoundingSphere(e=new Float32Array(4)){let n=this._engine.wasm._tempMemFloat;return this._engine.wasm._wl_mesh_get_boundingSphere(this._index,this._engine.wasm._tempMem),e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e}attribute(e){if(typeof e!="number")throw new TypeError("Expected number, but got "+typeof e);let n=this._engine.wasm._tempMemUint32;if(this._engine.wasm._wl_mesh_get_attribute(this._index,e,this._engine.wasm._tempMem),n[0]==255)return null;let r=n[5];return new Xr(this._engine,{attribute:n[0],offset:n[1],stride:n[2],formatSize:n[3],componentCount:n[4],arraySize:r||1,length:this.vertexCount,bufferType:e!==Ge.JointId?Float32Array:Uint16Array})}destroy(){this._engine.wasm._wl_mesh_destroy(this._index)}equals(e){return e?this._index===e._index:!1}},Xr=class{length=0;_engine;_attribute=-1;_offset=0;_stride=0;_formatSize=0;_componentCount=0;_arraySize=1;_bufferType;_tempBufferGetter;constructor(e,n){this._engine=e;let r=this._engine.wasm;this._attribute=n.attribute,this._offset=n.offset,this._stride=n.stride,this._formatSize=n.formatSize,this._componentCount=n.componentCount,this._arraySize=n.arraySize,this._bufferType=n.bufferType,this.length=n.length,this._tempBufferGetter=this._bufferType===Float32Array?r.getTempBufferF32.bind(r):r.getTempBufferU16.bind(r)}createArray(e=1){return e=e>this.length?this.length:e,new this._bufferType(e*this._componentCount*this._arraySize)}get(e,n=this.createArray()){if(n.length%this._componentCount!==0)throw new Error(`out.length, ${n.length} is not a multiple of the attribute vector components, ${this._componentCount}`);let r=this._tempBufferGetter(n.length),s=this._bufferType.BYTES_PER_ELEMENT,a=s*n.length,l=this._formatSize*this._arraySize,c=this._componentCount*s*this._arraySize;this._engine.wasm._wl_mesh_get_attribute_values(this._attribute,l,this._offset+e*this._stride,this._stride,c,r.byteOffset,a);for(let h=0;h<n.length;++h)n[h]=r[h];return n}set(e,n){if(n.length%this._componentCount!==0)throw new Error(`out.length, ${n.length} is not a multiple of the attribute vector components, ${this._componentCount}`);let r=this._bufferType.BYTES_PER_ELEMENT,s=r*n.length,a=this._componentCount*r*this._arraySize,l=this._formatSize*this._arraySize,c=this._engine.wasm;if(n.buffer!=c.HEAPU8.buffer){let h=this._tempBufferGetter(n.length);h.set(n),n=h}return c._wl_mesh_set_attribute_values(this._attribute,a,n.byteOffset,s,l,this._offset+e*this._stride,this._stride),this}},Le=class{_index;_definition;_engine;constructor(e,n){if(this._engine=e,typeof n!="number"){if(!n?.pipeline)throw new Error("Missing parameter 'pipeline'");let r=this._engine.wasm,s=n.pipeline;if(this._index=r._wl_material_create(r.tempUTF8(s)),this._index<0)throw new Error(`No such pipeline '${s}'`)}else this._index=n;if(this._definition=this._engine.wasm._wl_material_get_definition(this._index),!this._engine.wasm._materialDefinitions[this._definition])throw new Error(`Material Definition ${this._definition} not found for material with index ${this._index}`);return new Proxy(this,{get(r,s){let a=e.wasm,c=a._materialDefinitions[r._definition].get(s);if(!c)return r[s];if(a._wl_material_get_param_value(r._index,c.index,a._tempMem)){let h=c.type;switch(h.type){case we.UnsignedInt:return h.componentCount==1?a._tempMemUint32[0]:new Uint32Array(a.HEAPU32.buffer,a._tempMem,h.componentCount);case we.Int:return h.componentCount==1?a._tempMemInt[0]:new Int32Array(a.HEAP32.buffer,a._tempMem,h.componentCount);case we.Float:return h.componentCount==1?a._tempMemFloat[0]:new Float32Array(a.HEAPF32.buffer,a._tempMem,h.componentCount);case we.Sampler:return new Qe(e,a._tempMemInt[0]);default:throw new Error(`Invalid type ${h} on parameter ${c.index} for material ${r._index}`)}}},set(r,s,a){let l=e.wasm,h=l._materialDefinitions[r._definition].get(s);if(!h)return r[s]=a,!0;switch(h.type.type){case we.UnsignedInt:case we.Int:case we.Sampler:let i=a.id??a;l._wl_material_set_param_value_uint(r._index,h.index,i);break;case we.Float:let o=1;if(typeof a=="number")l._tempMemFloat[0]=a;else{o=a.length;for(let _=0;_<o;++_)l._tempMemFloat[_]=a[_]}l._wl_material_set_param_value_float(r._index,h.index,l._tempMem,o);break;case we.Font:throw new Error("Setting font properties is currently unsupported.")}return!0}})}get shader(){return this.pipeline}get pipeline(){let e=this._engine.wasm;return e.UTF8ToString((e._wl_material_get_pipeline||e._wl_material_get_shader)(this._index))}get engine(){return this._engine}clone(){let e=this._engine.wasm._wl_material_clone(this._index);return e>0?new Le(this._engine,e):null}equals(e){return e?this._index===e._index:!1}static wrap(e,n){return n>0?new Le(e,n):null}},Ft=null,Qe=class{_engine;_id=0;_imageIndex=null;constructor(e,n){this._engine=e??WL;let r=e.wasm;if(n instanceof HTMLImageElement||n instanceof HTMLVideoElement||n instanceof HTMLCanvasElement){let s=r._images.length;r._images.push(n),this._imageIndex=s,this._id=this._engine.wasm._wl_renderer_addImage(s)}else this._id=n;this._engine.textures[this._id]=this}get valid(){return this._id>=0}get id(){return this._id}update(){!this.valid||this._imageIndex===null||this._engine.wasm._wl_renderer_updateImage(this._id,this._imageIndex)}get width(){return this._engine.wasm._wl_texture_width(this._id)}get height(){return this._engine.wasm._wl_texture_height(this._id)}get engine(){return this._engine}updateSubImage(e,n,r,s){if(!this.valid||this._imageIndex===null)return;if(!Ft){let h=document.createElement("canvas"),d=h.getContext("2d");if(!d)throw new Error("Texture.updateSubImage(): Failed to obtain CanvasRenderingContext2D.");Ft={canvas:h,ctx:d}}let a=this._engine.wasm,l=a._images[this._imageIndex];if(!l)return;Ft.canvas.width=r,Ft.canvas.height=s,Ft.ctx.drawImage(l,e,n,r,s,0,0,r,s);let c=(l.videoHeight??l.height)-n-s;a._images[this._imageIndex]=Ft.canvas,a._wl_renderer_updateImage(this._id,this._imageIndex,e,c),a._images[this._imageIndex]=l}destroy(){this._engine.wasm._wl_texture_destroy(this._id),this._imageIndex!==null&&(this._engine.wasm._images[this._imageIndex]=null,this._imageIndex=void 0)}equals(e){return e?this._id===e._id:!1}},$e=class{_index;_engine;constructor(e=WL,n){this._engine=e,this._index=n}get duration(){return this._engine.wasm._wl_animation_get_duration(this._index)}get trackCount(){return this._engine.wasm._wl_animation_get_trackCount(this._index)}retarget(e){let n=this._engine.wasm;if(e instanceof Gt){let a=n._wl_animation_retargetToSkin(this._index,e._index);return new $e(this._engine,a)}if(e.length!=this.trackCount)throw Error("Expected "+this.trackCount.toString()+" targets, but got "+e.length.toString());let r=n._malloc(2*e.length);for(let a=0;a<e.length;++a)n.HEAPU16[r>>1+a]=e[a].objectId;let s=n._wl_animation_retarget(this._index,r);return n._free(r),new $e(this._engine,s)}equals(e){return e?this._index===e._index:!1}};var Gt=class{_index;_engine;constructor(e,n){this._engine=e,this._index=n}get jointCount(){return this._engine.wasm._wl_skin_get_joint_count(this._index)}get jointIds(){let e=this._engine.wasm;return new Uint16Array(e.HEAPU16.buffer,e._wl_skin_joint_ids(this._index),this.jointCount)}get inverseBindTransforms(){let e=this._engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_skin_inverse_bind_transforms(this._index),8*this.jointCount)}get inverseBindScalings(){let e=this._engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_skin_inverse_bind_scalings(this._index),3*this.jointCount)}equals(e){return e?this._index===e._index:!1}};var B0=new Map([[P.Bool,!1],[P.Int,0],[P.Float,0],[P.String,""],[P.Enum,void 0],[P.Object,null],[P.Mesh,null],[P.Texture,null],[P.Material,null],[P.Animation,null],[P.Skin,null],[P.Color,[0,0,0,1]]]);var En=class extends O{name="wonderland-engine-8thwall-camera";started=!1;view=null;position=[0,0,0];rotation=[0,0,0,-1];glTextureRenderer=null;promptForDeviceMotion(){return new Promise(async(e,n)=>{window.dispatchEvent(new Event("8thwall-request-user-interaction")),window.addEventListener("8thwall-safe-to-request-permissions",async()=>{try{let r=await DeviceMotionEvent.requestPermission();e(r)}catch(r){n(r)}})})}async getPermissions(){if(DeviceMotionEvent&&DeviceMotionEvent.requestPermission)try{if(await DeviceMotionEvent.requestPermission()!=="granted")throw new Error("MotionEvent")}catch(e){if(e.name==="NotAllowedError"){if(await this.promptForDeviceMotion()!=="granted")throw new Error("MotionEvent")}else throw new Error("MotionEvent")}try{(await navigator.mediaDevices.getUserMedia({video:!0,audio:!0})).getTracks().forEach(n=>{n.stop()})}catch{throw new Error("Camera")}}init(){this.view=this.object.getComponent("view"),this.onUpdate=this.onUpdate.bind(this),this.onAttach=this.onAttach.bind(this),this.onException=this.onException.bind(this),this.onCameraStatusChange=this.onCameraStatusChange.bind(this)}async start(){this.view=this.object.getComponent("view"),this.useCustomUIOverlays||fh.init();try{await this.getPermissions()}catch(n){window.dispatchEvent(new CustomEvent("8thwall-permission-fail",{detail:n}));return}await this.waitForXR8(),XR8.XrController.configure({disableWorldTracking:!1}),this.glTextureRenderer=XR8.GlTextureRenderer.pipelineModule(),XR8.addCameraPipelineModules([this.glTextureRenderer,XR8.XrController.pipelineModule(),this]);let e={cameraConfig:{direction:XR8.XrConfig.camera().BACK},canvas:Module.canvas,allowedDevices:XR8.XrConfig.device().ANY,ownRunLoop:!1};XR8.run(e)}onAttach(e){this.started=!0,this.engine.scene.colorClearEnabled=!1;let n=Module.ctx,r=this.object.rotationWorld,s=this.object.getTranslationWorld([]);this.position=Array.from(s),this.rotation=Array.from(r),XR8.XrController.updateCameraProjectionMatrix({origin:{x:s[0],y:s[1],z:s[2]},facing:{x:r[0],y:r[1],z:r[2],w:r[3]},cam:{pixelRectWidth:Module.canvas.width,pixelRectHeight:Module.canvas.height,nearClipPlane:this.view.near,farClipPlane:this.view.far}}),this.engine.scene.onPreRender.push(()=>{n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),XR8.runPreRender(Date.now()),XR8.runRender()}),this.engine.scene.onPostRender.push(()=>{XR8.runPostRender(Date.now())})}onCameraStatusChange(e){e&&e.status==="failed"&&this.onException(new Error(`Camera failed with status: ${e.status}`))}onUpdate(e){if(!e.processCpuResult.reality)return;let{rotation:n,position:r,intrinsics:s}=e.processCpuResult.reality;if(this.rotation[0]=n.x,this.rotation[1]=n.y,this.rotation[2]=n.z,this.rotation[3]=n.w,this.position[0]=r.x,this.position[1]=r.y,this.position[2]=r.z,s){let a=this.view.projectionMatrix;for(let l=0;l<16;l++)Number.isFinite(s[l])&&(a[l]=s[l])}r&&n&&(this.object.rotationWorld=this.rotation,this.object.setTranslationWorld(this.position))}onException(e){console.error("8thwall exception:",e),window.dispatchEvent(new CustomEvent("8thwall-error",{detail:e}))}waitForXR8(){return new Promise((e,n)=>{window.XR8?e():window.addEventListener("xrloaded",()=>e())})}};M(En,"TypeName","8thwall-camera"),M(En,"Properties",{useCustomUIOverlays:{type:P.Bool,default:!1}});var fh={init:function(){this.handleRequestUserInteraction=this.handleRequestUserInteraction.bind(this),this.handlePermissionFail=this.handlePermissionFail.bind(this),this.handleError=this.handleError.bind(this),window.addEventListener("8thwall-request-user-interaction",this.handleRequestUserInteraction),window.addEventListener("8thwall-permission-fail",this.handlePermissionFail),window.addEventListener("8thwall-error",this.handleError)},handleRequestUserInteraction:function(){let t=this.showOverlay(uh);window.addEventListener("8thwall-safe-to-request-permissions",()=>{t.remove()})},handlePermissionFail:function(t){this.showOverlay(gh)},handleError:function(t){this.showOverlay(wh)},showOverlay:function(t){let e=document.createElement("div");return e.innerHTML=t,document.body.appendChild(e),e}},uh=`
<style>
  #request-permission-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 999;
    color: #fff;
    background-color: rgba(0, 0, 0, 0.5);
    text-align: center;
    font-family: sans-serif;
  }

  .request-permission-overlay_title {
    margin: 30px;
    font-size: 32px;
  }

  .request-permission-overlay_button {
    background-color: #e80086;
    font-size: 22px;
    padding: 10px 30px;
    color: #fff;
    border-radius: 15px;
    border: none;
  }
</style>

<div id="request-permission-overlay">
  <div class="request-permission-overlay_title">This app requires to use your camera and motion sensors</div>

  <button class="request-permission-overlay_button" onclick="window.dispatchEvent(new Event('8thwall-safe-to-request-permissions'))">OK</button>
</div>`,gh=`
<style>
  #failed-permission-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 999;
    color: #fff;
    background-color: rgba(0, 0, 0, 0.5);
    text-align: center;
    font-family: sans-serif;
  }

  .failed-permission-overlay_title {
    margin: 30px;
    font-size: 32px;
  }

  .failed-permission-overlay_button {
    background-color: #e80086;
    font-size: 22px;
    padding: 10px 30px;
    color: #fff;
    border-radius: 15px;
    border: none;
  }
</style>

<div id="failed-permission-overlay">
  <div class="failed-permission-overlay_title">Failed to grant permissions. Reset the the permissions and refresh the page.</div>

  <button class="failed-permission-overlay_button" onclick="window.location.reload()">Refresh the page</button>
</div>`,wh=`
<style>
  #wall-error-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 999;
    color: #fff;
    background-color: rgba(0, 0, 0, 0.5);
    text-align: center;
    font-family: sans-serif;
  }

  .wall-error-overlay_title {
    margin: 30px;
    font-size: 32px;
  }

  .wall-error-overlay_button {
    background-color: #e80086;
    font-size: 22px;
    padding: 10px 30px;
    color: #fff;
    border-radius: 15px;
    border: none;
  }
</style>

<div id="wall-error-overlay">
  <div class="wall-error-overlay_title">Error has occurred. Please reload the page</div>

  <button class="wall-error-overlay_button" onclick="window.location.reload()">Reload</button>
</div>`;var ie=class extends O{onHover=new ge;onUnhover=new ge;onClick=new ge;onMove=new ge;onDown=new ge;onUp=new ge;addHoverFunction(e){this.onHover.add(e)}removeHoverFunction(e){this.onHover.remove(e)}addUnHoverFunction(e){this.onUnhover.add(e)}removeUnHoverFunction(e){this.onUnhover.remove(e)}addClickFunction(e){this.onClick.add(e)}removeClickFunction(e){this.onClick.remove(e)}addMoveFunction(e){this.onMove.add(e)}removeMoveFunction(e){this.onMove.remove(e)}addDownFunction(e){this.onDown.add(e)}removeDownFunction(e){this.onDown.remove(e)}addUpFunction(e){this.onUp.add(e)}removeUpFunction(e){this.onUp.remove(e)}};M(ie,"TypeName","cursor-target"),M(ie,"Properties",{});var X=1e-6,Q=typeof Float32Array<"u"?Float32Array:Array,De=Math.random;var hg=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function Ca(){var t=new Q(9);return Q!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}var ze={};je(ze,{add:()=>tp,adjoint:()=>jh,clone:()=>yh,copy:()=>bh,create:()=>xh,determinant:()=>Ph,equals:()=>sp,exactEquals:()=>ip,frob:()=>ep,fromQuat:()=>Bh,fromQuat2:()=>qh,fromRotation:()=>Dh,fromRotationTranslation:()=>La,fromRotationTranslationScale:()=>Vh,fromRotationTranslationScaleOrigin:()=>Hh,fromScaling:()=>Lh,fromTranslation:()=>kh,fromValues:()=>Mh,fromXRotation:()=>zh,fromYRotation:()=>Uh,fromZRotation:()=>Nh,frustum:()=>Wh,getRotation:()=>Qr,getScaling:()=>Da,getTranslation:()=>Gr,identity:()=>Oa,invert:()=>Sh,lookAt:()=>Zh,mul:()=>ap,multiply:()=>ka,multiplyScalar:()=>np,multiplyScalarAndAdd:()=>rp,ortho:()=>Qh,orthoNO:()=>Ua,orthoZO:()=>$h,perspective:()=>Xh,perspectiveFromFieldOfView:()=>Gh,perspectiveNO:()=>za,perspectiveZO:()=>Yh,rotate:()=>Fh,rotateX:()=>Rh,rotateY:()=>Ch,rotateZ:()=>Oh,scale:()=>Ih,set:()=>Ah,str:()=>Kh,sub:()=>op,subtract:()=>Na,targetTo:()=>Jh,translate:()=>Eh,transpose:()=>Th});function xh(){var t=new Q(16);return Q!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function yh(t){var e=new Q(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function bh(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Mh(t,e,n,r,s,a,l,c,h,d,i,o,_,m,u,g){var f=new Q(16);return f[0]=t,f[1]=e,f[2]=n,f[3]=r,f[4]=s,f[5]=a,f[6]=l,f[7]=c,f[8]=h,f[9]=d,f[10]=i,f[11]=o,f[12]=_,f[13]=m,f[14]=u,f[15]=g,f}function Ah(t,e,n,r,s,a,l,c,h,d,i,o,_,m,u,g,f){return t[0]=e,t[1]=n,t[2]=r,t[3]=s,t[4]=a,t[5]=l,t[6]=c,t[7]=h,t[8]=d,t[9]=i,t[10]=o,t[11]=_,t[12]=m,t[13]=u,t[14]=g,t[15]=f,t}function Oa(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Th(t,e){if(t===e){var n=e[1],r=e[2],s=e[3],a=e[6],l=e[7],c=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=a,t[11]=e[14],t[12]=s,t[13]=l,t[14]=c}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Sh(t,e){var n=e[0],r=e[1],s=e[2],a=e[3],l=e[4],c=e[5],h=e[6],d=e[7],i=e[8],o=e[9],_=e[10],m=e[11],u=e[12],g=e[13],f=e[14],w=e[15],v=n*c-r*l,x=n*h-s*l,T=n*d-a*l,A=r*h-s*c,S=r*d-a*c,F=s*d-a*h,E=i*g-o*u,D=i*f-_*u,z=i*w-m*u,V=o*f-_*g,U=o*w-m*g,L=_*w-m*f,I=v*L-x*U+T*V+A*z-S*D+F*E;return I?(I=1/I,t[0]=(c*L-h*U+d*V)*I,t[1]=(s*U-r*L-a*V)*I,t[2]=(g*F-f*S+w*A)*I,t[3]=(_*S-o*F-m*A)*I,t[4]=(h*z-l*L-d*D)*I,t[5]=(n*L-s*z+a*D)*I,t[6]=(f*T-u*F-w*x)*I,t[7]=(i*F-_*T+m*x)*I,t[8]=(l*U-c*z+d*E)*I,t[9]=(r*z-n*U-a*E)*I,t[10]=(u*S-g*T+w*v)*I,t[11]=(o*T-i*S-m*v)*I,t[12]=(c*D-l*V-h*E)*I,t[13]=(n*V-r*D+s*E)*I,t[14]=(g*x-u*A-f*v)*I,t[15]=(i*A-o*x+_*v)*I,t):null}function jh(t,e){var n=e[0],r=e[1],s=e[2],a=e[3],l=e[4],c=e[5],h=e[6],d=e[7],i=e[8],o=e[9],_=e[10],m=e[11],u=e[12],g=e[13],f=e[14],w=e[15];return t[0]=c*(_*w-m*f)-o*(h*w-d*f)+g*(h*m-d*_),t[1]=-(r*(_*w-m*f)-o*(s*w-a*f)+g*(s*m-a*_)),t[2]=r*(h*w-d*f)-c*(s*w-a*f)+g*(s*d-a*h),t[3]=-(r*(h*m-d*_)-c*(s*m-a*_)+o*(s*d-a*h)),t[4]=-(l*(_*w-m*f)-i*(h*w-d*f)+u*(h*m-d*_)),t[5]=n*(_*w-m*f)-i*(s*w-a*f)+u*(s*m-a*_),t[6]=-(n*(h*w-d*f)-l*(s*w-a*f)+u*(s*d-a*h)),t[7]=n*(h*m-d*_)-l*(s*m-a*_)+i*(s*d-a*h),t[8]=l*(o*w-m*g)-i*(c*w-d*g)+u*(c*m-d*o),t[9]=-(n*(o*w-m*g)-i*(r*w-a*g)+u*(r*m-a*o)),t[10]=n*(c*w-d*g)-l*(r*w-a*g)+u*(r*d-a*c),t[11]=-(n*(c*m-d*o)-l*(r*m-a*o)+i*(r*d-a*c)),t[12]=-(l*(o*f-_*g)-i*(c*f-h*g)+u*(c*_-h*o)),t[13]=n*(o*f-_*g)-i*(r*f-s*g)+u*(r*_-s*o),t[14]=-(n*(c*f-h*g)-l*(r*f-s*g)+u*(r*h-s*c)),t[15]=n*(c*_-h*o)-l*(r*_-s*o)+i*(r*h-s*c),t}function Ph(t){var e=t[0],n=t[1],r=t[2],s=t[3],a=t[4],l=t[5],c=t[6],h=t[7],d=t[8],i=t[9],o=t[10],_=t[11],m=t[12],u=t[13],g=t[14],f=t[15],w=e*l-n*a,v=e*c-r*a,x=e*h-s*a,T=n*c-r*l,A=n*h-s*l,S=r*h-s*c,F=d*u-i*m,E=d*g-o*m,D=d*f-_*m,z=i*g-o*u,V=i*f-_*u,U=o*f-_*g;return w*U-v*V+x*z+T*D-A*E+S*F}function ka(t,e,n){var r=e[0],s=e[1],a=e[2],l=e[3],c=e[4],h=e[5],d=e[6],i=e[7],o=e[8],_=e[9],m=e[10],u=e[11],g=e[12],f=e[13],w=e[14],v=e[15],x=n[0],T=n[1],A=n[2],S=n[3];return t[0]=x*r+T*c+A*o+S*g,t[1]=x*s+T*h+A*_+S*f,t[2]=x*a+T*d+A*m+S*w,t[3]=x*l+T*i+A*u+S*v,x=n[4],T=n[5],A=n[6],S=n[7],t[4]=x*r+T*c+A*o+S*g,t[5]=x*s+T*h+A*_+S*f,t[6]=x*a+T*d+A*m+S*w,t[7]=x*l+T*i+A*u+S*v,x=n[8],T=n[9],A=n[10],S=n[11],t[8]=x*r+T*c+A*o+S*g,t[9]=x*s+T*h+A*_+S*f,t[10]=x*a+T*d+A*m+S*w,t[11]=x*l+T*i+A*u+S*v,x=n[12],T=n[13],A=n[14],S=n[15],t[12]=x*r+T*c+A*o+S*g,t[13]=x*s+T*h+A*_+S*f,t[14]=x*a+T*d+A*m+S*w,t[15]=x*l+T*i+A*u+S*v,t}function Eh(t,e,n){var r=n[0],s=n[1],a=n[2],l,c,h,d,i,o,_,m,u,g,f,w;return e===t?(t[12]=e[0]*r+e[4]*s+e[8]*a+e[12],t[13]=e[1]*r+e[5]*s+e[9]*a+e[13],t[14]=e[2]*r+e[6]*s+e[10]*a+e[14],t[15]=e[3]*r+e[7]*s+e[11]*a+e[15]):(l=e[0],c=e[1],h=e[2],d=e[3],i=e[4],o=e[5],_=e[6],m=e[7],u=e[8],g=e[9],f=e[10],w=e[11],t[0]=l,t[1]=c,t[2]=h,t[3]=d,t[4]=i,t[5]=o,t[6]=_,t[7]=m,t[8]=u,t[9]=g,t[10]=f,t[11]=w,t[12]=l*r+i*s+u*a+e[12],t[13]=c*r+o*s+g*a+e[13],t[14]=h*r+_*s+f*a+e[14],t[15]=d*r+m*s+w*a+e[15]),t}function Ih(t,e,n){var r=n[0],s=n[1],a=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Fh(t,e,n,r){var s=r[0],a=r[1],l=r[2],c=Math.hypot(s,a,l),h,d,i,o,_,m,u,g,f,w,v,x,T,A,S,F,E,D,z,V,U,L,I,J;return c<X?null:(c=1/c,s*=c,a*=c,l*=c,h=Math.sin(n),d=Math.cos(n),i=1-d,o=e[0],_=e[1],m=e[2],u=e[3],g=e[4],f=e[5],w=e[6],v=e[7],x=e[8],T=e[9],A=e[10],S=e[11],F=s*s*i+d,E=a*s*i+l*h,D=l*s*i-a*h,z=s*a*i-l*h,V=a*a*i+d,U=l*a*i+s*h,L=s*l*i+a*h,I=a*l*i-s*h,J=l*l*i+d,t[0]=o*F+g*E+x*D,t[1]=_*F+f*E+T*D,t[2]=m*F+w*E+A*D,t[3]=u*F+v*E+S*D,t[4]=o*z+g*V+x*U,t[5]=_*z+f*V+T*U,t[6]=m*z+w*V+A*U,t[7]=u*z+v*V+S*U,t[8]=o*L+g*I+x*J,t[9]=_*L+f*I+T*J,t[10]=m*L+w*I+A*J,t[11]=u*L+v*I+S*J,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function Rh(t,e,n){var r=Math.sin(n),s=Math.cos(n),a=e[4],l=e[5],c=e[6],h=e[7],d=e[8],i=e[9],o=e[10],_=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*s+d*r,t[5]=l*s+i*r,t[6]=c*s+o*r,t[7]=h*s+_*r,t[8]=d*s-a*r,t[9]=i*s-l*r,t[10]=o*s-c*r,t[11]=_*s-h*r,t}function Ch(t,e,n){var r=Math.sin(n),s=Math.cos(n),a=e[0],l=e[1],c=e[2],h=e[3],d=e[8],i=e[9],o=e[10],_=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*s-d*r,t[1]=l*s-i*r,t[2]=c*s-o*r,t[3]=h*s-_*r,t[8]=a*r+d*s,t[9]=l*r+i*s,t[10]=c*r+o*s,t[11]=h*r+_*s,t}function Oh(t,e,n){var r=Math.sin(n),s=Math.cos(n),a=e[0],l=e[1],c=e[2],h=e[3],d=e[4],i=e[5],o=e[6],_=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*s+d*r,t[1]=l*s+i*r,t[2]=c*s+o*r,t[3]=h*s+_*r,t[4]=d*s-a*r,t[5]=i*s-l*r,t[6]=o*s-c*r,t[7]=_*s-h*r,t}function kh(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function Lh(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Dh(t,e,n){var r=n[0],s=n[1],a=n[2],l=Math.hypot(r,s,a),c,h,d;return l<X?null:(l=1/l,r*=l,s*=l,a*=l,c=Math.sin(e),h=Math.cos(e),d=1-h,t[0]=r*r*d+h,t[1]=s*r*d+a*c,t[2]=a*r*d-s*c,t[3]=0,t[4]=r*s*d-a*c,t[5]=s*s*d+h,t[6]=a*s*d+r*c,t[7]=0,t[8]=r*a*d+s*c,t[9]=s*a*d-r*c,t[10]=a*a*d+h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function zh(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Uh(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Nh(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function La(t,e,n){var r=e[0],s=e[1],a=e[2],l=e[3],c=r+r,h=s+s,d=a+a,i=r*c,o=r*h,_=r*d,m=s*h,u=s*d,g=a*d,f=l*c,w=l*h,v=l*d;return t[0]=1-(m+g),t[1]=o+v,t[2]=_-w,t[3]=0,t[4]=o-v,t[5]=1-(i+g),t[6]=u+f,t[7]=0,t[8]=_+w,t[9]=u-f,t[10]=1-(i+m),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function qh(t,e){var n=new Q(3),r=-e[0],s=-e[1],a=-e[2],l=e[3],c=e[4],h=e[5],d=e[6],i=e[7],o=r*r+s*s+a*a+l*l;return o>0?(n[0]=(c*l+i*r+h*a-d*s)*2/o,n[1]=(h*l+i*s+d*r-c*a)*2/o,n[2]=(d*l+i*a+c*s-h*r)*2/o):(n[0]=(c*l+i*r+h*a-d*s)*2,n[1]=(h*l+i*s+d*r-c*a)*2,n[2]=(d*l+i*a+c*s-h*r)*2),La(t,e,n),t}function Gr(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function Da(t,e){var n=e[0],r=e[1],s=e[2],a=e[4],l=e[5],c=e[6],h=e[8],d=e[9],i=e[10];return t[0]=Math.hypot(n,r,s),t[1]=Math.hypot(a,l,c),t[2]=Math.hypot(h,d,i),t}function Qr(t,e){var n=new Q(3);Da(n,e);var r=1/n[0],s=1/n[1],a=1/n[2],l=e[0]*r,c=e[1]*s,h=e[2]*a,d=e[4]*r,i=e[5]*s,o=e[6]*a,_=e[8]*r,m=e[9]*s,u=e[10]*a,g=l+i+u,f=0;return g>0?(f=Math.sqrt(g+1)*2,t[3]=.25*f,t[0]=(o-m)/f,t[1]=(_-h)/f,t[2]=(c-d)/f):l>i&&l>u?(f=Math.sqrt(1+l-i-u)*2,t[3]=(o-m)/f,t[0]=.25*f,t[1]=(c+d)/f,t[2]=(_+h)/f):i>u?(f=Math.sqrt(1+i-l-u)*2,t[3]=(_-h)/f,t[0]=(c+d)/f,t[1]=.25*f,t[2]=(o+m)/f):(f=Math.sqrt(1+u-l-i)*2,t[3]=(c-d)/f,t[0]=(_+h)/f,t[1]=(o+m)/f,t[2]=.25*f),t}function Vh(t,e,n,r){var s=e[0],a=e[1],l=e[2],c=e[3],h=s+s,d=a+a,i=l+l,o=s*h,_=s*d,m=s*i,u=a*d,g=a*i,f=l*i,w=c*h,v=c*d,x=c*i,T=r[0],A=r[1],S=r[2];return t[0]=(1-(u+f))*T,t[1]=(_+x)*T,t[2]=(m-v)*T,t[3]=0,t[4]=(_-x)*A,t[5]=(1-(o+f))*A,t[6]=(g+w)*A,t[7]=0,t[8]=(m+v)*S,t[9]=(g-w)*S,t[10]=(1-(o+u))*S,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function Hh(t,e,n,r,s){var a=e[0],l=e[1],c=e[2],h=e[3],d=a+a,i=l+l,o=c+c,_=a*d,m=a*i,u=a*o,g=l*i,f=l*o,w=c*o,v=h*d,x=h*i,T=h*o,A=r[0],S=r[1],F=r[2],E=s[0],D=s[1],z=s[2],V=(1-(g+w))*A,U=(m+T)*A,L=(u-x)*A,I=(m-T)*S,J=(1-(_+w))*S,_e=(f+v)*S,he=(u+x)*F,Lt=(f-v)*F,Dt=(1-(_+g))*F;return t[0]=V,t[1]=U,t[2]=L,t[3]=0,t[4]=I,t[5]=J,t[6]=_e,t[7]=0,t[8]=he,t[9]=Lt,t[10]=Dt,t[11]=0,t[12]=n[0]+E-(V*E+I*D+he*z),t[13]=n[1]+D-(U*E+J*D+Lt*z),t[14]=n[2]+z-(L*E+_e*D+Dt*z),t[15]=1,t}function Bh(t,e){var n=e[0],r=e[1],s=e[2],a=e[3],l=n+n,c=r+r,h=s+s,d=n*l,i=r*l,o=r*c,_=s*l,m=s*c,u=s*h,g=a*l,f=a*c,w=a*h;return t[0]=1-o-u,t[1]=i+w,t[2]=_-f,t[3]=0,t[4]=i-w,t[5]=1-d-u,t[6]=m+g,t[7]=0,t[8]=_+f,t[9]=m-g,t[10]=1-d-o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Wh(t,e,n,r,s,a,l){var c=1/(n-e),h=1/(s-r),d=1/(a-l);return t[0]=a*2*c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a*2*h,t[6]=0,t[7]=0,t[8]=(n+e)*c,t[9]=(s+r)*h,t[10]=(l+a)*d,t[11]=-1,t[12]=0,t[13]=0,t[14]=l*a*2*d,t[15]=0,t}function za(t,e,n,r,s){var a=1/Math.tan(e/2),l;return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==1/0?(l=1/(r-s),t[10]=(s+r)*l,t[14]=2*s*r*l):(t[10]=-1,t[14]=-2*r),t}var Xh=za;function Yh(t,e,n,r,s){var a=1/Math.tan(e/2),l;return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==1/0?(l=1/(r-s),t[10]=s*l,t[14]=s*r*l):(t[10]=-1,t[14]=-r),t}function Gh(t,e,n,r){var s=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),l=Math.tan(e.leftDegrees*Math.PI/180),c=Math.tan(e.rightDegrees*Math.PI/180),h=2/(l+c),d=2/(s+a);return t[0]=h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=d,t[6]=0,t[7]=0,t[8]=-((l-c)*h*.5),t[9]=(s-a)*d*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function Ua(t,e,n,r,s,a,l){var c=1/(e-n),h=1/(r-s),d=1/(a-l);return t[0]=-2*c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*d,t[11]=0,t[12]=(e+n)*c,t[13]=(s+r)*h,t[14]=(l+a)*d,t[15]=1,t}var Qh=Ua;function $h(t,e,n,r,s,a,l){var c=1/(e-n),h=1/(r-s),d=1/(a-l);return t[0]=-2*c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=d,t[11]=0,t[12]=(e+n)*c,t[13]=(s+r)*h,t[14]=a*d,t[15]=1,t}function Zh(t,e,n,r){var s,a,l,c,h,d,i,o,_,m,u=e[0],g=e[1],f=e[2],w=r[0],v=r[1],x=r[2],T=n[0],A=n[1],S=n[2];return Math.abs(u-T)<X&&Math.abs(g-A)<X&&Math.abs(f-S)<X?Oa(t):(i=u-T,o=g-A,_=f-S,m=1/Math.hypot(i,o,_),i*=m,o*=m,_*=m,s=v*_-x*o,a=x*i-w*_,l=w*o-v*i,m=Math.hypot(s,a,l),m?(m=1/m,s*=m,a*=m,l*=m):(s=0,a=0,l=0),c=o*l-_*a,h=_*s-i*l,d=i*a-o*s,m=Math.hypot(c,h,d),m?(m=1/m,c*=m,h*=m,d*=m):(c=0,h=0,d=0),t[0]=s,t[1]=c,t[2]=i,t[3]=0,t[4]=a,t[5]=h,t[6]=o,t[7]=0,t[8]=l,t[9]=d,t[10]=_,t[11]=0,t[12]=-(s*u+a*g+l*f),t[13]=-(c*u+h*g+d*f),t[14]=-(i*u+o*g+_*f),t[15]=1,t)}function Jh(t,e,n,r){var s=e[0],a=e[1],l=e[2],c=r[0],h=r[1],d=r[2],i=s-n[0],o=a-n[1],_=l-n[2],m=i*i+o*o+_*_;m>0&&(m=1/Math.sqrt(m),i*=m,o*=m,_*=m);var u=h*_-d*o,g=d*i-c*_,f=c*o-h*i;return m=u*u+g*g+f*f,m>0&&(m=1/Math.sqrt(m),u*=m,g*=m,f*=m),t[0]=u,t[1]=g,t[2]=f,t[3]=0,t[4]=o*f-_*g,t[5]=_*u-i*f,t[6]=i*g-o*u,t[7]=0,t[8]=i,t[9]=o,t[10]=_,t[11]=0,t[12]=s,t[13]=a,t[14]=l,t[15]=1,t}function Kh(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function ep(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function tp(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function Na(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function np(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function rp(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function ip(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function sp(t,e){var n=t[0],r=t[1],s=t[2],a=t[3],l=t[4],c=t[5],h=t[6],d=t[7],i=t[8],o=t[9],_=t[10],m=t[11],u=t[12],g=t[13],f=t[14],w=t[15],v=e[0],x=e[1],T=e[2],A=e[3],S=e[4],F=e[5],E=e[6],D=e[7],z=e[8],V=e[9],U=e[10],L=e[11],I=e[12],J=e[13],_e=e[14],he=e[15];return Math.abs(n-v)<=X*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(r-x)<=X*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(s-T)<=X*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(a-A)<=X*Math.max(1,Math.abs(a),Math.abs(A))&&Math.abs(l-S)<=X*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(c-F)<=X*Math.max(1,Math.abs(c),Math.abs(F))&&Math.abs(h-E)<=X*Math.max(1,Math.abs(h),Math.abs(E))&&Math.abs(d-D)<=X*Math.max(1,Math.abs(d),Math.abs(D))&&Math.abs(i-z)<=X*Math.max(1,Math.abs(i),Math.abs(z))&&Math.abs(o-V)<=X*Math.max(1,Math.abs(o),Math.abs(V))&&Math.abs(_-U)<=X*Math.max(1,Math.abs(_),Math.abs(U))&&Math.abs(m-L)<=X*Math.max(1,Math.abs(m),Math.abs(L))&&Math.abs(u-I)<=X*Math.max(1,Math.abs(u),Math.abs(I))&&Math.abs(g-J)<=X*Math.max(1,Math.abs(g),Math.abs(J))&&Math.abs(f-_e)<=X*Math.max(1,Math.abs(f),Math.abs(_e))&&Math.abs(w-he)<=X*Math.max(1,Math.abs(w),Math.abs(he))}var ap=ka,op=Na;var k={};je(k,{add:()=>id,calculateW:()=>Gp,clone:()=>td,conjugate:()=>Jp,copy:()=>On,create:()=>$t,dot:()=>kn,equals:()=>_d,exactEquals:()=>cd,exp:()=>co,fromEuler:()=>Kp,fromMat3:()=>ho,fromValues:()=>nd,getAngle:()=>Yp,getAxisAngle:()=>Xp,identity:()=>Wp,invert:()=>Zp,len:()=>od,length:()=>Ln,lerp:()=>ad,ln:()=>_o,mul:()=>sd,multiply:()=>lo,normalize:()=>ti,pow:()=>Qp,random:()=>$p,rotateX:()=>Jr,rotateY:()=>Kr,rotateZ:()=>ei,rotationTo:()=>hd,scale:()=>po,set:()=>rd,setAxes:()=>dd,setAxisAngle:()=>oo,slerp:()=>Cn,sqlerp:()=>pd,sqrLen:()=>ld,squaredLength:()=>Dn,str:()=>ed});var b={};je(b,{add:()=>hp,angle:()=>Fp,bezier:()=>Mp,ceil:()=>pp,clone:()=>lp,copy:()=>cp,create:()=>In,cross:()=>Qt,dist:()=>Up,distance:()=>Wa,div:()=>zp,divide:()=>Ba,dot:()=>Rn,equals:()=>kp,exactEquals:()=>Op,floor:()=>dp,forEach:()=>Vp,fromValues:()=>Fn,hermite:()=>bp,inverse:()=>xp,len:()=>Zr,length:()=>qa,lerp:()=>yp,max:()=>fp,min:()=>mp,mul:()=>Dp,multiply:()=>Ha,negate:()=>vp,normalize:()=>$r,random:()=>Ap,rotateX:()=>Pp,rotateY:()=>Ep,rotateZ:()=>Ip,round:()=>up,scale:()=>gp,scaleAndAdd:()=>wp,set:()=>_p,sqrDist:()=>Np,sqrLen:()=>qp,squaredDistance:()=>Xa,squaredLength:()=>Ya,str:()=>Cp,sub:()=>Lp,subtract:()=>Va,transformMat3:()=>Sp,transformMat4:()=>Tp,transformQuat:()=>jp,zero:()=>Rp});function In(){var t=new Q(3);return Q!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function lp(t){var e=new Q(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function qa(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function Fn(t,e,n){var r=new Q(3);return r[0]=t,r[1]=e,r[2]=n,r}function cp(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function _p(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function hp(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Va(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Ha(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function Ba(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function pp(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function dp(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function mp(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function fp(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function up(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function gp(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function wp(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function Wa(t,e){var n=e[0]-t[0],r=e[1]-t[1],s=e[2]-t[2];return Math.hypot(n,r,s)}function Xa(t,e){var n=e[0]-t[0],r=e[1]-t[1],s=e[2]-t[2];return n*n+r*r+s*s}function Ya(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function vp(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function xp(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function $r(t,e){var n=e[0],r=e[1],s=e[2],a=n*n+r*r+s*s;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}function Rn(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Qt(t,e,n){var r=e[0],s=e[1],a=e[2],l=n[0],c=n[1],h=n[2];return t[0]=s*h-a*c,t[1]=a*l-r*h,t[2]=r*c-s*l,t}function yp(t,e,n,r){var s=e[0],a=e[1],l=e[2];return t[0]=s+r*(n[0]-s),t[1]=a+r*(n[1]-a),t[2]=l+r*(n[2]-l),t}function bp(t,e,n,r,s,a){var l=a*a,c=l*(2*a-3)+1,h=l*(a-2)+a,d=l*(a-1),i=l*(3-2*a);return t[0]=e[0]*c+n[0]*h+r[0]*d+s[0]*i,t[1]=e[1]*c+n[1]*h+r[1]*d+s[1]*i,t[2]=e[2]*c+n[2]*h+r[2]*d+s[2]*i,t}function Mp(t,e,n,r,s,a){var l=1-a,c=l*l,h=a*a,d=c*l,i=3*a*c,o=3*h*l,_=h*a;return t[0]=e[0]*d+n[0]*i+r[0]*o+s[0]*_,t[1]=e[1]*d+n[1]*i+r[1]*o+s[1]*_,t[2]=e[2]*d+n[2]*i+r[2]*o+s[2]*_,t}function Ap(t,e){e=e||1;var n=De()*2*Math.PI,r=De()*2-1,s=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*s,t[1]=Math.sin(n)*s,t[2]=r*e,t}function Tp(t,e,n){var r=e[0],s=e[1],a=e[2],l=n[3]*r+n[7]*s+n[11]*a+n[15];return l=l||1,t[0]=(n[0]*r+n[4]*s+n[8]*a+n[12])/l,t[1]=(n[1]*r+n[5]*s+n[9]*a+n[13])/l,t[2]=(n[2]*r+n[6]*s+n[10]*a+n[14])/l,t}function Sp(t,e,n){var r=e[0],s=e[1],a=e[2];return t[0]=r*n[0]+s*n[3]+a*n[6],t[1]=r*n[1]+s*n[4]+a*n[7],t[2]=r*n[2]+s*n[5]+a*n[8],t}function jp(t,e,n){var r=n[0],s=n[1],a=n[2],l=n[3],c=e[0],h=e[1],d=e[2],i=s*d-a*h,o=a*c-r*d,_=r*h-s*c,m=s*_-a*o,u=a*i-r*_,g=r*o-s*i,f=l*2;return i*=f,o*=f,_*=f,m*=2,u*=2,g*=2,t[0]=c+i+m,t[1]=h+o+u,t[2]=d+_+g,t}function Pp(t,e,n,r){var s=[],a=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],a[0]=s[0],a[1]=s[1]*Math.cos(r)-s[2]*Math.sin(r),a[2]=s[1]*Math.sin(r)+s[2]*Math.cos(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function Ep(t,e,n,r){var s=[],a=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],a[0]=s[2]*Math.sin(r)+s[0]*Math.cos(r),a[1]=s[1],a[2]=s[2]*Math.cos(r)-s[0]*Math.sin(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function Ip(t,e,n,r){var s=[],a=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],a[0]=s[0]*Math.cos(r)-s[1]*Math.sin(r),a[1]=s[0]*Math.sin(r)+s[1]*Math.cos(r),a[2]=s[2],t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function Fp(t,e){var n=t[0],r=t[1],s=t[2],a=e[0],l=e[1],c=e[2],h=Math.sqrt(n*n+r*r+s*s),d=Math.sqrt(a*a+l*l+c*c),i=h*d,o=i&&Rn(t,e)/i;return Math.acos(Math.min(Math.max(o,-1),1))}function Rp(t){return t[0]=0,t[1]=0,t[2]=0,t}function Cp(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Op(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function kp(t,e){var n=t[0],r=t[1],s=t[2],a=e[0],l=e[1],c=e[2];return Math.abs(n-a)<=X*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-l)<=X*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(s-c)<=X*Math.max(1,Math.abs(s),Math.abs(c))}var Lp=Va,Dp=Ha,zp=Ba,Up=Wa,Np=Xa,Zr=qa,qp=Ya,Vp=function(){var t=In();return function(e,n,r,s,a,l){var c,h;for(n||(n=3),r||(r=0),s?h=Math.min(s*n+r,e.length):h=e.length,c=r;c<h;c+=n)t[0]=e[c],t[1]=e[c+1],t[2]=e[c+2],a(t,t,l),e[c]=t[0],e[c+1]=t[1],e[c+2]=t[2];return e}}();function Hp(){var t=new Q(4);return Q!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Ga(t){var e=new Q(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Qa(t,e,n,r){var s=new Q(4);return s[0]=t,s[1]=e,s[2]=n,s[3]=r,s}function $a(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Za(t,e,n,r,s){return t[0]=e,t[1]=n,t[2]=r,t[3]=s,t}function Ja(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function Ka(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function eo(t){var e=t[0],n=t[1],r=t[2],s=t[3];return Math.hypot(e,n,r,s)}function to(t){var e=t[0],n=t[1],r=t[2],s=t[3];return e*e+n*n+r*r+s*s}function no(t,e){var n=e[0],r=e[1],s=e[2],a=e[3],l=n*n+r*r+s*s+a*a;return l>0&&(l=1/Math.sqrt(l)),t[0]=n*l,t[1]=r*l,t[2]=s*l,t[3]=a*l,t}function ro(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function io(t,e,n,r){var s=e[0],a=e[1],l=e[2],c=e[3];return t[0]=s+r*(n[0]-s),t[1]=a+r*(n[1]-a),t[2]=l+r*(n[2]-l),t[3]=c+r*(n[3]-c),t}function so(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function ao(t,e){var n=t[0],r=t[1],s=t[2],a=t[3],l=e[0],c=e[1],h=e[2],d=e[3];return Math.abs(n-l)<=X*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(r-c)<=X*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(s-h)<=X*Math.max(1,Math.abs(s),Math.abs(h))&&Math.abs(a-d)<=X*Math.max(1,Math.abs(a),Math.abs(d))}var pg=function(){var t=Hp();return function(e,n,r,s,a,l){var c,h;for(n||(n=4),r||(r=0),s?h=Math.min(s*n+r,e.length):h=e.length,c=r;c<h;c+=n)t[0]=e[c],t[1]=e[c+1],t[2]=e[c+2],t[3]=e[c+3],a(t,t,l),e[c]=t[0],e[c+1]=t[1],e[c+2]=t[2],e[c+3]=t[3];return e}}();function $t(){var t=new Q(4);return Q!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Wp(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function oo(t,e,n){n=n*.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function Xp(t,e){var n=Math.acos(e[3])*2,r=Math.sin(n/2);return r>X?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function Yp(t,e){var n=kn(t,e);return Math.acos(2*n*n-1)}function lo(t,e,n){var r=e[0],s=e[1],a=e[2],l=e[3],c=n[0],h=n[1],d=n[2],i=n[3];return t[0]=r*i+l*c+s*d-a*h,t[1]=s*i+l*h+a*c-r*d,t[2]=a*i+l*d+r*h-s*c,t[3]=l*i-r*c-s*h-a*d,t}function Jr(t,e,n){n*=.5;var r=e[0],s=e[1],a=e[2],l=e[3],c=Math.sin(n),h=Math.cos(n);return t[0]=r*h+l*c,t[1]=s*h+a*c,t[2]=a*h-s*c,t[3]=l*h-r*c,t}function Kr(t,e,n){n*=.5;var r=e[0],s=e[1],a=e[2],l=e[3],c=Math.sin(n),h=Math.cos(n);return t[0]=r*h-a*c,t[1]=s*h+l*c,t[2]=a*h+r*c,t[3]=l*h-s*c,t}function ei(t,e,n){n*=.5;var r=e[0],s=e[1],a=e[2],l=e[3],c=Math.sin(n),h=Math.cos(n);return t[0]=r*h+s*c,t[1]=s*h-r*c,t[2]=a*h+l*c,t[3]=l*h-a*c,t}function Gp(t,e){var n=e[0],r=e[1],s=e[2];return t[0]=n,t[1]=r,t[2]=s,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-s*s)),t}function co(t,e){var n=e[0],r=e[1],s=e[2],a=e[3],l=Math.sqrt(n*n+r*r+s*s),c=Math.exp(a),h=l>0?c*Math.sin(l)/l:0;return t[0]=n*h,t[1]=r*h,t[2]=s*h,t[3]=c*Math.cos(l),t}function _o(t,e){var n=e[0],r=e[1],s=e[2],a=e[3],l=Math.sqrt(n*n+r*r+s*s),c=l>0?Math.atan2(l,a)/l:0;return t[0]=n*c,t[1]=r*c,t[2]=s*c,t[3]=.5*Math.log(n*n+r*r+s*s+a*a),t}function Qp(t,e,n){return _o(t,e),po(t,t,n),co(t,t),t}function Cn(t,e,n,r){var s=e[0],a=e[1],l=e[2],c=e[3],h=n[0],d=n[1],i=n[2],o=n[3],_,m,u,g,f;return m=s*h+a*d+l*i+c*o,m<0&&(m=-m,h=-h,d=-d,i=-i,o=-o),1-m>X?(_=Math.acos(m),u=Math.sin(_),g=Math.sin((1-r)*_)/u,f=Math.sin(r*_)/u):(g=1-r,f=r),t[0]=g*s+f*h,t[1]=g*a+f*d,t[2]=g*l+f*i,t[3]=g*c+f*o,t}function $p(t){var e=De(),n=De(),r=De(),s=Math.sqrt(1-e),a=Math.sqrt(e);return t[0]=s*Math.sin(2*Math.PI*n),t[1]=s*Math.cos(2*Math.PI*n),t[2]=a*Math.sin(2*Math.PI*r),t[3]=a*Math.cos(2*Math.PI*r),t}function Zp(t,e){var n=e[0],r=e[1],s=e[2],a=e[3],l=n*n+r*r+s*s+a*a,c=l?1/l:0;return t[0]=-n*c,t[1]=-r*c,t[2]=-s*c,t[3]=a*c,t}function Jp(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function ho(t,e){var n=e[0]+e[4]+e[8],r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var s=0;e[4]>e[0]&&(s=1),e[8]>e[s*3+s]&&(s=2);var a=(s+1)%3,l=(s+2)%3;r=Math.sqrt(e[s*3+s]-e[a*3+a]-e[l*3+l]+1),t[s]=.5*r,r=.5/r,t[3]=(e[a*3+l]-e[l*3+a])*r,t[a]=(e[a*3+s]+e[s*3+a])*r,t[l]=(e[l*3+s]+e[s*3+l])*r}return t}function Kp(t,e,n,r){var s=.5*Math.PI/180;e*=s,n*=s,r*=s;var a=Math.sin(e),l=Math.cos(e),c=Math.sin(n),h=Math.cos(n),d=Math.sin(r),i=Math.cos(r);return t[0]=a*h*i-l*c*d,t[1]=l*c*i+a*h*d,t[2]=l*h*d-a*c*i,t[3]=l*h*i+a*c*d,t}function ed(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var td=Ga,nd=Qa,On=$a,rd=Za,id=Ja,sd=lo,po=Ka,kn=ro,ad=io,Ln=eo,od=Ln,Dn=to,ld=Dn,ti=no,cd=so,_d=ao,hd=function(){var t=In(),e=Fn(1,0,0),n=Fn(0,1,0);return function(r,s,a){var l=Rn(s,a);return l<-.999999?(Qt(t,e,s),Zr(t)<1e-6&&Qt(t,n,s),$r(t,t),oo(r,t,Math.PI),r):l>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(Qt(t,s,a),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+l,ti(r,r))}}(),pd=function(){var t=$t(),e=$t();return function(n,r,s,a,l,c){return Cn(t,r,l,c),Cn(e,s,a,c),Cn(n,t,e,2*c*(1-c)),n}}(),dd=function(){var t=Ca();return function(e,n,r,s){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=s[0],t[4]=s[1],t[7]=s[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],ti(e,ho(e,t))}}();var ne={};je(ne,{add:()=>kd,clone:()=>fd,conjugate:()=>Nd,copy:()=>fo,create:()=>md,dot:()=>go,equals:()=>Xd,exactEquals:()=>Wd,fromMat4:()=>xd,fromRotation:()=>vd,fromRotationTranslation:()=>mo,fromRotationTranslationValues:()=>gd,fromTranslation:()=>wd,fromValues:()=>ud,getDual:()=>Ad,getReal:()=>Md,getTranslation:()=>jd,identity:()=>yd,invert:()=>Ud,len:()=>qd,length:()=>wo,lerp:()=>zd,mul:()=>Ld,multiply:()=>uo,normalize:()=>Hd,rotateAroundAxis:()=>Od,rotateByQuatAppend:()=>Rd,rotateByQuatPrepend:()=>Cd,rotateX:()=>Ed,rotateY:()=>Id,rotateZ:()=>Fd,scale:()=>Dd,set:()=>bd,setDual:()=>Sd,setReal:()=>Td,sqrLen:()=>Vd,squaredLength:()=>zn,str:()=>Bd,translate:()=>Pd});function md(){var t=new Q(8);return Q!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t}function fd(t){var e=new Q(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function ud(t,e,n,r,s,a,l,c){var h=new Q(8);return h[0]=t,h[1]=e,h[2]=n,h[3]=r,h[4]=s,h[5]=a,h[6]=l,h[7]=c,h}function gd(t,e,n,r,s,a,l){var c=new Q(8);c[0]=t,c[1]=e,c[2]=n,c[3]=r;var h=s*.5,d=a*.5,i=l*.5;return c[4]=h*r+d*n-i*e,c[5]=d*r+i*t-h*n,c[6]=i*r+h*e-d*t,c[7]=-h*t-d*e-i*n,c}function mo(t,e,n){var r=n[0]*.5,s=n[1]*.5,a=n[2]*.5,l=e[0],c=e[1],h=e[2],d=e[3];return t[0]=l,t[1]=c,t[2]=h,t[3]=d,t[4]=r*d+s*h-a*c,t[5]=s*d+a*l-r*h,t[6]=a*d+r*c-s*l,t[7]=-r*l-s*c-a*h,t}function wd(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0]*.5,t[5]=e[1]*.5,t[6]=e[2]*.5,t[7]=0,t}function vd(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function xd(t,e){var n=$t();Qr(n,e);var r=new Q(3);return Gr(r,e),mo(t,n,r),t}function fo(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function yd(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function bd(t,e,n,r,s,a,l,c,h){return t[0]=e,t[1]=n,t[2]=r,t[3]=s,t[4]=a,t[5]=l,t[6]=c,t[7]=h,t}var Md=On;function Ad(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t}var Td=On;function Sd(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t}function jd(t,e){var n=e[4],r=e[5],s=e[6],a=e[7],l=-e[0],c=-e[1],h=-e[2],d=e[3];return t[0]=(n*d+a*l+r*h-s*c)*2,t[1]=(r*d+a*c+s*l-n*h)*2,t[2]=(s*d+a*h+n*c-r*l)*2,t}function Pd(t,e,n){var r=e[0],s=e[1],a=e[2],l=e[3],c=n[0]*.5,h=n[1]*.5,d=n[2]*.5,i=e[4],o=e[5],_=e[6],m=e[7];return t[0]=r,t[1]=s,t[2]=a,t[3]=l,t[4]=l*c+s*d-a*h+i,t[5]=l*h+a*c-r*d+o,t[6]=l*d+r*h-s*c+_,t[7]=-r*c-s*h-a*d+m,t}function Ed(t,e,n){var r=-e[0],s=-e[1],a=-e[2],l=e[3],c=e[4],h=e[5],d=e[6],i=e[7],o=c*l+i*r+h*a-d*s,_=h*l+i*s+d*r-c*a,m=d*l+i*a+c*s-h*r,u=i*l-c*r-h*s-d*a;return Jr(t,e,n),r=t[0],s=t[1],a=t[2],l=t[3],t[4]=o*l+u*r+_*a-m*s,t[5]=_*l+u*s+m*r-o*a,t[6]=m*l+u*a+o*s-_*r,t[7]=u*l-o*r-_*s-m*a,t}function Id(t,e,n){var r=-e[0],s=-e[1],a=-e[2],l=e[3],c=e[4],h=e[5],d=e[6],i=e[7],o=c*l+i*r+h*a-d*s,_=h*l+i*s+d*r-c*a,m=d*l+i*a+c*s-h*r,u=i*l-c*r-h*s-d*a;return Kr(t,e,n),r=t[0],s=t[1],a=t[2],l=t[3],t[4]=o*l+u*r+_*a-m*s,t[5]=_*l+u*s+m*r-o*a,t[6]=m*l+u*a+o*s-_*r,t[7]=u*l-o*r-_*s-m*a,t}function Fd(t,e,n){var r=-e[0],s=-e[1],a=-e[2],l=e[3],c=e[4],h=e[5],d=e[6],i=e[7],o=c*l+i*r+h*a-d*s,_=h*l+i*s+d*r-c*a,m=d*l+i*a+c*s-h*r,u=i*l-c*r-h*s-d*a;return ei(t,e,n),r=t[0],s=t[1],a=t[2],l=t[3],t[4]=o*l+u*r+_*a-m*s,t[5]=_*l+u*s+m*r-o*a,t[6]=m*l+u*a+o*s-_*r,t[7]=u*l-o*r-_*s-m*a,t}function Rd(t,e,n){var r=n[0],s=n[1],a=n[2],l=n[3],c=e[0],h=e[1],d=e[2],i=e[3];return t[0]=c*l+i*r+h*a-d*s,t[1]=h*l+i*s+d*r-c*a,t[2]=d*l+i*a+c*s-h*r,t[3]=i*l-c*r-h*s-d*a,c=e[4],h=e[5],d=e[6],i=e[7],t[4]=c*l+i*r+h*a-d*s,t[5]=h*l+i*s+d*r-c*a,t[6]=d*l+i*a+c*s-h*r,t[7]=i*l-c*r-h*s-d*a,t}function Cd(t,e,n){var r=e[0],s=e[1],a=e[2],l=e[3],c=n[0],h=n[1],d=n[2],i=n[3];return t[0]=r*i+l*c+s*d-a*h,t[1]=s*i+l*h+a*c-r*d,t[2]=a*i+l*d+r*h-s*c,t[3]=l*i-r*c-s*h-a*d,c=n[4],h=n[5],d=n[6],i=n[7],t[4]=r*i+l*c+s*d-a*h,t[5]=s*i+l*h+a*c-r*d,t[6]=a*i+l*d+r*h-s*c,t[7]=l*i-r*c-s*h-a*d,t}function Od(t,e,n,r){if(Math.abs(r)<X)return fo(t,e);var s=Math.hypot(n[0],n[1],n[2]);r=r*.5;var a=Math.sin(r),l=a*n[0]/s,c=a*n[1]/s,h=a*n[2]/s,d=Math.cos(r),i=e[0],o=e[1],_=e[2],m=e[3];t[0]=i*d+m*l+o*h-_*c,t[1]=o*d+m*c+_*l-i*h,t[2]=_*d+m*h+i*c-o*l,t[3]=m*d-i*l-o*c-_*h;var u=e[4],g=e[5],f=e[6],w=e[7];return t[4]=u*d+w*l+g*h-f*c,t[5]=g*d+w*c+f*l-u*h,t[6]=f*d+w*h+u*c-g*l,t[7]=w*d-u*l-g*c-f*h,t}function kd(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t}function uo(t,e,n){var r=e[0],s=e[1],a=e[2],l=e[3],c=n[4],h=n[5],d=n[6],i=n[7],o=e[4],_=e[5],m=e[6],u=e[7],g=n[0],f=n[1],w=n[2],v=n[3];return t[0]=r*v+l*g+s*w-a*f,t[1]=s*v+l*f+a*g-r*w,t[2]=a*v+l*w+r*f-s*g,t[3]=l*v-r*g-s*f-a*w,t[4]=r*i+l*c+s*d-a*h+o*v+u*g+_*w-m*f,t[5]=s*i+l*h+a*c-r*d+_*v+u*f+m*g-o*w,t[6]=a*i+l*d+r*h-s*c+m*v+u*w+o*f-_*g,t[7]=l*i-r*c-s*h-a*d+u*v-o*g-_*f-m*w,t}var Ld=uo;function Dd(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t}var go=kn;function zd(t,e,n,r){var s=1-r;return go(e,n)<0&&(r=-r),t[0]=e[0]*s+n[0]*r,t[1]=e[1]*s+n[1]*r,t[2]=e[2]*s+n[2]*r,t[3]=e[3]*s+n[3]*r,t[4]=e[4]*s+n[4]*r,t[5]=e[5]*s+n[5]*r,t[6]=e[6]*s+n[6]*r,t[7]=e[7]*s+n[7]*r,t}function Ud(t,e){var n=zn(e);return t[0]=-e[0]/n,t[1]=-e[1]/n,t[2]=-e[2]/n,t[3]=e[3]/n,t[4]=-e[4]/n,t[5]=-e[5]/n,t[6]=-e[6]/n,t[7]=e[7]/n,t}function Nd(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t}var wo=Ln,qd=wo,zn=Dn,Vd=zn;function Hd(t,e){var n=zn(e);if(n>0){n=Math.sqrt(n);var r=e[0]/n,s=e[1]/n,a=e[2]/n,l=e[3]/n,c=e[4],h=e[5],d=e[6],i=e[7],o=r*c+s*h+a*d+l*i;t[0]=r,t[1]=s,t[2]=a,t[3]=l,t[4]=(c-r*o)/n,t[5]=(h-s*o)/n,t[6]=(d-a*o)/n,t[7]=(i-l*o)/n}return t}function Bd(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function Wd(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]}function Xd(t,e){var n=t[0],r=t[1],s=t[2],a=t[3],l=t[4],c=t[5],h=t[6],d=t[7],i=e[0],o=e[1],_=e[2],m=e[3],u=e[4],g=e[5],f=e[6],w=e[7];return Math.abs(n-i)<=X*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-o)<=X*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(s-_)<=X*Math.max(1,Math.abs(s),Math.abs(_))&&Math.abs(a-m)<=X*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(l-u)<=X*Math.max(1,Math.abs(l),Math.abs(u))&&Math.abs(c-g)<=X*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(h-f)<=X*Math.max(1,Math.abs(h),Math.abs(f))&&Math.abs(d-w)<=X*Math.max(1,Math.abs(d),Math.abs(w))}var Un=class extends O{collisionMask=0;maxDistance=100;onDestroyCallbacks=[];input=null;origin=new Float32Array(3);cursorObjScale=new Float32Array(3);direction=new Float32Array(3);tempVec=new Float32Array(3);projectionMatrix=new Float32Array(16);viewComponent=null;visible=!0;isDown=!1;lastIsDown=!1;arTouchDown=!1;cursorPos=new Float32Array(3);lastCursorPosOnTarget=new Float32Array(3);hoveringObject=null;hoveringObjectTarget=null;cursorRayScale=new Float32Array(3);globalTarget=null;collisionGroup=1;cursorRayObject=null;cursorRayScalingAxis=2;cursorObject=null;handedness=0;rayCastMode=0;styleCursor=!0;start(){if(this.collisionMask=1<<this.collisionGroup,this.handedness==0){let n=this.object.getComponent("input");n?(this.handedness=n.handedness||"none",this.input=n):console.warn("cursor component on object",this.object.name,'was configured with handedness "input component", but object has no input component.')}else this.handedness=["left","right","none"][this.handedness-1];if(this.globalTarget=this.object.addComponent(ie),this.viewComponent=this.object.getComponent(Me),this.viewComponent!=null){let n=this.onClick.bind(this);this.engine.canvas.addEventListener("click",n);let r=this.onPointerMove.bind(this);this.engine.canvas.addEventListener("pointermove",r);let s=this.onPointerDown.bind(this);this.engine.canvas.addEventListener("pointerdown",s);let a=this.onPointerUp.bind(this);this.engine.canvas.addEventListener("pointerup",a),ze.invert(this.projectionMatrix,this.viewComponent.projectionMatrix);let l=this.onViewportResize.bind(this);window.addEventListener("resize",l),this.onDestroyCallbacks.push(()=>{this.engine.canvas.removeEventListener("click",n),this.engine.canvas.removeEventListener("pointermove",r),this.engine.canvas.removeEventListener("pointerdown",s),this.engine.canvas.removeEventListener("pointerup",a),window.removeEventListener("resize",l)})}let e=this.setupVREvents.bind(this);this.engine.onXRSessionStart.add(e),this.onDestroyCallbacks.push(()=>{this.engine.onXRSessionStart.remove(e)}),this.cursorRayObject&&(this.cursorRayScale.set(this.cursorRayObject.scalingLocal),this.object.getTranslationWorld(this.origin),this.object.getForward(this.direction),this._setCursorRayTransform(b.add(this.tempVec,this.origin,this.direction)))}onViewportResize(){this.viewComponent&&ze.invert(this.projectionMatrix,this.viewComponent.projectionMatrix)}_setCursorRayTransform(e){if(!this.cursorRayObject)return;let n=b.dist(this.origin,e);this.cursorRayObject.setTranslationLocal([0,0,-n/2]),this.cursorRayScalingAxis!=4&&(this.cursorRayObject.resetScaling(),this.cursorRayScale[this.cursorRayScalingAxis]=n/2,this.cursorRayObject.scale(this.cursorRayScale))}_setCursorVisibility(e){this.visible!=e&&(this.visible=e,this.cursorObject&&(e?(this.cursorObject.resetScaling(),this.cursorObject.scale(this.cursorObjScale)):(this.cursorObjScale.set(this.cursorObject.scalingLocal),this.cursorObject.scale([0,0,0]))))}update(){this.doUpdate(!1)}doUpdate(e){if(this.engine.xrSession)if(this.arTouchDown&&this.input&&this.engine.xrSession.inputSources[0].handedness==="none"&&this.engine.xrSession.inputSources[0].gamepad){let r=this.engine.xrSession.inputSources[0].gamepad.axes;this.direction[0]=r[0],this.direction[1]=-r[1],this.direction[2]=-1,this.updateDirection()}else this.object.getTranslationWorld(this.origin),this.object.getForward(this.direction);let n=this.rayCastMode==0?this.engine.scene.rayCast(this.origin,this.direction,this.collisionMask):this.engine.physics.rayCast(this.origin,this.direction,this.collisionMask,this.maxDistance);n.hitCount>0?this.cursorPos.set(n.locations[0]):this.cursorPos.fill(0),this.hoverBehaviour(n,e),this.cursorObject&&(this.hoveringObject&&(this.cursorPos[0]!=0||this.cursorPos[1]!=0||this.cursorPos[2]!=0)?(this._setCursorVisibility(!0),this.cursorObject.setTranslationWorld(this.cursorPos),this._setCursorRayTransform(this.cursorPos)):this._setCursorVisibility(!1))}hoverBehaviour(e,n){if(e.hitCount>0){if(!this.hoveringObject||!this.hoveringObject.equals(e.objects[0])){if(this.hoveringObject){let a=this.hoveringObject.getComponent(ie);a&&a.onUnhover.notify(this.hoveringObject,this),this.globalTarget.onUnhover.notify(this.hoveringObject,this)}this.hoveringObject=e.objects[0],this.styleCursor&&(this.engine.canvas.style.cursor="pointer");let s=this.hoveringObject.getComponent(ie);s&&(this.hoveringObjectTarget=s,s.onHover.notify(this.hoveringObject,this)),this.globalTarget.onHover.notify(this.hoveringObject,this)}this.hoveringObjectTarget&&(this.hoveringObject.toLocalSpaceTransform(this.tempVec,this.cursorPos),(this.lastCursorPosOnTarget[0]!=this.tempVec[0]||this.lastCursorPosOnTarget[1]!=this.tempVec[1]||this.lastCursorPosOnTarget[2]!=this.tempVec[2])&&(this.hoveringObjectTarget.onMove.notify(this.hoveringObject,this),this.lastCursorPosOnTarget.set(this.tempVec)));let r=this.hoveringObject.getComponent(ie);this.isDown!==this.lastIsDown&&(this.isDown?(r&&r.onDown.notify(this.hoveringObject,this),this.globalTarget.onDown.notify(this.hoveringObject,this)):(r&&r.onUp.notify(this.hoveringObject,this),this.globalTarget.onUp.notify(this.hoveringObject,this))),n&&(r&&r.onClick.notify(this.hoveringObject,this),this.globalTarget.onClick.notify(this.hoveringObject,this))}else if(this.hoveringObject&&e.hitCount==0){let r=this.hoveringObject.getComponent(ie);r&&r.onUnhover.notify(this.hoveringObject,this),this.globalTarget.onUnhover.notify(this.hoveringObject,this),this.hoveringObject=null,this.hoveringObjectTarget=null,this.styleCursor&&(this.engine.canvas.style.cursor="default")}this.lastIsDown=this.isDown}setupVREvents(e){let n=this.onSelect.bind(this);e.addEventListener("select",n);let r=this.onSelectStart.bind(this);e.addEventListener("selectstart",r);let s=this.onSelectEnd.bind(this);e.addEventListener("selectend",s),this.onDestroyCallbacks.push(()=>{this.engine.xrSession&&(e.removeEventListener("select",n),e.removeEventListener("selectstart",r),e.removeEventListener("selectend",s))}),this.onViewportResize()}onSelect(e){e.inputSource.handedness==this.handedness&&this.doUpdate(!0)}onSelectStart(e){this.arTouchDown=!0,e.inputSource.handedness==this.handedness&&(this.isDown=!0)}onSelectEnd(e){this.arTouchDown=!1,e.inputSource.handedness==this.handedness&&(this.isDown=!1)}onPointerMove(e){if(!e.isPrimary)return;let n=this.engine.canvas.getBoundingClientRect(),r=this.updateMousePos(e.clientX,e.clientY,n.width,n.height);this.hoverBehaviour(r,!1)}onClick(e){let n=this.engine.canvas.getBoundingClientRect(),r=this.updateMousePos(e.clientX,e.clientY,n.width,n.height);this.hoverBehaviour(r,!0)}onPointerDown(e){if(!e.isPrimary||e.button!==0)return;let n=this.engine.canvas.getBoundingClientRect(),r=this.updateMousePos(e.clientX,e.clientY,n.width,n.height);this.isDown=!0,this.hoverBehaviour(r,!1)}onPointerUp(e){if(!e.isPrimary||e.button!==0)return;let n=this.engine.canvas.getBoundingClientRect(),r=this.updateMousePos(e.clientX,e.clientY,n.width,n.height);this.isDown=!1,this.hoverBehaviour(r,!1)}updateMousePos(e,n,r,s){let a=e/r,l=n/s;return this.direction[0]=a*2-1,this.direction[1]=-l*2+1,this.direction[2]=-1,this.updateDirection()}updateDirection(){this.object.getTranslationWorld(this.origin),b.transformMat4(this.direction,this.direction,this.projectionMatrix),b.normalize(this.direction,this.direction),b.transformQuat(this.direction,this.direction,this.object.transformWorld);let e=this.rayCastMode==0?this.engine.scene.rayCast(this.origin,this.direction,this.collisionMask):this.engine.physics.rayCast(this.origin,this.direction,this.collisionMask,this.maxDistance);return e.hitCount>0?this.cursorPos.set(e.locations[0]):this.cursorPos.fill(0),e}onDeactivate(){if(this._setCursorVisibility(!1),this.hoveringObject){let e=this.hoveringObject.getComponent(ie);e&&e.onUnhover.notify(this.hoveringObject,this),this.globalTarget.onUnhover.notify(this.hoveringObject,this)}this.cursorRayObject&&this.cursorRayObject.scale([0,0,0])}onActivate(){this._setCursorVisibility(!0)}onDestroy(){for(let e of this.onDestroyCallbacks)e()}};M(Un,"TypeName","cursor"),M(Un,"Properties",{collisionGroup:{type:P.Int,default:1},cursorRayObject:{type:P.Object},cursorRayScalingAxis:{type:P.Enum,values:["x","y","z","none"],default:"z"},cursorObject:{type:P.Object},handedness:{type:P.Enum,values:["input component","left","right","none"],default:"input component"},rayCastMode:{type:P.Enum,values:["collision","physx"],default:"collision"},styleCursor:{type:P.Bool,default:!0}});var Yd=function(t,e,n,r){var s=arguments.length,a=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(l=t[c])&&(a=(s<3?l(a):s>3?l(e,n,a):l(e,n))||a);return s>3&&a&&Object.defineProperty(e,n,a),a},Nn=class extends O{obj=null;start(){let e=new Float32Array(3);ne.getTranslation(e,this.object.transformWorld),console.log("Debug object:",this.object.name),console.log("Other object:",this.obj?.name),console.log("	translation",e),console.log("	transformWorld",this.object.transformWorld),console.log("	transformLocal",this.object.transformLocal)}};M(Nn,"TypeName","debug-object");Yd([Wr.object()],Nn.prototype,"obj",void 0);var qn=class extends O{start(){this.engine.xr?this.setFixedFoveation():this.engine.onXRSessionStart.push(this.setFixedFoveation.bind(this))}setFixedFoveation(){this.engine.xr.baseLayer.fixedFoveation=this.fixedFoveation}};M(qn,"TypeName","fixed-foveation"),M(qn,"Properties",{fixedFoveation:{type:P.Float,default:.5}});var Vn=new Float32Array(3),Zt=new Float32Array(4);function Hn(t,e){let n=e.orientation;Zt[0]=n.x,Zt[1]=n.y,Zt[2]=n.z,Zt[3]=n.w;let r=e.position;Vn[0]=r.x,Vn[1]=r.y,Vn[2]=r.z,t.resetTranslationRotation(),t.transformLocal.set(Zt),t.translate(Vn)}var Jt=["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"],Bn=class extends O{init(){this.handedness=["left","right"][this.handedness]}start(){if(this.joints=[],this.session=null,this.hasPose=!1,this._childrenActive=!0,!("XRHand"in window)){console.warn("WebXR Hand Tracking not supported by this browser."),this.active=!1;return}if(this.handSkin){let n=this.handSkin.jointIds;this.joints[Jt[0]]=this.engine.wrapObject(n[0]);for(let r=0;r<n.length;++r){let s=this.engine.wrapObject(n[r]);this.joints[s.name]=s}return}for(let e=0;e<=Jt.length;++e){let n=this.engine.scene.addObject(this.object.parent),r=n.addComponent("mesh");r.mesh=this.jointMesh,r.material=this.jointMaterial,this.joints[Jt[e]]=n}}update(e){if(this.session||this.engine.xr&&this.setupVREvents(this.engine.xr.session),!!this.session){if(this.hasPose=!1,this.session&&this.session.inputSources)for(let n=0;n<=this.session.inputSources.length;++n){let r=this.session.inputSources[n];if(!r||!r.hand||r.handedness!=this.handedness)continue;if(this.hasPose=!0,r.hand.get("wrist")!==null){let l=Module.webxr_frame.getJointPose(r.hand.get("wrist"),this.engine.xr.currentReferenceSpace);l&&Hn(this.object,l.transform)}let s=new Float32Array(3),a=new Float32Array(4);k.invert(a,this.object.transformLocal),this.object.getTranslationLocal(s);for(let l=0;l<Jt.length;++l){let c=Jt[l],h=this.joints[c];if(h==null)continue;let d=null;if(r.hand.get(c)!==null&&(d=this.engine.xr.frame.getJointPose(r.hand.get(c),this.engine.xr.currentReferenceSpace)),d!==null)if(this.handSkin)h.resetTranslationRotation(),h.translate([d.transform.position.x-s[0],d.transform.position.y-s[1],d.transform.position.z-s[2]]),h.rotate(a),h.rotateObject([d.transform.orientation.x,d.transform.orientation.y,d.transform.orientation.z,d.transform.orientation.w]);else{Hn(this.object,p.transform);let i=d.radius||.007;h.scale([i,i,i])}else this.handSkin||h.scale([0,0,0])}}!this.hasPose&&this._childrenActive?(this._childrenActive=!1,this.deactivateChildrenWithoutPose&&this.setChildrenActive(!1),this.controllerToDeactivate&&(this.controllerToDeactivate.active=!0,this.setChildrenActive(!0,this.controllerToDeactivate))):this.hasPose&&!this._childrenActive&&(this._childrenActive=!0,this.deactivateChildrenWithoutPose&&this.setChildrenActive(!0),this.controllerToDeactivate&&(this.controllerToDeactivate.active=!1,this.setChildrenActive(!1,this.controllerToDeactivate)))}}setChildrenActive(e,n){n=n||this.object;let r=n.children;for(let s of r)s.active=e,this.setChildrenActive(e,s)}isGrabbing(){let e=[0,0,0];ne.getTranslation(e,this.joints["index-finger-tip"].transformLocal);let n=[0,0,0];return ne.getTranslation(n,this.joints["thumb-tip"].transformLocal),b.sqrDist(n,e)<.001}setupVREvents(e){this.session=e}};M(Bn,"TypeName","hand-tracking"),M(Bn,"Properties",{handedness:{type:P.Enum,default:"left",values:["left","right"]},jointMesh:{type:P.Mesh,default:null},jointMaterial:{type:P.Material,default:null},handSkin:{type:P.Skin,default:null},deactivateChildrenWithoutPose:{type:P.Bool,default:!0},controllerToDeactivate:{type:P.Object}});var Wg=Ze(ni(),1);var Xn=class extends O{init(){this.origin=new Float32Array(3),this.fwd=new Float32Array(3),this.up=new Float32Array(3)}update(){this.spatial&&(this.object.getTranslationWorld(this.origin),this.object.getForward(this.fwd),this.object.getUp(this.up),Howler.pos(this.origin[0],this.origin[1],this.origin[2]),Howler.orientation(this.fwd[0],this.fwd[1],this.fwd[2],this.up[0],this.up[1],this.up[2]))}};M(Xn,"TypeName","howler-audio-listener"),M(Xn,"Properties",{spatial:{type:P.Bool,default:!0}});var vo=Ze(ni(),1);var Yn=class extends O{start(){this.audio=new vo.Howl({src:[this.src],loop:this.loop,volume:this.volume,autoplay:this.autoplay}),this.lastPlayedAudioId=null,this.origin=new Float32Array(3),this.lastOrigin=new Float32Array(3),this.spatial&&this.autoplay&&(this.updatePosition(),this.play())}update(){!this.spatial||!this.lastPlayedAudioId||(this.object.getTranslationWorld(this.origin),(Math.abs(this.lastOrigin[0]-this.origin[0])>.005||Math.abs(this.lastOrigin[1]-this.origin[1])>.005||Math.abs(this.lastOrigin[2]-this.origin[2])>.005)&&this.updatePosition())}updatePosition(){this.audio.pos(this.origin[0],this.origin[1],this.origin[2],this.lastPlayedAudioId),this.lastOrigin.set(this.origin)}play(){this.lastPlayedAudioId&&this.audio.stop(this.lastPlayedAudioId),this.lastPlayedAudioId=this.audio.play(),this.spatial&&this.updatePosition()}stop(){this.lastPlayedAudioId&&(this.audio.stop(this.lastPlayedAudioId),this.lastPlayedAudioId=null)}onDeactivate(){this.stop()}};M(Yn,"TypeName","howler-audio-source"),M(Yn,"Properties",{volume:{type:P.Float,default:1},spatial:{type:P.Bool,default:!0},loop:{type:P.Bool,default:!1},autoplay:{type:P.Bool,default:!1},src:{type:P.String,default:""}});var Gn=class extends O{start(){if(!this.material)throw Error("image-texture: material property not set");this.engine.textures.load(this.url,"anonymous").then(e=>{let n=this.material,r=n.shader;r==="Flat Opaque Textured"?n.flatTexture=e:r==="Phong Opaque Textured"||r==="Foliage"?n.diffuseTexture=e:r==="Background"?n.texture=e:r==="Physical Opaque Textured"?n.albedoTexture=e:console.error("Shader",r,"not supported by image-texture")}).catch(console.err)}};M(Gn,"TypeName","image-texture"),M(Gn,"Properties",{url:{type:P.String},material:{type:P.Material}});var Qn=class extends O{init(){this.currentRotationY=0,this.currentRotationX=0,this.origin=new Float32Array(3),this.parentOrigin=new Float32Array(3),this.rotationX=0,this.rotationY=0}start(){document.addEventListener("mousemove",n=>{if(this.active&&(this.mouseDown||!this.requireMouseDown)){this.rotationY=-this.sensitity*n.movementX/100,this.rotationX=-this.sensitity*n.movementY/100,this.currentRotationX+=this.rotationX,this.currentRotationY+=this.rotationY,this.currentRotationX=Math.min(1.507,this.currentRotationX),this.currentRotationX=Math.max(-1.507,this.currentRotationX),this.object.getTranslationWorld(this.origin);let r=this.object.parent;r!==null&&(r.getTranslationWorld(this.parentOrigin),b.sub(this.origin,this.origin,this.parentOrigin)),this.object.resetTranslationRotation(),this.object.rotateAxisAngleRad([1,0,0],this.currentRotationX),this.object.rotateAxisAngleRad([0,1,0],this.currentRotationY),this.object.translate(this.origin)}});let e=this.engine.canvas;this.pointerLockOnClick&&e.addEventListener("mousedown",()=>{e.requestPointerLock=e.requestPointerLock||e.mozRequestPointerLock||e.webkitRequestPointerLock,e.requestPointerLock()}),this.requireMouseDown&&(this.mouseButtonIndex==2&&e.addEventListener("contextmenu",n=>{n.preventDefault()},!1),e.addEventListener("mousedown",n=>{if(n.button==this.mouseButtonIndex&&(this.mouseDown=!0,document.body.style.cursor="grabbing",n.button==1))return n.preventDefault(),!1}),e.addEventListener("mouseup",n=>{n.button==this.mouseButtonIndex&&(this.mouseDown=!1,document.body.style.cursor="initial")}))}};M(Qn,"TypeName","mouse-look"),M(Qn,"Properties",{sensitity:{type:P.Float,default:.25},requireMouseDown:{type:P.Bool,default:!0},mouseButtonIndex:{type:P.Int},pointerLockOnClick:{type:P.Bool,default:!1}});var $n=class extends O{start(){this.object.resetTranslationRotation(),this.object.translate([0,this.height,0]),this.onSessionStartCallback=this.onXRSessionStart.bind(this),this.onSessionEndCallback=this.onXRSessionEnd.bind(this)}onActivate(){this.engine.onXRSessionStart.add(this.onSessionStartCallback),this.engine.onXRSessionEnd.add(this.onSessionStartCallback)}onDeactivate(){this.engine.onXRSessionStart.remove(this.onSessionEndCallback),this.engine.onXRSessionEnd.remove(this.onSessionEndCallback)}onXRSessionStart(){["local","viewer"].includes(this.engine.xr.currentReferenceSpace)||this.object.resetTranslationRotation()}onXRSessionEnd(){["local","viewer"].includes(this.engine.xr.currentReferenceSpace)||(this.object.resetTranslationRotation(),this.object.translate([0,this.height,0]))}};M($n,"TypeName","player-height"),M($n,"Properties",{height:{type:P.Float,default:1.75}});var Zn=class extends O{start(){this.engine.xrSession?this.setTargetFramerate(this.engine.xrSession):this.engine.onXRSessionStart.push(this.setTargetFramerate.bind(this))}setTargetFramerate(e){if(e.supportedFrameRates&&e.updateTargetFrameRate){let n=this.engine.xrSession.supportedFrameRates;n.sort((r,s)=>Math.abs(r-this.framerate)-Math.abs(s-this.framerate)),this.engine.xrSession.updateTargetFrameRate(n[0])}}};M(Zn,"TypeName","target-framerate"),M(Zn,"Properties",{framerate:{type:P.Float,default:90}});var Jn=class extends O{init(){if(this._prevThumbstickAxis=new Float32Array(2),this._tempVec=new Float32Array(3),this._tempVec0=new Float32Array(3),this._currentIndicatorRotation=0,this.input=this.object.getComponent("input"),!this.input){console.error(this.object.name,"generic-teleport-component.js: input component is required on the object");return}if(!this.teleportIndicatorMeshObject){console.error(this.object.name,"generic-teleport-component.js: Teleport indicator mesh is missing");return}if(!this.camRoot){console.error(this.object.name,"generic-teleport-component.js: camRoot not set");return}this.isIndicating=!1,this.indicatorHidden=!0,this.hitSpot=new Float32Array(3),this._hasHit=!1,this._extraRotation=0,this._currentStickAxes=new Float32Array(2)}start(){if(this.cam&&(this.isMouseIndicating=!1,canvas.addEventListener("mousedown",this.onMouseDown.bind(this)),canvas.addEventListener("mouseup",this.onMouseUp.bind(this))),this.handedness==0){let e=this.object.getComponent("input");e?(this.handedness=e.handedness,this.input=e):console.warn("teleport component on object",this.object.name,'was configured with handedness "input component", but object has no input component.')}else this.handedness=["left","right"][this.handedness-1];this.engine.onXRSessionStart.push(this.setupVREvents.bind(this)),this.teleportIndicatorMeshObject.active=!1}_getCamRotation(){return this.eyeLeft.getForward(this._tempVec),this._tempVec[1]=0,b.normalize(this._tempVec,this._tempVec),Math.atan2(this._tempVec[0],this._tempVec[2])}update(){let e=0;if(this.gamepad&&this.gamepad.axes&&(this._currentStickAxes[0]=this.gamepad.axes[2],this._currentStickAxes[1]=this.gamepad.axes[3],e=Math.abs(this._currentStickAxes[0])+Math.abs(this._currentStickAxes[1])),!this.isIndicating&&this._prevThumbstickAxis[1]>=this.thumbstickActivationThreshhold&&this._currentStickAxes[1]<this.thumbstickActivationThreshhold?this.isIndicating=!0:this.isIndicating&&e<this.thumbstickDeactivationThreshhold&&(this.isIndicating=!1,this.teleportIndicatorMeshObject.active=!1,this._hasHit&&this._teleportPlayer(this.hitSpot,this._extraRotation)),this.isIndicating&&this.teleportIndicatorMeshObject&&this.input){let n=this._tempVec0;ne.getTranslation(n,this.object.transformWorld);let r=this.object.getForward(this._tempVec),s=this.rayHit=this.rayCastMode==0?this.engine.scene.rayCast(n,r,1<<this.floorGroup):this.engine.physics.rayCast(n,r,1<<this.floorGroup,this.maxDistance);s.hitCount>0?(this.indicatorHidden=!1,this._extraRotation=Math.PI+Math.atan2(this._currentStickAxes[0],this._currentStickAxes[1]),this._currentIndicatorRotation=this._getCamRotation()+(this._extraRotation-Math.PI),this.teleportIndicatorMeshObject.resetTranslationRotation(),this.teleportIndicatorMeshObject.rotateAxisAngleRad([0,1,0],this._currentIndicatorRotation),this.teleportIndicatorMeshObject.translate(s.locations[0]),this.teleportIndicatorMeshObject.translate([0,this.indicatorYOffset,0]),this.teleportIndicatorMeshObject.active=!0,this.hitSpot.set(s.locations[0]),this._hasHit=!0):(this.indicatorHidden||(this.teleportIndicatorMeshObject.active=!1,this.indicatorHidden=!0),this._hasHit=!1)}else this.teleportIndicatorMeshObject&&this.isMouseIndicating&&this.onMousePressed();this._prevThumbstickAxis.set(this._currentStickAxes)}setupVREvents(e){if(this.session=e,e.addEventListener("end",function(){this.gamepad=null,this.session=null}.bind(this)),e.inputSources&&e.inputSources.length)for(let n=0;n<e.inputSources.length;n++){let r=e.inputSources[n];r.handedness==this.handedness&&(this.gamepad=r.gamepad)}e.addEventListener("inputsourceschange",function(n){if(n.added&&n.added.length)for(let r=0;r<n.added.length;r++){let s=n.added[r];s.handedness==this.handedness&&(this.gamepad=s.gamepad)}}.bind(this))}onMouseDown(){this.isMouseIndicating=!0}onMouseUp(){this.isMouseIndicating=!1,this.teleportIndicatorMeshObject.active=!1,this._hasHit&&this._teleportPlayer(this.hitSpot,0)}onMousePressed(){let e=[0,0,0];ne.getTranslation(e,this.cam.transformWorld);let n=this.cam.getForward(this._tempVec),r=this.rayHit=this.rayCastMode==0?this.engine.scene.rayCast(e,n,1<<this.floorGroup):this.engine.physics.rayCast(e,n,1<<this.floorGroup,this.maxDistance);r.hitCount>0?(this.indicatorHidden=!1,n[1]=0,b.normalize(n,n),this._currentIndicatorRotation=-Math.sign(n[2])*Math.acos(n[0])-Math.PI*.5,this.teleportIndicatorMeshObject.resetTranslationRotation(),this.teleportIndicatorMeshObject.rotateAxisAngleRad([0,1,0],this._currentIndicatorRotation),this.teleportIndicatorMeshObject.translate(r.locations[0]),this.teleportIndicatorMeshObject.active=!0,this.hitSpot=r.locations[0],this._hasHit=!0):(this.indicatorHidden||(this.teleportIndicatorMeshObject.active=!1,this.indicatorHidden=!0),this._hasHit=!1)}_teleportPlayer(e,n){this.camRoot.rotateAxisAngleRad([0,1,0],n);let r=this._tempVec,s=this._tempVec0;this.session?(this.eyeLeft.getTranslationWorld(r),this.eyeRight.getTranslationWorld(s),b.add(r,r,s),b.scale(r,r,.5)):this.cam.getTranslationWorld(r),this.camRoot.getTranslationWorld(s),b.sub(r,s,r),r[0]+=e[0],r[1]=e[1],r[2]+=e[2],this.camRoot.setTranslationWorld(r)}};M(Jn,"TypeName","teleport"),M(Jn,"Properties",{teleportIndicatorMeshObject:{type:P.Object},camRoot:{type:P.Object},cam:{type:P.Object},eyeLeft:{type:P.Object},eyeRight:{type:P.Object},handedness:{type:P.Enum,values:["input component","left","right","none"],default:"input component"},floorGroup:{type:P.Int,default:1},thumbstickActivationThreshhold:{type:P.Float,default:-.7},thumbstickDeactivationThreshhold:{type:P.Float,default:.3},indicatorYOffset:{type:P.Float,default:.01},rayCastMode:{type:P.Enum,values:["collision","physx"],default:"collision"},maxDistance:{type:P.Float,default:100}});var Kn=b.create(),ce=b.create(),Kt=b.create(),er=class extends O{init(){this.points=new Array(this.segments+1);for(let e=0;e<this.points.length;++e)this.points[e]=b.create();this.currentPointOffset=0,this.up=[0,1,0],this.timeTillNext=this.interval}start(){this.trailContainer=this.engine.scene.addObject(),this.meshComp=this.trailContainer.addComponent("mesh"),this.meshComp.material=this.material;let e=2*this.points.length;this.indexData=new Uint32Array(6*this.segments);for(let n=0,r=0;n<e-2;n+=2,r+=6)this.indexData.subarray(r,r+6).set([n+1,n+0,n+2,n+2,n+3,n+1]);this.mesh=new Ct(this.engine,{vertexCount:e,indexData:this.indexData,indexType:ve.UnsignedInt}),this.meshComp.mesh=this.mesh}updateVertices(){let e=this.mesh.attribute(Ge.Position),n=this.mesh.attribute(Ge.TextureCoordinate),r=this.mesh.attribute(Ge.Normal);b.set(Kn,0,0,0);for(let s=0;s<this.points.length;++s){let a=this.points[(this.currentPointIndex+s+1)%this.points.length],l=this.points[(this.currentPointIndex+s+2)%this.points.length];s!==this.points.length-1&&b.sub(Kn,l,a),b.cross(ce,this.up,Kn),b.normalize(ce,ce);let c=1-this.timeTillNext/this.interval,h=(s-c)/this.segments;b.scale(ce,ce,(this.taper?h:1)*this.width/2),e.set(s*2,[a[0]-ce[0],a[1]-ce[1],a[2]-ce[2]]),e.set(s*2+1,[a[0]+ce[0],a[1]+ce[1],a[2]+ce[2]]),r&&(b.cross(Kt,Kn,ce),b.normalize(Kt,Kt),r.set(s*2,Kt),r.set(s*2+1,Kt)),n&&(n.set(s*2,[0,h]),n.set(s*2+1,[1,h]))}this.mesh.update()}resetTrail(){this.object.getTranslationWorld(this.points[0]);for(let e=1;e<this.points.length;++e)b.copy(this.points[e],this.points[0]);this.currentPointIndex=0,this.timeTillNext=this.interval}update(e){this.timeTillNext-=e,e>this.resetThreshold&&this.resetTrail(),this.timeTillNext<0&&(this.currentPointIndex=(this.currentPointIndex+1)%this.points.length,this.timeTillNext=this.timeTillNext%this.interval+this.interval),this.object.getTranslationWorld(this.points[this.currentPointIndex]),this.updateVertices()}onActivate(){this.resetTrail()}onDestroy(){this.trailContainer.destroy(),this.mesh.destroy()}};M(er,"TypeName","trail"),M(er,"Properties",{material:{type:P.Material},segments:{type:P.Int,default:50},interval:{type:P.Float,default:.1},width:{type:P.Float,default:1},taper:{type:P.Bool,default:!0},resetThreshold:{type:P.Float,default:.5}});Math.clamp=function(t,e,n){return Math.max(e,Math.min(t,n))};var Gd=function(){let t=new Float32Array(3),e=new Float32Array(3),n=new Float32Array(3),r=new Float32Array(3),s=new Float32Array(3),a=new Float32Array(3),l=new Float32Array(3),c=new Float32Array(4),h=new Float32Array(4),d=new Float32Array(4),i=new Float32Array(4);return function(o,_,m,u,g,f,w,v,x,T){b.sub(n,u,m);let A=b.length(n);b.sub(t,u,g);let S=b.length(t);b.sub(t,f,m);let F=Math.clamp(b.length(t),w,A+S-w);b.sub(e,g,m),b.sub(r,m,u),b.sub(s,g,u),b.normalize(e,e),b.normalize(n,n),b.normalize(r,r),b.normalize(s,s),b.normalize(t,t);let E=Math.acos(Math.clamp(b.dot(e,n),-1,1)),D=Math.acos(Math.clamp(b.dot(r,s),-1,1)),z=Math.acos(Math.clamp(b.dot(e,t),-1,1)),V=Math.acos(Math.clamp((S*S-A*A-F*F)/(-2*A*F),-1,1)),U=Math.acos(Math.clamp((F*F-A*A-S*S)/(-2*A*S),-1,1));b.sub(e,g,m),b.sub(n,u,m),b.sub(t,f,m),b.cross(a,e,n),b.cross(l,e,t),T?(b.sub(n,T,u),b.transformQuat(n,[0,0,-1],x)):b.sub(n,u,m);let L=b.length(a);L==0?a.set([1,0,0]):b.scale(a,a,1/L),b.normalize(l,l),k.conjugate(v,v),k.setAxisAngle(h,b.transformQuat(c,a,v),V-E),k.setAxisAngle(i,b.transformQuat(c,l,v),z),k.mul(o,o,k.mul(c,h,i)),k.normalize(o,o),k.conjugate(x,x),k.setAxisAngle(d,b.transformQuat(c,a,x),U-D),k.mul(_,_,d),k.normalize(_,_)}}(),tr=class extends O{init(){this.pos=new Float32Array(3*7),this.p=[this.pos.subarray(0,3),this.pos.subarray(3,6),this.pos.subarray(6,9),this.pos.subarray(9,12),this.pos.subarray(12,15),this.pos.subarray(15,18),this.pos.subarray(18,21)]}update(){let e=this.p;this.root.getTranslationWorld(e[0]),this.middle.getTranslationWorld(e[1]),this.end.getTranslationWorld(e[2]),this.target.getTranslationWorld(e[3]);let n=e[4],r=e[5];this.root.getTranslationLocal(n),this.middle.getTranslationLocal(r),this.helper&&this.helper.getTranslationWorld(e[6]),Gd(this.root.transformLocal,this.middle.transformLocal,e[0],e[1],e[2],e[3],.01,this.root.transformWorld.subarray(0,4),this.middle.transformWorld.subarray(0,4),this.helper?e[6]:null),this.root.setTranslationLocal(n),this.middle.setTranslationLocal(r),this.root.setDirty(),this.middle.setDirty()}};M(tr,"TypeName","two-joint-ik-solver"),M(tr,"Properties",{root:{type:P.Object},middle:{type:P.Object},end:{type:P.Object},target:{type:P.Object},helper:{type:P.Object}});var nr=class extends O{init(){if(!this.material)throw Error("video-texture: material property not set");this.loaded=!1,this.frameUpdateRequested=!0}start(){if(this.video=document.createElement("video"),this.video.src=this.url,this.video.crossOrigin="anonymous",this.video.playsInline=!0,this.video.loop=this.loop,this.video.muted=this.muted,this.video.addEventListener("playing",()=>{this.loaded=!0}),this.autoplay){let e=()=>{this.video.play(),window.removeEventListener("click",e),window.removeEventListener("touchstart",e)};window.addEventListener("click",e),window.addEventListener("touchstart",e)}}applyTexture(){let e=this.material,n=e.shader,r=this.texture=new Qe(this.engine,this.video);n==="Flat Opaque Textured"?e.flatTexture=r:n==="Phong Opaque Textured"||n==="Foliage"?e.diffuseTexture=r:n==="Background"?e.texture=r:n==="Physical Opaque Textured"?e.albedoTexture=r:console.error("Shader",n,"not supported by video-texture"),"requestVideoFrameCallback"in this.video?this.video.requestVideoFrameCallback(this.updateVideo.bind(this)):this.video.addEventListener("timeupdate",()=>{this.frameUpdateRequested=!0})}update(e){this.loaded&&this.frameUpdateRequested&&(this.texture?this.texture.update():this.applyTexture(),this.frameUpdateRequested=!1)}updateVideo(){this.frameUpdateRequested=!0,this.video.requestVideoFrameCallback(this.updateVideo.bind(this))}};M(nr,"TypeName","video-texture"),M(nr,"Properties",{url:{type:P.String},material:{type:P.Material},loop:{type:P.Bool,default:!0},autoplay:{type:P.Bool,default:!0},muted:{type:P.Bool,default:!0}});var rr=class extends O{start(){this.components=[],this.getComponents(this.object),this.onXRSessionEnd(),this.engine.onXRSessionStart.push(this.onXRSessionStart.bind(this)),this.engine.onXRSessionEnd.push(this.onXRSessionEnd.bind(this))}getComponents(e){let n=e.getComponents().filter(r=>r.type!=="vr-mode-active-switch");if(this.components=this.components.concat(n),this.affectChildren){let r=e.children;for(let s=0;s<r.length;++s)this.getComponents(r[s])}}setComponentsActive(e){let n=this.components;for(let r=0;r<n.length;++r)n[r].active=e}onXRSessionStart(){this.active&&this.setComponentsActive(this.activateComponents==0)}onXRSessionEnd(){this.active&&this.setComponentsActive(this.activateComponents!=0)}};M(rr,"TypeName","vr-mode-active-switch"),M(rr,"Properties",{activateComponents:{type:P.Enum,values:["in VR","in non-VR"],default:"in VR"},affectChildren:{type:P.Bool,default:!0}});var Qd={X:[1,0,0],Y:[0,1,0],Z:[0,0,1]},$d={PositiveX:[1,0,0],NegativeX:[-1,0,0],PositiveY:[0,1,0],NegativeY:[0,-1,0],PositiveZ:[0,0,1],NegativeZ:[0,0,-1]},ir=class extends O{meta=null;bones={hips:null,spine:null,chest:null,upperChest:null,neck:null,head:null,leftEye:null,rightEye:null,jaw:null,leftUpperLeg:null,leftLowerLeg:null,leftFoot:null,leftToes:null,rightUpperLeg:null,rightLowerLeg:null,rightFoot:null,rightToes:null,leftShoulder:null,leftUpperArm:null,leftLowerArm:null,leftHand:null,rightShoulder:null,rightUpperArm:null,rightLowerArm:null,rightHand:null,leftThumbMetacarpal:null,leftThumbProximal:null,leftThumbDistal:null,leftIndexProximal:null,leftIndexIntermediate:null,leftIndexDistal:null,leftMiddleProximal:null,leftMiddleIntermediate:null,leftMiddleDistal:null,leftRingProximal:null,leftRingIntermediate:null,leftRingDistal:null,leftLittleProximal:null,leftLittleIntermediate:null,leftLittleDistal:null,rightThumbMetacarpal:null,rightThumbProximal:null,rightThumbDistal:null,rightIndexProximal:null,rightIndexIntermediate:null,rightIndexDistal:null,rightMiddleProximal:null,rightMiddleIntermediate:null,rightMiddleDistal:null,rightRingProximal:null,rightRingIntermediate:null,rightRingDistal:null,rightLittleProximal:null,rightLittleIntermediate:null,rightLittleDistal:null};restPose={};_nodeConstraints=[];_springChains=[];_sphereColliders=[];_capsuleColliders=[];_firstPersonAnnotations=[];_lookAt=null;_initialized=!1;init(){this._tempV3=b.create(),this._tempV3A=b.create(),this._tempV3B=b.create(),this._tempQuat=k.create(),this._tempQuatA=k.create(),this._tempQuatB=k.create(),this._tempMat4A=ze.create(),this._tempQuat2=ne.create(),this._tailToShape=b.create(),this._headToTail=b.create(),this._inertia=b.create(),this._stiffness=b.create(),this._external=b.create(),this._rightVector=b.set(b.create(),1,0,0),this._upVector=b.set(b.create(),0,1,0),this._forwardVector=b.set(b.create(),0,0,1),this._identityQuat=k.identity(k.create()),this._rad2deg=180/Math.PI}start(){if(!this.src){console.error("vrm: src property not set");return}this.engine.scene.append(this.src,{loadGltfExtensions:!0}).then(({root:e,extensions:n})=>{e.children.forEach(r=>r.parent=this.object),this._initializeVrm(n),e.destroy()})}_initializeVrm(e){if(this._initialized)throw Error("VRM component has already been initialized");let n=e.root.VRMC_vrm;if(!n)throw Error("Missing VRM extensions");if(n.specVersion!=="1.0")throw Error(`Unsupported VRM version, only 1.0 is supported, but encountered '${n.specVersion}'`);this.meta=n.meta,this._parseHumanoid(n.humanoid,e),n.firstPerson&&this._parseFirstPerson(n.firstPerson,e),n.lookAt&&this._parseLookAt(n.lookAt),this._findAndParseNodeConstraints(e);let r=e.root.VRMC_springBone;r&&this._parseAndInitializeSpringBones(r,e),this._initialized=!0}_parseHumanoid(e,n){for(let r in e.humanBones){if(!(r in this.bones)){console.warn(`Unrecognized bone '${r}'`);continue}let s=e.humanBones[r].node,a=n.idMapping[s];this.bones[r]=this.engine.wrapObject(a),this.restPose[r]=k.copy(k.create(),this.bones[r].rotationLocal)}}_parseFirstPerson(e,n){for(let r of e.meshAnnotations){let s={node:this.engine.wrapObject(n.idMapping[r.node]),firstPerson:!0,thirdPerson:!0};switch(r.type){case"firstPersonOnly":s.thirdPerson=!1;break;case"thirdPersonOnly":s.firstPerson=!1;break;case"both":break;case"auto":console.warn("First person mesh annotation type 'auto' is not supported, treating as 'both'!");break;default:console.error(`Invalid mesh annotation type '${r.type}'`);break}this._firstPersonAnnotations.push(s)}}_parseLookAt(e){if(e.type!=="bone"){console.warn(`Unsupported lookAt type '${e.type}', only 'bone' is supported`);return}let n=r=>({inputMaxValue:r.inputMaxValue,outputScale:r.outputScale});this._lookAt={offsetFromHeadBone:e.offsetFromHeadBone||[0,0,0],horizontalInner:n(e.rangeMapHorizontalInner),horizontalOuter:n(e.rangeMapHorizontalOuter),verticalDown:n(e.rangeMapVerticalDown),verticalUp:n(e.rangeMapVerticalUp)}}_findAndParseNodeConstraints(e){let n=r=>{let s=e.node[r.objectId];if(s&&"VRMC_node_constraint"in s){let l=s.VRMC_node_constraint.constraint,c,h;if("roll"in l?(c="roll",h=Qd[l.roll.rollAxis]):"aim"in l?(c="aim",h=$d[l.aim.aimAxis]):"rotation"in l&&(c="rotation"),c){let d=this.engine.wrapObject(e.idMapping[l[c].source]);this._nodeConstraints.push({type:c,source:d,destination:r,axis:h,weight:l[c].weight,destinationRestLocalRotation:k.copy(k.create(),r.rotationLocal),sourceRestLocalRotation:k.copy(k.create(),d.rotationLocal),sourceRestLocalRotationInv:k.invert(k.create(),d.rotationLocal)})}else console.warn("Unrecognized or invalid VRMC_node_constraint, ignoring it")}for(let a of r.children)n(a)};n(this.object)}_parseAndInitializeSpringBones(e,n){let r=(e.colliders||[]).map((a,l)=>{let c="capsule"in a.shape?"capsule":"sphere";return{id:l,object:this.engine.wrapObject(n.idMapping[a.node]),shape:{isCapsule:c==="capsule",radius:a.shape[c].radius,offset:a.shape[c].offset,tail:a.shape[c].tail},cache:{head:b.create(),tail:b.create()}}});this._sphereColliders=r.filter(a=>!a.shape.isCapsule),this._capsuleColliders=r.filter(a=>a.shape.isCapsule);let s=(e.colliderGroups||[]).map(a=>({name:a.name,colliders:a.colliders.map(l=>r[l])}));for(let a of e.springs){let l=[];for(let h of a.joints){let d={hitRadius:0,stiffness:1,gravityPower:0,gravityDir:[0,-1,0],dragForce:.5,node:null,state:null};Object.assign(d,h),d.node=this.engine.wrapObject(n.idMapping[d.node]),l.push(d)}let c=(a.colliderGroups||[]).flatMap(h=>s[h].colliders);this._springChains.push({name:a.name,center:a.center?this.engine.wrapObject(n.idMapping[a.center]):null,joints:l,sphereColliders:c.filter(h=>!h.shape.isCapsule),capsuleColliders:c.filter(h=>h.shape.isCapsule)})}for(let a of this._springChains)for(let l=0;l<a.joints.length-1;++l){let c=a.joints[l],h=a.joints[l+1],d=c.node.getTranslationWorld(b.create()),i=h.node.getTranslationWorld(b.create()),o=b.subtract(this._tempV3A,d,i),_={prevTail:i,currentTail:b.copy(b.create(),i),initialLocalRotation:k.copy(k.create(),c.node.rotationLocal),initialLocalTransformInvert:ne.invert(ne.create(),c.node.transformLocal),boneAxis:b.normalize(b.create(),h.node.getTranslationLocal(this._tempV3)),boneLength:Math.max(.01,b.length(o)),prevTailCenter:null,currentTailCenter:null};a.center&&(_.prevTailCenter=a.center.transformPointInverseWorld(b.create(),i),_.currentTailCenter=b.copy(b.create(),i)),c.state=_}}update(e){this._initialized&&(this._resolveLookAt(),this._resolveConstraints(),this._updateSpringBones(e))}_rangeMap(e,n){let r=e.inputMaxValue,s=e.outputScale;return Math.min(n,r)/r*s}_resolveLookAt(){if(!this._lookAt||!this.lookAtTarget)return;let e=this.bones.head.transformPointWorld(this._tempV3A,this._lookAt.offsetFromHeadBone),n=this.lookAtTarget.getTranslationWorld(this._tempV3B),r=b.sub(this._tempV3A,n,e);b.normalize(r,r),this.bones.head.parent.transformVectorInverseWorld(r);let s=b.dot(r,this._forwardVector),a=b.dot(r,this._rightVector),l=Math.atan2(a,s)*this._rad2deg,c=Math.sqrt(a*a+s*s),h=b.dot(r,this._upVector),d=Math.atan2(-h,c)*this._rad2deg;if(d>0?d=this._rangeMap(this._lookAt.verticalDown,d):d=-this._rangeMap(this._lookAt.verticalUp,-d),this.bones.leftEye){let i=l;i>0?i=this._rangeMap(this._lookAt.horizontalInner,i):i=-this._rangeMap(this._lookAt.horizontalOuter,-i);let o=k.fromEuler(this._tempQuatA,d,i,0);this.bones.leftEye.rotationLocal=k.multiply(o,this.restPose.leftEye,o)}if(this.bones.rightEye){let i=l;i>0?i=this._rangeMap(this._lookAt.horizontalOuter,i):i=-this._rangeMap(this._lookAt.horizontalInner,-i);let o=k.fromEuler(this._tempQuatA,d,i,0);this.bones.rightEye.rotationLocal=k.multiply(o,this.restPose.rightEye,o)}}_resolveConstraints(){for(let e of this._nodeConstraints)this._resolveConstraint(e)}_resolveConstraint(e){let n=e.destinationRestLocalRotation,r=e.sourceRestLocalRotationInv,s=k.identity(this._tempQuatA);switch(e.type){case"roll":{let a=k.multiply(this._tempQuatA,r,e.source.rotationLocal),l=k.multiply(this._tempQuatA,e.sourceRestLocalRotation,a);k.mul(l,l,r);let c=k.invert(this._tempQuatB,n),h=k.multiply(this._tempQuatB,c,l);k.multiply(h,h,n);let d=b.transformQuat(this._tempV3A,e.axis,h),i=k.rotationTo(this._tempQuatA,e.axis,d);k.mul(s,n,k.invert(this._tempQuat,i)),k.mul(s,s,h)}break;case"aim":{let a=e.destination.parent.rotationWorld,l=b.transformQuat(this._tempV3A,e.axis,n);b.transformQuat(l,l,a);let c=e.source.getTranslationWorld(this._tempV3B);b.sub(c,c,e.destination.getTranslationWorld(this._tempV3)),b.normalize(c,c);let h=k.rotationTo(this._tempQuatA,l,c);k.mul(s,k.invert(this._tempQuat,a),h),k.mul(s,s,a),k.mul(s,s,n)}break;case"rotation":{let a=k.mul(s,r,e.source.rotationLocal);k.mul(s,n,a)}break}k.slerp(s,n,s,e.weight),e.destination.rotationLocal=s}_updateSpringBones(e){this._sphereColliders.forEach(({object:n,shape:r,cache:s})=>{let a=b.copy(s.head,r.offset);n.transformVectorWorld(a),b.add(s.head,n.getTranslationWorld(this._tempV3),a)}),this._capsuleColliders.forEach(({object:n,shape:r,cache:s})=>{let a=n.getTranslationWorld(this._tempV3A),l=b.copy(s.head,r.offset);n.transformVectorWorld(l),b.add(s.head,a,l);let c=b.copy(s.tail,r.tail);n.transformVectorWorld(c),b.add(s.tail,a,c)}),this._springChains.forEach(n=>{for(let r=0;r<n.joints.length-1;++r){let s=n.joints[r],a=s.node.parent?s.node.parent.rotationWorld:this._identityQuat,l=this._inertia;n.center?(b.sub(l,s.state.currentTailCenter,s.state.prevTailCenter),n.center.transformVectorWorld(l)):b.sub(l,s.state.currentTail,s.state.prevTail),b.scale(l,l,1-s.dragForce);let c=b.copy(this._stiffness,s.state.boneAxis);b.transformQuat(c,c,s.state.initialLocalRotation),b.transformQuat(c,c,a),b.scale(c,c,e*s.stiffness);let h=b.scale(this._external,s.gravityDir,e*s.gravityPower),d=b.copy(this._tempV3A,s.state.currentTail);b.add(d,d,l),b.add(d,d,c),b.add(d,d,h);let i=s.node.getTranslationWorld(this._tempV3B);b.sub(d,d,i),b.normalize(d,d),b.scaleAndAdd(d,i,d,s.state.boneLength);for(let{shape:m,cache:u}of n.sphereColliders){let g=this._tailToShape,f=u.head;g=b.sub(g,d,f);let w=m.radius+s.hitRadius,v=b.length(g)-w;v<0&&(b.normalize(g,g),b.scaleAndAdd(d,d,g,-v),b.sub(d,d,i),b.normalize(d,d),b.scaleAndAdd(d,i,d,s.state.boneLength))}for(let{shape:m,cache:u}of n.capsuleColliders){let g=this._tailToShape,f=u.head,w=u.tail;g=b.sub(g,d,f);let v=b.sub(this._headToTail,w,f),x=b.dot(v,g);b.squaredLength(v)<=x?b.sub(g,d,w):x>0&&(b.scale(v,v,x/b.squaredLength(v)),b.sub(g,g,v));let T=m.radius+s.hitRadius,A=b.length(g)-T;A<0&&(b.normalize(g,g),b.scaleAndAdd(d,d,g,-A),b.sub(d,d,i),b.normalize(d,d),b.scaleAndAdd(d,i,d,s.state.boneLength))}b.copy(s.state.prevTail,s.state.currentTail),b.copy(s.state.currentTail,d),n.center&&(b.copy(s.state.prevTailCenter,s.state.currentTailCenter),b.copy(s.state.currentTailCenter,d),n.center.transformPointInverseWorld(s.state.currentTailCenter)),s.node.parent.transformPointInverseWorld(d);let o=ne.fromTranslation(this._tempQuat2,d);ne.multiply(o,s.state.initialLocalTransformInvert,o),ne.getTranslation(d,o),b.normalize(d,d);let _=k.rotationTo(this._tempQuatA,s.state.boneAxis,d);s.node.rotationLocal=k.mul(this._tempQuatA,s.state.initialLocalRotation,_)}})}set firstPerson(e){this._firstPersonAnnotations.forEach(n=>{let r=e==n.firstPerson||e!=n.thirdPerson;n.node.getComponents("mesh").forEach(s=>{s.active=r})})}};M(ir,"TypeName","vrm"),M(ir,"Properties",{src:{type:P.String},lookAtTarget:{type:P.Object}});var sr=class extends O{init(){this.up=!1,this.right=!1,this.down=!1,this.left=!1,window.addEventListener("keydown",this.press.bind(this)),window.addEventListener("keyup",this.release.bind(this))}start(){this.headObject=this.headObject||this.object}update(){let e=[0,0,0];this.up&&(e[2]-=1),this.down&&(e[2]+=1),this.left&&(e[0]-=1),this.right&&(e[0]+=1),b.normalize(e,e),e[0]*=this.speed,e[2]*=this.speed,b.transformQuat(e,e,this.headObject.transformWorld),this.object.translate(e)}press(e){e.keyCode===38||e.keyCode===87||e.keyCode===90?this.up=!0:e.keyCode===39||e.keyCode===68?this.right=!0:e.keyCode===40||e.keyCode===83?this.down=!0:(e.keyCode===37||e.keyCode===65||e.keyCode===81)&&(this.left=!0)}release(e){e.keyCode===38||e.keyCode===87||e.keyCode===90?this.up=!1:e.keyCode===39||e.keyCode===68?this.right=!1:e.keyCode===40||e.keyCode===83?this.down=!1:(e.keyCode===37||e.keyCode===65||e.keyCode===81)&&(this.left=!1)}};M(sr,"TypeName","wasd-controls"),M(sr,"Properties",{speed:{type:P.Float,default:.1},headObject:{type:P.Object}});console.log("Zesty SDK Version: ",ba);var kt=class extends O{init(){this.formats=Object.values(Yt),this.formatKeys=Object.keys(Yt),this.styleKeys=["standard","minimal","transparent"]}start(){if(this.mesh=this.object.getComponent(Se),!this.mesh)throw new Error("'zesty-banner ' missing mesh component");if(this.createAutomaticCollision&&(this.collision=this.object.getComponent(be)||this.object.addComponent(be,{collider:Sn.Box,group:2}),this.cursorTarget=this.object.getComponent(ie)||this.object.addComponent(ie),this.cursorTarget.addClickFunction(this.onClick.bind(this))),this.dynamicFormats){let e=document.createElement("script");e.onload=()=>{this.formatsOverride=zestyFormats.formats,this.startLoading()},e.setAttribute("src","https://ipfs.io/ipns/lib.zesty.market/zesty-formats.js"),e.setAttribute("crossorigin","anonymous"),document.body.appendChild(e)}else this.startLoading()}startLoading(){this.loadBanner(this.space,this.formatKeys[this.format],this.styleKeys[this.style]).then(e=>{this.banner=e,this.scaleToRatio&&(this.height=this.object.scalingLocal[1],this.object.resetScaling(),this.createAutomaticCollision&&(this.collision.extents=[this.formats[this.format].width*this.height,this.height,.1]),this.object.scale([this.formats[this.format].width*this.height,this.height,1]));let n=this.mesh.material.clone();if(this.textureProperty==="auto"){let r=n.shader;if(r==="Phong Opaque Textured")n.diffuseTexture=e.texture,n.alphaMaskThreshold=.3;else if(r==="Flat Opaque Textured")n.flatTexture=e.texture,n.alphaMaskThreshold=.8;else throw Error("'zesty-banner' unable to apply banner texture: unsupported pipeline "+r);this.mesh.material=n,this.mesh.material.alphaMaskTexture=e.texture}else this.mesh.material[this.textureProperty]=e.texture,this.mesh.material.alphaMaskTexture=e.texture;this.beacon&&xa(this.space)})}onClick(){this.banner?.url&&(this.engine.xrSession?this.engine.xrSession.end().then(this.executeClick.bind(this)):this.executeClick())}executeClick(){ua(this.banner.url),this.beacon&&ya(this.space)}async loadBanner(e,n,r){let s=await va(e,n,r),{asset_url:a,cta_url:l}=s.Ads[0];return this.engine.textures.load(a,"").then(c=>({texture:c,imageSrc:a,url:l,campaignId:s.CampaignId}))}};M(kt,"TypeName","zesty-banner"),M(kt,"Properties",{space:oe.int(),format:oe.enum(["tall","wide","square"],"square"),style:oe.enum(["standard","minimal","transparent"],"transparent"),scaleToRatio:oe.bool(!0),textureProperty:oe.string("auto"),assignAlphaMaskTexture:oe.bool(!0),beacon:oe.bool(!0),dynamicFormats:oe.bool(!0),createAutomaticCollision:oe.bool(!0)});WL.registerComponent(nt,it,se,st,at,ot,lt,ct,_t,ht,pt,dt,mt,ft,ut,gt,wt,vt,xt,yt,bt,Mt);WL.registerComponent(kt);})();
/*! Bundled license information:

howler/dist/howler.js:
  (*!
   *  howler.js v2.2.3
   *  howlerjs.com
   *
   *  (c) 2013-2020, James Simpson of GoldFire Studios
   *  goldfirestudios.com
   *
   *  MIT License
   *)
  (*!
   *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
   *  
   *  howler.js v2.2.3
   *  howlerjs.com
   *
   *  (c) 2013-2020, James Simpson of GoldFire Studios
   *  goldfirestudios.com
   *
   *  MIT License
   *)

howler/dist/howler.js:
  (*!
   *  howler.js v2.2.3
   *  howlerjs.com
   *
   *  (c) 2013-2020, James Simpson of GoldFire Studios
   *  goldfirestudios.com
   *
   *  MIT License
   *)
  (*!
   *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
   *  
   *  howler.js v2.2.3
   *  howlerjs.com
   *
   *  (c) 2013-2020, James Simpson of GoldFire Studios
   *  goldfirestudios.com
   *
   *  MIT License
   *)
*/
//# sourceMappingURL=Wonderland Test-bundle.js.map
