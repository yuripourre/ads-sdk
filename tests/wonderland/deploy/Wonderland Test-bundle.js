(()=>{var bo=Object.create;var an=Object.defineProperty;var Mo=Object.getOwnPropertyDescriptor;var Ao=Object.getOwnPropertyNames;var To=Object.getPrototypeOf,jo=Object.prototype.hasOwnProperty;var So=(t,e,n)=>e in t?an(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Y=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Ie=(t,e)=>{for(var n in e)an(t,n,{get:e[n],enumerable:!0})},Po=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of Ao(e))!jo.call(t,s)&&s!==n&&an(t,s,{get:()=>e[s],enumerable:!(r=Mo(e,s))||r.enumerable});return t};var tt=(t,e,n)=>(n=t!=null?bo(To(t)):{},Po(e||!t||!t.__esModule?an(n,"default",{value:t,enumerable:!0}):n,t));var M=(t,e,n)=>(So(t,typeof e!="symbol"?e+"":e,n),n);var yr=Y(xn=>{(function(){"use strict";var t=function(){this.init()};t.prototype={init:function(){var i=this||e;return i._counter=1e3,i._html5AudioPool=[],i.html5PoolSize=10,i._codecs={},i._howls=[],i._muted=!1,i._volume=1,i._canPlayEvent="canplaythrough",i._navigator=typeof window<"u"&&window.navigator?window.navigator:null,i.masterGain=null,i.noAudio=!1,i.usingWebAudio=!0,i.autoSuspend=!0,i.ctx=null,i.autoUnlock=!0,i._setup(),i},volume:function(i){var o=this||e;if(i=parseFloat(i),o.ctx||d(),typeof i<"u"&&i>=0&&i<=1){if(o._volume=i,o._muted)return o;o.usingWebAudio&&o.masterGain.gain.setValueAtTime(i,e.ctx.currentTime);for(var _=0;_<o._howls.length;_++)if(!o._howls[_]._webAudio)for(var m=o._howls[_]._getSoundIds(),u=0;u<m.length;u++){var g=o._howls[_]._soundById(m[u]);g&&g._node&&(g._node.volume=g._volume*i)}return o}return o._volume},mute:function(i){var o=this||e;o.ctx||d(),o._muted=i,o.usingWebAudio&&o.masterGain.gain.setValueAtTime(i?0:o._volume,e.ctx.currentTime);for(var _=0;_<o._howls.length;_++)if(!o._howls[_]._webAudio)for(var m=o._howls[_]._getSoundIds(),u=0;u<m.length;u++){var g=o._howls[_]._soundById(m[u]);g&&g._node&&(g._node.muted=i?!0:g._muted)}return o},stop:function(){for(var i=this||e,o=0;o<i._howls.length;o++)i._howls[o].stop();return i},unload:function(){for(var i=this||e,o=i._howls.length-1;o>=0;o--)i._howls[o].unload();return i.usingWebAudio&&i.ctx&&typeof i.ctx.close<"u"&&(i.ctx.close(),i.ctx=null,d()),i},codecs:function(i){return(this||e)._codecs[i.replace(/^x-/,"")]},_setup:function(){var i=this||e;if(i.state=i.ctx&&i.ctx.state||"suspended",i._autoSuspend(),!i.usingWebAudio)if(typeof Audio<"u")try{var o=new Audio;typeof o.oncanplaythrough>"u"&&(i._canPlayEvent="canplay")}catch{i.noAudio=!0}else i.noAudio=!0;try{var o=new Audio;o.muted&&(i.noAudio=!0)}catch{}return i.noAudio||i._setupCodecs(),i},_setupCodecs:function(){var i=this||e,o=null;try{o=typeof Audio<"u"?new Audio:null}catch{return i}if(!o||typeof o.canPlayType!="function")return i;var _=o.canPlayType("audio/mpeg;").replace(/^no$/,""),m=i._navigator?i._navigator.userAgent:"",u=m.match(/OPR\/([0-6].)/g),g=u&&parseInt(u[0].split("/")[1],10)<33,f=m.indexOf("Safari")!==-1&&m.indexOf("Chrome")===-1,w=m.match(/Version\/(.*?) /),v=f&&w&&parseInt(w[1],10)<15;return i._codecs={mp3:!!(!g&&(_||o.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!_,opus:!!o.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!o.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!o.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(o.canPlayType('audio/wav; codecs="1"')||o.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!o.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!o.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(o.canPlayType("audio/x-m4a;")||o.canPlayType("audio/m4a;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(o.canPlayType("audio/x-m4b;")||o.canPlayType("audio/m4b;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(o.canPlayType("audio/x-mp4;")||o.canPlayType("audio/mp4;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!v&&o.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!v&&o.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!o.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(o.canPlayType("audio/x-flac;")||o.canPlayType("audio/flac;")).replace(/^no$/,"")},i},_unlockAudio:function(){var i=this||e;if(!(i._audioUnlocked||!i.ctx)){i._audioUnlocked=!1,i.autoUnlock=!1,!i._mobileUnloaded&&i.ctx.sampleRate!==44100&&(i._mobileUnloaded=!0,i.unload()),i._scratchBuffer=i.ctx.createBuffer(1,1,22050);var o=function(_){for(;i._html5AudioPool.length<i.html5PoolSize;)try{var m=new Audio;m._unlocked=!0,i._releaseHtml5Audio(m)}catch{i.noAudio=!0;break}for(var u=0;u<i._howls.length;u++)if(!i._howls[u]._webAudio)for(var g=i._howls[u]._getSoundIds(),f=0;f<g.length;f++){var w=i._howls[u]._soundById(g[f]);w&&w._node&&!w._node._unlocked&&(w._node._unlocked=!0,w._node.load())}i._autoResume();var v=i.ctx.createBufferSource();v.buffer=i._scratchBuffer,v.connect(i.ctx.destination),typeof v.start>"u"?v.noteOn(0):v.start(0),typeof i.ctx.resume=="function"&&i.ctx.resume(),v.onended=function(){v.disconnect(0),i._audioUnlocked=!0,document.removeEventListener("touchstart",o,!0),document.removeEventListener("touchend",o,!0),document.removeEventListener("click",o,!0),document.removeEventListener("keydown",o,!0);for(var x=0;x<i._howls.length;x++)i._howls[x]._emit("unlock")}};return document.addEventListener("touchstart",o,!0),document.addEventListener("touchend",o,!0),document.addEventListener("click",o,!0),document.addEventListener("keydown",o,!0),i}},_obtainHtml5Audio:function(){var i=this||e;if(i._html5AudioPool.length)return i._html5AudioPool.pop();var o=new Audio().play();return o&&typeof Promise<"u"&&(o instanceof Promise||typeof o.then=="function")&&o.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(i){var o=this||e;return i._unlocked&&o._html5AudioPool.push(i),o},_autoSuspend:function(){var i=this;if(!(!i.autoSuspend||!i.ctx||typeof i.ctx.suspend>"u"||!e.usingWebAudio)){for(var o=0;o<i._howls.length;o++)if(i._howls[o]._webAudio){for(var _=0;_<i._howls[o]._sounds.length;_++)if(!i._howls[o]._sounds[_]._paused)return i}return i._suspendTimer&&clearTimeout(i._suspendTimer),i._suspendTimer=setTimeout(function(){if(i.autoSuspend){i._suspendTimer=null,i.state="suspending";var m=function(){i.state="suspended",i._resumeAfterSuspend&&(delete i._resumeAfterSuspend,i._autoResume())};i.ctx.suspend().then(m,m)}},3e4),i}},_autoResume:function(){var i=this;if(!(!i.ctx||typeof i.ctx.resume>"u"||!e.usingWebAudio))return i.state==="running"&&i.ctx.state!=="interrupted"&&i._suspendTimer?(clearTimeout(i._suspendTimer),i._suspendTimer=null):i.state==="suspended"||i.state==="running"&&i.ctx.state==="interrupted"?(i.ctx.resume().then(function(){i.state="running";for(var o=0;o<i._howls.length;o++)i._howls[o]._emit("resume")}),i._suspendTimer&&(clearTimeout(i._suspendTimer),i._suspendTimer=null)):i.state==="suspending"&&(i._resumeAfterSuspend=!0),i}};var e=new t,n=function(i){var o=this;if(!i.src||i.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}o.init(i)};n.prototype={init:function(i){var o=this;return e.ctx||d(),o._autoplay=i.autoplay||!1,o._format=typeof i.format!="string"?i.format:[i.format],o._html5=i.html5||!1,o._muted=i.mute||!1,o._loop=i.loop||!1,o._pool=i.pool||5,o._preload=typeof i.preload=="boolean"||i.preload==="metadata"?i.preload:!0,o._rate=i.rate||1,o._sprite=i.sprite||{},o._src=typeof i.src!="string"?i.src:[i.src],o._volume=i.volume!==void 0?i.volume:1,o._xhr={method:i.xhr&&i.xhr.method?i.xhr.method:"GET",headers:i.xhr&&i.xhr.headers?i.xhr.headers:null,withCredentials:i.xhr&&i.xhr.withCredentials?i.xhr.withCredentials:!1},o._duration=0,o._state="unloaded",o._sounds=[],o._endTimers={},o._queue=[],o._playLock=!1,o._onend=i.onend?[{fn:i.onend}]:[],o._onfade=i.onfade?[{fn:i.onfade}]:[],o._onload=i.onload?[{fn:i.onload}]:[],o._onloaderror=i.onloaderror?[{fn:i.onloaderror}]:[],o._onplayerror=i.onplayerror?[{fn:i.onplayerror}]:[],o._onpause=i.onpause?[{fn:i.onpause}]:[],o._onplay=i.onplay?[{fn:i.onplay}]:[],o._onstop=i.onstop?[{fn:i.onstop}]:[],o._onmute=i.onmute?[{fn:i.onmute}]:[],o._onvolume=i.onvolume?[{fn:i.onvolume}]:[],o._onrate=i.onrate?[{fn:i.onrate}]:[],o._onseek=i.onseek?[{fn:i.onseek}]:[],o._onunlock=i.onunlock?[{fn:i.onunlock}]:[],o._onresume=[],o._webAudio=e.usingWebAudio&&!o._html5,typeof e.ctx<"u"&&e.ctx&&e.autoUnlock&&e._unlockAudio(),e._howls.push(o),o._autoplay&&o._queue.push({event:"play",action:function(){o.play()}}),o._preload&&o._preload!=="none"&&o.load(),o},load:function(){var i=this,o=null;if(e.noAudio){i._emit("loaderror",null,"No audio support.");return}typeof i._src=="string"&&(i._src=[i._src]);for(var _=0;_<i._src.length;_++){var m,u;if(i._format&&i._format[_])m=i._format[_];else{if(u=i._src[_],typeof u!="string"){i._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}m=/^data:audio\/([^;,]+);/i.exec(u),m||(m=/\.([^.]+)$/.exec(u.split("?",1)[0])),m&&(m=m[1].toLowerCase())}if(m||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),m&&e.codecs(m)){o=i._src[_];break}}if(!o){i._emit("loaderror",null,"No codec support for selected audio sources.");return}return i._src=o,i._state="loading",window.location.protocol==="https:"&&o.slice(0,5)==="http:"&&(i._html5=!0,i._webAudio=!1),new r(i),i._webAudio&&a(i),i},play:function(i,o){var _=this,m=null;if(typeof i=="number")m=i,i=null;else{if(typeof i=="string"&&_._state==="loaded"&&!_._sprite[i])return null;if(typeof i>"u"&&(i="__default",!_._playLock)){for(var u=0,g=0;g<_._sounds.length;g++)_._sounds[g]._paused&&!_._sounds[g]._ended&&(u++,m=_._sounds[g]._id);u===1?i=null:m=null}}var f=m?_._soundById(m):_._inactiveSound();if(!f)return null;if(m&&!i&&(i=f._sprite||"__default"),_._state!=="loaded"){f._sprite=i,f._ended=!1;var w=f._id;return _._queue.push({event:"play",action:function(){_.play(w)}}),w}if(m&&!f._paused)return o||_._loadQueue("play"),f._id;_._webAudio&&e._autoResume();var v=Math.max(0,f._seek>0?f._seek:_._sprite[i][0]/1e3),x=Math.max(0,(_._sprite[i][0]+_._sprite[i][1])/1e3-v),T=x*1e3/Math.abs(f._rate),A=_._sprite[i][0]/1e3,j=(_._sprite[i][0]+_._sprite[i][1])/1e3;f._sprite=i,f._ended=!1;var I=function(){f._paused=!1,f._seek=v,f._start=A,f._stop=j,f._loop=!!(f._loop||_._sprite[i][2])};if(v>=j){_._ended(f);return}var E=f._node;if(_._webAudio){var D=function(){_._playLock=!1,I(),_._refreshBuffer(f);var k=f._muted||_._muted?0:f._volume;E.gain.setValueAtTime(k,e.ctx.currentTime),f._playStart=e.ctx.currentTime,typeof E.bufferSource.start>"u"?f._loop?E.bufferSource.noteGrainOn(0,v,86400):E.bufferSource.noteGrainOn(0,v,x):f._loop?E.bufferSource.start(0,v,86400):E.bufferSource.start(0,v,x),T!==1/0&&(_._endTimers[f._id]=setTimeout(_._ended.bind(_,f),T)),o||setTimeout(function(){_._emit("play",f._id),_._loadQueue()},0)};e.state==="running"&&e.ctx.state!=="interrupted"?D():(_._playLock=!0,_.once("resume",D),_._clearTimer(f._id))}else{var z=function(){E.currentTime=v,E.muted=f._muted||_._muted||e._muted||E.muted,E.volume=f._volume*e.volume(),E.playbackRate=f._rate;try{var k=E.play();if(k&&typeof Promise<"u"&&(k instanceof Promise||typeof k.then=="function")?(_._playLock=!0,I(),k.then(function(){_._playLock=!1,E._unlocked=!0,o?_._loadQueue():_._emit("play",f._id)}).catch(function(){_._playLock=!1,_._emit("playerror",f._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),f._ended=!0,f._paused=!0})):o||(_._playLock=!1,I(),_._emit("play",f._id)),E.playbackRate=f._rate,E.paused){_._emit("playerror",f._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}i!=="__default"||f._loop?_._endTimers[f._id]=setTimeout(_._ended.bind(_,f),T):(_._endTimers[f._id]=function(){_._ended(f),E.removeEventListener("ended",_._endTimers[f._id],!1)},E.addEventListener("ended",_._endTimers[f._id],!1))}catch(F){_._emit("playerror",f._id,F)}};E.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(E.src=_._src,E.load());var q=window&&window.ejecta||!E.readyState&&e._navigator.isCocoonJS;if(E.readyState>=3||q)z();else{_._playLock=!0,_._state="loading";var H=function(){_._state="loaded",z(),E.removeEventListener(e._canPlayEvent,H,!1)};E.addEventListener(e._canPlayEvent,H,!1),_._clearTimer(f._id)}}return f._id},pause:function(i){var o=this;if(o._state!=="loaded"||o._playLock)return o._queue.push({event:"pause",action:function(){o.pause(i)}}),o;for(var _=o._getSoundIds(i),m=0;m<_.length;m++){o._clearTimer(_[m]);var u=o._soundById(_[m]);if(u&&!u._paused&&(u._seek=o.seek(_[m]),u._rateSeek=0,u._paused=!0,o._stopFade(_[m]),u._node))if(o._webAudio){if(!u._node.bufferSource)continue;typeof u._node.bufferSource.stop>"u"?u._node.bufferSource.noteOff(0):u._node.bufferSource.stop(0),o._cleanBuffer(u._node)}else(!isNaN(u._node.duration)||u._node.duration===1/0)&&u._node.pause();arguments[1]||o._emit("pause",u?u._id:null)}return o},stop:function(i,o){var _=this;if(_._state!=="loaded"||_._playLock)return _._queue.push({event:"stop",action:function(){_.stop(i)}}),_;for(var m=_._getSoundIds(i),u=0;u<m.length;u++){_._clearTimer(m[u]);var g=_._soundById(m[u]);g&&(g._seek=g._start||0,g._rateSeek=0,g._paused=!0,g._ended=!0,_._stopFade(m[u]),g._node&&(_._webAudio?g._node.bufferSource&&(typeof g._node.bufferSource.stop>"u"?g._node.bufferSource.noteOff(0):g._node.bufferSource.stop(0),_._cleanBuffer(g._node)):(!isNaN(g._node.duration)||g._node.duration===1/0)&&(g._node.currentTime=g._start||0,g._node.pause(),g._node.duration===1/0&&_._clearSound(g._node))),o||_._emit("stop",g._id))}return _},mute:function(i,o){var _=this;if(_._state!=="loaded"||_._playLock)return _._queue.push({event:"mute",action:function(){_.mute(i,o)}}),_;if(typeof o>"u")if(typeof i=="boolean")_._muted=i;else return _._muted;for(var m=_._getSoundIds(o),u=0;u<m.length;u++){var g=_._soundById(m[u]);g&&(g._muted=i,g._interval&&_._stopFade(g._id),_._webAudio&&g._node?g._node.gain.setValueAtTime(i?0:g._volume,e.ctx.currentTime):g._node&&(g._node.muted=e._muted?!0:i),_._emit("mute",g._id))}return _},volume:function(){var i=this,o=arguments,_,m;if(o.length===0)return i._volume;if(o.length===1||o.length===2&&typeof o[1]>"u"){var u=i._getSoundIds(),g=u.indexOf(o[0]);g>=0?m=parseInt(o[0],10):_=parseFloat(o[0])}else o.length>=2&&(_=parseFloat(o[0]),m=parseInt(o[1],10));var f;if(typeof _<"u"&&_>=0&&_<=1){if(i._state!=="loaded"||i._playLock)return i._queue.push({event:"volume",action:function(){i.volume.apply(i,o)}}),i;typeof m>"u"&&(i._volume=_),m=i._getSoundIds(m);for(var w=0;w<m.length;w++)f=i._soundById(m[w]),f&&(f._volume=_,o[2]||i._stopFade(m[w]),i._webAudio&&f._node&&!f._muted?f._node.gain.setValueAtTime(_,e.ctx.currentTime):f._node&&!f._muted&&(f._node.volume=_*e.volume()),i._emit("volume",f._id))}else return f=m?i._soundById(m):i._sounds[0],f?f._volume:0;return i},fade:function(i,o,_,m){var u=this;if(u._state!=="loaded"||u._playLock)return u._queue.push({event:"fade",action:function(){u.fade(i,o,_,m)}}),u;i=Math.min(Math.max(0,parseFloat(i)),1),o=Math.min(Math.max(0,parseFloat(o)),1),_=parseFloat(_),u.volume(i,m);for(var g=u._getSoundIds(m),f=0;f<g.length;f++){var w=u._soundById(g[f]);if(w){if(m||u._stopFade(g[f]),u._webAudio&&!w._muted){var v=e.ctx.currentTime,x=v+_/1e3;w._volume=i,w._node.gain.setValueAtTime(i,v),w._node.gain.linearRampToValueAtTime(o,x)}u._startFadeInterval(w,i,o,_,g[f],typeof m>"u")}}return u},_startFadeInterval:function(i,o,_,m,u,g){var f=this,w=o,v=_-o,x=Math.abs(v/.01),T=Math.max(4,x>0?m/x:m),A=Date.now();i._fadeTo=_,i._interval=setInterval(function(){var j=(Date.now()-A)/m;A=Date.now(),w+=v*j,w=Math.round(w*100)/100,v<0?w=Math.max(_,w):w=Math.min(_,w),f._webAudio?i._volume=w:f.volume(w,i._id,!0),g&&(f._volume=w),(_<o&&w<=_||_>o&&w>=_)&&(clearInterval(i._interval),i._interval=null,i._fadeTo=null,f.volume(_,i._id),f._emit("fade",i._id))},T)},_stopFade:function(i){var o=this,_=o._soundById(i);return _&&_._interval&&(o._webAudio&&_._node.gain.cancelScheduledValues(e.ctx.currentTime),clearInterval(_._interval),_._interval=null,o.volume(_._fadeTo,i),_._fadeTo=null,o._emit("fade",i)),o},loop:function(){var i=this,o=arguments,_,m,u;if(o.length===0)return i._loop;if(o.length===1)if(typeof o[0]=="boolean")_=o[0],i._loop=_;else return u=i._soundById(parseInt(o[0],10)),u?u._loop:!1;else o.length===2&&(_=o[0],m=parseInt(o[1],10));for(var g=i._getSoundIds(m),f=0;f<g.length;f++)u=i._soundById(g[f]),u&&(u._loop=_,i._webAudio&&u._node&&u._node.bufferSource&&(u._node.bufferSource.loop=_,_&&(u._node.bufferSource.loopStart=u._start||0,u._node.bufferSource.loopEnd=u._stop,i.playing(g[f])&&(i.pause(g[f],!0),i.play(g[f],!0)))));return i},rate:function(){var i=this,o=arguments,_,m;if(o.length===0)m=i._sounds[0]._id;else if(o.length===1){var u=i._getSoundIds(),g=u.indexOf(o[0]);g>=0?m=parseInt(o[0],10):_=parseFloat(o[0])}else o.length===2&&(_=parseFloat(o[0]),m=parseInt(o[1],10));var f;if(typeof _=="number"){if(i._state!=="loaded"||i._playLock)return i._queue.push({event:"rate",action:function(){i.rate.apply(i,o)}}),i;typeof m>"u"&&(i._rate=_),m=i._getSoundIds(m);for(var w=0;w<m.length;w++)if(f=i._soundById(m[w]),f){i.playing(m[w])&&(f._rateSeek=i.seek(m[w]),f._playStart=i._webAudio?e.ctx.currentTime:f._playStart),f._rate=_,i._webAudio&&f._node&&f._node.bufferSource?f._node.bufferSource.playbackRate.setValueAtTime(_,e.ctx.currentTime):f._node&&(f._node.playbackRate=_);var v=i.seek(m[w]),x=(i._sprite[f._sprite][0]+i._sprite[f._sprite][1])/1e3-v,T=x*1e3/Math.abs(f._rate);(i._endTimers[m[w]]||!f._paused)&&(i._clearTimer(m[w]),i._endTimers[m[w]]=setTimeout(i._ended.bind(i,f),T)),i._emit("rate",f._id)}}else return f=i._soundById(m),f?f._rate:i._rate;return i},seek:function(){var i=this,o=arguments,_,m;if(o.length===0)i._sounds.length&&(m=i._sounds[0]._id);else if(o.length===1){var u=i._getSoundIds(),g=u.indexOf(o[0]);g>=0?m=parseInt(o[0],10):i._sounds.length&&(m=i._sounds[0]._id,_=parseFloat(o[0]))}else o.length===2&&(_=parseFloat(o[0]),m=parseInt(o[1],10));if(typeof m>"u")return 0;if(typeof _=="number"&&(i._state!=="loaded"||i._playLock))return i._queue.push({event:"seek",action:function(){i.seek.apply(i,o)}}),i;var f=i._soundById(m);if(f)if(typeof _=="number"&&_>=0){var w=i.playing(m);w&&i.pause(m,!0),f._seek=_,f._ended=!1,i._clearTimer(m),!i._webAudio&&f._node&&!isNaN(f._node.duration)&&(f._node.currentTime=_);var v=function(){w&&i.play(m,!0),i._emit("seek",m)};if(w&&!i._webAudio){var x=function(){i._playLock?setTimeout(x,0):v()};setTimeout(x,0)}else v()}else if(i._webAudio){var T=i.playing(m)?e.ctx.currentTime-f._playStart:0,A=f._rateSeek?f._rateSeek-f._seek:0;return f._seek+(A+T*Math.abs(f._rate))}else return f._node.currentTime;return i},playing:function(i){var o=this;if(typeof i=="number"){var _=o._soundById(i);return _?!_._paused:!1}for(var m=0;m<o._sounds.length;m++)if(!o._sounds[m]._paused)return!0;return!1},duration:function(i){var o=this,_=o._duration,m=o._soundById(i);return m&&(_=o._sprite[m._sprite][1]/1e3),_},state:function(){return this._state},unload:function(){for(var i=this,o=i._sounds,_=0;_<o.length;_++)o[_]._paused||i.stop(o[_]._id),i._webAudio||(i._clearSound(o[_]._node),o[_]._node.removeEventListener("error",o[_]._errorFn,!1),o[_]._node.removeEventListener(e._canPlayEvent,o[_]._loadFn,!1),o[_]._node.removeEventListener("ended",o[_]._endFn,!1),e._releaseHtml5Audio(o[_]._node)),delete o[_]._node,i._clearTimer(o[_]._id);var m=e._howls.indexOf(i);m>=0&&e._howls.splice(m,1);var u=!0;for(_=0;_<e._howls.length;_++)if(e._howls[_]._src===i._src||i._src.indexOf(e._howls[_]._src)>=0){u=!1;break}return s&&u&&delete s[i._src],e.noAudio=!1,i._state="unloaded",i._sounds=[],i=null,null},on:function(i,o,_,m){var u=this,g=u["_on"+i];return typeof o=="function"&&g.push(m?{id:_,fn:o,once:m}:{id:_,fn:o}),u},off:function(i,o,_){var m=this,u=m["_on"+i],g=0;if(typeof o=="number"&&(_=o,o=null),o||_)for(g=0;g<u.length;g++){var f=_===u[g].id;if(o===u[g].fn&&f||!o&&f){u.splice(g,1);break}}else if(i)m["_on"+i]=[];else{var w=Object.keys(m);for(g=0;g<w.length;g++)w[g].indexOf("_on")===0&&Array.isArray(m[w[g]])&&(m[w[g]]=[])}return m},once:function(i,o,_){var m=this;return m.on(i,o,_,1),m},_emit:function(i,o,_){for(var m=this,u=m["_on"+i],g=u.length-1;g>=0;g--)(!u[g].id||u[g].id===o||i==="load")&&(setTimeout(function(f){f.call(this,o,_)}.bind(m,u[g].fn),0),u[g].once&&m.off(i,u[g].fn,u[g].id));return m._loadQueue(i),m},_loadQueue:function(i){var o=this;if(o._queue.length>0){var _=o._queue[0];_.event===i&&(o._queue.shift(),o._loadQueue()),i||_.action()}return o},_ended:function(i){var o=this,_=i._sprite;if(!o._webAudio&&i._node&&!i._node.paused&&!i._node.ended&&i._node.currentTime<i._stop)return setTimeout(o._ended.bind(o,i),100),o;var m=!!(i._loop||o._sprite[_][2]);if(o._emit("end",i._id),!o._webAudio&&m&&o.stop(i._id,!0).play(i._id),o._webAudio&&m){o._emit("play",i._id),i._seek=i._start||0,i._rateSeek=0,i._playStart=e.ctx.currentTime;var u=(i._stop-i._start)*1e3/Math.abs(i._rate);o._endTimers[i._id]=setTimeout(o._ended.bind(o,i),u)}return o._webAudio&&!m&&(i._paused=!0,i._ended=!0,i._seek=i._start||0,i._rateSeek=0,o._clearTimer(i._id),o._cleanBuffer(i._node),e._autoSuspend()),!o._webAudio&&!m&&o.stop(i._id,!0),o},_clearTimer:function(i){var o=this;if(o._endTimers[i]){if(typeof o._endTimers[i]!="function")clearTimeout(o._endTimers[i]);else{var _=o._soundById(i);_&&_._node&&_._node.removeEventListener("ended",o._endTimers[i],!1)}delete o._endTimers[i]}return o},_soundById:function(i){for(var o=this,_=0;_<o._sounds.length;_++)if(i===o._sounds[_]._id)return o._sounds[_];return null},_inactiveSound:function(){var i=this;i._drain();for(var o=0;o<i._sounds.length;o++)if(i._sounds[o]._ended)return i._sounds[o].reset();return new r(i)},_drain:function(){var i=this,o=i._pool,_=0,m=0;if(!(i._sounds.length<o)){for(m=0;m<i._sounds.length;m++)i._sounds[m]._ended&&_++;for(m=i._sounds.length-1;m>=0;m--){if(_<=o)return;i._sounds[m]._ended&&(i._webAudio&&i._sounds[m]._node&&i._sounds[m]._node.disconnect(0),i._sounds.splice(m,1),_--)}}},_getSoundIds:function(i){var o=this;if(typeof i>"u"){for(var _=[],m=0;m<o._sounds.length;m++)_.push(o._sounds[m]._id);return _}else return[i]},_refreshBuffer:function(i){var o=this;return i._node.bufferSource=e.ctx.createBufferSource(),i._node.bufferSource.buffer=s[o._src],i._panner?i._node.bufferSource.connect(i._panner):i._node.bufferSource.connect(i._node),i._node.bufferSource.loop=i._loop,i._loop&&(i._node.bufferSource.loopStart=i._start||0,i._node.bufferSource.loopEnd=i._stop||0),i._node.bufferSource.playbackRate.setValueAtTime(i._rate,e.ctx.currentTime),o},_cleanBuffer:function(i){var o=this,_=e._navigator&&e._navigator.vendor.indexOf("Apple")>=0;if(e._scratchBuffer&&i.bufferSource&&(i.bufferSource.onended=null,i.bufferSource.disconnect(0),_))try{i.bufferSource.buffer=e._scratchBuffer}catch{}return i.bufferSource=null,o},_clearSound:function(i){var o=/MSIE |Trident\//.test(e._navigator&&e._navigator.userAgent);o||(i.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var r=function(i){this._parent=i,this.init()};r.prototype={init:function(){var i=this,o=i._parent;return i._muted=o._muted,i._loop=o._loop,i._volume=o._volume,i._rate=o._rate,i._seek=0,i._paused=!0,i._ended=!0,i._sprite="__default",i._id=++e._counter,o._sounds.push(i),i.create(),i},create:function(){var i=this,o=i._parent,_=e._muted||i._muted||i._parent._muted?0:i._volume;return o._webAudio?(i._node=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),i._node.gain.setValueAtTime(_,e.ctx.currentTime),i._node.paused=!0,i._node.connect(e.masterGain)):e.noAudio||(i._node=e._obtainHtml5Audio(),i._errorFn=i._errorListener.bind(i),i._node.addEventListener("error",i._errorFn,!1),i._loadFn=i._loadListener.bind(i),i._node.addEventListener(e._canPlayEvent,i._loadFn,!1),i._endFn=i._endListener.bind(i),i._node.addEventListener("ended",i._endFn,!1),i._node.src=o._src,i._node.preload=o._preload===!0?"auto":o._preload,i._node.volume=_*e.volume(),i._node.load()),i},reset:function(){var i=this,o=i._parent;return i._muted=o._muted,i._loop=o._loop,i._volume=o._volume,i._rate=o._rate,i._seek=0,i._rateSeek=0,i._paused=!0,i._ended=!0,i._sprite="__default",i._id=++e._counter,i},_errorListener:function(){var i=this;i._parent._emit("loaderror",i._id,i._node.error?i._node.error.code:0),i._node.removeEventListener("error",i._errorFn,!1)},_loadListener:function(){var i=this,o=i._parent;o._duration=Math.ceil(i._node.duration*10)/10,Object.keys(o._sprite).length===0&&(o._sprite={__default:[0,o._duration*1e3]}),o._state!=="loaded"&&(o._state="loaded",o._emit("load"),o._loadQueue()),i._node.removeEventListener(e._canPlayEvent,i._loadFn,!1)},_endListener:function(){var i=this,o=i._parent;o._duration===1/0&&(o._duration=Math.ceil(i._node.duration*10)/10,o._sprite.__default[1]===1/0&&(o._sprite.__default[1]=o._duration*1e3),o._ended(i)),i._node.removeEventListener("ended",i._endFn,!1)}};var s={},a=function(i){var o=i._src;if(s[o]){i._duration=s[o].duration,h(i);return}if(/^data:[^;]+;base64,/.test(o)){for(var _=atob(o.split(",")[1]),m=new Uint8Array(_.length),u=0;u<_.length;++u)m[u]=_.charCodeAt(u);c(m.buffer,i)}else{var g=new XMLHttpRequest;g.open(i._xhr.method,o,!0),g.withCredentials=i._xhr.withCredentials,g.responseType="arraybuffer",i._xhr.headers&&Object.keys(i._xhr.headers).forEach(function(f){g.setRequestHeader(f,i._xhr.headers[f])}),g.onload=function(){var f=(g.status+"")[0];if(f!=="0"&&f!=="2"&&f!=="3"){i._emit("loaderror",null,"Failed loading audio file with status: "+g.status+".");return}c(g.response,i)},g.onerror=function(){i._webAudio&&(i._html5=!0,i._webAudio=!1,i._sounds=[],delete s[o],i.load())},l(g)}},l=function(i){try{i.send()}catch{i.onerror()}},c=function(i,o){var _=function(){o._emit("loaderror",null,"Decoding audio data failed.")},m=function(u){u&&o._sounds.length>0?(s[o._src]=u,h(o,u)):_()};typeof Promise<"u"&&e.ctx.decodeAudioData.length===1?e.ctx.decodeAudioData(i).then(m).catch(_):e.ctx.decodeAudioData(i,m,_)},h=function(i,o){o&&!i._duration&&(i._duration=o.duration),Object.keys(i._sprite).length===0&&(i._sprite={__default:[0,i._duration*1e3]}),i._state!=="loaded"&&(i._state="loaded",i._emit("load"),i._loadQueue())},d=function(){if(e.usingWebAudio){try{typeof AudioContext<"u"?e.ctx=new AudioContext:typeof webkitAudioContext<"u"?e.ctx=new webkitAudioContext:e.usingWebAudio=!1}catch{e.usingWebAudio=!1}e.ctx||(e.usingWebAudio=!1);var i=/iP(hone|od|ad)/.test(e._navigator&&e._navigator.platform),o=e._navigator&&e._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),_=o?parseInt(o[1],10):null;if(i&&_&&_<9){var m=/safari/.test(e._navigator&&e._navigator.userAgent.toLowerCase());e._navigator&&!m&&(e.usingWebAudio=!1)}e.usingWebAudio&&(e.masterGain=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),e.masterGain.gain.setValueAtTime(e._muted?0:e._volume,e.ctx.currentTime),e.masterGain.connect(e.ctx.destination)),e._setup()}};typeof define=="function"&&define.amd&&define([],function(){return{Howler:e,Howl:n}}),typeof xn<"u"&&(xn.Howler=e,xn.Howl=n),typeof global<"u"?(global.HowlerGlobal=t,global.Howler=e,global.Howl=n,global.Sound=r):typeof window<"u"&&(window.HowlerGlobal=t,window.Howler=e,window.Howl=n,window.Sound=r)})();(function(){"use strict";HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var n=this;if(!n.ctx||!n.ctx.listener)return n;for(var r=n._howls.length-1;r>=0;r--)n._howls[r].stereo(e);return n},HowlerGlobal.prototype.pos=function(e,n,r){var s=this;if(!s.ctx||!s.ctx.listener)return s;if(n=typeof n!="number"?s._pos[1]:n,r=typeof r!="number"?s._pos[2]:r,typeof e=="number")s._pos=[e,n,r],typeof s.ctx.listener.positionX<"u"?(s.ctx.listener.positionX.setTargetAtTime(s._pos[0],Howler.ctx.currentTime,.1),s.ctx.listener.positionY.setTargetAtTime(s._pos[1],Howler.ctx.currentTime,.1),s.ctx.listener.positionZ.setTargetAtTime(s._pos[2],Howler.ctx.currentTime,.1)):s.ctx.listener.setPosition(s._pos[0],s._pos[1],s._pos[2]);else return s._pos;return s},HowlerGlobal.prototype.orientation=function(e,n,r,s,a,l){var c=this;if(!c.ctx||!c.ctx.listener)return c;var h=c._orientation;if(n=typeof n!="number"?h[1]:n,r=typeof r!="number"?h[2]:r,s=typeof s!="number"?h[3]:s,a=typeof a!="number"?h[4]:a,l=typeof l!="number"?h[5]:l,typeof e=="number")c._orientation=[e,n,r,s,a,l],typeof c.ctx.listener.forwardX<"u"?(c.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),c.ctx.listener.forwardY.setTargetAtTime(n,Howler.ctx.currentTime,.1),c.ctx.listener.forwardZ.setTargetAtTime(r,Howler.ctx.currentTime,.1),c.ctx.listener.upX.setTargetAtTime(s,Howler.ctx.currentTime,.1),c.ctx.listener.upY.setTargetAtTime(a,Howler.ctx.currentTime,.1),c.ctx.listener.upZ.setTargetAtTime(l,Howler.ctx.currentTime,.1)):c.ctx.listener.setOrientation(e,n,r,s,a,l);else return h;return c},Howl.prototype.init=function(e){return function(n){var r=this;return r._orientation=n.orientation||[1,0,0],r._stereo=n.stereo||null,r._pos=n.pos||null,r._pannerAttr={coneInnerAngle:typeof n.coneInnerAngle<"u"?n.coneInnerAngle:360,coneOuterAngle:typeof n.coneOuterAngle<"u"?n.coneOuterAngle:360,coneOuterGain:typeof n.coneOuterGain<"u"?n.coneOuterGain:0,distanceModel:typeof n.distanceModel<"u"?n.distanceModel:"inverse",maxDistance:typeof n.maxDistance<"u"?n.maxDistance:1e4,panningModel:typeof n.panningModel<"u"?n.panningModel:"HRTF",refDistance:typeof n.refDistance<"u"?n.refDistance:1,rolloffFactor:typeof n.rolloffFactor<"u"?n.rolloffFactor:1},r._onstereo=n.onstereo?[{fn:n.onstereo}]:[],r._onpos=n.onpos?[{fn:n.onpos}]:[],r._onorientation=n.onorientation?[{fn:n.onorientation}]:[],e.call(this,n)}}(Howl.prototype.init),Howl.prototype.stereo=function(e,n){var r=this;if(!r._webAudio)return r;if(r._state!=="loaded")return r._queue.push({event:"stereo",action:function(){r.stereo(e,n)}}),r;var s=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof n>"u")if(typeof e=="number")r._stereo=e,r._pos=[e,0,0];else return r._stereo;for(var a=r._getSoundIds(n),l=0;l<a.length;l++){var c=r._soundById(a[l]);if(c)if(typeof e=="number")c._stereo=e,c._pos=[e,0,0],c._node&&(c._pannerAttr.panningModel="equalpower",(!c._panner||!c._panner.pan)&&t(c,s),s==="spatial"?typeof c._panner.positionX<"u"?(c._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),c._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),c._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):c._panner.setPosition(e,0,0):c._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),r._emit("stereo",c._id);else return c._stereo}return r},Howl.prototype.pos=function(e,n,r,s){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"pos",action:function(){a.pos(e,n,r,s)}}),a;if(n=typeof n!="number"?0:n,r=typeof r!="number"?-.5:r,typeof s>"u")if(typeof e=="number")a._pos=[e,n,r];else return a._pos;for(var l=a._getSoundIds(s),c=0;c<l.length;c++){var h=a._soundById(l[c]);if(h)if(typeof e=="number")h._pos=[e,n,r],h._node&&((!h._panner||h._panner.pan)&&t(h,"spatial"),typeof h._panner.positionX<"u"?(h._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),h._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),h._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime)):h._panner.setPosition(e,n,r)),a._emit("pos",h._id);else return h._pos}return a},Howl.prototype.orientation=function(e,n,r,s){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"orientation",action:function(){a.orientation(e,n,r,s)}}),a;if(n=typeof n!="number"?a._orientation[1]:n,r=typeof r!="number"?a._orientation[2]:r,typeof s>"u")if(typeof e=="number")a._orientation=[e,n,r];else return a._orientation;for(var l=a._getSoundIds(s),c=0;c<l.length;c++){var h=a._soundById(l[c]);if(h)if(typeof e=="number")h._orientation=[e,n,r],h._node&&(h._panner||(h._pos||(h._pos=a._pos||[0,0,-.5]),t(h,"spatial")),typeof h._panner.orientationX<"u"?(h._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),h._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),h._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime)):h._panner.setOrientation(e,n,r)),a._emit("orientation",h._id);else return h._orientation}return a},Howl.prototype.pannerAttr=function(){var e=this,n=arguments,r,s,a;if(!e._webAudio)return e;if(n.length===0)return e._pannerAttr;if(n.length===1)if(typeof n[0]=="object")r=n[0],typeof s>"u"&&(r.pannerAttr||(r.pannerAttr={coneInnerAngle:r.coneInnerAngle,coneOuterAngle:r.coneOuterAngle,coneOuterGain:r.coneOuterGain,distanceModel:r.distanceModel,maxDistance:r.maxDistance,refDistance:r.refDistance,rolloffFactor:r.rolloffFactor,panningModel:r.panningModel}),e._pannerAttr={coneInnerAngle:typeof r.pannerAttr.coneInnerAngle<"u"?r.pannerAttr.coneInnerAngle:e._coneInnerAngle,coneOuterAngle:typeof r.pannerAttr.coneOuterAngle<"u"?r.pannerAttr.coneOuterAngle:e._coneOuterAngle,coneOuterGain:typeof r.pannerAttr.coneOuterGain<"u"?r.pannerAttr.coneOuterGain:e._coneOuterGain,distanceModel:typeof r.pannerAttr.distanceModel<"u"?r.pannerAttr.distanceModel:e._distanceModel,maxDistance:typeof r.pannerAttr.maxDistance<"u"?r.pannerAttr.maxDistance:e._maxDistance,refDistance:typeof r.pannerAttr.refDistance<"u"?r.pannerAttr.refDistance:e._refDistance,rolloffFactor:typeof r.pannerAttr.rolloffFactor<"u"?r.pannerAttr.rolloffFactor:e._rolloffFactor,panningModel:typeof r.pannerAttr.panningModel<"u"?r.pannerAttr.panningModel:e._panningModel});else return a=e._soundById(parseInt(n[0],10)),a?a._pannerAttr:e._pannerAttr;else n.length===2&&(r=n[0],s=parseInt(n[1],10));for(var l=e._getSoundIds(s),c=0;c<l.length;c++)if(a=e._soundById(l[c]),a){var h=a._pannerAttr;h={coneInnerAngle:typeof r.coneInnerAngle<"u"?r.coneInnerAngle:h.coneInnerAngle,coneOuterAngle:typeof r.coneOuterAngle<"u"?r.coneOuterAngle:h.coneOuterAngle,coneOuterGain:typeof r.coneOuterGain<"u"?r.coneOuterGain:h.coneOuterGain,distanceModel:typeof r.distanceModel<"u"?r.distanceModel:h.distanceModel,maxDistance:typeof r.maxDistance<"u"?r.maxDistance:h.maxDistance,refDistance:typeof r.refDistance<"u"?r.refDistance:h.refDistance,rolloffFactor:typeof r.rolloffFactor<"u"?r.rolloffFactor:h.rolloffFactor,panningModel:typeof r.panningModel<"u"?r.panningModel:h.panningModel};var d=a._panner;d?(d.coneInnerAngle=h.coneInnerAngle,d.coneOuterAngle=h.coneOuterAngle,d.coneOuterGain=h.coneOuterGain,d.distanceModel=h.distanceModel,d.maxDistance=h.maxDistance,d.refDistance=h.refDistance,d.rolloffFactor=h.rolloffFactor,d.panningModel=h.panningModel):(a._pos||(a._pos=e._pos||[0,0,-.5]),t(a,"spatial"))}return e},Sound.prototype.init=function(e){return function(){var n=this,r=n._parent;n._orientation=r._orientation,n._stereo=r._stereo,n._pos=r._pos,n._pannerAttr=r._pannerAttr,e.call(this),n._stereo?r.stereo(n._stereo):n._pos&&r.pos(n._pos[0],n._pos[1],n._pos[2],n._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var n=this,r=n._parent;return n._orientation=r._orientation,n._stereo=r._stereo,n._pos=r._pos,n._pannerAttr=r._pannerAttr,n._stereo?r.stereo(n._stereo):n._pos?r.pos(n._pos[0],n._pos[1],n._pos[2],n._id):n._panner&&(n._panner.disconnect(0),n._panner=void 0,r._refreshBuffer(n)),e.call(this)}}(Sound.prototype.reset);var t=function(e,n){n=n||"spatial",n==="spatial"?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,typeof e._panner.positionX<"u"?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),typeof e._panner.orientationX<"u"?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}})()});var br=Y((Wu,ns)=>{"use strict";ns.exports=function(e,n){return function(){for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];return e.apply(n,s)}}});var K=Y((Xu,ss)=>{"use strict";var p_=br(),Ar=Object.prototype.toString,Tr=function(t){return function(e){var n=Ar.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())}}(Object.create(null));function Qe(t){return t=t.toLowerCase(),function(n){return Tr(n)===t}}function jr(t){return Array.isArray(t)}function Mn(t){return typeof t>"u"}function d_(t){return t!==null&&!Mn(t)&&t.constructor!==null&&!Mn(t.constructor)&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)}var rs=Qe("ArrayBuffer");function m_(t){var e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&rs(t.buffer),e}function f_(t){return typeof t=="string"}function u_(t){return typeof t=="number"}function is(t){return t!==null&&typeof t=="object"}function bn(t){if(Tr(t)!=="object")return!1;var e=Object.getPrototypeOf(t);return e===null||e===Object.prototype}var g_=Qe("Date"),w_=Qe("File"),v_=Qe("Blob"),x_=Qe("FileList");function Sr(t){return Ar.call(t)==="[object Function]"}function y_(t){return is(t)&&Sr(t.pipe)}function b_(t){var e="[object FormData]";return t&&(typeof FormData=="function"&&t instanceof FormData||Ar.call(t)===e||Sr(t.toString)&&t.toString()===e)}var M_=Qe("URLSearchParams");function A_(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function T_(){return typeof navigator<"u"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window<"u"&&typeof document<"u"}function Pr(t,e){if(!(t===null||typeof t>"u"))if(typeof t!="object"&&(t=[t]),jr(t))for(var n=0,r=t.length;n<r;n++)e.call(null,t[n],n,t);else for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.call(null,t[s],s,t)}function Mr(){var t={};function e(s,a){bn(t[a])&&bn(s)?t[a]=Mr(t[a],s):bn(s)?t[a]=Mr({},s):jr(s)?t[a]=s.slice():t[a]=s}for(var n=0,r=arguments.length;n<r;n++)Pr(arguments[n],e);return t}function j_(t,e,n){return Pr(e,function(s,a){n&&typeof s=="function"?t[a]=p_(s,n):t[a]=s}),t}function S_(t){return t.charCodeAt(0)===65279&&(t=t.slice(1)),t}function P_(t,e,n,r){t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,n&&Object.assign(t.prototype,n)}function E_(t,e,n){var r,s,a,l={};e=e||{};do{for(r=Object.getOwnPropertyNames(t),s=r.length;s-- >0;)a=r[s],l[a]||(e[a]=t[a],l[a]=!0);t=Object.getPrototypeOf(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e}function F_(t,e,n){t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;var r=t.indexOf(e,n);return r!==-1&&r===n}function I_(t){if(!t)return null;var e=t.length;if(Mn(e))return null;for(var n=new Array(e);e-- >0;)n[e]=t[e];return n}var R_=function(t){return function(e){return t&&e instanceof t}}(typeof Uint8Array<"u"&&Object.getPrototypeOf(Uint8Array));ss.exports={isArray:jr,isArrayBuffer:rs,isBuffer:d_,isFormData:b_,isArrayBufferView:m_,isString:f_,isNumber:u_,isObject:is,isPlainObject:bn,isUndefined:Mn,isDate:g_,isFile:w_,isBlob:v_,isFunction:Sr,isStream:y_,isURLSearchParams:M_,isStandardBrowserEnv:T_,forEach:Pr,merge:Mr,extend:j_,trim:A_,stripBOM:S_,inherits:P_,toFlatObject:E_,kindOf:Tr,kindOfTest:Qe,endsWith:F_,toArray:I_,isTypedArray:R_,isFileList:x_}});var Er=Y((Yu,os)=>{"use strict";var St=K();function as(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}os.exports=function(e,n,r){if(!n)return e;var s;if(r)s=r(n);else if(St.isURLSearchParams(n))s=n.toString();else{var a=[];St.forEach(n,function(h,d){h===null||typeof h>"u"||(St.isArray(h)?d=d+"[]":h=[h],St.forEach(h,function(o){St.isDate(o)?o=o.toISOString():St.isObject(o)&&(o=JSON.stringify(o)),a.push(as(d)+"="+as(o))}))}),s=a.join("&")}if(s){var l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e}});var cs=Y((Gu,ls)=>{"use strict";var C_=K();function An(){this.handlers=[]}An.prototype.use=function(e,n,r){return this.handlers.push({fulfilled:e,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1};An.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)};An.prototype.forEach=function(e){C_.forEach(this.handlers,function(r){r!==null&&e(r)})};ls.exports=An});var hs=Y((Qu,_s)=>{"use strict";var O_=K();_s.exports=function(e,n){O_.forEach(e,function(s,a){a!==n&&a.toUpperCase()===n.toUpperCase()&&(e[n]=s,delete e[a])})}});var $e=Y(($u,fs)=>{"use strict";var ps=K();function Pt(t,e,n,r,s){Error.call(this),this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),r&&(this.request=r),s&&(this.response=s)}ps.inherits(Pt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var ds=Pt.prototype,ms={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach(function(t){ms[t]={value:t}});Object.defineProperties(Pt,ms);Object.defineProperty(ds,"isAxiosError",{value:!0});Pt.from=function(t,e,n,r,s,a){var l=Object.create(ds);return ps.toFlatObject(t,l,function(h){return h!==Error.prototype}),Pt.call(l,t.message,e,n,r,s),l.name=t.name,a&&Object.assign(l,a),l};fs.exports=Pt});var Fr=Y((Zu,us)=>{"use strict";us.exports={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1}});var Ir=Y((Ju,gs)=>{"use strict";var we=K();function L_(t,e){e=e||new FormData;var n=[];function r(a){return a===null?"":we.isDate(a)?a.toISOString():we.isArrayBuffer(a)||we.isTypedArray(a)?typeof Blob=="function"?new Blob([a]):Buffer.from(a):a}function s(a,l){if(we.isPlainObject(a)||we.isArray(a)){if(n.indexOf(a)!==-1)throw Error("Circular reference detected in "+l);n.push(a),we.forEach(a,function(h,d){if(!we.isUndefined(h)){var i=l?l+"."+d:d,o;if(h&&!l&&typeof h=="object"){if(we.endsWith(d,"{}"))h=JSON.stringify(h);else if(we.endsWith(d,"[]")&&(o=we.toArray(h))){o.forEach(function(_){!we.isUndefined(_)&&e.append(i,r(_))});return}}s(h,i)}}),n.pop()}else e.append(l,r(a))}return s(t),e}gs.exports=L_});var vs=Y((Ku,ws)=>{"use strict";var Rr=$e();ws.exports=function(e,n,r){var s=r.config.validateStatus;!r.status||!s||s(r.status)?e(r):n(new Rr("Request failed with status code "+r.status,[Rr.ERR_BAD_REQUEST,Rr.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}});var ys=Y((e0,xs)=>{"use strict";var Tn=K();xs.exports=Tn.isStandardBrowserEnv()?function(){return{write:function(n,r,s,a,l,c){var h=[];h.push(n+"="+encodeURIComponent(r)),Tn.isNumber(s)&&h.push("expires="+new Date(s).toGMTString()),Tn.isString(a)&&h.push("path="+a),Tn.isString(l)&&h.push("domain="+l),c===!0&&h.push("secure"),document.cookie=h.join("; ")},read:function(n){var r=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove:function(n){this.write(n,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()});var Ms=Y((t0,bs)=>{"use strict";bs.exports=function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}});var Ts=Y((n0,As)=>{"use strict";As.exports=function(e,n){return n?e.replace(/\/+$/,"")+"/"+n.replace(/^\/+/,""):e}});var Cr=Y((r0,js)=>{"use strict";var k_=Ms(),D_=Ts();js.exports=function(e,n){return e&&!k_(n)?D_(e,n):n}});var Ps=Y((i0,Ss)=>{"use strict";var Or=K(),z_=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];Ss.exports=function(e){var n={},r,s,a;return e&&Or.forEach(e.split(`
`),function(c){if(a=c.indexOf(":"),r=Or.trim(c.substr(0,a)).toLowerCase(),s=Or.trim(c.substr(a+1)),r){if(n[r]&&z_.indexOf(r)>=0)return;r==="set-cookie"?n[r]=(n[r]?n[r]:[]).concat([s]):n[r]=n[r]?n[r]+", "+s:s}}),n}});var Is=Y((s0,Fs)=>{"use strict";var Es=K();Fs.exports=Es.isStandardBrowserEnv()?function(){var e=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a"),r;function s(a){var l=a;return e&&(n.setAttribute("href",l),l=n.href),n.setAttribute("href",l),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:n.pathname.charAt(0)==="/"?n.pathname:"/"+n.pathname}}return r=s(window.location.href),function(l){var c=Es.isString(l)?s(l):l;return c.protocol===r.protocol&&c.host===r.host}}():function(){return function(){return!0}}()});var Qt=Y((a0,Cs)=>{"use strict";var Lr=$e(),H_=K();function Rs(t){Lr.call(this,t??"canceled",Lr.ERR_CANCELED),this.name="CanceledError"}H_.inherits(Rs,Lr,{__CANCEL__:!0});Cs.exports=Rs});var Ls=Y((o0,Os)=>{"use strict";Os.exports=function(e){var n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return n&&n[1]||""}});var kr=Y((l0,ks)=>{"use strict";var $t=K(),U_=vs(),N_=ys(),q_=Er(),V_=Cr(),B_=Ps(),W_=Is(),X_=Fr(),Pe=$e(),Y_=Qt(),G_=Ls();ks.exports=function(e){return new Promise(function(r,s){var a=e.data,l=e.headers,c=e.responseType,h;function d(){e.cancelToken&&e.cancelToken.unsubscribe(h),e.signal&&e.signal.removeEventListener("abort",h)}$t.isFormData(a)&&$t.isStandardBrowserEnv()&&delete l["Content-Type"];var i=new XMLHttpRequest;if(e.auth){var o=e.auth.username||"",_=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";l.Authorization="Basic "+btoa(o+":"+_)}var m=V_(e.baseURL,e.url);i.open(e.method.toUpperCase(),q_(m,e.params,e.paramsSerializer),!0),i.timeout=e.timeout;function u(){if(i){var w="getAllResponseHeaders"in i?B_(i.getAllResponseHeaders()):null,v=!c||c==="text"||c==="json"?i.responseText:i.response,x={data:v,status:i.status,statusText:i.statusText,headers:w,config:e,request:i};U_(function(A){r(A),d()},function(A){s(A),d()},x),i=null}}if("onloadend"in i?i.onloadend=u:i.onreadystatechange=function(){!i||i.readyState!==4||i.status===0&&!(i.responseURL&&i.responseURL.indexOf("file:")===0)||setTimeout(u)},i.onabort=function(){i&&(s(new Pe("Request aborted",Pe.ECONNABORTED,e,i)),i=null)},i.onerror=function(){s(new Pe("Network Error",Pe.ERR_NETWORK,e,i,i)),i=null},i.ontimeout=function(){var v=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",x=e.transitional||X_;e.timeoutErrorMessage&&(v=e.timeoutErrorMessage),s(new Pe(v,x.clarifyTimeoutError?Pe.ETIMEDOUT:Pe.ECONNABORTED,e,i)),i=null},$t.isStandardBrowserEnv()){var g=(e.withCredentials||W_(m))&&e.xsrfCookieName?N_.read(e.xsrfCookieName):void 0;g&&(l[e.xsrfHeaderName]=g)}"setRequestHeader"in i&&$t.forEach(l,function(v,x){typeof a>"u"&&x.toLowerCase()==="content-type"?delete l[x]:i.setRequestHeader(x,v)}),$t.isUndefined(e.withCredentials)||(i.withCredentials=!!e.withCredentials),c&&c!=="json"&&(i.responseType=e.responseType),typeof e.onDownloadProgress=="function"&&i.addEventListener("progress",e.onDownloadProgress),typeof e.onUploadProgress=="function"&&i.upload&&i.upload.addEventListener("progress",e.onUploadProgress),(e.cancelToken||e.signal)&&(h=function(w){i&&(s(!w||w&&w.type?new Y_:w),i.abort(),i=null)},e.cancelToken&&e.cancelToken.subscribe(h),e.signal&&(e.signal.aborted?h():e.signal.addEventListener("abort",h))),a||(a=null);var f=G_(m);if(f&&["http","https","file"].indexOf(f)===-1){s(new Pe("Unsupported protocol "+f+":",Pe.ERR_BAD_REQUEST,e));return}i.send(a)})}});var zs=Y((c0,Ds)=>{Ds.exports=null});var Sn=Y((_0,qs)=>{"use strict";var ee=K(),Hs=hs(),Us=$e(),Q_=Fr(),$_=Ir(),Z_={"Content-Type":"application/x-www-form-urlencoded"};function Ns(t,e){!ee.isUndefined(t)&&ee.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}function J_(){var t;return typeof XMLHttpRequest<"u"?t=kr():typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]"&&(t=kr()),t}function K_(t,e,n){if(ee.isString(t))try{return(e||JSON.parse)(t),ee.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(t)}var jn={transitional:Q_,adapter:J_(),transformRequest:[function(e,n){if(Hs(n,"Accept"),Hs(n,"Content-Type"),ee.isFormData(e)||ee.isArrayBuffer(e)||ee.isBuffer(e)||ee.isStream(e)||ee.isFile(e)||ee.isBlob(e))return e;if(ee.isArrayBufferView(e))return e.buffer;if(ee.isURLSearchParams(e))return Ns(n,"application/x-www-form-urlencoded;charset=utf-8"),e.toString();var r=ee.isObject(e),s=n&&n["Content-Type"],a;if((a=ee.isFileList(e))||r&&s==="multipart/form-data"){var l=this.env&&this.env.FormData;return $_(a?{"files[]":e}:e,l&&new l)}else if(r||s==="application/json")return Ns(n,"application/json"),K_(e);return e}],transformResponse:[function(e){var n=this.transitional||jn.transitional,r=n&&n.silentJSONParsing,s=n&&n.forcedJSONParsing,a=!r&&this.responseType==="json";if(a||s&&ee.isString(e)&&e.length)try{return JSON.parse(e)}catch(l){if(a)throw l.name==="SyntaxError"?Us.from(l,Us.ERR_BAD_RESPONSE,this,null,this.response):l}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:zs()},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};ee.forEach(["delete","get","head"],function(e){jn.headers[e]={}});ee.forEach(["post","put","patch"],function(e){jn.headers[e]=ee.merge(Z_)});qs.exports=jn});var Bs=Y((h0,Vs)=>{"use strict";var eh=K(),th=Sn();Vs.exports=function(e,n,r){var s=this||th;return eh.forEach(r,function(l){e=l.call(s,e,n)}),e}});var Dr=Y((p0,Ws)=>{"use strict";Ws.exports=function(e){return!!(e&&e.__CANCEL__)}});var Gs=Y((d0,Ys)=>{"use strict";var Xs=K(),zr=Bs(),nh=Dr(),rh=Sn(),ih=Qt();function Hr(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new ih}Ys.exports=function(e){Hr(e),e.headers=e.headers||{},e.data=zr.call(e,e.data,e.headers,e.transformRequest),e.headers=Xs.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),Xs.forEach(["delete","get","head","post","put","patch","common"],function(s){delete e.headers[s]});var n=e.adapter||rh.adapter;return n(e).then(function(s){return Hr(e),s.data=zr.call(e,s.data,s.headers,e.transformResponse),s},function(s){return nh(s)||(Hr(e),s&&s.response&&(s.response.data=zr.call(e,s.response.data,s.response.headers,e.transformResponse))),Promise.reject(s)})}});var Ur=Y((m0,Qs)=>{"use strict";var ae=K();Qs.exports=function(e,n){n=n||{};var r={};function s(i,o){return ae.isPlainObject(i)&&ae.isPlainObject(o)?ae.merge(i,o):ae.isPlainObject(o)?ae.merge({},o):ae.isArray(o)?o.slice():o}function a(i){if(ae.isUndefined(n[i])){if(!ae.isUndefined(e[i]))return s(void 0,e[i])}else return s(e[i],n[i])}function l(i){if(!ae.isUndefined(n[i]))return s(void 0,n[i])}function c(i){if(ae.isUndefined(n[i])){if(!ae.isUndefined(e[i]))return s(void 0,e[i])}else return s(void 0,n[i])}function h(i){if(i in n)return s(e[i],n[i]);if(i in e)return s(void 0,e[i])}var d={url:l,method:l,data:l,baseURL:c,transformRequest:c,transformResponse:c,paramsSerializer:c,timeout:c,timeoutMessage:c,withCredentials:c,adapter:c,responseType:c,xsrfCookieName:c,xsrfHeaderName:c,onUploadProgress:c,onDownloadProgress:c,decompress:c,maxContentLength:c,maxBodyLength:c,beforeRedirect:c,transport:c,httpAgent:c,httpsAgent:c,cancelToken:c,socketPath:c,responseEncoding:c,validateStatus:h};return ae.forEach(Object.keys(e).concat(Object.keys(n)),function(o){var _=d[o]||a,m=_(o);ae.isUndefined(m)&&_!==h||(r[o]=m)}),r}});var Nr=Y((f0,$s)=>{$s.exports={version:"0.27.2"}});var Ks=Y((u0,Js)=>{"use strict";var sh=Nr().version,De=$e(),qr={};["object","boolean","number","function","string","symbol"].forEach(function(t,e){qr[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});var Zs={};qr.transitional=function(e,n,r){function s(a,l){return"[Axios v"+sh+"] Transitional option '"+a+"'"+l+(r?". "+r:"")}return function(a,l,c){if(e===!1)throw new De(s(l," has been removed"+(n?" in "+n:"")),De.ERR_DEPRECATED);return n&&!Zs[l]&&(Zs[l]=!0,console.warn(s(l," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(a,l,c):!0}};function ah(t,e,n){if(typeof t!="object")throw new De("options must be an object",De.ERR_BAD_OPTION_VALUE);for(var r=Object.keys(t),s=r.length;s-- >0;){var a=r[s],l=e[a];if(l){var c=t[a],h=c===void 0||l(c,a,t);if(h!==!0)throw new De("option "+a+" must be "+h,De.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new De("Unknown option "+a,De.ERR_BAD_OPTION)}}Js.exports={assertOptions:ah,validators:qr}});var sa=Y((g0,ia)=>{"use strict";var na=K(),oh=Er(),ea=cs(),ta=Gs(),Pn=Ur(),lh=Cr(),ra=Ks(),Et=ra.validators;function Ft(t){this.defaults=t,this.interceptors={request:new ea,response:new ea}}Ft.prototype.request=function(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=Pn(this.defaults,n),n.method?n.method=n.method.toLowerCase():this.defaults.method?n.method=this.defaults.method.toLowerCase():n.method="get";var r=n.transitional;r!==void 0&&ra.assertOptions(r,{silentJSONParsing:Et.transitional(Et.boolean),forcedJSONParsing:Et.transitional(Et.boolean),clarifyTimeoutError:Et.transitional(Et.boolean)},!1);var s=[],a=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(n)===!1||(a=a&&m.synchronous,s.unshift(m.fulfilled,m.rejected))});var l=[];this.interceptors.response.forEach(function(m){l.push(m.fulfilled,m.rejected)});var c;if(!a){var h=[ta,void 0];for(Array.prototype.unshift.apply(h,s),h=h.concat(l),c=Promise.resolve(n);h.length;)c=c.then(h.shift(),h.shift());return c}for(var d=n;s.length;){var i=s.shift(),o=s.shift();try{d=i(d)}catch(_){o(_);break}}try{c=ta(d)}catch(_){return Promise.reject(_)}for(;l.length;)c=c.then(l.shift(),l.shift());return c};Ft.prototype.getUri=function(e){e=Pn(this.defaults,e);var n=lh(e.baseURL,e.url);return oh(n,e.params,e.paramsSerializer)};na.forEach(["delete","get","head","options"],function(e){Ft.prototype[e]=function(n,r){return this.request(Pn(r||{},{method:e,url:n,data:(r||{}).data}))}});na.forEach(["post","put","patch"],function(e){function n(r){return function(a,l,c){return this.request(Pn(c||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:a,data:l}))}}Ft.prototype[e]=n(),Ft.prototype[e+"Form"]=n(!0)});ia.exports=Ft});var oa=Y((w0,aa)=>{"use strict";var ch=Qt();function It(t){if(typeof t!="function")throw new TypeError("executor must be a function.");var e;this.promise=new Promise(function(s){e=s});var n=this;this.promise.then(function(r){if(n._listeners){var s,a=n._listeners.length;for(s=0;s<a;s++)n._listeners[s](r);n._listeners=null}}),this.promise.then=function(r){var s,a=new Promise(function(l){n.subscribe(l),s=l}).then(r);return a.cancel=function(){n.unsubscribe(s)},a},t(function(s){n.reason||(n.reason=new ch(s),e(n.reason))})}It.prototype.throwIfRequested=function(){if(this.reason)throw this.reason};It.prototype.subscribe=function(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]};It.prototype.unsubscribe=function(e){if(this._listeners){var n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}};It.source=function(){var e,n=new It(function(s){e=s});return{token:n,cancel:e}};aa.exports=It});var ca=Y((v0,la)=>{"use strict";la.exports=function(e){return function(r){return e.apply(null,r)}}});var ha=Y((x0,_a)=>{"use strict";var _h=K();_a.exports=function(e){return _h.isObject(e)&&e.isAxiosError===!0}});var ma=Y((y0,Vr)=>{"use strict";var pa=K(),hh=br(),En=sa(),ph=Ur(),dh=Sn();function da(t){var e=new En(t),n=hh(En.prototype.request,e);return pa.extend(n,En.prototype,e),pa.extend(n,e),n.create=function(s){return da(ph(t,s))},n}var re=da(dh);re.Axios=En;re.CanceledError=Qt();re.CancelToken=oa();re.isCancel=Dr();re.VERSION=Nr().version;re.toFormData=Ir();re.AxiosError=$e();re.Cancel=re.CanceledError;re.all=function(e){return Promise.all(e)};re.spread=ca();re.isAxiosError=ha();Vr.exports=re;Vr.exports.default=re});var Br=Y((b0,fa)=>{fa.exports=ma()});var ii=Y(Qn=>{(function(){"use strict";var t=function(){this.init()};t.prototype={init:function(){var i=this||e;return i._counter=1e3,i._html5AudioPool=[],i.html5PoolSize=10,i._codecs={},i._howls=[],i._muted=!1,i._volume=1,i._canPlayEvent="canplaythrough",i._navigator=typeof window<"u"&&window.navigator?window.navigator:null,i.masterGain=null,i.noAudio=!1,i.usingWebAudio=!0,i.autoSuspend=!0,i.ctx=null,i.autoUnlock=!0,i._setup(),i},volume:function(i){var o=this||e;if(i=parseFloat(i),o.ctx||d(),typeof i<"u"&&i>=0&&i<=1){if(o._volume=i,o._muted)return o;o.usingWebAudio&&o.masterGain.gain.setValueAtTime(i,e.ctx.currentTime);for(var _=0;_<o._howls.length;_++)if(!o._howls[_]._webAudio)for(var m=o._howls[_]._getSoundIds(),u=0;u<m.length;u++){var g=o._howls[_]._soundById(m[u]);g&&g._node&&(g._node.volume=g._volume*i)}return o}return o._volume},mute:function(i){var o=this||e;o.ctx||d(),o._muted=i,o.usingWebAudio&&o.masterGain.gain.setValueAtTime(i?0:o._volume,e.ctx.currentTime);for(var _=0;_<o._howls.length;_++)if(!o._howls[_]._webAudio)for(var m=o._howls[_]._getSoundIds(),u=0;u<m.length;u++){var g=o._howls[_]._soundById(m[u]);g&&g._node&&(g._node.muted=i?!0:g._muted)}return o},stop:function(){for(var i=this||e,o=0;o<i._howls.length;o++)i._howls[o].stop();return i},unload:function(){for(var i=this||e,o=i._howls.length-1;o>=0;o--)i._howls[o].unload();return i.usingWebAudio&&i.ctx&&typeof i.ctx.close<"u"&&(i.ctx.close(),i.ctx=null,d()),i},codecs:function(i){return(this||e)._codecs[i.replace(/^x-/,"")]},_setup:function(){var i=this||e;if(i.state=i.ctx&&i.ctx.state||"suspended",i._autoSuspend(),!i.usingWebAudio)if(typeof Audio<"u")try{var o=new Audio;typeof o.oncanplaythrough>"u"&&(i._canPlayEvent="canplay")}catch{i.noAudio=!0}else i.noAudio=!0;try{var o=new Audio;o.muted&&(i.noAudio=!0)}catch{}return i.noAudio||i._setupCodecs(),i},_setupCodecs:function(){var i=this||e,o=null;try{o=typeof Audio<"u"?new Audio:null}catch{return i}if(!o||typeof o.canPlayType!="function")return i;var _=o.canPlayType("audio/mpeg;").replace(/^no$/,""),m=i._navigator?i._navigator.userAgent:"",u=m.match(/OPR\/([0-6].)/g),g=u&&parseInt(u[0].split("/")[1],10)<33,f=m.indexOf("Safari")!==-1&&m.indexOf("Chrome")===-1,w=m.match(/Version\/(.*?) /),v=f&&w&&parseInt(w[1],10)<15;return i._codecs={mp3:!!(!g&&(_||o.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!_,opus:!!o.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!o.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!o.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(o.canPlayType('audio/wav; codecs="1"')||o.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!o.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!o.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(o.canPlayType("audio/x-m4a;")||o.canPlayType("audio/m4a;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(o.canPlayType("audio/x-m4b;")||o.canPlayType("audio/m4b;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(o.canPlayType("audio/x-mp4;")||o.canPlayType("audio/mp4;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!v&&o.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!v&&o.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!o.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(o.canPlayType("audio/x-flac;")||o.canPlayType("audio/flac;")).replace(/^no$/,"")},i},_unlockAudio:function(){var i=this||e;if(!(i._audioUnlocked||!i.ctx)){i._audioUnlocked=!1,i.autoUnlock=!1,!i._mobileUnloaded&&i.ctx.sampleRate!==44100&&(i._mobileUnloaded=!0,i.unload()),i._scratchBuffer=i.ctx.createBuffer(1,1,22050);var o=function(_){for(;i._html5AudioPool.length<i.html5PoolSize;)try{var m=new Audio;m._unlocked=!0,i._releaseHtml5Audio(m)}catch{i.noAudio=!0;break}for(var u=0;u<i._howls.length;u++)if(!i._howls[u]._webAudio)for(var g=i._howls[u]._getSoundIds(),f=0;f<g.length;f++){var w=i._howls[u]._soundById(g[f]);w&&w._node&&!w._node._unlocked&&(w._node._unlocked=!0,w._node.load())}i._autoResume();var v=i.ctx.createBufferSource();v.buffer=i._scratchBuffer,v.connect(i.ctx.destination),typeof v.start>"u"?v.noteOn(0):v.start(0),typeof i.ctx.resume=="function"&&i.ctx.resume(),v.onended=function(){v.disconnect(0),i._audioUnlocked=!0,document.removeEventListener("touchstart",o,!0),document.removeEventListener("touchend",o,!0),document.removeEventListener("click",o,!0),document.removeEventListener("keydown",o,!0);for(var x=0;x<i._howls.length;x++)i._howls[x]._emit("unlock")}};return document.addEventListener("touchstart",o,!0),document.addEventListener("touchend",o,!0),document.addEventListener("click",o,!0),document.addEventListener("keydown",o,!0),i}},_obtainHtml5Audio:function(){var i=this||e;if(i._html5AudioPool.length)return i._html5AudioPool.pop();var o=new Audio().play();return o&&typeof Promise<"u"&&(o instanceof Promise||typeof o.then=="function")&&o.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(i){var o=this||e;return i._unlocked&&o._html5AudioPool.push(i),o},_autoSuspend:function(){var i=this;if(!(!i.autoSuspend||!i.ctx||typeof i.ctx.suspend>"u"||!e.usingWebAudio)){for(var o=0;o<i._howls.length;o++)if(i._howls[o]._webAudio){for(var _=0;_<i._howls[o]._sounds.length;_++)if(!i._howls[o]._sounds[_]._paused)return i}return i._suspendTimer&&clearTimeout(i._suspendTimer),i._suspendTimer=setTimeout(function(){if(i.autoSuspend){i._suspendTimer=null,i.state="suspending";var m=function(){i.state="suspended",i._resumeAfterSuspend&&(delete i._resumeAfterSuspend,i._autoResume())};i.ctx.suspend().then(m,m)}},3e4),i}},_autoResume:function(){var i=this;if(!(!i.ctx||typeof i.ctx.resume>"u"||!e.usingWebAudio))return i.state==="running"&&i.ctx.state!=="interrupted"&&i._suspendTimer?(clearTimeout(i._suspendTimer),i._suspendTimer=null):i.state==="suspended"||i.state==="running"&&i.ctx.state==="interrupted"?(i.ctx.resume().then(function(){i.state="running";for(var o=0;o<i._howls.length;o++)i._howls[o]._emit("resume")}),i._suspendTimer&&(clearTimeout(i._suspendTimer),i._suspendTimer=null)):i.state==="suspending"&&(i._resumeAfterSuspend=!0),i}};var e=new t,n=function(i){var o=this;if(!i.src||i.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}o.init(i)};n.prototype={init:function(i){var o=this;return e.ctx||d(),o._autoplay=i.autoplay||!1,o._format=typeof i.format!="string"?i.format:[i.format],o._html5=i.html5||!1,o._muted=i.mute||!1,o._loop=i.loop||!1,o._pool=i.pool||5,o._preload=typeof i.preload=="boolean"||i.preload==="metadata"?i.preload:!0,o._rate=i.rate||1,o._sprite=i.sprite||{},o._src=typeof i.src!="string"?i.src:[i.src],o._volume=i.volume!==void 0?i.volume:1,o._xhr={method:i.xhr&&i.xhr.method?i.xhr.method:"GET",headers:i.xhr&&i.xhr.headers?i.xhr.headers:null,withCredentials:i.xhr&&i.xhr.withCredentials?i.xhr.withCredentials:!1},o._duration=0,o._state="unloaded",o._sounds=[],o._endTimers={},o._queue=[],o._playLock=!1,o._onend=i.onend?[{fn:i.onend}]:[],o._onfade=i.onfade?[{fn:i.onfade}]:[],o._onload=i.onload?[{fn:i.onload}]:[],o._onloaderror=i.onloaderror?[{fn:i.onloaderror}]:[],o._onplayerror=i.onplayerror?[{fn:i.onplayerror}]:[],o._onpause=i.onpause?[{fn:i.onpause}]:[],o._onplay=i.onplay?[{fn:i.onplay}]:[],o._onstop=i.onstop?[{fn:i.onstop}]:[],o._onmute=i.onmute?[{fn:i.onmute}]:[],o._onvolume=i.onvolume?[{fn:i.onvolume}]:[],o._onrate=i.onrate?[{fn:i.onrate}]:[],o._onseek=i.onseek?[{fn:i.onseek}]:[],o._onunlock=i.onunlock?[{fn:i.onunlock}]:[],o._onresume=[],o._webAudio=e.usingWebAudio&&!o._html5,typeof e.ctx<"u"&&e.ctx&&e.autoUnlock&&e._unlockAudio(),e._howls.push(o),o._autoplay&&o._queue.push({event:"play",action:function(){o.play()}}),o._preload&&o._preload!=="none"&&o.load(),o},load:function(){var i=this,o=null;if(e.noAudio){i._emit("loaderror",null,"No audio support.");return}typeof i._src=="string"&&(i._src=[i._src]);for(var _=0;_<i._src.length;_++){var m,u;if(i._format&&i._format[_])m=i._format[_];else{if(u=i._src[_],typeof u!="string"){i._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}m=/^data:audio\/([^;,]+);/i.exec(u),m||(m=/\.([^.]+)$/.exec(u.split("?",1)[0])),m&&(m=m[1].toLowerCase())}if(m||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),m&&e.codecs(m)){o=i._src[_];break}}if(!o){i._emit("loaderror",null,"No codec support for selected audio sources.");return}return i._src=o,i._state="loading",window.location.protocol==="https:"&&o.slice(0,5)==="http:"&&(i._html5=!0,i._webAudio=!1),new r(i),i._webAudio&&a(i),i},play:function(i,o){var _=this,m=null;if(typeof i=="number")m=i,i=null;else{if(typeof i=="string"&&_._state==="loaded"&&!_._sprite[i])return null;if(typeof i>"u"&&(i="__default",!_._playLock)){for(var u=0,g=0;g<_._sounds.length;g++)_._sounds[g]._paused&&!_._sounds[g]._ended&&(u++,m=_._sounds[g]._id);u===1?i=null:m=null}}var f=m?_._soundById(m):_._inactiveSound();if(!f)return null;if(m&&!i&&(i=f._sprite||"__default"),_._state!=="loaded"){f._sprite=i,f._ended=!1;var w=f._id;return _._queue.push({event:"play",action:function(){_.play(w)}}),w}if(m&&!f._paused)return o||_._loadQueue("play"),f._id;_._webAudio&&e._autoResume();var v=Math.max(0,f._seek>0?f._seek:_._sprite[i][0]/1e3),x=Math.max(0,(_._sprite[i][0]+_._sprite[i][1])/1e3-v),T=x*1e3/Math.abs(f._rate),A=_._sprite[i][0]/1e3,j=(_._sprite[i][0]+_._sprite[i][1])/1e3;f._sprite=i,f._ended=!1;var I=function(){f._paused=!1,f._seek=v,f._start=A,f._stop=j,f._loop=!!(f._loop||_._sprite[i][2])};if(v>=j){_._ended(f);return}var E=f._node;if(_._webAudio){var D=function(){_._playLock=!1,I(),_._refreshBuffer(f);var k=f._muted||_._muted?0:f._volume;E.gain.setValueAtTime(k,e.ctx.currentTime),f._playStart=e.ctx.currentTime,typeof E.bufferSource.start>"u"?f._loop?E.bufferSource.noteGrainOn(0,v,86400):E.bufferSource.noteGrainOn(0,v,x):f._loop?E.bufferSource.start(0,v,86400):E.bufferSource.start(0,v,x),T!==1/0&&(_._endTimers[f._id]=setTimeout(_._ended.bind(_,f),T)),o||setTimeout(function(){_._emit("play",f._id),_._loadQueue()},0)};e.state==="running"&&e.ctx.state!=="interrupted"?D():(_._playLock=!0,_.once("resume",D),_._clearTimer(f._id))}else{var z=function(){E.currentTime=v,E.muted=f._muted||_._muted||e._muted||E.muted,E.volume=f._volume*e.volume(),E.playbackRate=f._rate;try{var k=E.play();if(k&&typeof Promise<"u"&&(k instanceof Promise||typeof k.then=="function")?(_._playLock=!0,I(),k.then(function(){_._playLock=!1,E._unlocked=!0,o?_._loadQueue():_._emit("play",f._id)}).catch(function(){_._playLock=!1,_._emit("playerror",f._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),f._ended=!0,f._paused=!0})):o||(_._playLock=!1,I(),_._emit("play",f._id)),E.playbackRate=f._rate,E.paused){_._emit("playerror",f._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}i!=="__default"||f._loop?_._endTimers[f._id]=setTimeout(_._ended.bind(_,f),T):(_._endTimers[f._id]=function(){_._ended(f),E.removeEventListener("ended",_._endTimers[f._id],!1)},E.addEventListener("ended",_._endTimers[f._id],!1))}catch(F){_._emit("playerror",f._id,F)}};E.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(E.src=_._src,E.load());var q=window&&window.ejecta||!E.readyState&&e._navigator.isCocoonJS;if(E.readyState>=3||q)z();else{_._playLock=!0,_._state="loading";var H=function(){_._state="loaded",z(),E.removeEventListener(e._canPlayEvent,H,!1)};E.addEventListener(e._canPlayEvent,H,!1),_._clearTimer(f._id)}}return f._id},pause:function(i){var o=this;if(o._state!=="loaded"||o._playLock)return o._queue.push({event:"pause",action:function(){o.pause(i)}}),o;for(var _=o._getSoundIds(i),m=0;m<_.length;m++){o._clearTimer(_[m]);var u=o._soundById(_[m]);if(u&&!u._paused&&(u._seek=o.seek(_[m]),u._rateSeek=0,u._paused=!0,o._stopFade(_[m]),u._node))if(o._webAudio){if(!u._node.bufferSource)continue;typeof u._node.bufferSource.stop>"u"?u._node.bufferSource.noteOff(0):u._node.bufferSource.stop(0),o._cleanBuffer(u._node)}else(!isNaN(u._node.duration)||u._node.duration===1/0)&&u._node.pause();arguments[1]||o._emit("pause",u?u._id:null)}return o},stop:function(i,o){var _=this;if(_._state!=="loaded"||_._playLock)return _._queue.push({event:"stop",action:function(){_.stop(i)}}),_;for(var m=_._getSoundIds(i),u=0;u<m.length;u++){_._clearTimer(m[u]);var g=_._soundById(m[u]);g&&(g._seek=g._start||0,g._rateSeek=0,g._paused=!0,g._ended=!0,_._stopFade(m[u]),g._node&&(_._webAudio?g._node.bufferSource&&(typeof g._node.bufferSource.stop>"u"?g._node.bufferSource.noteOff(0):g._node.bufferSource.stop(0),_._cleanBuffer(g._node)):(!isNaN(g._node.duration)||g._node.duration===1/0)&&(g._node.currentTime=g._start||0,g._node.pause(),g._node.duration===1/0&&_._clearSound(g._node))),o||_._emit("stop",g._id))}return _},mute:function(i,o){var _=this;if(_._state!=="loaded"||_._playLock)return _._queue.push({event:"mute",action:function(){_.mute(i,o)}}),_;if(typeof o>"u")if(typeof i=="boolean")_._muted=i;else return _._muted;for(var m=_._getSoundIds(o),u=0;u<m.length;u++){var g=_._soundById(m[u]);g&&(g._muted=i,g._interval&&_._stopFade(g._id),_._webAudio&&g._node?g._node.gain.setValueAtTime(i?0:g._volume,e.ctx.currentTime):g._node&&(g._node.muted=e._muted?!0:i),_._emit("mute",g._id))}return _},volume:function(){var i=this,o=arguments,_,m;if(o.length===0)return i._volume;if(o.length===1||o.length===2&&typeof o[1]>"u"){var u=i._getSoundIds(),g=u.indexOf(o[0]);g>=0?m=parseInt(o[0],10):_=parseFloat(o[0])}else o.length>=2&&(_=parseFloat(o[0]),m=parseInt(o[1],10));var f;if(typeof _<"u"&&_>=0&&_<=1){if(i._state!=="loaded"||i._playLock)return i._queue.push({event:"volume",action:function(){i.volume.apply(i,o)}}),i;typeof m>"u"&&(i._volume=_),m=i._getSoundIds(m);for(var w=0;w<m.length;w++)f=i._soundById(m[w]),f&&(f._volume=_,o[2]||i._stopFade(m[w]),i._webAudio&&f._node&&!f._muted?f._node.gain.setValueAtTime(_,e.ctx.currentTime):f._node&&!f._muted&&(f._node.volume=_*e.volume()),i._emit("volume",f._id))}else return f=m?i._soundById(m):i._sounds[0],f?f._volume:0;return i},fade:function(i,o,_,m){var u=this;if(u._state!=="loaded"||u._playLock)return u._queue.push({event:"fade",action:function(){u.fade(i,o,_,m)}}),u;i=Math.min(Math.max(0,parseFloat(i)),1),o=Math.min(Math.max(0,parseFloat(o)),1),_=parseFloat(_),u.volume(i,m);for(var g=u._getSoundIds(m),f=0;f<g.length;f++){var w=u._soundById(g[f]);if(w){if(m||u._stopFade(g[f]),u._webAudio&&!w._muted){var v=e.ctx.currentTime,x=v+_/1e3;w._volume=i,w._node.gain.setValueAtTime(i,v),w._node.gain.linearRampToValueAtTime(o,x)}u._startFadeInterval(w,i,o,_,g[f],typeof m>"u")}}return u},_startFadeInterval:function(i,o,_,m,u,g){var f=this,w=o,v=_-o,x=Math.abs(v/.01),T=Math.max(4,x>0?m/x:m),A=Date.now();i._fadeTo=_,i._interval=setInterval(function(){var j=(Date.now()-A)/m;A=Date.now(),w+=v*j,w=Math.round(w*100)/100,v<0?w=Math.max(_,w):w=Math.min(_,w),f._webAudio?i._volume=w:f.volume(w,i._id,!0),g&&(f._volume=w),(_<o&&w<=_||_>o&&w>=_)&&(clearInterval(i._interval),i._interval=null,i._fadeTo=null,f.volume(_,i._id),f._emit("fade",i._id))},T)},_stopFade:function(i){var o=this,_=o._soundById(i);return _&&_._interval&&(o._webAudio&&_._node.gain.cancelScheduledValues(e.ctx.currentTime),clearInterval(_._interval),_._interval=null,o.volume(_._fadeTo,i),_._fadeTo=null,o._emit("fade",i)),o},loop:function(){var i=this,o=arguments,_,m,u;if(o.length===0)return i._loop;if(o.length===1)if(typeof o[0]=="boolean")_=o[0],i._loop=_;else return u=i._soundById(parseInt(o[0],10)),u?u._loop:!1;else o.length===2&&(_=o[0],m=parseInt(o[1],10));for(var g=i._getSoundIds(m),f=0;f<g.length;f++)u=i._soundById(g[f]),u&&(u._loop=_,i._webAudio&&u._node&&u._node.bufferSource&&(u._node.bufferSource.loop=_,_&&(u._node.bufferSource.loopStart=u._start||0,u._node.bufferSource.loopEnd=u._stop,i.playing(g[f])&&(i.pause(g[f],!0),i.play(g[f],!0)))));return i},rate:function(){var i=this,o=arguments,_,m;if(o.length===0)m=i._sounds[0]._id;else if(o.length===1){var u=i._getSoundIds(),g=u.indexOf(o[0]);g>=0?m=parseInt(o[0],10):_=parseFloat(o[0])}else o.length===2&&(_=parseFloat(o[0]),m=parseInt(o[1],10));var f;if(typeof _=="number"){if(i._state!=="loaded"||i._playLock)return i._queue.push({event:"rate",action:function(){i.rate.apply(i,o)}}),i;typeof m>"u"&&(i._rate=_),m=i._getSoundIds(m);for(var w=0;w<m.length;w++)if(f=i._soundById(m[w]),f){i.playing(m[w])&&(f._rateSeek=i.seek(m[w]),f._playStart=i._webAudio?e.ctx.currentTime:f._playStart),f._rate=_,i._webAudio&&f._node&&f._node.bufferSource?f._node.bufferSource.playbackRate.setValueAtTime(_,e.ctx.currentTime):f._node&&(f._node.playbackRate=_);var v=i.seek(m[w]),x=(i._sprite[f._sprite][0]+i._sprite[f._sprite][1])/1e3-v,T=x*1e3/Math.abs(f._rate);(i._endTimers[m[w]]||!f._paused)&&(i._clearTimer(m[w]),i._endTimers[m[w]]=setTimeout(i._ended.bind(i,f),T)),i._emit("rate",f._id)}}else return f=i._soundById(m),f?f._rate:i._rate;return i},seek:function(){var i=this,o=arguments,_,m;if(o.length===0)i._sounds.length&&(m=i._sounds[0]._id);else if(o.length===1){var u=i._getSoundIds(),g=u.indexOf(o[0]);g>=0?m=parseInt(o[0],10):i._sounds.length&&(m=i._sounds[0]._id,_=parseFloat(o[0]))}else o.length===2&&(_=parseFloat(o[0]),m=parseInt(o[1],10));if(typeof m>"u")return 0;if(typeof _=="number"&&(i._state!=="loaded"||i._playLock))return i._queue.push({event:"seek",action:function(){i.seek.apply(i,o)}}),i;var f=i._soundById(m);if(f)if(typeof _=="number"&&_>=0){var w=i.playing(m);w&&i.pause(m,!0),f._seek=_,f._ended=!1,i._clearTimer(m),!i._webAudio&&f._node&&!isNaN(f._node.duration)&&(f._node.currentTime=_);var v=function(){w&&i.play(m,!0),i._emit("seek",m)};if(w&&!i._webAudio){var x=function(){i._playLock?setTimeout(x,0):v()};setTimeout(x,0)}else v()}else if(i._webAudio){var T=i.playing(m)?e.ctx.currentTime-f._playStart:0,A=f._rateSeek?f._rateSeek-f._seek:0;return f._seek+(A+T*Math.abs(f._rate))}else return f._node.currentTime;return i},playing:function(i){var o=this;if(typeof i=="number"){var _=o._soundById(i);return _?!_._paused:!1}for(var m=0;m<o._sounds.length;m++)if(!o._sounds[m]._paused)return!0;return!1},duration:function(i){var o=this,_=o._duration,m=o._soundById(i);return m&&(_=o._sprite[m._sprite][1]/1e3),_},state:function(){return this._state},unload:function(){for(var i=this,o=i._sounds,_=0;_<o.length;_++)o[_]._paused||i.stop(o[_]._id),i._webAudio||(i._clearSound(o[_]._node),o[_]._node.removeEventListener("error",o[_]._errorFn,!1),o[_]._node.removeEventListener(e._canPlayEvent,o[_]._loadFn,!1),o[_]._node.removeEventListener("ended",o[_]._endFn,!1),e._releaseHtml5Audio(o[_]._node)),delete o[_]._node,i._clearTimer(o[_]._id);var m=e._howls.indexOf(i);m>=0&&e._howls.splice(m,1);var u=!0;for(_=0;_<e._howls.length;_++)if(e._howls[_]._src===i._src||i._src.indexOf(e._howls[_]._src)>=0){u=!1;break}return s&&u&&delete s[i._src],e.noAudio=!1,i._state="unloaded",i._sounds=[],i=null,null},on:function(i,o,_,m){var u=this,g=u["_on"+i];return typeof o=="function"&&g.push(m?{id:_,fn:o,once:m}:{id:_,fn:o}),u},off:function(i,o,_){var m=this,u=m["_on"+i],g=0;if(typeof o=="number"&&(_=o,o=null),o||_)for(g=0;g<u.length;g++){var f=_===u[g].id;if(o===u[g].fn&&f||!o&&f){u.splice(g,1);break}}else if(i)m["_on"+i]=[];else{var w=Object.keys(m);for(g=0;g<w.length;g++)w[g].indexOf("_on")===0&&Array.isArray(m[w[g]])&&(m[w[g]]=[])}return m},once:function(i,o,_){var m=this;return m.on(i,o,_,1),m},_emit:function(i,o,_){for(var m=this,u=m["_on"+i],g=u.length-1;g>=0;g--)(!u[g].id||u[g].id===o||i==="load")&&(setTimeout(function(f){f.call(this,o,_)}.bind(m,u[g].fn),0),u[g].once&&m.off(i,u[g].fn,u[g].id));return m._loadQueue(i),m},_loadQueue:function(i){var o=this;if(o._queue.length>0){var _=o._queue[0];_.event===i&&(o._queue.shift(),o._loadQueue()),i||_.action()}return o},_ended:function(i){var o=this,_=i._sprite;if(!o._webAudio&&i._node&&!i._node.paused&&!i._node.ended&&i._node.currentTime<i._stop)return setTimeout(o._ended.bind(o,i),100),o;var m=!!(i._loop||o._sprite[_][2]);if(o._emit("end",i._id),!o._webAudio&&m&&o.stop(i._id,!0).play(i._id),o._webAudio&&m){o._emit("play",i._id),i._seek=i._start||0,i._rateSeek=0,i._playStart=e.ctx.currentTime;var u=(i._stop-i._start)*1e3/Math.abs(i._rate);o._endTimers[i._id]=setTimeout(o._ended.bind(o,i),u)}return o._webAudio&&!m&&(i._paused=!0,i._ended=!0,i._seek=i._start||0,i._rateSeek=0,o._clearTimer(i._id),o._cleanBuffer(i._node),e._autoSuspend()),!o._webAudio&&!m&&o.stop(i._id,!0),o},_clearTimer:function(i){var o=this;if(o._endTimers[i]){if(typeof o._endTimers[i]!="function")clearTimeout(o._endTimers[i]);else{var _=o._soundById(i);_&&_._node&&_._node.removeEventListener("ended",o._endTimers[i],!1)}delete o._endTimers[i]}return o},_soundById:function(i){for(var o=this,_=0;_<o._sounds.length;_++)if(i===o._sounds[_]._id)return o._sounds[_];return null},_inactiveSound:function(){var i=this;i._drain();for(var o=0;o<i._sounds.length;o++)if(i._sounds[o]._ended)return i._sounds[o].reset();return new r(i)},_drain:function(){var i=this,o=i._pool,_=0,m=0;if(!(i._sounds.length<o)){for(m=0;m<i._sounds.length;m++)i._sounds[m]._ended&&_++;for(m=i._sounds.length-1;m>=0;m--){if(_<=o)return;i._sounds[m]._ended&&(i._webAudio&&i._sounds[m]._node&&i._sounds[m]._node.disconnect(0),i._sounds.splice(m,1),_--)}}},_getSoundIds:function(i){var o=this;if(typeof i>"u"){for(var _=[],m=0;m<o._sounds.length;m++)_.push(o._sounds[m]._id);return _}else return[i]},_refreshBuffer:function(i){var o=this;return i._node.bufferSource=e.ctx.createBufferSource(),i._node.bufferSource.buffer=s[o._src],i._panner?i._node.bufferSource.connect(i._panner):i._node.bufferSource.connect(i._node),i._node.bufferSource.loop=i._loop,i._loop&&(i._node.bufferSource.loopStart=i._start||0,i._node.bufferSource.loopEnd=i._stop||0),i._node.bufferSource.playbackRate.setValueAtTime(i._rate,e.ctx.currentTime),o},_cleanBuffer:function(i){var o=this,_=e._navigator&&e._navigator.vendor.indexOf("Apple")>=0;if(e._scratchBuffer&&i.bufferSource&&(i.bufferSource.onended=null,i.bufferSource.disconnect(0),_))try{i.bufferSource.buffer=e._scratchBuffer}catch{}return i.bufferSource=null,o},_clearSound:function(i){var o=/MSIE |Trident\//.test(e._navigator&&e._navigator.userAgent);o||(i.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var r=function(i){this._parent=i,this.init()};r.prototype={init:function(){var i=this,o=i._parent;return i._muted=o._muted,i._loop=o._loop,i._volume=o._volume,i._rate=o._rate,i._seek=0,i._paused=!0,i._ended=!0,i._sprite="__default",i._id=++e._counter,o._sounds.push(i),i.create(),i},create:function(){var i=this,o=i._parent,_=e._muted||i._muted||i._parent._muted?0:i._volume;return o._webAudio?(i._node=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),i._node.gain.setValueAtTime(_,e.ctx.currentTime),i._node.paused=!0,i._node.connect(e.masterGain)):e.noAudio||(i._node=e._obtainHtml5Audio(),i._errorFn=i._errorListener.bind(i),i._node.addEventListener("error",i._errorFn,!1),i._loadFn=i._loadListener.bind(i),i._node.addEventListener(e._canPlayEvent,i._loadFn,!1),i._endFn=i._endListener.bind(i),i._node.addEventListener("ended",i._endFn,!1),i._node.src=o._src,i._node.preload=o._preload===!0?"auto":o._preload,i._node.volume=_*e.volume(),i._node.load()),i},reset:function(){var i=this,o=i._parent;return i._muted=o._muted,i._loop=o._loop,i._volume=o._volume,i._rate=o._rate,i._seek=0,i._rateSeek=0,i._paused=!0,i._ended=!0,i._sprite="__default",i._id=++e._counter,i},_errorListener:function(){var i=this;i._parent._emit("loaderror",i._id,i._node.error?i._node.error.code:0),i._node.removeEventListener("error",i._errorFn,!1)},_loadListener:function(){var i=this,o=i._parent;o._duration=Math.ceil(i._node.duration*10)/10,Object.keys(o._sprite).length===0&&(o._sprite={__default:[0,o._duration*1e3]}),o._state!=="loaded"&&(o._state="loaded",o._emit("load"),o._loadQueue()),i._node.removeEventListener(e._canPlayEvent,i._loadFn,!1)},_endListener:function(){var i=this,o=i._parent;o._duration===1/0&&(o._duration=Math.ceil(i._node.duration*10)/10,o._sprite.__default[1]===1/0&&(o._sprite.__default[1]=o._duration*1e3),o._ended(i)),i._node.removeEventListener("ended",i._endFn,!1)}};var s={},a=function(i){var o=i._src;if(s[o]){i._duration=s[o].duration,h(i);return}if(/^data:[^;]+;base64,/.test(o)){for(var _=atob(o.split(",")[1]),m=new Uint8Array(_.length),u=0;u<_.length;++u)m[u]=_.charCodeAt(u);c(m.buffer,i)}else{var g=new XMLHttpRequest;g.open(i._xhr.method,o,!0),g.withCredentials=i._xhr.withCredentials,g.responseType="arraybuffer",i._xhr.headers&&Object.keys(i._xhr.headers).forEach(function(f){g.setRequestHeader(f,i._xhr.headers[f])}),g.onload=function(){var f=(g.status+"")[0];if(f!=="0"&&f!=="2"&&f!=="3"){i._emit("loaderror",null,"Failed loading audio file with status: "+g.status+".");return}c(g.response,i)},g.onerror=function(){i._webAudio&&(i._html5=!0,i._webAudio=!1,i._sounds=[],delete s[o],i.load())},l(g)}},l=function(i){try{i.send()}catch{i.onerror()}},c=function(i,o){var _=function(){o._emit("loaderror",null,"Decoding audio data failed.")},m=function(u){u&&o._sounds.length>0?(s[o._src]=u,h(o,u)):_()};typeof Promise<"u"&&e.ctx.decodeAudioData.length===1?e.ctx.decodeAudioData(i).then(m).catch(_):e.ctx.decodeAudioData(i,m,_)},h=function(i,o){o&&!i._duration&&(i._duration=o.duration),Object.keys(i._sprite).length===0&&(i._sprite={__default:[0,i._duration*1e3]}),i._state!=="loaded"&&(i._state="loaded",i._emit("load"),i._loadQueue())},d=function(){if(e.usingWebAudio){try{typeof AudioContext<"u"?e.ctx=new AudioContext:typeof webkitAudioContext<"u"?e.ctx=new webkitAudioContext:e.usingWebAudio=!1}catch{e.usingWebAudio=!1}e.ctx||(e.usingWebAudio=!1);var i=/iP(hone|od|ad)/.test(e._navigator&&e._navigator.platform),o=e._navigator&&e._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),_=o?parseInt(o[1],10):null;if(i&&_&&_<9){var m=/safari/.test(e._navigator&&e._navigator.userAgent.toLowerCase());e._navigator&&!m&&(e.usingWebAudio=!1)}e.usingWebAudio&&(e.masterGain=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),e.masterGain.gain.setValueAtTime(e._muted?0:e._volume,e.ctx.currentTime),e.masterGain.connect(e.ctx.destination)),e._setup()}};typeof define=="function"&&define.amd&&define([],function(){return{Howler:e,Howl:n}}),typeof Qn<"u"&&(Qn.Howler=e,Qn.Howl=n),typeof global<"u"?(global.HowlerGlobal=t,global.Howler=e,global.Howl=n,global.Sound=r):typeof window<"u"&&(window.HowlerGlobal=t,window.Howler=e,window.Howl=n,window.Sound=r)})();(function(){"use strict";HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var n=this;if(!n.ctx||!n.ctx.listener)return n;for(var r=n._howls.length-1;r>=0;r--)n._howls[r].stereo(e);return n},HowlerGlobal.prototype.pos=function(e,n,r){var s=this;if(!s.ctx||!s.ctx.listener)return s;if(n=typeof n!="number"?s._pos[1]:n,r=typeof r!="number"?s._pos[2]:r,typeof e=="number")s._pos=[e,n,r],typeof s.ctx.listener.positionX<"u"?(s.ctx.listener.positionX.setTargetAtTime(s._pos[0],Howler.ctx.currentTime,.1),s.ctx.listener.positionY.setTargetAtTime(s._pos[1],Howler.ctx.currentTime,.1),s.ctx.listener.positionZ.setTargetAtTime(s._pos[2],Howler.ctx.currentTime,.1)):s.ctx.listener.setPosition(s._pos[0],s._pos[1],s._pos[2]);else return s._pos;return s},HowlerGlobal.prototype.orientation=function(e,n,r,s,a,l){var c=this;if(!c.ctx||!c.ctx.listener)return c;var h=c._orientation;if(n=typeof n!="number"?h[1]:n,r=typeof r!="number"?h[2]:r,s=typeof s!="number"?h[3]:s,a=typeof a!="number"?h[4]:a,l=typeof l!="number"?h[5]:l,typeof e=="number")c._orientation=[e,n,r,s,a,l],typeof c.ctx.listener.forwardX<"u"?(c.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),c.ctx.listener.forwardY.setTargetAtTime(n,Howler.ctx.currentTime,.1),c.ctx.listener.forwardZ.setTargetAtTime(r,Howler.ctx.currentTime,.1),c.ctx.listener.upX.setTargetAtTime(s,Howler.ctx.currentTime,.1),c.ctx.listener.upY.setTargetAtTime(a,Howler.ctx.currentTime,.1),c.ctx.listener.upZ.setTargetAtTime(l,Howler.ctx.currentTime,.1)):c.ctx.listener.setOrientation(e,n,r,s,a,l);else return h;return c},Howl.prototype.init=function(e){return function(n){var r=this;return r._orientation=n.orientation||[1,0,0],r._stereo=n.stereo||null,r._pos=n.pos||null,r._pannerAttr={coneInnerAngle:typeof n.coneInnerAngle<"u"?n.coneInnerAngle:360,coneOuterAngle:typeof n.coneOuterAngle<"u"?n.coneOuterAngle:360,coneOuterGain:typeof n.coneOuterGain<"u"?n.coneOuterGain:0,distanceModel:typeof n.distanceModel<"u"?n.distanceModel:"inverse",maxDistance:typeof n.maxDistance<"u"?n.maxDistance:1e4,panningModel:typeof n.panningModel<"u"?n.panningModel:"HRTF",refDistance:typeof n.refDistance<"u"?n.refDistance:1,rolloffFactor:typeof n.rolloffFactor<"u"?n.rolloffFactor:1},r._onstereo=n.onstereo?[{fn:n.onstereo}]:[],r._onpos=n.onpos?[{fn:n.onpos}]:[],r._onorientation=n.onorientation?[{fn:n.onorientation}]:[],e.call(this,n)}}(Howl.prototype.init),Howl.prototype.stereo=function(e,n){var r=this;if(!r._webAudio)return r;if(r._state!=="loaded")return r._queue.push({event:"stereo",action:function(){r.stereo(e,n)}}),r;var s=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof n>"u")if(typeof e=="number")r._stereo=e,r._pos=[e,0,0];else return r._stereo;for(var a=r._getSoundIds(n),l=0;l<a.length;l++){var c=r._soundById(a[l]);if(c)if(typeof e=="number")c._stereo=e,c._pos=[e,0,0],c._node&&(c._pannerAttr.panningModel="equalpower",(!c._panner||!c._panner.pan)&&t(c,s),s==="spatial"?typeof c._panner.positionX<"u"?(c._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),c._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),c._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):c._panner.setPosition(e,0,0):c._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),r._emit("stereo",c._id);else return c._stereo}return r},Howl.prototype.pos=function(e,n,r,s){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"pos",action:function(){a.pos(e,n,r,s)}}),a;if(n=typeof n!="number"?0:n,r=typeof r!="number"?-.5:r,typeof s>"u")if(typeof e=="number")a._pos=[e,n,r];else return a._pos;for(var l=a._getSoundIds(s),c=0;c<l.length;c++){var h=a._soundById(l[c]);if(h)if(typeof e=="number")h._pos=[e,n,r],h._node&&((!h._panner||h._panner.pan)&&t(h,"spatial"),typeof h._panner.positionX<"u"?(h._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),h._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),h._panner.positionZ.setValueAtTime(r,Howler.ctx.currentTime)):h._panner.setPosition(e,n,r)),a._emit("pos",h._id);else return h._pos}return a},Howl.prototype.orientation=function(e,n,r,s){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"orientation",action:function(){a.orientation(e,n,r,s)}}),a;if(n=typeof n!="number"?a._orientation[1]:n,r=typeof r!="number"?a._orientation[2]:r,typeof s>"u")if(typeof e=="number")a._orientation=[e,n,r];else return a._orientation;for(var l=a._getSoundIds(s),c=0;c<l.length;c++){var h=a._soundById(l[c]);if(h)if(typeof e=="number")h._orientation=[e,n,r],h._node&&(h._panner||(h._pos||(h._pos=a._pos||[0,0,-.5]),t(h,"spatial")),typeof h._panner.orientationX<"u"?(h._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),h._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),h._panner.orientationZ.setValueAtTime(r,Howler.ctx.currentTime)):h._panner.setOrientation(e,n,r)),a._emit("orientation",h._id);else return h._orientation}return a},Howl.prototype.pannerAttr=function(){var e=this,n=arguments,r,s,a;if(!e._webAudio)return e;if(n.length===0)return e._pannerAttr;if(n.length===1)if(typeof n[0]=="object")r=n[0],typeof s>"u"&&(r.pannerAttr||(r.pannerAttr={coneInnerAngle:r.coneInnerAngle,coneOuterAngle:r.coneOuterAngle,coneOuterGain:r.coneOuterGain,distanceModel:r.distanceModel,maxDistance:r.maxDistance,refDistance:r.refDistance,rolloffFactor:r.rolloffFactor,panningModel:r.panningModel}),e._pannerAttr={coneInnerAngle:typeof r.pannerAttr.coneInnerAngle<"u"?r.pannerAttr.coneInnerAngle:e._coneInnerAngle,coneOuterAngle:typeof r.pannerAttr.coneOuterAngle<"u"?r.pannerAttr.coneOuterAngle:e._coneOuterAngle,coneOuterGain:typeof r.pannerAttr.coneOuterGain<"u"?r.pannerAttr.coneOuterGain:e._coneOuterGain,distanceModel:typeof r.pannerAttr.distanceModel<"u"?r.pannerAttr.distanceModel:e._distanceModel,maxDistance:typeof r.pannerAttr.maxDistance<"u"?r.pannerAttr.maxDistance:e._maxDistance,refDistance:typeof r.pannerAttr.refDistance<"u"?r.pannerAttr.refDistance:e._refDistance,rolloffFactor:typeof r.pannerAttr.rolloffFactor<"u"?r.pannerAttr.rolloffFactor:e._rolloffFactor,panningModel:typeof r.pannerAttr.panningModel<"u"?r.pannerAttr.panningModel:e._panningModel});else return a=e._soundById(parseInt(n[0],10)),a?a._pannerAttr:e._pannerAttr;else n.length===2&&(r=n[0],s=parseInt(n[1],10));for(var l=e._getSoundIds(s),c=0;c<l.length;c++)if(a=e._soundById(l[c]),a){var h=a._pannerAttr;h={coneInnerAngle:typeof r.coneInnerAngle<"u"?r.coneInnerAngle:h.coneInnerAngle,coneOuterAngle:typeof r.coneOuterAngle<"u"?r.coneOuterAngle:h.coneOuterAngle,coneOuterGain:typeof r.coneOuterGain<"u"?r.coneOuterGain:h.coneOuterGain,distanceModel:typeof r.distanceModel<"u"?r.distanceModel:h.distanceModel,maxDistance:typeof r.maxDistance<"u"?r.maxDistance:h.maxDistance,refDistance:typeof r.refDistance<"u"?r.refDistance:h.refDistance,rolloffFactor:typeof r.rolloffFactor<"u"?r.rolloffFactor:h.rolloffFactor,panningModel:typeof r.panningModel<"u"?r.panningModel:h.panningModel};var d=a._panner;d?(d.coneInnerAngle=h.coneInnerAngle,d.coneOuterAngle=h.coneOuterAngle,d.coneOuterGain=h.coneOuterGain,d.distanceModel=h.distanceModel,d.maxDistance=h.maxDistance,d.refDistance=h.refDistance,d.rolloffFactor=h.rolloffFactor,d.panningModel=h.panningModel):(a._pos||(a._pos=e._pos||[0,0,-.5]),t(a,"spatial"))}return e},Sound.prototype.init=function(e){return function(){var n=this,r=n._parent;n._orientation=r._orientation,n._stereo=r._stereo,n._pos=r._pos,n._pannerAttr=r._pannerAttr,e.call(this),n._stereo?r.stereo(n._stereo):n._pos&&r.pos(n._pos[0],n._pos[1],n._pos[2],n._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var n=this,r=n._parent;return n._orientation=r._orientation,n._stereo=r._stereo,n._pos=r._pos,n._pannerAttr=r._pannerAttr,n._stereo?r.stereo(n._stereo):n._pos?r.pos(n._pos[0],n._pos[1],n._pos[2],n._id):n._panner&&(n._panner.disconnect(0),n._panner=void 0,r._refreshBuffer(n)),e.call(this)}}(Sound.prototype.reset);var t=function(e,n){n=n||"spatial",n==="spatial"?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,typeof e._panner.positionX<"u"?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),typeof e._panner.orientationX<"u"?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}})()});var S;(function(t){t[t.Native=1]="Native",t[t.Bool=2]="Bool",t[t.Int=4]="Int",t[t.Float=8]="Float",t[t.String=16]="String",t[t.Enum=32]="Enum",t[t.Object=64]="Object",t[t.Mesh=128]="Mesh",t[t.Texture=256]="Texture",t[t.Material=512]="Material",t[t.Animation=1024]="Animation",t[t.Skin=2048]="Skin",t[t.Color=4096]="Color"})(S||(S={}));var _r={bool(t=!1){return{type:S.Bool,default:t}},int(t=0){return{type:S.Int,default:t}},float(t=0){return{type:S.Float,default:t}},string(t=""){return{type:S.String,default:t}},enum(t,e){return{type:S.Enum,values:t,default:e}},object(){return{type:S.Object,default:null}},mesh(){return{type:S.Mesh,default:null}},texture(){return{type:S.Texture,default:null}},material(){return{type:S.Material,default:null}},animation(){return{type:S.Animation,default:null}},skin(){return{type:S.Skin,default:null}},color(t=0,e=0,n=0,r=1){return{type:S.Color,default:[t,e,n,r]}}};function si(t){return function(e,n){let r=e.constructor;r.Properties=r.Properties??{},r.Properties[n]=t}}function nt(){return function(t,e,n){n.enumerable=!0}}function V(){return function(t,e,n){nt()(t,e,n),si({type:S.Native})(t,e)}}var de={};for(let t in _r)de[t]=(...e)=>{let n=_r[t];return si(n(...e))};function on(t){return t===""?!0:t&&(typeof t=="string"||t.constructor===String)}function ai(t){return t==null?!1:typeof t=="number"||t.constructor===Number}var me=class{_listeners=[];_event=void 0;_autoResolve;constructor(e=!1){this._autoResolve=e}add(e,n={}){let{once:r=!1,id:s=void 0}=n;return this._event!==void 0&&(e(...this._event),r)?this:(this._listeners.push({id:s,once:r,callback:e}),this)}push(...e){for(let n of e)this.add(n);return this}once(e){return this.add(e,{once:!0})}remove(e){let n=this._find(e);return n!==null&&this._listeners.splice(n,1),this}has(e){return this._find(e)!==null}notify(...e){let n=this._listeners;this._autoResolve&&(this._event=e);for(let r=0;r<n.length;++r){let s=n[r];s.once&&n.splice(r--,1);try{s.callback(...e)}catch(a){console.error(a)}}}notifyUnsafe(...e){let n=this._listeners;this._autoResolve&&(this._event=e);for(let r=0;r<n.length;++r){let s=n[r];s.once&&n.splice(r--,1),s.callback(...e)}}promise(){return new Promise((e,n)=>{this.once((...r)=>{r.length>1?e(r):e(r[0])})})}_find(e){let n=this._listeners;if(on(e)){for(let r=0;r<n.length;++r)if(n[r].id===e)return r;return null}for(let r=0;r<n.length;++r)if(n[r].callback===e)return r;return null}};var U=function(t,e,n,r){var s=arguments.length,a=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(l=t[c])&&(a=(s<3?l(a):s>3?l(e,n,a):l(e,n))||a);return s>3&&a&&Object.defineProperty(e,n,a),a},oi;(function(t){t[t.Sphere=0]="Sphere",t[t.AxisAlignedBox=1]="AxisAlignedBox",t[t.Box=2]="Box"})(oi||(oi={}));var li;(function(t){t[t.Left=0]="Left",t[t.Center=1]="Center",t[t.Right=2]="Right"})(li||(li={}));var ci;(function(t){t[t.Line=0]="Line",t[t.Middle=1]="Middle",t[t.Top=2]="Top",t[t.Bottom=3]="Bottom"})(ci||(ci={}));var _i;(function(t){t[t.None=0]="None",t[t.Outline=1]="Outline"})(_i||(_i={}));var Re;(function(t){t[t.Head=0]="Head",t[t.EyeLeft=1]="EyeLeft",t[t.EyeRight=2]="EyeRight",t[t.ControllerLeft=3]="ControllerLeft",t[t.ControllerRight=4]="ControllerRight",t[t.RayLeft=5]="RayLeft",t[t.RayRight=6]="RayRight"})(Re||(Re={}));var hi;(function(t){t[t.Point=0]="Point",t[t.Spot=1]="Spot",t[t.Sun=2]="Sun"})(hi||(hi={}));var pi;(function(t){t[t.Playing=0]="Playing",t[t.Paused=1]="Paused",t[t.Stopped=2]="Stopped"})(pi||(pi={}));var ln;(function(t){t[t.Force=0]="Force",t[t.Impulse=1]="Impulse",t[t.VelocityChange=2]="VelocityChange",t[t.Acceleration=3]="Acceleration"})(ln||(ln={}));var di;(function(t){t[t.Touch=0]="Touch",t[t.TouchLost=1]="TouchLost",t[t.TriggerTouch=2]="TriggerTouch",t[t.TriggerTouchLost=3]="TriggerTouchLost"})(di||(di={}));var cn;(function(t){t[t.None=0]="None",t[t.Sphere=1]="Sphere",t[t.Capsule=2]="Capsule",t[t.Box=3]="Box",t[t.Plane=4]="Plane",t[t.ConvexMesh=5]="ConvexMesh",t[t.TriangleMesh=6]="TriangleMesh"})(cn||(cn={}));var Xe;(function(t){t[t.Position=0]="Position",t[t.Tangent=1]="Tangent",t[t.Normal=2]="Normal",t[t.TextureCoordinate=3]="TextureCoordinate",t[t.Color=4]="Color",t[t.JointId=5]="JointId",t[t.JointWeight=6]="JointWeight"})(Xe||(Xe={}));var fe;(function(t){t[t.UnsignedInt=0]="UnsignedInt",t[t.Int=1]="Int",t[t.Float=2]="Float",t[t.Sampler=3]="Sampler",t[t.Font=4]="Font"})(fe||(fe={}));function mi(t){return t===cn.ConvexMesh||t===cn.TriangleMesh}var R=class{_manager;_id;_object;_engine;constructor(e,n=-1,r=-1){this._engine=e,this._manager=n,this._id=r,this._object=null}get engine(){return this._engine}get type(){return this.constructor.TypeName??this._engine.wasm._typeNameFor(this._manager)}get object(){if(!this._object){let e=this._engine.wasm._wl_component_get_object(this._manager,this._id);this._object=this._engine.wrapObject(e)}return this._object}set active(e){this._engine.wasm._wl_component_setActive(this._manager,this._id,e)}get active(){return this._engine.wasm._wl_component_isActive(this._manager,this._id)!=0}destroy(){this._engine.wasm._wl_component_remove(this._manager,this._id),this._manager=-1,this._id=-1}equals(e){return e?this._manager==e._manager&&this._id==e._id:!1}};M(R,"TypeName"),M(R,"Properties"),M(R,"Dependencies");var pr=class extends R{get collider(){return this._engine.wasm._wl_collision_component_get_collider(this._id)}set collider(e){this._engine.wasm._wl_collision_component_set_collider(this._id,e)}get extents(){let e=this._engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_collision_component_get_extents(this._id),3)}set extents(e){this.extents.set(e)}get group(){return this._engine.wasm._wl_collision_component_get_group(this._id)}set group(e){this._engine.wasm._wl_collision_component_set_group(this._id,e)}queryOverlaps(){let e=this._engine.wasm._wl_collision_component_query_overlaps(this._id,this._engine.wasm._tempMem,this._engine.wasm._tempMemSize>>1),n=new Array(e);for(let r=0;r<e;++r)n[r]=new pr(this._engine,this._manager,this._engine.wasm._tempMemUint16[r]);return n}},Ve=pr;M(Ve,"TypeName","collision");U([V()],Ve.prototype,"collider",null);U([V()],Ve.prototype,"extents",null);U([V()],Ve.prototype,"group",null);var ge=class extends R{get alignment(){return this._engine.wasm._wl_text_component_get_horizontal_alignment(this._id)}set alignment(e){this._engine.wasm._wl_text_component_set_horizontal_alignment(this._id,e)}get justification(){return this._engine.wasm._wl_text_component_get_vertical_alignment(this._id)}set justification(e){this._engine.wasm._wl_text_component_set_vertical_alignment(this._id,e)}get characterSpacing(){return this._engine.wasm._wl_text_component_get_character_spacing(this._id)}set characterSpacing(e){this._engine.wasm._wl_text_component_set_character_spacing(this._id,e)}get lineSpacing(){return this._engine.wasm._wl_text_component_get_line_spacing(this._id)}set lineSpacing(e){this._engine.wasm._wl_text_component_set_line_spacing(this._id,e)}get effect(){return this._engine.wasm._wl_text_component_get_effect(this._id)}set effect(e){this._engine.wasm._wl_text_component_set_effect(this._id,e)}get text(){let e=this._engine.wasm,n=e._wl_text_component_get_text(this._id);return e.UTF8ToString(n)}set text(e){let n=this._engine.wasm;n._wl_text_component_set_text(this._id,n.tempUTF8(e))}set material(e){let n=e?e._index:0;this._engine.wasm._wl_text_component_set_material(this._id,n)}get material(){let e=this._engine.wasm._wl_text_component_get_material(this._id);return e>0?new Oe(this._engine,e):null}};M(ge,"TypeName","text");U([V()],ge.prototype,"alignment",null);U([V()],ge.prototype,"justification",null);U([V()],ge.prototype,"characterSpacing",null);U([V()],ge.prototype,"lineSpacing",null);U([V()],ge.prototype,"effect",null);U([V()],ge.prototype,"text",null);U([V()],ge.prototype,"material",null);var Ae=class extends R{get projectionMatrix(){let e=this._engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_view_component_get_projection_matrix(this._id),16)}get near(){return this._engine.wasm._wl_view_component_get_near(this._id)}set near(e){this._engine.wasm._wl_view_component_set_near(this._id,e)}get far(){return this._engine.wasm._wl_view_component_get_far(this._id)}set far(e){this._engine.wasm._wl_view_component_set_far(this._id,e)}get fov(){return this._engine.wasm._wl_view_component_get_fov(this._id)}set fov(e){this._engine.wasm._wl_view_component_set_fov(this._id,e)}};M(Ae,"TypeName","view");U([nt()],Ae.prototype,"projectionMatrix",null);U([V()],Ae.prototype,"near",null);U([V()],Ae.prototype,"far",null);U([V()],Ae.prototype,"fov",null);var Be=class extends R{get inputType(){return this._engine.wasm._wl_input_component_get_type(this._id)}set inputType(e){this._engine.wasm._wl_input_component_set_type(this._id,e)}get xrInputSource(){let e=this._engine.xrSession;if(e){for(let n of e.inputSources)if(n.handedness==this.handedness)return n}return null}get handedness(){let e=this.inputType;return e==Re.ControllerRight||e==Re.RayRight||e==Re.EyeRight?"right":e==Re.ControllerLeft||e==Re.RayLeft||e==Re.EyeLeft?"left":null}};M(Be,"TypeName","input");U([V()],Be.prototype,"inputType",null);U([nt()],Be.prototype,"xrInputSource",null);U([nt()],Be.prototype,"handedness",null);var it=class extends R{get color(){let e=this._engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_light_component_get_color(this._id),4)}set color(e){this.color.set(e)}get lightType(){return this._engine.wasm._wl_light_component_get_type(this._id)}set lightType(e){this._engine.wasm._wl_light_component_set_type(this._id,e)}};M(it,"TypeName","light");U([V()],it.prototype,"color",null);U([V()],it.prototype,"lightType",null);var Ce=class extends R{set animation(e){this._engine.wasm._wl_animation_component_set_animation(this._id,e?e._index:0)}get animation(){let e=this._engine.wasm._wl_animation_component_get_animation(this._id);return e>0?new Ye(this._engine,e):null}set playCount(e){this._engine.wasm._wl_animation_component_set_playCount(this._id,e)}get playCount(){return this._engine.wasm._wl_animation_component_get_playCount(this._id)}set speed(e){this._engine.wasm._wl_animation_component_set_speed(this._id,e)}get speed(){return this._engine.wasm._wl_animation_component_get_speed(this._id)}get state(){return this._engine.wasm._wl_animation_component_state(this._id)}play(){this._engine.wasm._wl_animation_component_play(this._id)}stop(){this._engine.wasm._wl_animation_component_stop(this._id)}pause(){this._engine.wasm._wl_animation_component_pause(this._id)}};M(Ce,"TypeName","animation");U([V()],Ce.prototype,"animation",null);U([V()],Ce.prototype,"playCount",null);U([V()],Ce.prototype,"speed",null);U([nt()],Ce.prototype,"state",null);var We=class extends R{set material(e){this._engine.wasm._wl_mesh_component_set_material(this._id,e?e._index:0)}get material(){let e=this._engine.wasm._wl_mesh_component_get_material(this._id);return e>0?new Oe(this._engine,e):null}get mesh(){let e=this._engine.wasm._wl_mesh_component_get_mesh(this._id);return e>0?new st(this._engine,e):null}set mesh(e){this._engine.wasm._wl_mesh_component_set_mesh(this._id,e?e._index:0)}get skin(){let e=this._engine.wasm._wl_mesh_component_get_skin(this._id);return e>0?new qt(this._engine,e):null}set skin(e){this._engine.wasm._wl_mesh_component_set_skin(this._id,e?e._index:0)}};M(We,"TypeName","mesh");U([V()],We.prototype,"material",null);U([V()],We.prototype,"mesh",null);U([V()],We.prototype,"skin",null);var fi;(function(t){t[t.None=0]="None",t[t.X=1]="X",t[t.Y=2]="Y",t[t.Z=4]="Z"})(fi||(fi={}));var $=class extends R{set static(e){this._engine.wasm._wl_physx_component_set_static(this._id,e)}get static(){return!!this._engine.wasm._wl_physx_component_get_static(this._id)}set kinematic(e){this._engine.wasm._wl_physx_component_set_kinematic(this._id,e)}get kinematic(){return!!this._engine.wasm._wl_physx_component_get_kinematic(this._id)}set gravity(e){this._engine.wasm._wl_physx_component_set_gravity(this._id,e)}get gravity(){return!!this._engine.wasm._wl_physx_component_get_gravity(this._id)}set simulate(e){this._engine.wasm._wl_physx_component_set_simulate(this._id,e)}get simulate(){return!!this._engine.wasm._wl_physx_component_get_simulate(this._id)}set allowSimulation(e){this._engine.wasm._wl_physx_component_set_allowSimulation(this._id,e)}get allowSimulation(){return!!this._engine.wasm._wl_physx_component_get_allowSimulation(this._id)}set allowQuery(e){this._engine.wasm._wl_physx_component_set_allowQuery(this._id,e)}get allowQuery(){return!!this._engine.wasm._wl_physx_component_get_allowQuery(this._id)}set trigger(e){this._engine.wasm._wl_physx_component_set_trigger(this._id,e)}get trigger(){return!!this._engine.wasm._wl_physx_component_get_trigger(this._id)}set shape(e){this._engine.wasm._wl_physx_component_set_shape(this._id,e)}get shape(){return this._engine.wasm._wl_physx_component_get_shape(this._id)}set shapeData(e){e==null||!mi(this.shape)||this._engine.wasm._wl_physx_component_set_shape_data(this._id,e.index)}get shapeData(){return mi(this.shape)?{index:this._engine.wasm._wl_physx_component_get_shape_data(this._id)}:null}set extents(e){this.extents.set(e)}get extents(){let e=this._engine.wasm,n=e._wl_physx_component_get_extents(this._id);return new Float32Array(e.HEAPF32.buffer,n,3)}get staticFriction(){return this._engine.wasm._wl_physx_component_get_staticFriction(this._id)}set staticFriction(e){this._engine.wasm._wl_physx_component_set_staticFriction(this._id,e)}get dynamicFriction(){return this._engine.wasm._wl_physx_component_get_dynamicFriction(this._id)}set dynamicFriction(e){this._engine.wasm._wl_physx_component_set_dynamicFriction(this._id,e)}get bounciness(){return this._engine.wasm._wl_physx_component_get_bounciness(this._id)}set bounciness(e){this._engine.wasm._wl_physx_component_set_bounciness(this._id,e)}get linearDamping(){return this._engine.wasm._wl_physx_component_get_linearDamping(this._id)}set linearDamping(e){this._engine.wasm._wl_physx_component_set_linearDamping(this._id,e)}get angularDamping(){return this._engine.wasm._wl_physx_component_get_angularDamping(this._id)}set angularDamping(e){this._engine.wasm._wl_physx_component_set_angularDamping(this._id,e)}set linearVelocity(e){this._engine.wasm._wl_physx_component_set_linearVelocity(this._id,e[0],e[1],e[2])}get linearVelocity(){let e=this._engine.wasm;return e._wl_physx_component_get_linearVelocity(this._id,e._tempMem),new Float32Array(e.HEAPF32.buffer,e._tempMem,3)}set angularVelocity(e){this._engine.wasm._wl_physx_component_set_angularVelocity(this._id,e[0],e[1],e[2])}get angularVelocity(){let e=this._engine.wasm;return e._wl_physx_component_get_angularVelocity(this._id,e._tempMem),new Float32Array(e.HEAPF32.buffer,e._tempMem,3)}set groupsMask(e){this._engine.wasm._wl_physx_component_set_groupsMask(this._id,e)}get groupsMask(){return this._engine.wasm._wl_physx_component_get_groupsMask(this._id)}set blocksMask(e){this._engine.wasm._wl_physx_component_set_blocksMask(this._id,e)}get blocksMask(){return this._engine.wasm._wl_physx_component_get_blocksMask(this._id)}set linearLockAxis(e){this._engine.wasm._wl_physx_component_set_linearLockAxis(this._id,e)}get linearLockAxis(){return this._engine.wasm._wl_physx_component_get_linearLockAxis(this._id)}set angularLockAxis(e){this._engine.wasm._wl_physx_component_set_angularLockAxis(this._id,e)}get angularLockAxis(){return this._engine.wasm._wl_physx_component_get_angularLockAxis(this._id)}set mass(e){this._engine.wasm._wl_physx_component_set_mass(this._id,e)}get mass(){return this._engine.wasm._wl_physx_component_get_mass(this._id)}set massSpaceInteriaTensor(e){this._engine.wasm._wl_physx_component_set_massSpaceInertiaTensor(this._id,e[0],e[1],e[2])}addForce(e,n=ln.Force,r=!1,s,a=!1){let l=this._engine.wasm;if(!s){l._wl_physx_component_addForce(this._id,e[0],e[1],e[2],n,r);return}l._wl_physx_component_addForceAt(this._id,e[0],e[1],e[2],n,r,s[0],s[1],s[2],a)}addTorque(e,n=ln.Force){this._engine.wasm._wl_physx_component_addTorque(this._id,e[0],e[1],e[2],n)}onCollision(e){return this.onCollisionWith(this,e)}onCollisionWith(e,n){let r=this._engine.physics;return r._callbacks[this._id]=r._callbacks[this._id]||[],r._callbacks[this._id].push(n),this._engine.wasm._wl_physx_component_addCallback(this._id,e._id||this._id)}removeCollisionCallback(e){let n=this._engine.physics,r=this._engine.wasm._wl_physx_component_removeCallback(this._id,e);r&&n._callbacks[this._id].splice(-r)}};M($,"TypeName","physx");U([V()],$.prototype,"static",null);U([V()],$.prototype,"kinematic",null);U([V()],$.prototype,"gravity",null);U([V()],$.prototype,"simulate",null);U([V()],$.prototype,"allowSimulation",null);U([V()],$.prototype,"allowQuery",null);U([V()],$.prototype,"trigger",null);U([V()],$.prototype,"shape",null);U([V()],$.prototype,"shapeData",null);U([V()],$.prototype,"extents",null);U([V()],$.prototype,"staticFriction",null);U([V()],$.prototype,"dynamicFriction",null);U([V()],$.prototype,"bounciness",null);U([V()],$.prototype,"linearDamping",null);U([V()],$.prototype,"angularDamping",null);U([V()],$.prototype,"linearVelocity",null);U([V()],$.prototype,"angularVelocity",null);U([V()],$.prototype,"groupsMask",null);U([V()],$.prototype,"blocksMask",null);U([V()],$.prototype,"linearLockAxis",null);U([V()],$.prototype,"angularLockAxis",null);U([V()],$.prototype,"mass",null);var ue;(function(t){t[t.UnsignedByte=1]="UnsignedByte",t[t.UnsignedShort=2]="UnsignedShort",t[t.UnsignedInt=4]="UnsignedInt"})(ue||(ue={}));var st=class{_index=-1;_engine;constructor(e,n){if(this._engine=e??WL,this._index=-1,ai(n)){this._index=n;return}if(!n.vertexCount)throw new Error("Missing parameter 'vertexCount'");let r=this._engine.wasm,s=0,a=0,l=0;if(n.indexData)switch(a=n.indexType||ue.UnsignedShort,l=n.indexData.length*a,s=r._malloc(l),a){case ue.UnsignedByte:r.HEAPU8.set(n.indexData,s);break;case ue.UnsignedShort:r.HEAPU16.set(n.indexData,s>>1);break;case ue.UnsignedInt:r.HEAPU32.set(n.indexData,s>>2);break}let{skinned:c=!1}=n;this._index=r._wl_mesh_create(s,l,a,n.vertexCount,c)}get vertexCount(){return this._engine.wasm._wl_mesh_get_vertexCount(this._index)}get indexData(){let e=this._engine.wasm,n=e._tempMem,r=e._wl_mesh_get_indexData(this._index,n,n+4);if(r===null)return null;let s=e.HEAPU32[n/4];switch(e.HEAPU32[n/4+1]){case ue.UnsignedByte:return new Uint8Array(e.HEAPU8.buffer,r,s);case ue.UnsignedShort:return new Uint16Array(e.HEAPU16.buffer,r,s);case ue.UnsignedInt:return new Uint32Array(e.HEAPU32.buffer,r,s)}return null}get engine(){return this._engine}update(){this._engine.wasm._wl_mesh_update(this._index)}getBoundingSphere(e=new Float32Array(4)){let n=this._engine.wasm._tempMemFloat;return this._engine.wasm._wl_mesh_get_boundingSphere(this._index,this._engine.wasm._tempMem),e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e}attribute(e){if(typeof e!="number")throw new TypeError("Expected number, but got "+typeof e);let n=this._engine.wasm._tempMemUint32;if(this._engine.wasm._wl_mesh_get_attribute(this._index,e,this._engine.wasm._tempMem),n[0]==255)return null;let r=n[5];return new hr(this._engine,{attribute:n[0],offset:n[1],stride:n[2],formatSize:n[3],componentCount:n[4],arraySize:r||1,length:this.vertexCount,bufferType:e!==Xe.JointId?Float32Array:Uint16Array})}destroy(){this._engine.wasm._wl_mesh_destroy(this._index)}equals(e){return e?this._index===e._index:!1}},hr=class{length=0;_engine;_attribute=-1;_offset=0;_stride=0;_formatSize=0;_componentCount=0;_arraySize=1;_bufferType;_tempBufferGetter;constructor(e,n){this._engine=e;let r=this._engine.wasm;this._attribute=n.attribute,this._offset=n.offset,this._stride=n.stride,this._formatSize=n.formatSize,this._componentCount=n.componentCount,this._arraySize=n.arraySize,this._bufferType=n.bufferType,this.length=n.length,this._tempBufferGetter=this._bufferType===Float32Array?r.getTempBufferF32.bind(r):r.getTempBufferU16.bind(r)}createArray(e=1){return e=e>this.length?this.length:e,new this._bufferType(e*this._componentCount*this._arraySize)}get(e,n=this.createArray()){if(n.length%this._componentCount!==0)throw new Error(`out.length, ${n.length} is not a multiple of the attribute vector components, ${this._componentCount}`);let r=this._tempBufferGetter(n.length),s=this._bufferType.BYTES_PER_ELEMENT,a=s*n.length,l=this._formatSize*this._arraySize,c=this._componentCount*s*this._arraySize;this._engine.wasm._wl_mesh_get_attribute_values(this._attribute,l,this._offset+e*this._stride,this._stride,c,r.byteOffset,a);for(let h=0;h<n.length;++h)n[h]=r[h];return n}set(e,n){if(n.length%this._componentCount!==0)throw new Error(`out.length, ${n.length} is not a multiple of the attribute vector components, ${this._componentCount}`);let r=this._bufferType.BYTES_PER_ELEMENT,s=r*n.length,a=this._componentCount*r*this._arraySize,l=this._formatSize*this._arraySize,c=this._engine.wasm;if(n.buffer!=c.HEAPU8.buffer){let h=this._tempBufferGetter(n.length);h.set(n),n=h}return c._wl_mesh_set_attribute_values(this._attribute,a,n.byteOffset,s,l,this._offset+e*this._stride,this._stride),this}},Oe=class{_index;_definition;_engine;constructor(e,n){if(this._engine=e,typeof n!="number"){if(!n?.pipeline)throw new Error("Missing parameter 'pipeline'");let r=this._engine.wasm,s=n.pipeline;if(this._index=r._wl_material_create(r.tempUTF8(s)),this._index<0)throw new Error(`No such pipeline '${s}'`)}else this._index=n;if(this._definition=this._engine.wasm._wl_material_get_definition(this._index),!this._engine.wasm._materialDefinitions[this._definition])throw new Error(`Material Definition ${this._definition} not found for material with index ${this._index}`);return new Proxy(this,{get(r,s){let a=e.wasm,c=a._materialDefinitions[r._definition].get(s);if(!c)return r[s];if(a._wl_material_get_param_value(r._index,c.index,a._tempMem)){let h=c.type;switch(h.type){case fe.UnsignedInt:return h.componentCount==1?a._tempMemUint32[0]:new Uint32Array(a.HEAPU32.buffer,a._tempMem,h.componentCount);case fe.Int:return h.componentCount==1?a._tempMemInt[0]:new Int32Array(a.HEAP32.buffer,a._tempMem,h.componentCount);case fe.Float:return h.componentCount==1?a._tempMemFloat[0]:new Float32Array(a.HEAPF32.buffer,a._tempMem,h.componentCount);case fe.Sampler:return e.textures.wrap(a._tempMemInt[0]);default:throw new Error(`Invalid type ${h} on parameter ${c.index} for material ${r._index}`)}}},set(r,s,a){let l=e.wasm,h=l._materialDefinitions[r._definition].get(s);if(!h)return r[s]=a,!0;switch(h.type.type){case fe.UnsignedInt:case fe.Int:case fe.Sampler:let i=a.id??a;l._wl_material_set_param_value_uint(r._index,h.index,i);break;case fe.Float:let o=1;if(typeof a=="number")l._tempMemFloat[0]=a;else{o=a.length;for(let _=0;_<o;++_)l._tempMemFloat[_]=a[_]}l._wl_material_set_param_value_float(r._index,h.index,l._tempMem,o);break;case fe.Font:throw new Error("Setting font properties is currently unsupported.")}return!0}})}get shader(){return this.pipeline}get pipeline(){let e=this._engine.wasm;return e.UTF8ToString(e._wl_material_get_pipeline(this._index))}get engine(){return this._engine}clone(){let e=this._engine.wasm._wl_material_clone(this._index);return e>0?new Oe(this._engine,e):null}equals(e){return e?this._index===e._index:!1}static wrap(e,n){return n>0?new Oe(e,n):null}},rt=null,Nt=class{_engine;_id=0;_imageIndex=null;constructor(e,n){this._engine=e??WL;let r=e.wasm;if(n instanceof HTMLImageElement||n instanceof HTMLVideoElement||n instanceof HTMLCanvasElement){let s=r._images.length;r._images.push(n),this._imageIndex=s,this._id=this._engine.wasm._wl_renderer_addImage(s)}else this._id=n;this._engine.textures._set(this)}get valid(){return this._id>=0}get id(){return this._id}update(){!this.valid||this._imageIndex===null||this._engine.wasm._wl_renderer_updateImage(this._id,this._imageIndex)}get width(){return this._engine.wasm._wl_texture_width(this._id)}get height(){return this._engine.wasm._wl_texture_height(this._id)}get engine(){return this._engine}updateSubImage(e,n,r,s){if(!this.valid||this._imageIndex===null)return;if(!rt){let h=document.createElement("canvas"),d=h.getContext("2d");if(!d)throw new Error("Texture.updateSubImage(): Failed to obtain CanvasRenderingContext2D.");rt={canvas:h,ctx:d}}let a=this._engine.wasm,l=a._images[this._imageIndex];if(!l)return;rt.canvas.width=r,rt.canvas.height=s,rt.ctx.drawImage(l,e,n,r,s,0,0,r,s);let c=(l.videoHeight??l.height)-n-s;a._images[this._imageIndex]=rt.canvas,a._wl_renderer_updateImage(this._id,this._imageIndex,e,c),a._images[this._imageIndex]=l}destroy(){this.engine.textures._destroy(this),this._id=-1,this._imageIndex=null}equals(e){return e?this._id===e._id:!1}},Ye=class{_index;_engine;constructor(e=WL,n){this._engine=e,this._index=n}get duration(){return this._engine.wasm._wl_animation_get_duration(this._index)}get trackCount(){return this._engine.wasm._wl_animation_get_trackCount(this._index)}retarget(e){let n=this._engine.wasm;if(e instanceof qt){let a=n._wl_animation_retargetToSkin(this._index,e._index);return new Ye(this._engine,a)}if(e.length!=this.trackCount)throw Error("Expected "+this.trackCount.toString()+" targets, but got "+e.length.toString());let r=n._malloc(2*e.length);for(let a=0;a<e.length;++a)n.HEAPU16[r>>1+a]=e[a].objectId;let s=n._wl_animation_retarget(this._index,r);return n._free(r),new Ye(this._engine,s)}equals(e){return e?this._index===e._index:!1}};var qt=class{_index;_engine;constructor(e,n){this._engine=e,this._index=n}get jointCount(){return this._engine.wasm._wl_skin_get_joint_count(this._index)}get jointIds(){let e=this._engine.wasm;return new Uint16Array(e.HEAPU16.buffer,e._wl_skin_joint_ids(this._index),this.jointCount)}get inverseBindTransforms(){let e=this._engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_skin_inverse_bind_transforms(this._index),8*this.jointCount)}get inverseBindScalings(){let e=this._engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_skin_inverse_bind_scalings(this._index),3*this.jointCount)}equals(e){return e?this._index===e._index:!1}};var Sm=new Map([[S.Bool,!1],[S.Int,0],[S.Float,0],[S.String,""],[S.Enum,void 0],[S.Object,null],[S.Mesh,null],[S.Texture,null],[S.Material,null],[S.Animation,null],[S.Skin,null],[S.Color,[0,0,0,1]]]);var at=class extends R{name="wonderland-engine-8thwall-camera";started=!1;view=null;position=[0,0,0];rotation=[0,0,0,-1];glTextureRenderer=null;promptForDeviceMotion(){return new Promise(async(e,n)=>{window.dispatchEvent(new Event("8thwall-request-user-interaction")),window.addEventListener("8thwall-safe-to-request-permissions",async()=>{try{let r=await DeviceMotionEvent.requestPermission();e(r)}catch(r){n(r)}})})}async getPermissions(){if(DeviceMotionEvent&&DeviceMotionEvent.requestPermission)try{if(await DeviceMotionEvent.requestPermission()!=="granted")throw new Error("MotionEvent")}catch(e){if(e.name==="NotAllowedError"){if(await this.promptForDeviceMotion()!=="granted")throw new Error("MotionEvent")}else throw new Error("MotionEvent")}try{(await navigator.mediaDevices.getUserMedia({video:!0,audio:!0})).getTracks().forEach(n=>{n.stop()})}catch{throw new Error("Camera")}}init(){this.view=this.object.getComponent("view"),this.onUpdate=this.onUpdate.bind(this),this.onAttach=this.onAttach.bind(this),this.onException=this.onException.bind(this),this.onCameraStatusChange=this.onCameraStatusChange.bind(this)}async start(){this.view=this.object.getComponent("view"),this.useCustomUIOverlays||Eo.init();try{await this.getPermissions()}catch(n){window.dispatchEvent(new CustomEvent("8thwall-permission-fail",{detail:n}));return}await this.waitForXR8(),XR8.XrController.configure({disableWorldTracking:!1}),this.glTextureRenderer=XR8.GlTextureRenderer.pipelineModule(),XR8.addCameraPipelineModules([this.glTextureRenderer,XR8.XrController.pipelineModule(),this]);let e={cameraConfig:{direction:XR8.XrConfig.camera().BACK},canvas:Module.canvas,allowedDevices:XR8.XrConfig.device().ANY,ownRunLoop:!1};XR8.run(e)}onAttach(e){this.started=!0,this.engine.scene.colorClearEnabled=!1;let n=Module.ctx,r=this.object.rotationWorld,s=this.object.getTranslationWorld([]);this.position=Array.from(s),this.rotation=Array.from(r),XR8.XrController.updateCameraProjectionMatrix({origin:{x:s[0],y:s[1],z:s[2]},facing:{x:r[0],y:r[1],z:r[2],w:r[3]},cam:{pixelRectWidth:Module.canvas.width,pixelRectHeight:Module.canvas.height,nearClipPlane:this.view.near,farClipPlane:this.view.far}}),this.engine.scene.onPreRender.push(()=>{n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),XR8.runPreRender(Date.now()),XR8.runRender()}),this.engine.scene.onPostRender.push(()=>{XR8.runPostRender(Date.now())})}onCameraStatusChange(e){e&&e.status==="failed"&&this.onException(new Error(`Camera failed with status: ${e.status}`))}onUpdate(e){if(!e.processCpuResult.reality)return;let{rotation:n,position:r,intrinsics:s}=e.processCpuResult.reality;if(this.rotation[0]=n.x,this.rotation[1]=n.y,this.rotation[2]=n.z,this.rotation[3]=n.w,this.position[0]=r.x,this.position[1]=r.y,this.position[2]=r.z,s){let a=this.view.projectionMatrix;for(let l=0;l<16;l++)Number.isFinite(s[l])&&(a[l]=s[l])}r&&n&&(this.object.rotationWorld=this.rotation,this.object.setTranslationWorld(this.position))}onException(e){console.error("8thwall exception:",e),window.dispatchEvent(new CustomEvent("8thwall-error",{detail:e}))}waitForXR8(){return new Promise((e,n)=>{window.XR8?e():window.addEventListener("xrloaded",()=>e())})}};M(at,"TypeName","8thwall-camera"),M(at,"Properties",{useCustomUIOverlays:{type:S.Bool,default:!1}});var Eo={init:function(){this.handleRequestUserInteraction=this.handleRequestUserInteraction.bind(this),this.handlePermissionFail=this.handlePermissionFail.bind(this),this.handleError=this.handleError.bind(this),window.addEventListener("8thwall-request-user-interaction",this.handleRequestUserInteraction),window.addEventListener("8thwall-permission-fail",this.handlePermissionFail),window.addEventListener("8thwall-error",this.handleError)},handleRequestUserInteraction:function(){let t=this.showOverlay(Fo);window.addEventListener("8thwall-safe-to-request-permissions",()=>{t.remove()})},handlePermissionFail:function(t){this.showOverlay(Io)},handleError:function(t){this.showOverlay(Ro)},showOverlay:function(t){let e=document.createElement("div");return e.innerHTML=t,document.body.appendChild(e),e}},Fo=`
<style>
  #request-permission-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 999;
    color: #fff;
    background-color: rgba(0, 0, 0, 0.5);
    text-align: center;
    font-family: sans-serif;
  }

  .request-permission-overlay_title {
    margin: 30px;
    font-size: 32px;
  }

  .request-permission-overlay_button {
    background-color: #e80086;
    font-size: 22px;
    padding: 10px 30px;
    color: #fff;
    border-radius: 15px;
    border: none;
  }
</style>

<div id="request-permission-overlay">
  <div class="request-permission-overlay_title">This app requires to use your camera and motion sensors</div>

  <button class="request-permission-overlay_button" onclick="window.dispatchEvent(new Event('8thwall-safe-to-request-permissions'))">OK</button>
</div>`,Io=`
<style>
  #failed-permission-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 999;
    color: #fff;
    background-color: rgba(0, 0, 0, 0.5);
    text-align: center;
    font-family: sans-serif;
  }

  .failed-permission-overlay_title {
    margin: 30px;
    font-size: 32px;
  }

  .failed-permission-overlay_button {
    background-color: #e80086;
    font-size: 22px;
    padding: 10px 30px;
    color: #fff;
    border-radius: 15px;
    border: none;
  }
</style>

<div id="failed-permission-overlay">
  <div class="failed-permission-overlay_title">Failed to grant permissions. Reset the the permissions and refresh the page.</div>

  <button class="failed-permission-overlay_button" onclick="window.location.reload()">Refresh the page</button>
</div>`,Ro=`
<style>
  #wall-error-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 999;
    color: #fff;
    background-color: rgba(0, 0, 0, 0.5);
    text-align: center;
    font-family: sans-serif;
  }

  .wall-error-overlay_title {
    margin: 30px;
    font-size: 32px;
  }

  .wall-error-overlay_button {
    background-color: #e80086;
    font-size: 22px;
    padding: 10px 30px;
    color: #fff;
    border-radius: 15px;
    border: none;
  }
</style>

<div id="wall-error-overlay">
  <div class="wall-error-overlay_title">Error has occurred. Please reload the page</div>

  <button class="wall-error-overlay_button" onclick="window.location.reload()">Reload</button>
</div>`;var se=class extends R{onHover=new me;onUnhover=new me;onClick=new me;onMove=new me;onDown=new me;onUp=new me;addHoverFunction(e){this.onHover.add(e)}removeHoverFunction(e){this.onHover.remove(e)}addUnHoverFunction(e){this.onUnhover.add(e)}removeUnHoverFunction(e){this.onUnhover.remove(e)}addClickFunction(e){this.onClick.add(e)}removeClickFunction(e){this.onClick.remove(e)}addMoveFunction(e){this.onMove.add(e)}removeMoveFunction(e){this.onMove.remove(e)}addDownFunction(e){this.onDown.add(e)}removeDownFunction(e){this.onDown.remove(e)}addUpFunction(e){this.onUp.add(e)}removeUpFunction(e){this.onUp.remove(e)}};M(se,"TypeName","cursor-target"),M(se,"Properties",{});var B=1e-6,G=typeof Float32Array<"u"?Float32Array:Array,Le=Math.random;var Qm=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function ui(){var t=new G(9);return G!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}var ke={};Ie(ke,{add:()=>fl,adjoint:()=>No,clone:()=>Lo,copy:()=>ko,create:()=>Oo,determinant:()=>qo,equals:()=>vl,exactEquals:()=>wl,frob:()=>ml,fromQuat:()=>il,fromQuat2:()=>tl,fromRotation:()=>Zo,fromRotationTranslation:()=>vi,fromRotationTranslationScale:()=>nl,fromRotationTranslationScaleOrigin:()=>rl,fromScaling:()=>$o,fromTranslation:()=>Qo,fromValues:()=>Do,fromXRotation:()=>Jo,fromYRotation:()=>Ko,fromZRotation:()=>el,frustum:()=>sl,getRotation:()=>mr,getScaling:()=>xi,getTranslation:()=>dr,identity:()=>gi,invert:()=>Uo,lookAt:()=>hl,mul:()=>xl,multiply:()=>wi,multiplyScalar:()=>ul,multiplyScalarAndAdd:()=>gl,ortho:()=>cl,orthoNO:()=>bi,orthoZO:()=>_l,perspective:()=>al,perspectiveFromFieldOfView:()=>ll,perspectiveNO:()=>yi,perspectiveZO:()=>ol,rotate:()=>Wo,rotateX:()=>Xo,rotateY:()=>Yo,rotateZ:()=>Go,scale:()=>Bo,set:()=>zo,str:()=>dl,sub:()=>yl,subtract:()=>Mi,targetTo:()=>pl,translate:()=>Vo,transpose:()=>Ho});function Oo(){var t=new G(16);return G!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Lo(t){var e=new G(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function ko(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Do(t,e,n,r,s,a,l,c,h,d,i,o,_,m,u,g){var f=new G(16);return f[0]=t,f[1]=e,f[2]=n,f[3]=r,f[4]=s,f[5]=a,f[6]=l,f[7]=c,f[8]=h,f[9]=d,f[10]=i,f[11]=o,f[12]=_,f[13]=m,f[14]=u,f[15]=g,f}function zo(t,e,n,r,s,a,l,c,h,d,i,o,_,m,u,g,f){return t[0]=e,t[1]=n,t[2]=r,t[3]=s,t[4]=a,t[5]=l,t[6]=c,t[7]=h,t[8]=d,t[9]=i,t[10]=o,t[11]=_,t[12]=m,t[13]=u,t[14]=g,t[15]=f,t}function gi(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ho(t,e){if(t===e){var n=e[1],r=e[2],s=e[3],a=e[6],l=e[7],c=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=a,t[11]=e[14],t[12]=s,t[13]=l,t[14]=c}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Uo(t,e){var n=e[0],r=e[1],s=e[2],a=e[3],l=e[4],c=e[5],h=e[6],d=e[7],i=e[8],o=e[9],_=e[10],m=e[11],u=e[12],g=e[13],f=e[14],w=e[15],v=n*c-r*l,x=n*h-s*l,T=n*d-a*l,A=r*h-s*c,j=r*d-a*c,I=s*d-a*h,E=i*g-o*u,D=i*f-_*u,z=i*w-m*u,q=o*f-_*g,H=o*w-m*g,k=_*w-m*f,F=v*k-x*H+T*q+A*z-j*D+I*E;return F?(F=1/F,t[0]=(c*k-h*H+d*q)*F,t[1]=(s*H-r*k-a*q)*F,t[2]=(g*I-f*j+w*A)*F,t[3]=(_*j-o*I-m*A)*F,t[4]=(h*z-l*k-d*D)*F,t[5]=(n*k-s*z+a*D)*F,t[6]=(f*T-u*I-w*x)*F,t[7]=(i*I-_*T+m*x)*F,t[8]=(l*H-c*z+d*E)*F,t[9]=(r*z-n*H-a*E)*F,t[10]=(u*j-g*T+w*v)*F,t[11]=(o*T-i*j-m*v)*F,t[12]=(c*D-l*q-h*E)*F,t[13]=(n*q-r*D+s*E)*F,t[14]=(g*x-u*A-f*v)*F,t[15]=(i*A-o*x+_*v)*F,t):null}function No(t,e){var n=e[0],r=e[1],s=e[2],a=e[3],l=e[4],c=e[5],h=e[6],d=e[7],i=e[8],o=e[9],_=e[10],m=e[11],u=e[12],g=e[13],f=e[14],w=e[15];return t[0]=c*(_*w-m*f)-o*(h*w-d*f)+g*(h*m-d*_),t[1]=-(r*(_*w-m*f)-o*(s*w-a*f)+g*(s*m-a*_)),t[2]=r*(h*w-d*f)-c*(s*w-a*f)+g*(s*d-a*h),t[3]=-(r*(h*m-d*_)-c*(s*m-a*_)+o*(s*d-a*h)),t[4]=-(l*(_*w-m*f)-i*(h*w-d*f)+u*(h*m-d*_)),t[5]=n*(_*w-m*f)-i*(s*w-a*f)+u*(s*m-a*_),t[6]=-(n*(h*w-d*f)-l*(s*w-a*f)+u*(s*d-a*h)),t[7]=n*(h*m-d*_)-l*(s*m-a*_)+i*(s*d-a*h),t[8]=l*(o*w-m*g)-i*(c*w-d*g)+u*(c*m-d*o),t[9]=-(n*(o*w-m*g)-i*(r*w-a*g)+u*(r*m-a*o)),t[10]=n*(c*w-d*g)-l*(r*w-a*g)+u*(r*d-a*c),t[11]=-(n*(c*m-d*o)-l*(r*m-a*o)+i*(r*d-a*c)),t[12]=-(l*(o*f-_*g)-i*(c*f-h*g)+u*(c*_-h*o)),t[13]=n*(o*f-_*g)-i*(r*f-s*g)+u*(r*_-s*o),t[14]=-(n*(c*f-h*g)-l*(r*f-s*g)+u*(r*h-s*c)),t[15]=n*(c*_-h*o)-l*(r*_-s*o)+i*(r*h-s*c),t}function qo(t){var e=t[0],n=t[1],r=t[2],s=t[3],a=t[4],l=t[5],c=t[6],h=t[7],d=t[8],i=t[9],o=t[10],_=t[11],m=t[12],u=t[13],g=t[14],f=t[15],w=e*l-n*a,v=e*c-r*a,x=e*h-s*a,T=n*c-r*l,A=n*h-s*l,j=r*h-s*c,I=d*u-i*m,E=d*g-o*m,D=d*f-_*m,z=i*g-o*u,q=i*f-_*u,H=o*f-_*g;return w*H-v*q+x*z+T*D-A*E+j*I}function wi(t,e,n){var r=e[0],s=e[1],a=e[2],l=e[3],c=e[4],h=e[5],d=e[6],i=e[7],o=e[8],_=e[9],m=e[10],u=e[11],g=e[12],f=e[13],w=e[14],v=e[15],x=n[0],T=n[1],A=n[2],j=n[3];return t[0]=x*r+T*c+A*o+j*g,t[1]=x*s+T*h+A*_+j*f,t[2]=x*a+T*d+A*m+j*w,t[3]=x*l+T*i+A*u+j*v,x=n[4],T=n[5],A=n[6],j=n[7],t[4]=x*r+T*c+A*o+j*g,t[5]=x*s+T*h+A*_+j*f,t[6]=x*a+T*d+A*m+j*w,t[7]=x*l+T*i+A*u+j*v,x=n[8],T=n[9],A=n[10],j=n[11],t[8]=x*r+T*c+A*o+j*g,t[9]=x*s+T*h+A*_+j*f,t[10]=x*a+T*d+A*m+j*w,t[11]=x*l+T*i+A*u+j*v,x=n[12],T=n[13],A=n[14],j=n[15],t[12]=x*r+T*c+A*o+j*g,t[13]=x*s+T*h+A*_+j*f,t[14]=x*a+T*d+A*m+j*w,t[15]=x*l+T*i+A*u+j*v,t}function Vo(t,e,n){var r=n[0],s=n[1],a=n[2],l,c,h,d,i,o,_,m,u,g,f,w;return e===t?(t[12]=e[0]*r+e[4]*s+e[8]*a+e[12],t[13]=e[1]*r+e[5]*s+e[9]*a+e[13],t[14]=e[2]*r+e[6]*s+e[10]*a+e[14],t[15]=e[3]*r+e[7]*s+e[11]*a+e[15]):(l=e[0],c=e[1],h=e[2],d=e[3],i=e[4],o=e[5],_=e[6],m=e[7],u=e[8],g=e[9],f=e[10],w=e[11],t[0]=l,t[1]=c,t[2]=h,t[3]=d,t[4]=i,t[5]=o,t[6]=_,t[7]=m,t[8]=u,t[9]=g,t[10]=f,t[11]=w,t[12]=l*r+i*s+u*a+e[12],t[13]=c*r+o*s+g*a+e[13],t[14]=h*r+_*s+f*a+e[14],t[15]=d*r+m*s+w*a+e[15]),t}function Bo(t,e,n){var r=n[0],s=n[1],a=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Wo(t,e,n,r){var s=r[0],a=r[1],l=r[2],c=Math.hypot(s,a,l),h,d,i,o,_,m,u,g,f,w,v,x,T,A,j,I,E,D,z,q,H,k,F,J;return c<B?null:(c=1/c,s*=c,a*=c,l*=c,h=Math.sin(n),d=Math.cos(n),i=1-d,o=e[0],_=e[1],m=e[2],u=e[3],g=e[4],f=e[5],w=e[6],v=e[7],x=e[8],T=e[9],A=e[10],j=e[11],I=s*s*i+d,E=a*s*i+l*h,D=l*s*i-a*h,z=s*a*i-l*h,q=a*a*i+d,H=l*a*i+s*h,k=s*l*i+a*h,F=a*l*i-s*h,J=l*l*i+d,t[0]=o*I+g*E+x*D,t[1]=_*I+f*E+T*D,t[2]=m*I+w*E+A*D,t[3]=u*I+v*E+j*D,t[4]=o*z+g*q+x*H,t[5]=_*z+f*q+T*H,t[6]=m*z+w*q+A*H,t[7]=u*z+v*q+j*H,t[8]=o*k+g*F+x*J,t[9]=_*k+f*F+T*J,t[10]=m*k+w*F+A*J,t[11]=u*k+v*F+j*J,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function Xo(t,e,n){var r=Math.sin(n),s=Math.cos(n),a=e[4],l=e[5],c=e[6],h=e[7],d=e[8],i=e[9],o=e[10],_=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*s+d*r,t[5]=l*s+i*r,t[6]=c*s+o*r,t[7]=h*s+_*r,t[8]=d*s-a*r,t[9]=i*s-l*r,t[10]=o*s-c*r,t[11]=_*s-h*r,t}function Yo(t,e,n){var r=Math.sin(n),s=Math.cos(n),a=e[0],l=e[1],c=e[2],h=e[3],d=e[8],i=e[9],o=e[10],_=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*s-d*r,t[1]=l*s-i*r,t[2]=c*s-o*r,t[3]=h*s-_*r,t[8]=a*r+d*s,t[9]=l*r+i*s,t[10]=c*r+o*s,t[11]=h*r+_*s,t}function Go(t,e,n){var r=Math.sin(n),s=Math.cos(n),a=e[0],l=e[1],c=e[2],h=e[3],d=e[4],i=e[5],o=e[6],_=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*s+d*r,t[1]=l*s+i*r,t[2]=c*s+o*r,t[3]=h*s+_*r,t[4]=d*s-a*r,t[5]=i*s-l*r,t[6]=o*s-c*r,t[7]=_*s-h*r,t}function Qo(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function $o(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Zo(t,e,n){var r=n[0],s=n[1],a=n[2],l=Math.hypot(r,s,a),c,h,d;return l<B?null:(l=1/l,r*=l,s*=l,a*=l,c=Math.sin(e),h=Math.cos(e),d=1-h,t[0]=r*r*d+h,t[1]=s*r*d+a*c,t[2]=a*r*d-s*c,t[3]=0,t[4]=r*s*d-a*c,t[5]=s*s*d+h,t[6]=a*s*d+r*c,t[7]=0,t[8]=r*a*d+s*c,t[9]=s*a*d-r*c,t[10]=a*a*d+h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function Jo(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ko(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function el(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function vi(t,e,n){var r=e[0],s=e[1],a=e[2],l=e[3],c=r+r,h=s+s,d=a+a,i=r*c,o=r*h,_=r*d,m=s*h,u=s*d,g=a*d,f=l*c,w=l*h,v=l*d;return t[0]=1-(m+g),t[1]=o+v,t[2]=_-w,t[3]=0,t[4]=o-v,t[5]=1-(i+g),t[6]=u+f,t[7]=0,t[8]=_+w,t[9]=u-f,t[10]=1-(i+m),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function tl(t,e){var n=new G(3),r=-e[0],s=-e[1],a=-e[2],l=e[3],c=e[4],h=e[5],d=e[6],i=e[7],o=r*r+s*s+a*a+l*l;return o>0?(n[0]=(c*l+i*r+h*a-d*s)*2/o,n[1]=(h*l+i*s+d*r-c*a)*2/o,n[2]=(d*l+i*a+c*s-h*r)*2/o):(n[0]=(c*l+i*r+h*a-d*s)*2,n[1]=(h*l+i*s+d*r-c*a)*2,n[2]=(d*l+i*a+c*s-h*r)*2),vi(t,e,n),t}function dr(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function xi(t,e){var n=e[0],r=e[1],s=e[2],a=e[4],l=e[5],c=e[6],h=e[8],d=e[9],i=e[10];return t[0]=Math.hypot(n,r,s),t[1]=Math.hypot(a,l,c),t[2]=Math.hypot(h,d,i),t}function mr(t,e){var n=new G(3);xi(n,e);var r=1/n[0],s=1/n[1],a=1/n[2],l=e[0]*r,c=e[1]*s,h=e[2]*a,d=e[4]*r,i=e[5]*s,o=e[6]*a,_=e[8]*r,m=e[9]*s,u=e[10]*a,g=l+i+u,f=0;return g>0?(f=Math.sqrt(g+1)*2,t[3]=.25*f,t[0]=(o-m)/f,t[1]=(_-h)/f,t[2]=(c-d)/f):l>i&&l>u?(f=Math.sqrt(1+l-i-u)*2,t[3]=(o-m)/f,t[0]=.25*f,t[1]=(c+d)/f,t[2]=(_+h)/f):i>u?(f=Math.sqrt(1+i-l-u)*2,t[3]=(_-h)/f,t[0]=(c+d)/f,t[1]=.25*f,t[2]=(o+m)/f):(f=Math.sqrt(1+u-l-i)*2,t[3]=(c-d)/f,t[0]=(_+h)/f,t[1]=(o+m)/f,t[2]=.25*f),t}function nl(t,e,n,r){var s=e[0],a=e[1],l=e[2],c=e[3],h=s+s,d=a+a,i=l+l,o=s*h,_=s*d,m=s*i,u=a*d,g=a*i,f=l*i,w=c*h,v=c*d,x=c*i,T=r[0],A=r[1],j=r[2];return t[0]=(1-(u+f))*T,t[1]=(_+x)*T,t[2]=(m-v)*T,t[3]=0,t[4]=(_-x)*A,t[5]=(1-(o+f))*A,t[6]=(g+w)*A,t[7]=0,t[8]=(m+v)*j,t[9]=(g-w)*j,t[10]=(1-(o+u))*j,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function rl(t,e,n,r,s){var a=e[0],l=e[1],c=e[2],h=e[3],d=a+a,i=l+l,o=c+c,_=a*d,m=a*i,u=a*o,g=l*i,f=l*o,w=c*o,v=h*d,x=h*i,T=h*o,A=r[0],j=r[1],I=r[2],E=s[0],D=s[1],z=s[2],q=(1-(g+w))*A,H=(m+T)*A,k=(u-x)*A,F=(m-T)*j,J=(1-(_+w))*j,he=(f+v)*j,pe=(u+x)*I,Ht=(f-v)*I,Ut=(1-(_+g))*I;return t[0]=q,t[1]=H,t[2]=k,t[3]=0,t[4]=F,t[5]=J,t[6]=he,t[7]=0,t[8]=pe,t[9]=Ht,t[10]=Ut,t[11]=0,t[12]=n[0]+E-(q*E+F*D+pe*z),t[13]=n[1]+D-(H*E+J*D+Ht*z),t[14]=n[2]+z-(k*E+he*D+Ut*z),t[15]=1,t}function il(t,e){var n=e[0],r=e[1],s=e[2],a=e[3],l=n+n,c=r+r,h=s+s,d=n*l,i=r*l,o=r*c,_=s*l,m=s*c,u=s*h,g=a*l,f=a*c,w=a*h;return t[0]=1-o-u,t[1]=i+w,t[2]=_-f,t[3]=0,t[4]=i-w,t[5]=1-d-u,t[6]=m+g,t[7]=0,t[8]=_+f,t[9]=m-g,t[10]=1-d-o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function sl(t,e,n,r,s,a,l){var c=1/(n-e),h=1/(s-r),d=1/(a-l);return t[0]=a*2*c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a*2*h,t[6]=0,t[7]=0,t[8]=(n+e)*c,t[9]=(s+r)*h,t[10]=(l+a)*d,t[11]=-1,t[12]=0,t[13]=0,t[14]=l*a*2*d,t[15]=0,t}function yi(t,e,n,r,s){var a=1/Math.tan(e/2),l;return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==1/0?(l=1/(r-s),t[10]=(s+r)*l,t[14]=2*s*r*l):(t[10]=-1,t[14]=-2*r),t}var al=yi;function ol(t,e,n,r,s){var a=1/Math.tan(e/2),l;return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==1/0?(l=1/(r-s),t[10]=s*l,t[14]=s*r*l):(t[10]=-1,t[14]=-r),t}function ll(t,e,n,r){var s=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),l=Math.tan(e.leftDegrees*Math.PI/180),c=Math.tan(e.rightDegrees*Math.PI/180),h=2/(l+c),d=2/(s+a);return t[0]=h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=d,t[6]=0,t[7]=0,t[8]=-((l-c)*h*.5),t[9]=(s-a)*d*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function bi(t,e,n,r,s,a,l){var c=1/(e-n),h=1/(r-s),d=1/(a-l);return t[0]=-2*c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*d,t[11]=0,t[12]=(e+n)*c,t[13]=(s+r)*h,t[14]=(l+a)*d,t[15]=1,t}var cl=bi;function _l(t,e,n,r,s,a,l){var c=1/(e-n),h=1/(r-s),d=1/(a-l);return t[0]=-2*c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=d,t[11]=0,t[12]=(e+n)*c,t[13]=(s+r)*h,t[14]=a*d,t[15]=1,t}function hl(t,e,n,r){var s,a,l,c,h,d,i,o,_,m,u=e[0],g=e[1],f=e[2],w=r[0],v=r[1],x=r[2],T=n[0],A=n[1],j=n[2];return Math.abs(u-T)<B&&Math.abs(g-A)<B&&Math.abs(f-j)<B?gi(t):(i=u-T,o=g-A,_=f-j,m=1/Math.hypot(i,o,_),i*=m,o*=m,_*=m,s=v*_-x*o,a=x*i-w*_,l=w*o-v*i,m=Math.hypot(s,a,l),m?(m=1/m,s*=m,a*=m,l*=m):(s=0,a=0,l=0),c=o*l-_*a,h=_*s-i*l,d=i*a-o*s,m=Math.hypot(c,h,d),m?(m=1/m,c*=m,h*=m,d*=m):(c=0,h=0,d=0),t[0]=s,t[1]=c,t[2]=i,t[3]=0,t[4]=a,t[5]=h,t[6]=o,t[7]=0,t[8]=l,t[9]=d,t[10]=_,t[11]=0,t[12]=-(s*u+a*g+l*f),t[13]=-(c*u+h*g+d*f),t[14]=-(i*u+o*g+_*f),t[15]=1,t)}function pl(t,e,n,r){var s=e[0],a=e[1],l=e[2],c=r[0],h=r[1],d=r[2],i=s-n[0],o=a-n[1],_=l-n[2],m=i*i+o*o+_*_;m>0&&(m=1/Math.sqrt(m),i*=m,o*=m,_*=m);var u=h*_-d*o,g=d*i-c*_,f=c*o-h*i;return m=u*u+g*g+f*f,m>0&&(m=1/Math.sqrt(m),u*=m,g*=m,f*=m),t[0]=u,t[1]=g,t[2]=f,t[3]=0,t[4]=o*f-_*g,t[5]=_*u-i*f,t[6]=i*g-o*u,t[7]=0,t[8]=i,t[9]=o,t[10]=_,t[11]=0,t[12]=s,t[13]=a,t[14]=l,t[15]=1,t}function dl(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function ml(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function fl(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function Mi(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function ul(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function gl(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function wl(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function vl(t,e){var n=t[0],r=t[1],s=t[2],a=t[3],l=t[4],c=t[5],h=t[6],d=t[7],i=t[8],o=t[9],_=t[10],m=t[11],u=t[12],g=t[13],f=t[14],w=t[15],v=e[0],x=e[1],T=e[2],A=e[3],j=e[4],I=e[5],E=e[6],D=e[7],z=e[8],q=e[9],H=e[10],k=e[11],F=e[12],J=e[13],he=e[14],pe=e[15];return Math.abs(n-v)<=B*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(r-x)<=B*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(s-T)<=B*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(a-A)<=B*Math.max(1,Math.abs(a),Math.abs(A))&&Math.abs(l-j)<=B*Math.max(1,Math.abs(l),Math.abs(j))&&Math.abs(c-I)<=B*Math.max(1,Math.abs(c),Math.abs(I))&&Math.abs(h-E)<=B*Math.max(1,Math.abs(h),Math.abs(E))&&Math.abs(d-D)<=B*Math.max(1,Math.abs(d),Math.abs(D))&&Math.abs(i-z)<=B*Math.max(1,Math.abs(i),Math.abs(z))&&Math.abs(o-q)<=B*Math.max(1,Math.abs(o),Math.abs(q))&&Math.abs(_-H)<=B*Math.max(1,Math.abs(_),Math.abs(H))&&Math.abs(m-k)<=B*Math.max(1,Math.abs(m),Math.abs(k))&&Math.abs(u-F)<=B*Math.max(1,Math.abs(u),Math.abs(F))&&Math.abs(g-J)<=B*Math.max(1,Math.abs(g),Math.abs(J))&&Math.abs(f-he)<=B*Math.max(1,Math.abs(f),Math.abs(he))&&Math.abs(w-pe)<=B*Math.max(1,Math.abs(w),Math.abs(pe))}var xl=wi,yl=Mi;var C={};Ie(C,{add:()=>wc,calculateW:()=>lc,clone:()=>fc,conjugate:()=>pc,copy:()=>mn,create:()=>Bt,dot:()=>fn,equals:()=>Ac,exactEquals:()=>Mc,exp:()=>Xi,fromEuler:()=>dc,fromMat3:()=>Gi,fromValues:()=>uc,getAngle:()=>oc,getAxisAngle:()=>ac,identity:()=>sc,invert:()=>hc,len:()=>yc,length:()=>un,lerp:()=>xc,ln:()=>Yi,mul:()=>vc,multiply:()=>Wi,normalize:()=>xr,pow:()=>cc,random:()=>_c,rotateX:()=>gr,rotateY:()=>wr,rotateZ:()=>vr,rotationTo:()=>Tc,scale:()=>Qi,set:()=>gc,setAxes:()=>Sc,setAxisAngle:()=>Bi,slerp:()=>dn,sqlerp:()=>jc,sqrLen:()=>bc,squaredLength:()=>gn,str:()=>mc});var y={};Ie(y,{add:()=>Tl,angle:()=>Wl,bezier:()=>Dl,ceil:()=>jl,clone:()=>bl,copy:()=>Ml,create:()=>_n,cross:()=>Vt,dist:()=>Kl,distance:()=>Pi,div:()=>Jl,divide:()=>Si,dot:()=>pn,equals:()=>Ql,exactEquals:()=>Gl,floor:()=>Sl,forEach:()=>nc,fromValues:()=>hn,hermite:()=>kl,inverse:()=>Ol,len:()=>ur,length:()=>Ai,lerp:()=>Ll,max:()=>El,min:()=>Pl,mul:()=>Zl,multiply:()=>ji,negate:()=>Cl,normalize:()=>fr,random:()=>zl,rotateX:()=>ql,rotateY:()=>Vl,rotateZ:()=>Bl,round:()=>Fl,scale:()=>Il,scaleAndAdd:()=>Rl,set:()=>Al,sqrDist:()=>ec,sqrLen:()=>tc,squaredDistance:()=>Ei,squaredLength:()=>Fi,str:()=>Yl,sub:()=>$l,subtract:()=>Ti,transformMat3:()=>Ul,transformMat4:()=>Hl,transformQuat:()=>Nl,zero:()=>Xl});function _n(){var t=new G(3);return G!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function bl(t){var e=new G(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Ai(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function hn(t,e,n){var r=new G(3);return r[0]=t,r[1]=e,r[2]=n,r}function Ml(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Al(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function Tl(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Ti(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function ji(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function Si(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function jl(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function Sl(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function Pl(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function El(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function Fl(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function Il(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function Rl(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function Pi(t,e){var n=e[0]-t[0],r=e[1]-t[1],s=e[2]-t[2];return Math.hypot(n,r,s)}function Ei(t,e){var n=e[0]-t[0],r=e[1]-t[1],s=e[2]-t[2];return n*n+r*r+s*s}function Fi(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function Cl(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function Ol(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function fr(t,e){var n=e[0],r=e[1],s=e[2],a=n*n+r*r+s*s;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}function pn(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Vt(t,e,n){var r=e[0],s=e[1],a=e[2],l=n[0],c=n[1],h=n[2];return t[0]=s*h-a*c,t[1]=a*l-r*h,t[2]=r*c-s*l,t}function Ll(t,e,n,r){var s=e[0],a=e[1],l=e[2];return t[0]=s+r*(n[0]-s),t[1]=a+r*(n[1]-a),t[2]=l+r*(n[2]-l),t}function kl(t,e,n,r,s,a){var l=a*a,c=l*(2*a-3)+1,h=l*(a-2)+a,d=l*(a-1),i=l*(3-2*a);return t[0]=e[0]*c+n[0]*h+r[0]*d+s[0]*i,t[1]=e[1]*c+n[1]*h+r[1]*d+s[1]*i,t[2]=e[2]*c+n[2]*h+r[2]*d+s[2]*i,t}function Dl(t,e,n,r,s,a){var l=1-a,c=l*l,h=a*a,d=c*l,i=3*a*c,o=3*h*l,_=h*a;return t[0]=e[0]*d+n[0]*i+r[0]*o+s[0]*_,t[1]=e[1]*d+n[1]*i+r[1]*o+s[1]*_,t[2]=e[2]*d+n[2]*i+r[2]*o+s[2]*_,t}function zl(t,e){e=e||1;var n=Le()*2*Math.PI,r=Le()*2-1,s=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*s,t[1]=Math.sin(n)*s,t[2]=r*e,t}function Hl(t,e,n){var r=e[0],s=e[1],a=e[2],l=n[3]*r+n[7]*s+n[11]*a+n[15];return l=l||1,t[0]=(n[0]*r+n[4]*s+n[8]*a+n[12])/l,t[1]=(n[1]*r+n[5]*s+n[9]*a+n[13])/l,t[2]=(n[2]*r+n[6]*s+n[10]*a+n[14])/l,t}function Ul(t,e,n){var r=e[0],s=e[1],a=e[2];return t[0]=r*n[0]+s*n[3]+a*n[6],t[1]=r*n[1]+s*n[4]+a*n[7],t[2]=r*n[2]+s*n[5]+a*n[8],t}function Nl(t,e,n){var r=n[0],s=n[1],a=n[2],l=n[3],c=e[0],h=e[1],d=e[2],i=s*d-a*h,o=a*c-r*d,_=r*h-s*c,m=s*_-a*o,u=a*i-r*_,g=r*o-s*i,f=l*2;return i*=f,o*=f,_*=f,m*=2,u*=2,g*=2,t[0]=c+i+m,t[1]=h+o+u,t[2]=d+_+g,t}function ql(t,e,n,r){var s=[],a=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],a[0]=s[0],a[1]=s[1]*Math.cos(r)-s[2]*Math.sin(r),a[2]=s[1]*Math.sin(r)+s[2]*Math.cos(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function Vl(t,e,n,r){var s=[],a=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],a[0]=s[2]*Math.sin(r)+s[0]*Math.cos(r),a[1]=s[1],a[2]=s[2]*Math.cos(r)-s[0]*Math.sin(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function Bl(t,e,n,r){var s=[],a=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],a[0]=s[0]*Math.cos(r)-s[1]*Math.sin(r),a[1]=s[0]*Math.sin(r)+s[1]*Math.cos(r),a[2]=s[2],t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function Wl(t,e){var n=t[0],r=t[1],s=t[2],a=e[0],l=e[1],c=e[2],h=Math.sqrt(n*n+r*r+s*s),d=Math.sqrt(a*a+l*l+c*c),i=h*d,o=i&&pn(t,e)/i;return Math.acos(Math.min(Math.max(o,-1),1))}function Xl(t){return t[0]=0,t[1]=0,t[2]=0,t}function Yl(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Gl(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function Ql(t,e){var n=t[0],r=t[1],s=t[2],a=e[0],l=e[1],c=e[2];return Math.abs(n-a)<=B*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-l)<=B*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(s-c)<=B*Math.max(1,Math.abs(s),Math.abs(c))}var $l=Ti,Zl=ji,Jl=Si,Kl=Pi,ec=Ei,ur=Ai,tc=Fi,nc=function(){var t=_n();return function(e,n,r,s,a,l){var c,h;for(n||(n=3),r||(r=0),s?h=Math.min(s*n+r,e.length):h=e.length,c=r;c<h;c+=n)t[0]=e[c],t[1]=e[c+1],t[2]=e[c+2],a(t,t,l),e[c]=t[0],e[c+1]=t[1],e[c+2]=t[2];return e}}();function rc(){var t=new G(4);return G!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Ii(t){var e=new G(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Ri(t,e,n,r){var s=new G(4);return s[0]=t,s[1]=e,s[2]=n,s[3]=r,s}function Ci(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Oi(t,e,n,r,s){return t[0]=e,t[1]=n,t[2]=r,t[3]=s,t}function Li(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function ki(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function Di(t){var e=t[0],n=t[1],r=t[2],s=t[3];return Math.hypot(e,n,r,s)}function zi(t){var e=t[0],n=t[1],r=t[2],s=t[3];return e*e+n*n+r*r+s*s}function Hi(t,e){var n=e[0],r=e[1],s=e[2],a=e[3],l=n*n+r*r+s*s+a*a;return l>0&&(l=1/Math.sqrt(l)),t[0]=n*l,t[1]=r*l,t[2]=s*l,t[3]=a*l,t}function Ui(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function Ni(t,e,n,r){var s=e[0],a=e[1],l=e[2],c=e[3];return t[0]=s+r*(n[0]-s),t[1]=a+r*(n[1]-a),t[2]=l+r*(n[2]-l),t[3]=c+r*(n[3]-c),t}function qi(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function Vi(t,e){var n=t[0],r=t[1],s=t[2],a=t[3],l=e[0],c=e[1],h=e[2],d=e[3];return Math.abs(n-l)<=B*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(r-c)<=B*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(s-h)<=B*Math.max(1,Math.abs(s),Math.abs(h))&&Math.abs(a-d)<=B*Math.max(1,Math.abs(a),Math.abs(d))}var $m=function(){var t=rc();return function(e,n,r,s,a,l){var c,h;for(n||(n=4),r||(r=0),s?h=Math.min(s*n+r,e.length):h=e.length,c=r;c<h;c+=n)t[0]=e[c],t[1]=e[c+1],t[2]=e[c+2],t[3]=e[c+3],a(t,t,l),e[c]=t[0],e[c+1]=t[1],e[c+2]=t[2],e[c+3]=t[3];return e}}();function Bt(){var t=new G(4);return G!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function sc(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Bi(t,e,n){n=n*.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function ac(t,e){var n=Math.acos(e[3])*2,r=Math.sin(n/2);return r>B?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function oc(t,e){var n=fn(t,e);return Math.acos(2*n*n-1)}function Wi(t,e,n){var r=e[0],s=e[1],a=e[2],l=e[3],c=n[0],h=n[1],d=n[2],i=n[3];return t[0]=r*i+l*c+s*d-a*h,t[1]=s*i+l*h+a*c-r*d,t[2]=a*i+l*d+r*h-s*c,t[3]=l*i-r*c-s*h-a*d,t}function gr(t,e,n){n*=.5;var r=e[0],s=e[1],a=e[2],l=e[3],c=Math.sin(n),h=Math.cos(n);return t[0]=r*h+l*c,t[1]=s*h+a*c,t[2]=a*h-s*c,t[3]=l*h-r*c,t}function wr(t,e,n){n*=.5;var r=e[0],s=e[1],a=e[2],l=e[3],c=Math.sin(n),h=Math.cos(n);return t[0]=r*h-a*c,t[1]=s*h+l*c,t[2]=a*h+r*c,t[3]=l*h-s*c,t}function vr(t,e,n){n*=.5;var r=e[0],s=e[1],a=e[2],l=e[3],c=Math.sin(n),h=Math.cos(n);return t[0]=r*h+s*c,t[1]=s*h-r*c,t[2]=a*h+l*c,t[3]=l*h-a*c,t}function lc(t,e){var n=e[0],r=e[1],s=e[2];return t[0]=n,t[1]=r,t[2]=s,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-s*s)),t}function Xi(t,e){var n=e[0],r=e[1],s=e[2],a=e[3],l=Math.sqrt(n*n+r*r+s*s),c=Math.exp(a),h=l>0?c*Math.sin(l)/l:0;return t[0]=n*h,t[1]=r*h,t[2]=s*h,t[3]=c*Math.cos(l),t}function Yi(t,e){var n=e[0],r=e[1],s=e[2],a=e[3],l=Math.sqrt(n*n+r*r+s*s),c=l>0?Math.atan2(l,a)/l:0;return t[0]=n*c,t[1]=r*c,t[2]=s*c,t[3]=.5*Math.log(n*n+r*r+s*s+a*a),t}function cc(t,e,n){return Yi(t,e),Qi(t,t,n),Xi(t,t),t}function dn(t,e,n,r){var s=e[0],a=e[1],l=e[2],c=e[3],h=n[0],d=n[1],i=n[2],o=n[3],_,m,u,g,f;return m=s*h+a*d+l*i+c*o,m<0&&(m=-m,h=-h,d=-d,i=-i,o=-o),1-m>B?(_=Math.acos(m),u=Math.sin(_),g=Math.sin((1-r)*_)/u,f=Math.sin(r*_)/u):(g=1-r,f=r),t[0]=g*s+f*h,t[1]=g*a+f*d,t[2]=g*l+f*i,t[3]=g*c+f*o,t}function _c(t){var e=Le(),n=Le(),r=Le(),s=Math.sqrt(1-e),a=Math.sqrt(e);return t[0]=s*Math.sin(2*Math.PI*n),t[1]=s*Math.cos(2*Math.PI*n),t[2]=a*Math.sin(2*Math.PI*r),t[3]=a*Math.cos(2*Math.PI*r),t}function hc(t,e){var n=e[0],r=e[1],s=e[2],a=e[3],l=n*n+r*r+s*s+a*a,c=l?1/l:0;return t[0]=-n*c,t[1]=-r*c,t[2]=-s*c,t[3]=a*c,t}function pc(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function Gi(t,e){var n=e[0]+e[4]+e[8],r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var s=0;e[4]>e[0]&&(s=1),e[8]>e[s*3+s]&&(s=2);var a=(s+1)%3,l=(s+2)%3;r=Math.sqrt(e[s*3+s]-e[a*3+a]-e[l*3+l]+1),t[s]=.5*r,r=.5/r,t[3]=(e[a*3+l]-e[l*3+a])*r,t[a]=(e[a*3+s]+e[s*3+a])*r,t[l]=(e[l*3+s]+e[s*3+l])*r}return t}function dc(t,e,n,r){var s=.5*Math.PI/180;e*=s,n*=s,r*=s;var a=Math.sin(e),l=Math.cos(e),c=Math.sin(n),h=Math.cos(n),d=Math.sin(r),i=Math.cos(r);return t[0]=a*h*i-l*c*d,t[1]=l*c*i+a*h*d,t[2]=l*h*d-a*c*i,t[3]=l*h*i+a*c*d,t}function mc(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var fc=Ii,uc=Ri,mn=Ci,gc=Oi,wc=Li,vc=Wi,Qi=ki,fn=Ui,xc=Ni,un=Di,yc=un,gn=zi,bc=gn,xr=Hi,Mc=qi,Ac=Vi,Tc=function(){var t=_n(),e=hn(1,0,0),n=hn(0,1,0);return function(r,s,a){var l=pn(s,a);return l<-.999999?(Vt(t,e,s),ur(t)<1e-6&&Vt(t,n,s),fr(t,t),Bi(r,t,Math.PI),r):l>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(Vt(t,s,a),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+l,xr(r,r))}}(),jc=function(){var t=Bt(),e=Bt();return function(n,r,s,a,l,c){return dn(t,r,l,c),dn(e,s,a,c),dn(n,t,e,2*c*(1-c)),n}}(),Sc=function(){var t=ui();return function(e,n,r,s){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=s[0],t[4]=s[1],t[7]=s[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],xr(e,Gi(e,t))}}();var te={};Ie(te,{add:()=>Qc,clone:()=>Ec,conjugate:()=>e_,copy:()=>Zi,create:()=>Pc,dot:()=>Ki,equals:()=>a_,exactEquals:()=>s_,fromMat4:()=>Oc,fromRotation:()=>Cc,fromRotationTranslation:()=>$i,fromRotationTranslationValues:()=>Ic,fromTranslation:()=>Rc,fromValues:()=>Fc,getDual:()=>zc,getReal:()=>Dc,getTranslation:()=>Nc,identity:()=>Lc,invert:()=>Kc,len:()=>t_,length:()=>es,lerp:()=>Jc,mul:()=>$c,multiply:()=>Ji,normalize:()=>r_,rotateAroundAxis:()=>Gc,rotateByQuatAppend:()=>Xc,rotateByQuatPrepend:()=>Yc,rotateX:()=>Vc,rotateY:()=>Bc,rotateZ:()=>Wc,scale:()=>Zc,set:()=>kc,setDual:()=>Uc,setReal:()=>Hc,sqrLen:()=>n_,squaredLength:()=>wn,str:()=>i_,translate:()=>qc});function Pc(){var t=new G(8);return G!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t}function Ec(t){var e=new G(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function Fc(t,e,n,r,s,a,l,c){var h=new G(8);return h[0]=t,h[1]=e,h[2]=n,h[3]=r,h[4]=s,h[5]=a,h[6]=l,h[7]=c,h}function Ic(t,e,n,r,s,a,l){var c=new G(8);c[0]=t,c[1]=e,c[2]=n,c[3]=r;var h=s*.5,d=a*.5,i=l*.5;return c[4]=h*r+d*n-i*e,c[5]=d*r+i*t-h*n,c[6]=i*r+h*e-d*t,c[7]=-h*t-d*e-i*n,c}function $i(t,e,n){var r=n[0]*.5,s=n[1]*.5,a=n[2]*.5,l=e[0],c=e[1],h=e[2],d=e[3];return t[0]=l,t[1]=c,t[2]=h,t[3]=d,t[4]=r*d+s*h-a*c,t[5]=s*d+a*l-r*h,t[6]=a*d+r*c-s*l,t[7]=-r*l-s*c-a*h,t}function Rc(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0]*.5,t[5]=e[1]*.5,t[6]=e[2]*.5,t[7]=0,t}function Cc(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function Oc(t,e){var n=Bt();mr(n,e);var r=new G(3);return dr(r,e),$i(t,n,r),t}function Zi(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function Lc(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function kc(t,e,n,r,s,a,l,c,h){return t[0]=e,t[1]=n,t[2]=r,t[3]=s,t[4]=a,t[5]=l,t[6]=c,t[7]=h,t}var Dc=mn;function zc(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t}var Hc=mn;function Uc(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t}function Nc(t,e){var n=e[4],r=e[5],s=e[6],a=e[7],l=-e[0],c=-e[1],h=-e[2],d=e[3];return t[0]=(n*d+a*l+r*h-s*c)*2,t[1]=(r*d+a*c+s*l-n*h)*2,t[2]=(s*d+a*h+n*c-r*l)*2,t}function qc(t,e,n){var r=e[0],s=e[1],a=e[2],l=e[3],c=n[0]*.5,h=n[1]*.5,d=n[2]*.5,i=e[4],o=e[5],_=e[6],m=e[7];return t[0]=r,t[1]=s,t[2]=a,t[3]=l,t[4]=l*c+s*d-a*h+i,t[5]=l*h+a*c-r*d+o,t[6]=l*d+r*h-s*c+_,t[7]=-r*c-s*h-a*d+m,t}function Vc(t,e,n){var r=-e[0],s=-e[1],a=-e[2],l=e[3],c=e[4],h=e[5],d=e[6],i=e[7],o=c*l+i*r+h*a-d*s,_=h*l+i*s+d*r-c*a,m=d*l+i*a+c*s-h*r,u=i*l-c*r-h*s-d*a;return gr(t,e,n),r=t[0],s=t[1],a=t[2],l=t[3],t[4]=o*l+u*r+_*a-m*s,t[5]=_*l+u*s+m*r-o*a,t[6]=m*l+u*a+o*s-_*r,t[7]=u*l-o*r-_*s-m*a,t}function Bc(t,e,n){var r=-e[0],s=-e[1],a=-e[2],l=e[3],c=e[4],h=e[5],d=e[6],i=e[7],o=c*l+i*r+h*a-d*s,_=h*l+i*s+d*r-c*a,m=d*l+i*a+c*s-h*r,u=i*l-c*r-h*s-d*a;return wr(t,e,n),r=t[0],s=t[1],a=t[2],l=t[3],t[4]=o*l+u*r+_*a-m*s,t[5]=_*l+u*s+m*r-o*a,t[6]=m*l+u*a+o*s-_*r,t[7]=u*l-o*r-_*s-m*a,t}function Wc(t,e,n){var r=-e[0],s=-e[1],a=-e[2],l=e[3],c=e[4],h=e[5],d=e[6],i=e[7],o=c*l+i*r+h*a-d*s,_=h*l+i*s+d*r-c*a,m=d*l+i*a+c*s-h*r,u=i*l-c*r-h*s-d*a;return vr(t,e,n),r=t[0],s=t[1],a=t[2],l=t[3],t[4]=o*l+u*r+_*a-m*s,t[5]=_*l+u*s+m*r-o*a,t[6]=m*l+u*a+o*s-_*r,t[7]=u*l-o*r-_*s-m*a,t}function Xc(t,e,n){var r=n[0],s=n[1],a=n[2],l=n[3],c=e[0],h=e[1],d=e[2],i=e[3];return t[0]=c*l+i*r+h*a-d*s,t[1]=h*l+i*s+d*r-c*a,t[2]=d*l+i*a+c*s-h*r,t[3]=i*l-c*r-h*s-d*a,c=e[4],h=e[5],d=e[6],i=e[7],t[4]=c*l+i*r+h*a-d*s,t[5]=h*l+i*s+d*r-c*a,t[6]=d*l+i*a+c*s-h*r,t[7]=i*l-c*r-h*s-d*a,t}function Yc(t,e,n){var r=e[0],s=e[1],a=e[2],l=e[3],c=n[0],h=n[1],d=n[2],i=n[3];return t[0]=r*i+l*c+s*d-a*h,t[1]=s*i+l*h+a*c-r*d,t[2]=a*i+l*d+r*h-s*c,t[3]=l*i-r*c-s*h-a*d,c=n[4],h=n[5],d=n[6],i=n[7],t[4]=r*i+l*c+s*d-a*h,t[5]=s*i+l*h+a*c-r*d,t[6]=a*i+l*d+r*h-s*c,t[7]=l*i-r*c-s*h-a*d,t}function Gc(t,e,n,r){if(Math.abs(r)<B)return Zi(t,e);var s=Math.hypot(n[0],n[1],n[2]);r=r*.5;var a=Math.sin(r),l=a*n[0]/s,c=a*n[1]/s,h=a*n[2]/s,d=Math.cos(r),i=e[0],o=e[1],_=e[2],m=e[3];t[0]=i*d+m*l+o*h-_*c,t[1]=o*d+m*c+_*l-i*h,t[2]=_*d+m*h+i*c-o*l,t[3]=m*d-i*l-o*c-_*h;var u=e[4],g=e[5],f=e[6],w=e[7];return t[4]=u*d+w*l+g*h-f*c,t[5]=g*d+w*c+f*l-u*h,t[6]=f*d+w*h+u*c-g*l,t[7]=w*d-u*l-g*c-f*h,t}function Qc(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t}function Ji(t,e,n){var r=e[0],s=e[1],a=e[2],l=e[3],c=n[4],h=n[5],d=n[6],i=n[7],o=e[4],_=e[5],m=e[6],u=e[7],g=n[0],f=n[1],w=n[2],v=n[3];return t[0]=r*v+l*g+s*w-a*f,t[1]=s*v+l*f+a*g-r*w,t[2]=a*v+l*w+r*f-s*g,t[3]=l*v-r*g-s*f-a*w,t[4]=r*i+l*c+s*d-a*h+o*v+u*g+_*w-m*f,t[5]=s*i+l*h+a*c-r*d+_*v+u*f+m*g-o*w,t[6]=a*i+l*d+r*h-s*c+m*v+u*w+o*f-_*g,t[7]=l*i-r*c-s*h-a*d+u*v-o*g-_*f-m*w,t}var $c=Ji;function Zc(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t}var Ki=fn;function Jc(t,e,n,r){var s=1-r;return Ki(e,n)<0&&(r=-r),t[0]=e[0]*s+n[0]*r,t[1]=e[1]*s+n[1]*r,t[2]=e[2]*s+n[2]*r,t[3]=e[3]*s+n[3]*r,t[4]=e[4]*s+n[4]*r,t[5]=e[5]*s+n[5]*r,t[6]=e[6]*s+n[6]*r,t[7]=e[7]*s+n[7]*r,t}function Kc(t,e){var n=wn(e);return t[0]=-e[0]/n,t[1]=-e[1]/n,t[2]=-e[2]/n,t[3]=e[3]/n,t[4]=-e[4]/n,t[5]=-e[5]/n,t[6]=-e[6]/n,t[7]=e[7]/n,t}function e_(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t}var es=un,t_=es,wn=gn,n_=wn;function r_(t,e){var n=wn(e);if(n>0){n=Math.sqrt(n);var r=e[0]/n,s=e[1]/n,a=e[2]/n,l=e[3]/n,c=e[4],h=e[5],d=e[6],i=e[7],o=r*c+s*h+a*d+l*i;t[0]=r,t[1]=s,t[2]=a,t[3]=l,t[4]=(c-r*o)/n,t[5]=(h-s*o)/n,t[6]=(d-a*o)/n,t[7]=(i-l*o)/n}return t}function i_(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function s_(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]}function a_(t,e){var n=t[0],r=t[1],s=t[2],a=t[3],l=t[4],c=t[5],h=t[6],d=t[7],i=e[0],o=e[1],_=e[2],m=e[3],u=e[4],g=e[5],f=e[6],w=e[7];return Math.abs(n-i)<=B*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-o)<=B*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(s-_)<=B*Math.max(1,Math.abs(s),Math.abs(_))&&Math.abs(a-m)<=B*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(l-u)<=B*Math.max(1,Math.abs(l),Math.abs(u))&&Math.abs(c-g)<=B*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(h-f)<=B*Math.max(1,Math.abs(h),Math.abs(f))&&Math.abs(d-w)<=B*Math.max(1,Math.abs(d),Math.abs(w))}var Ge=function(t,e,n,r){var s=arguments.length,a=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(l=t[c])&&(a=(s<3?l(a):s>3?l(e,n,a):l(e,n))||a);return s>3&&a&&Object.defineProperty(e,n,a),a},le=class extends R{collisionMask=0;maxDistance=100;onDestroyCallbacks=[];input=null;origin=new Float32Array(3);cursorObjScale=new Float32Array(3);direction=new Float32Array(3);tempVec=new Float32Array(3);projectionMatrix=new Float32Array(16);viewComponent=null;visible=!0;isDown=!1;lastIsDown=!1;arTouchDown=!1;lastCursorPosOnTarget=new Float32Array(3);hoveringObject=null;hoveringObjectTarget=null;cursorRayScale=new Float32Array(3);globalTarget=new se(this.engine);cursorPos=new Float32Array(3);collisionGroup=1;cursorRayObject=null;cursorRayScalingAxis=2;cursorObject=null;handedness=0;rayCastMode=0;styleCursor=!0;start(){if(this.collisionMask=1<<this.collisionGroup,this.handedness==0){let n=this.object.getComponent("input");n?(this.handedness=n.handedness||"none",this.input=n):console.warn("cursor component on object",this.object.name,'was configured with handedness "input component", but object has no input component.')}else this.handedness=["left","right","none"][this.handedness-1];if(this.viewComponent=this.object.getComponent(Ae),this.viewComponent!=null){let n=this.onClick.bind(this);this.engine.canvas.addEventListener("click",n);let r=this.onPointerMove.bind(this);this.engine.canvas.addEventListener("pointermove",r);let s=this.onPointerDown.bind(this);this.engine.canvas.addEventListener("pointerdown",s);let a=this.onPointerUp.bind(this);this.engine.canvas.addEventListener("pointerup",a),ke.invert(this.projectionMatrix,this.viewComponent.projectionMatrix);let l=this.onViewportResize.bind(this);window.addEventListener("resize",l),this.onDestroyCallbacks.push(()=>{this.engine.canvas.removeEventListener("click",n),this.engine.canvas.removeEventListener("pointermove",r),this.engine.canvas.removeEventListener("pointerdown",s),this.engine.canvas.removeEventListener("pointerup",a),window.removeEventListener("resize",l)})}let e=this.setupVREvents.bind(this);this.engine.onXRSessionStart.add(e),this.onDestroyCallbacks.push(()=>{this.engine.onXRSessionStart.remove(e)}),this.cursorRayObject&&(this.cursorRayScale.set(this.cursorRayObject.scalingLocal),this.object.getTranslationWorld(this.origin),this.object.getForward(this.direction),this._setCursorRayTransform(y.add(this.tempVec,this.origin,this.direction)))}onViewportResize(){this.viewComponent&&ke.invert(this.projectionMatrix,this.viewComponent.projectionMatrix)}_setCursorRayTransform(e){if(!this.cursorRayObject)return;let n=y.dist(this.origin,e);this.cursorRayObject.setTranslationLocal([0,0,-n/2]),this.cursorRayScalingAxis!=4&&(this.cursorRayObject.resetScaling(),this.cursorRayScale[this.cursorRayScalingAxis]=n/2,this.cursorRayObject.scale(this.cursorRayScale))}_setCursorVisibility(e){this.visible!=e&&(this.visible=e,this.cursorObject&&(e?(this.cursorObject.resetScaling(),this.cursorObject.scale(this.cursorObjScale)):(this.cursorObjScale.set(this.cursorObject.scalingLocal),this.cursorObject.scale([0,0,0]))))}update(){this.doUpdate(!1)}doUpdate(e){if(this.engine.xrSession)if(this.arTouchDown&&this.input&&this.engine.xrSession.inputSources[0].handedness==="none"&&this.engine.xrSession.inputSources[0].gamepad){let r=this.engine.xrSession.inputSources[0].gamepad.axes;this.direction[0]=r[0],this.direction[1]=-r[1],this.direction[2]=-1,this.updateDirection()}else this.object.getTranslationWorld(this.origin),this.object.getForward(this.direction);let n=this.rayCastMode==0?this.engine.scene.rayCast(this.origin,this.direction,this.collisionMask):this.engine.physics.rayCast(this.origin,this.direction,this.collisionMask,this.maxDistance);n.hitCount>0?this.cursorPos.set(n.locations[0]):this.cursorPos.fill(0),this.hoverBehaviour(n,e),this.cursorObject&&(this.hoveringObject&&(this.cursorPos[0]!=0||this.cursorPos[1]!=0||this.cursorPos[2]!=0)?(this._setCursorVisibility(!0),this.cursorObject.setTranslationWorld(this.cursorPos),this._setCursorRayTransform(this.cursorPos)):this._setCursorVisibility(!1))}hoverBehaviour(e,n){if(e.hitCount>0){if(!this.hoveringObject||!this.hoveringObject.equals(e.objects[0])){if(this.hoveringObject){let a=this.hoveringObject.getComponent(se);a&&a.onUnhover.notify(this.hoveringObject,this),this.globalTarget.onUnhover.notify(this.hoveringObject,this)}this.hoveringObject=e.objects[0],this.styleCursor&&(this.engine.canvas.style.cursor="pointer");let s=this.hoveringObject.getComponent(se);s&&(this.hoveringObjectTarget=s,s.onHover.notify(this.hoveringObject,this)),this.globalTarget.onHover.notify(this.hoveringObject,this)}this.hoveringObjectTarget&&(this.hoveringObject.toLocalSpaceTransform(this.tempVec,this.cursorPos),(this.lastCursorPosOnTarget[0]!=this.tempVec[0]||this.lastCursorPosOnTarget[1]!=this.tempVec[1]||this.lastCursorPosOnTarget[2]!=this.tempVec[2])&&(this.hoveringObjectTarget.onMove.notify(this.hoveringObject,this),this.lastCursorPosOnTarget.set(this.tempVec)));let r=this.hoveringObject.getComponent(se);this.isDown!==this.lastIsDown&&(this.isDown?(r&&r.onDown.notify(this.hoveringObject,this),this.globalTarget.onDown.notify(this.hoveringObject,this)):(r&&r.onUp.notify(this.hoveringObject,this),this.globalTarget.onUp.notify(this.hoveringObject,this))),n&&(r&&r.onClick.notify(this.hoveringObject,this),this.globalTarget.onClick.notify(this.hoveringObject,this))}else if(this.hoveringObject&&e.hitCount==0){let r=this.hoveringObject.getComponent(se);r&&r.onUnhover.notify(this.hoveringObject,this),this.globalTarget.onUnhover.notify(this.hoveringObject,this),this.hoveringObject=null,this.hoveringObjectTarget=null,this.styleCursor&&(this.engine.canvas.style.cursor="default")}this.lastIsDown=this.isDown}setupVREvents(e){let n=this.onSelect.bind(this);e.addEventListener("select",n);let r=this.onSelectStart.bind(this);e.addEventListener("selectstart",r);let s=this.onSelectEnd.bind(this);e.addEventListener("selectend",s),this.onDestroyCallbacks.push(()=>{this.engine.xrSession&&(e.removeEventListener("select",n),e.removeEventListener("selectstart",r),e.removeEventListener("selectend",s))}),this.onViewportResize()}onSelect(e){e.inputSource.handedness==this.handedness&&this.doUpdate(!0)}onSelectStart(e){this.arTouchDown=!0,e.inputSource.handedness==this.handedness&&(this.isDown=!0)}onSelectEnd(e){this.arTouchDown=!1,e.inputSource.handedness==this.handedness&&(this.isDown=!1)}onPointerMove(e){if(!e.isPrimary)return;let n=this.engine.canvas.getBoundingClientRect(),r=this.updateMousePos(e.clientX,e.clientY,n.width,n.height);this.hoverBehaviour(r,!1)}onClick(e){let n=this.engine.canvas.getBoundingClientRect(),r=this.updateMousePos(e.clientX,e.clientY,n.width,n.height);this.hoverBehaviour(r,!0)}onPointerDown(e){if(!e.isPrimary||e.button!==0)return;let n=this.engine.canvas.getBoundingClientRect(),r=this.updateMousePos(e.clientX,e.clientY,n.width,n.height);this.isDown=!0,this.hoverBehaviour(r,!1)}onPointerUp(e){if(!e.isPrimary||e.button!==0)return;let n=this.engine.canvas.getBoundingClientRect(),r=this.updateMousePos(e.clientX,e.clientY,n.width,n.height);this.isDown=!1,this.hoverBehaviour(r,!1)}updateMousePos(e,n,r,s){let a=e/r,l=n/s;return this.direction[0]=a*2-1,this.direction[1]=-l*2+1,this.direction[2]=-1,this.updateDirection()}updateDirection(){this.object.getTranslationWorld(this.origin),y.transformMat4(this.direction,this.direction,this.projectionMatrix),y.normalize(this.direction,this.direction),y.transformQuat(this.direction,this.direction,this.object.transformWorld);let e=this.rayCastMode==0?this.engine.scene.rayCast(this.origin,this.direction,this.collisionMask):this.engine.physics.rayCast(this.origin,this.direction,this.collisionMask,this.maxDistance);return e.hitCount>0?this.cursorPos.set(e.locations[0]):this.cursorPos.fill(0),e}onDeactivate(){if(this._setCursorVisibility(!1),this.hoveringObject){let e=this.hoveringObject.getComponent(se);e&&e.onUnhover.notify(this.hoveringObject,this),this.globalTarget.onUnhover.notify(this.hoveringObject,this)}this.cursorRayObject&&this.cursorRayObject.scale([0,0,0])}onActivate(){this._setCursorVisibility(!0)}onDestroy(){for(let e of this.onDestroyCallbacks)e()}};M(le,"TypeName","cursor");Ge([de.int(1)],le.prototype,"collisionGroup",void 0);Ge([de.object()],le.prototype,"cursorRayObject",void 0);Ge([de.enum(["x","y","z","none"],"z")],le.prototype,"cursorRayScalingAxis",void 0);Ge([de.object()],le.prototype,"cursorObject",void 0);Ge([de.enum(["input component","left","right","none"],"input component")],le.prototype,"handedness",void 0);Ge([de.enum(["collision","physx"],"collision")],le.prototype,"rayCastMode",void 0);Ge([de.bool(!0)],le.prototype,"styleCursor",void 0);var o_=function(t,e,n,r){var s=arguments.length,a=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(l=t[c])&&(a=(s<3?l(a):s>3?l(e,n,a):l(e,n))||a);return s>3&&a&&Object.defineProperty(e,n,a),a},lt=class extends R{obj=null;start(){let e=new Float32Array(3);te.getTranslation(e,this.object.transformWorld),console.log("Debug object:",this.object.name),console.log("Other object:",this.obj?.name),console.log("	translation",e),console.log("	transformWorld",this.object.transformWorld),console.log("	transformLocal",this.object.transformLocal)}};M(lt,"TypeName","debug-object");o_([de.object()],lt.prototype,"obj",void 0);function l_(t,e,n,r){let s=Math.cos(e/2),a=Math.cos(n/2),l=Math.cos(r/2),c=Math.sin(e/2),h=Math.sin(n/2),d=Math.sin(r/2);t[0]=c*a*l+s*h*d,t[1]=s*h*l-c*a*d,t[2]=s*a*d-c*h*l,t[3]=s*a*l+c*h*d}var ct=class extends R{start(){this.rotationX=0,this.rotationY=0,this.lastClientX=-1,this.lastClientY=-1}init(){this.deviceOrientation=[0,0,0,1],this.screenOrientation=window.innerHeight>window.innerWidth?0:90,this._origin=[0,0,0],window.addEventListener("deviceorientation",function(e){let n=e.alpha||0,r=e.beta||0,s=e.gamma||0,a=Math.PI/180;l_(this.deviceOrientation,r*a,n*a,-s*a)}.bind(this)),window.addEventListener("orientationchange",function(e){this.screenOrientation=window.orientation||0}.bind(this),!1)}update(){Module.webxr_session==null&&(this.object.getTranslationLocal(this._origin),this.object.resetTransform(),this.screenOrientation!=0&&this.object.rotateAxisAngleDeg([0,0,-1],this.screenOrientation),this.object.rotate([-Math.sqrt(.5),0,0,Math.sqrt(.5)]),this.object.rotate(this.deviceOrientation),this.object.translate(this._origin))}};M(ct,"TypeName","device-orientation-look"),M(ct,"Properties",{});var _t=class extends R{init(){this.lastTarget=null}start(){this.tip=this.object.getComponent("collision")}update(){let e=this.tip.queryOverlaps(),n=null;for(let r=0;r<e.length;++r){let s=e[r].object,a=s.getComponent("cursor-target");if(a){a.equals(this.lastTarget)||(a.onHover(s,this),a.onClick(s,this)),n=a;break}}if(n)this.lastTarget=n;else{this.lastTarget&&this.lastTarget.onUnhover(this.lastTarget.object,this),this.lastTarget=null;return}}};M(_t,"TypeName","finger-cursor"),M(_t,"Properties",{});var ht=class extends R{start(){this.engine.xr?this.setFixedFoveation():this.engine.onXRSessionStart.push(this.setFixedFoveation.bind(this))}setFixedFoveation(){this.engine.xr.baseLayer.fixedFoveation=this.fixedFoveation}};M(ht,"TypeName","fixed-foveation"),M(ht,"Properties",{fixedFoveation:{type:S.Float,default:.5}});var vn=new Float32Array(3),Wt=new Float32Array(4);function Xt(t,e){let n=e.orientation;Wt[0]=n.x,Wt[1]=n.y,Wt[2]=n.z,Wt[3]=n.w;let r=e.position;vn[0]=r.x,vn[1]=r.y,vn[2]=r.z,t.resetTranslationRotation(),t.transformLocal.set(Wt),t.translate(vn)}var Yt=["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"],pt=class extends R{init(){this.handedness=["left","right"][this.handedness]}start(){if(this.joints=[],this.session=null,this.hasPose=!1,this._childrenActive=!0,!("XRHand"in window)){console.warn("WebXR Hand Tracking not supported by this browser."),this.active=!1;return}if(this.handSkin){let n=this.handSkin.jointIds;this.joints[Yt[0]]=this.engine.wrapObject(n[0]);for(let r=0;r<n.length;++r){let s=this.engine.wrapObject(n[r]);this.joints[s.name]=s}return}for(let e=0;e<=Yt.length;++e){let n=this.engine.scene.addObject(this.object.parent),r=n.addComponent("mesh");r.mesh=this.jointMesh,r.material=this.jointMaterial,this.joints[Yt[e]]=n}}update(e){if(this.session||this.engine.xr&&this.setupVREvents(this.engine.xr.session),!!this.session){if(this.hasPose=!1,this.session&&this.session.inputSources)for(let n=0;n<=this.session.inputSources.length;++n){let r=this.session.inputSources[n];if(!r||!r.hand||r.handedness!=this.handedness)continue;if(this.hasPose=!0,r.hand.get("wrist")!==null){let l=Module.webxr_frame.getJointPose(r.hand.get("wrist"),this.engine.xr.currentReferenceSpace);l&&Xt(this.object,l.transform)}let s=new Float32Array(3),a=new Float32Array(4);C.invert(a,this.object.transformLocal),this.object.getTranslationLocal(s);for(let l=0;l<Yt.length;++l){let c=Yt[l],h=this.joints[c];if(h==null)continue;let d=null;if(r.hand.get(c)!==null&&(d=this.engine.xr.frame.getJointPose(r.hand.get(c),this.engine.xr.currentReferenceSpace)),d!==null)if(this.handSkin)h.resetTranslationRotation(),h.translate([d.transform.position.x-s[0],d.transform.position.y-s[1],d.transform.position.z-s[2]]),h.rotate(a),h.rotateObject([d.transform.orientation.x,d.transform.orientation.y,d.transform.orientation.z,d.transform.orientation.w]);else{Xt(this.object,p.transform);let i=d.radius||.007;h.scale([i,i,i])}else this.handSkin||h.scale([0,0,0])}}!this.hasPose&&this._childrenActive?(this._childrenActive=!1,this.deactivateChildrenWithoutPose&&this.setChildrenActive(!1),this.controllerToDeactivate&&(this.controllerToDeactivate.active=!0,this.setChildrenActive(!0,this.controllerToDeactivate))):this.hasPose&&!this._childrenActive&&(this._childrenActive=!0,this.deactivateChildrenWithoutPose&&this.setChildrenActive(!0),this.controllerToDeactivate&&(this.controllerToDeactivate.active=!1,this.setChildrenActive(!1,this.controllerToDeactivate)))}}setChildrenActive(e,n){n=n||this.object;let r=n.children;for(let s of r)s.active=e,this.setChildrenActive(e,s)}isGrabbing(){let e=[0,0,0];te.getTranslation(e,this.joints["index-finger-tip"].transformLocal);let n=[0,0,0];return te.getTranslation(n,this.joints["thumb-tip"].transformLocal),y.sqrDist(n,e)<.001}setupVREvents(e){this.session=e}};M(pt,"TypeName","hand-tracking"),M(pt,"Properties",{handedness:{type:S.Enum,default:"left",values:["left","right"]},jointMesh:{type:S.Mesh,default:null},jointMaterial:{type:S.Material,default:null},handSkin:{type:S.Skin,default:null},deactivateChildrenWithoutPose:{type:S.Bool,default:!0},controllerToDeactivate:{type:S.Object}});var dt=class extends R{tempScaling=new Float32Array(3);visible=!1;xrHitTestSource=null;start(){this.engine.onXRSessionStart.add(this.xrSessionStart.bind(this)),this.engine.onXRSessionEnd.add(this.xrSessionEnd.bind(this)),this.tempScaling.set(this.object.scalingLocal),this.object.scale([0,0,0])}update(){let e=this.visible;if(this.xrHitTestSource){let n=this.engine.xrFrame;if(!n)return;let r=n.getHitTestResults(this.xrHitTestSource);if(r.length>0){let s=r[0].getPose(this.engine.xr.referenceSpaceForType("viewer"));this.visible=!!s,s&&Xt(this.object,s.transform)}else this.visible=!1}this.visible!=e&&(this.visible?(this.object.scalingLocal.set(this.tempScaling),this.object.setDirty()):(this.tempScaling.set(this.object.scalingLocal),this.object.scale([0,0,0])))}getHitTestResults(){return this.engine.xr?.frame?this.xrHitTestSource?this.engine.xr.frame.getHitTestResults(this.xrHitTestSource):[]:[]}xrSessionStart(e){if(e.requestHitTestSource===void 0){console.error("hit-test-location: hit test feature not available. Deactivating component."),this.active=!1;return}let n=this.engine.xr.referenceSpaceForType("viewer");e.requestHitTestSource({space:n}).then(r=>{this.xrHitTestSource=r}).catch(console.error)}xrSessionEnd(){this.xrHitTestSource&&(this.xrHitTestSource.cancel(),this.xrHitTestSource=null)}};M(dt,"TypeName","hit-test-location"),M(dt,"Properties",{});var If=tt(yr(),1);var mt=class extends R{init(){this.origin=new Float32Array(3),this.fwd=new Float32Array(3),this.up=new Float32Array(3)}update(){this.spatial&&(this.object.getTranslationWorld(this.origin),this.object.getForward(this.fwd),this.object.getUp(this.up),Howler.pos(this.origin[0],this.origin[1],this.origin[2]),Howler.orientation(this.fwd[0],this.fwd[1],this.fwd[2],this.up[0],this.up[1],this.up[2]))}};M(mt,"TypeName","howler-audio-listener"),M(mt,"Properties",{spatial:{type:S.Bool,default:!0}});var ts=tt(yr(),1);var ft=class extends R{start(){this.audio=new ts.Howl({src:[this.src],loop:this.loop,volume:this.volume,autoplay:this.autoplay}),this.lastPlayedAudioId=null,this.origin=new Float32Array(3),this.lastOrigin=new Float32Array(3),this.spatial&&this.autoplay&&(this.updatePosition(),this.play())}update(){!this.spatial||!this.lastPlayedAudioId||(this.object.getTranslationWorld(this.origin),(Math.abs(this.lastOrigin[0]-this.origin[0])>.005||Math.abs(this.lastOrigin[1]-this.origin[1])>.005||Math.abs(this.lastOrigin[2]-this.origin[2])>.005)&&this.updatePosition())}updatePosition(){this.audio.pos(this.origin[0],this.origin[1],this.origin[2],this.lastPlayedAudioId),this.lastOrigin.set(this.origin)}play(){this.lastPlayedAudioId&&this.audio.stop(this.lastPlayedAudioId),this.lastPlayedAudioId=this.audio.play(),this.spatial&&this.updatePosition()}stop(){this.lastPlayedAudioId&&(this.audio.stop(this.lastPlayedAudioId),this.lastPlayedAudioId=null)}onDeactivate(){this.stop()}};M(ft,"TypeName","howler-audio-source"),M(ft,"Properties",{volume:{type:S.Float,default:1},spatial:{type:S.Bool,default:!0},loop:{type:S.Bool,default:!1},autoplay:{type:S.Bool,default:!1},src:{type:S.String,default:""}});var ut=class extends R{start(){if(!this.material)throw Error("image-texture: material property not set");this.engine.textures.load(this.url,"anonymous").then(e=>{let n=this.material,r=n.shader;r==="Flat Opaque Textured"?n.flatTexture=e:r==="Phong Opaque Textured"||r==="Foliage"?n.diffuseTexture=e:r==="Background"?n.texture=e:r==="Physical Opaque Textured"?n.albedoTexture=e:console.error("Shader",r,"not supported by image-texture")}).catch(console.err)}};M(ut,"TypeName","image-texture"),M(ut,"Properties",{url:{type:S.String},material:{type:S.Material}});var gt=class extends R{init(){this.currentRotationY=0,this.currentRotationX=0,this.origin=new Float32Array(3),this.parentOrigin=new Float32Array(3),this.rotationX=0,this.rotationY=0}start(){document.addEventListener("mousemove",n=>{if(this.active&&(this.mouseDown||!this.requireMouseDown)){this.rotationY=-this.sensitity*n.movementX/100,this.rotationX=-this.sensitity*n.movementY/100,this.currentRotationX+=this.rotationX,this.currentRotationY+=this.rotationY,this.currentRotationX=Math.min(1.507,this.currentRotationX),this.currentRotationX=Math.max(-1.507,this.currentRotationX),this.object.getTranslationWorld(this.origin);let r=this.object.parent;r!==null&&(r.getTranslationWorld(this.parentOrigin),y.sub(this.origin,this.origin,this.parentOrigin)),this.object.resetTranslationRotation(),this.object.rotateAxisAngleRad([1,0,0],this.currentRotationX),this.object.rotateAxisAngleRad([0,1,0],this.currentRotationY),this.object.translate(this.origin)}});let e=this.engine.canvas;this.pointerLockOnClick&&e.addEventListener("mousedown",()=>{e.requestPointerLock=e.requestPointerLock||e.mozRequestPointerLock||e.webkitRequestPointerLock,e.requestPointerLock()}),this.requireMouseDown&&(this.mouseButtonIndex==2&&e.addEventListener("contextmenu",n=>{n.preventDefault()},!1),e.addEventListener("mousedown",n=>{if(n.button==this.mouseButtonIndex&&(this.mouseDown=!0,document.body.style.cursor="grabbing",n.button==1))return n.preventDefault(),!1}),e.addEventListener("mouseup",n=>{n.button==this.mouseButtonIndex&&(this.mouseDown=!1,document.body.style.cursor="initial")}))}};M(gt,"TypeName","mouse-look"),M(gt,"Properties",{sensitity:{type:S.Float,default:.25},requireMouseDown:{type:S.Bool,default:!0},mouseButtonIndex:{type:S.Int},pointerLockOnClick:{type:S.Bool,default:!1}});var wt=class extends R{start(){this.object.resetTranslationRotation(),this.object.translate([0,this.height,0]),this.onSessionStartCallback=this.onXRSessionStart.bind(this),this.onSessionEndCallback=this.onXRSessionEnd.bind(this)}onActivate(){this.engine.onXRSessionStart.add(this.onSessionStartCallback),this.engine.onXRSessionEnd.add(this.onSessionEndCallback)}onDeactivate(){this.engine.onXRSessionStart.remove(this.onSessionStartCallback),this.engine.onXRSessionEnd.remove(this.onSessionEndCallback)}onXRSessionStart(){["local","viewer"].includes(this.engine.xr.currentReferenceSpace)||this.object.resetTranslationRotation()}onXRSessionEnd(){["local","viewer"].includes(this.engine.xr.currentReferenceSpace)||(this.object.resetTranslationRotation(),this.object.translate([0,this.height,0]))}};M(wt,"TypeName","player-height"),M(wt,"Properties",{height:{type:S.Float,default:1.75}});var vt=class extends R{start(){this.engine.xrSession?this.setTargetFramerate(this.engine.xrSession):this.engine.onXRSessionStart.push(this.setTargetFramerate.bind(this))}setTargetFramerate(e){if(e.supportedFrameRates&&e.updateTargetFrameRate){let n=this.engine.xrSession.supportedFrameRates;n.sort((r,s)=>Math.abs(r-this.framerate)-Math.abs(s-this.framerate)),this.engine.xrSession.updateTargetFrameRate(n[0])}}};M(vt,"TypeName","target-framerate"),M(vt,"Properties",{framerate:{type:S.Float,default:90}});var xt=class extends R{init(){if(this._prevThumbstickAxis=new Float32Array(2),this._tempVec=new Float32Array(3),this._tempVec0=new Float32Array(3),this._currentIndicatorRotation=0,this.input=this.object.getComponent("input"),!this.input){console.error(this.object.name,"generic-teleport-component.js: input component is required on the object");return}if(!this.teleportIndicatorMeshObject){console.error(this.object.name,"generic-teleport-component.js: Teleport indicator mesh is missing");return}if(!this.camRoot){console.error(this.object.name,"generic-teleport-component.js: camRoot not set");return}this.isIndicating=!1,this.indicatorHidden=!0,this.hitSpot=new Float32Array(3),this._hasHit=!1,this._extraRotation=0,this._currentStickAxes=new Float32Array(2)}start(){if(this.cam&&(this.isMouseIndicating=!1,canvas.addEventListener("mousedown",this.onMouseDown.bind(this)),canvas.addEventListener("mouseup",this.onMouseUp.bind(this))),this.handedness==0){let e=this.object.getComponent("input");e?(this.handedness=e.handedness,this.input=e):console.warn("teleport component on object",this.object.name,'was configured with handedness "input component", but object has no input component.')}else this.handedness=["left","right"][this.handedness-1];this.engine.onXRSessionStart.push(this.setupVREvents.bind(this)),this.teleportIndicatorMeshObject.active=!1}_getCamRotation(){return this.eyeLeft.getForward(this._tempVec),this._tempVec[1]=0,y.normalize(this._tempVec,this._tempVec),Math.atan2(this._tempVec[0],this._tempVec[2])}update(){let e=0;if(this.gamepad&&this.gamepad.axes&&(this._currentStickAxes[0]=this.gamepad.axes[2],this._currentStickAxes[1]=this.gamepad.axes[3],e=Math.abs(this._currentStickAxes[0])+Math.abs(this._currentStickAxes[1])),!this.isIndicating&&this._prevThumbstickAxis[1]>=this.thumbstickActivationThreshhold&&this._currentStickAxes[1]<this.thumbstickActivationThreshhold?this.isIndicating=!0:this.isIndicating&&e<this.thumbstickDeactivationThreshhold&&(this.isIndicating=!1,this.teleportIndicatorMeshObject.active=!1,this._hasHit&&this._teleportPlayer(this.hitSpot,this._extraRotation)),this.isIndicating&&this.teleportIndicatorMeshObject&&this.input){let n=this._tempVec0;te.getTranslation(n,this.object.transformWorld);let r=this.object.getForward(this._tempVec),s=this.rayHit=this.rayCastMode==0?this.engine.scene.rayCast(n,r,1<<this.floorGroup):this.engine.physics.rayCast(n,r,1<<this.floorGroup,this.maxDistance);s.hitCount>0?(this.indicatorHidden=!1,this._extraRotation=Math.PI+Math.atan2(this._currentStickAxes[0],this._currentStickAxes[1]),this._currentIndicatorRotation=this._getCamRotation()+(this._extraRotation-Math.PI),this.teleportIndicatorMeshObject.resetTranslationRotation(),this.teleportIndicatorMeshObject.rotateAxisAngleRad([0,1,0],this._currentIndicatorRotation),this.teleportIndicatorMeshObject.translate(s.locations[0]),this.teleportIndicatorMeshObject.translate([0,this.indicatorYOffset,0]),this.teleportIndicatorMeshObject.active=!0,this.hitSpot.set(s.locations[0]),this._hasHit=!0):(this.indicatorHidden||(this.teleportIndicatorMeshObject.active=!1,this.indicatorHidden=!0),this._hasHit=!1)}else this.teleportIndicatorMeshObject&&this.isMouseIndicating&&this.onMousePressed();this._prevThumbstickAxis.set(this._currentStickAxes)}setupVREvents(e){if(this.session=e,e.addEventListener("end",function(){this.gamepad=null,this.session=null}.bind(this)),e.inputSources&&e.inputSources.length)for(let n=0;n<e.inputSources.length;n++){let r=e.inputSources[n];r.handedness==this.handedness&&(this.gamepad=r.gamepad)}e.addEventListener("inputsourceschange",function(n){if(n.added&&n.added.length)for(let r=0;r<n.added.length;r++){let s=n.added[r];s.handedness==this.handedness&&(this.gamepad=s.gamepad)}}.bind(this))}onMouseDown(){this.isMouseIndicating=!0}onMouseUp(){this.isMouseIndicating=!1,this.teleportIndicatorMeshObject.active=!1,this._hasHit&&this._teleportPlayer(this.hitSpot,0)}onMousePressed(){let e=[0,0,0];te.getTranslation(e,this.cam.transformWorld);let n=this.cam.getForward(this._tempVec),r=this.rayHit=this.rayCastMode==0?this.engine.scene.rayCast(e,n,1<<this.floorGroup):this.engine.physics.rayCast(e,n,1<<this.floorGroup,this.maxDistance);r.hitCount>0?(this.indicatorHidden=!1,n[1]=0,y.normalize(n,n),this._currentIndicatorRotation=-Math.sign(n[2])*Math.acos(n[0])-Math.PI*.5,this.teleportIndicatorMeshObject.resetTranslationRotation(),this.teleportIndicatorMeshObject.rotateAxisAngleRad([0,1,0],this._currentIndicatorRotation),this.teleportIndicatorMeshObject.translate(r.locations[0]),this.teleportIndicatorMeshObject.active=!0,this.hitSpot=r.locations[0],this._hasHit=!0):(this.indicatorHidden||(this.teleportIndicatorMeshObject.active=!1,this.indicatorHidden=!0),this._hasHit=!1)}_teleportPlayer(e,n){this.camRoot.rotateAxisAngleRad([0,1,0],n);let r=this._tempVec,s=this._tempVec0;this.session?(this.eyeLeft.getTranslationWorld(r),this.eyeRight.getTranslationWorld(s),y.add(r,r,s),y.scale(r,r,.5)):this.cam.getTranslationWorld(r),this.camRoot.getTranslationWorld(s),y.sub(r,s,r),r[0]+=e[0],r[1]=e[1],r[2]+=e[2],this.camRoot.setTranslationWorld(r)}};M(xt,"TypeName","teleport"),M(xt,"Properties",{teleportIndicatorMeshObject:{type:S.Object},camRoot:{type:S.Object},cam:{type:S.Object},eyeLeft:{type:S.Object},eyeRight:{type:S.Object},handedness:{type:S.Enum,values:["input component","left","right","none"],default:"input component"},floorGroup:{type:S.Int,default:1},thumbstickActivationThreshhold:{type:S.Float,default:-.7},thumbstickDeactivationThreshhold:{type:S.Float,default:.3},indicatorYOffset:{type:S.Float,default:.01},rayCastMode:{type:S.Enum,values:["collision","physx"],default:"collision"},maxDistance:{type:S.Float,default:100}});var yn=y.create(),ce=y.create(),Gt=y.create(),yt=class extends R{init(){this.points=new Array(this.segments+1);for(let e=0;e<this.points.length;++e)this.points[e]=y.create();this.currentPointOffset=0,this.up=[0,1,0],this.timeTillNext=this.interval}start(){this.trailContainer=this.engine.scene.addObject(),this.meshComp=this.trailContainer.addComponent("mesh"),this.meshComp.material=this.material;let e=2*this.points.length;this.indexData=new Uint32Array(6*this.segments);for(let n=0,r=0;n<e-2;n+=2,r+=6)this.indexData.subarray(r,r+6).set([n+1,n+0,n+2,n+2,n+3,n+1]);this.mesh=new st(this.engine,{vertexCount:e,indexData:this.indexData,indexType:ue.UnsignedInt}),this.meshComp.mesh=this.mesh}updateVertices(){let e=this.mesh.attribute(Xe.Position),n=this.mesh.attribute(Xe.TextureCoordinate),r=this.mesh.attribute(Xe.Normal);y.set(yn,0,0,0);for(let s=0;s<this.points.length;++s){let a=this.points[(this.currentPointIndex+s+1)%this.points.length],l=this.points[(this.currentPointIndex+s+2)%this.points.length];s!==this.points.length-1&&y.sub(yn,l,a),y.cross(ce,this.up,yn),y.normalize(ce,ce);let c=1-this.timeTillNext/this.interval,h=(s-c)/this.segments;y.scale(ce,ce,(this.taper?h:1)*this.width/2),e.set(s*2,[a[0]-ce[0],a[1]-ce[1],a[2]-ce[2]]),e.set(s*2+1,[a[0]+ce[0],a[1]+ce[1],a[2]+ce[2]]),r&&(y.cross(Gt,yn,ce),y.normalize(Gt,Gt),r.set(s*2,Gt),r.set(s*2+1,Gt)),n&&(n.set(s*2,[0,h]),n.set(s*2+1,[1,h]))}this.mesh.update()}resetTrail(){this.object.getTranslationWorld(this.points[0]);for(let e=1;e<this.points.length;++e)y.copy(this.points[e],this.points[0]);this.currentPointIndex=0,this.timeTillNext=this.interval}update(e){this.timeTillNext-=e,e>this.resetThreshold&&this.resetTrail(),this.timeTillNext<0&&(this.currentPointIndex=(this.currentPointIndex+1)%this.points.length,this.timeTillNext=this.timeTillNext%this.interval+this.interval),this.object.getTranslationWorld(this.points[this.currentPointIndex]),this.updateVertices()}onActivate(){this.resetTrail()}onDestroy(){this.trailContainer.destroy(),this.mesh.destroy()}};M(yt,"TypeName","trail"),M(yt,"Properties",{material:{type:S.Material},segments:{type:S.Int,default:50},interval:{type:S.Float,default:.1},width:{type:S.Float,default:1},taper:{type:S.Bool,default:!0},resetThreshold:{type:S.Float,default:.5}});Math.clamp=function(t,e,n){return Math.max(e,Math.min(t,n))};var c_=function(){let t=new Float32Array(3),e=new Float32Array(3),n=new Float32Array(3),r=new Float32Array(3),s=new Float32Array(3),a=new Float32Array(3),l=new Float32Array(3),c=new Float32Array(4),h=new Float32Array(4),d=new Float32Array(4),i=new Float32Array(4);return function(o,_,m,u,g,f,w,v,x,T){y.sub(n,u,m);let A=y.length(n);y.sub(t,u,g);let j=y.length(t);y.sub(t,f,m);let I=Math.clamp(y.length(t),w,A+j-w);y.sub(e,g,m),y.sub(r,m,u),y.sub(s,g,u),y.normalize(e,e),y.normalize(n,n),y.normalize(r,r),y.normalize(s,s),y.normalize(t,t);let E=Math.acos(Math.clamp(y.dot(e,n),-1,1)),D=Math.acos(Math.clamp(y.dot(r,s),-1,1)),z=Math.acos(Math.clamp(y.dot(e,t),-1,1)),q=Math.acos(Math.clamp((j*j-A*A-I*I)/(-2*A*I),-1,1)),H=Math.acos(Math.clamp((I*I-A*A-j*j)/(-2*A*j),-1,1));y.sub(e,g,m),y.sub(n,u,m),y.sub(t,f,m),y.cross(a,e,n),y.cross(l,e,t),T?(y.sub(n,T,u),y.transformQuat(n,[0,0,-1],x)):y.sub(n,u,m);let k=y.length(a);k==0?a.set([1,0,0]):y.scale(a,a,1/k),y.normalize(l,l),C.conjugate(v,v),C.setAxisAngle(h,y.transformQuat(c,a,v),q-E),C.setAxisAngle(i,y.transformQuat(c,l,v),z),C.mul(o,o,C.mul(c,h,i)),C.normalize(o,o),C.conjugate(x,x),C.setAxisAngle(d,y.transformQuat(c,a,x),H-D),C.mul(_,_,d),C.normalize(_,_)}}(),bt=class extends R{init(){this.pos=new Float32Array(3*7),this.p=[this.pos.subarray(0,3),this.pos.subarray(3,6),this.pos.subarray(6,9),this.pos.subarray(9,12),this.pos.subarray(12,15),this.pos.subarray(15,18),this.pos.subarray(18,21)]}update(){let e=this.p;this.root.getTranslationWorld(e[0]),this.middle.getTranslationWorld(e[1]),this.end.getTranslationWorld(e[2]),this.target.getTranslationWorld(e[3]);let n=e[4],r=e[5];this.root.getTranslationLocal(n),this.middle.getTranslationLocal(r),this.helper&&this.helper.getTranslationWorld(e[6]),c_(this.root.transformLocal,this.middle.transformLocal,e[0],e[1],e[2],e[3],.01,this.root.transformWorld.subarray(0,4),this.middle.transformWorld.subarray(0,4),this.helper?e[6]:null),this.root.setTranslationLocal(n),this.middle.setTranslationLocal(r),this.root.setDirty(),this.middle.setDirty()}};M(bt,"TypeName","two-joint-ik-solver"),M(bt,"Properties",{root:{type:S.Object},middle:{type:S.Object},end:{type:S.Object},target:{type:S.Object},helper:{type:S.Object}});var Mt=class extends R{init(){if(!this.material)throw Error("video-texture: material property not set");this.loaded=!1,this.frameUpdateRequested=!0}start(){if(this.video=document.createElement("video"),this.video.src=this.url,this.video.crossOrigin="anonymous",this.video.playsInline=!0,this.video.loop=this.loop,this.video.muted=this.muted,this.video.addEventListener("playing",()=>{this.loaded=!0}),this.autoplay){let e=()=>{this.video.play(),window.removeEventListener("click",e),window.removeEventListener("touchstart",e)};window.addEventListener("click",e),window.addEventListener("touchstart",e)}}applyTexture(){let e=this.material,n=e.shader,r=this.texture=new Nt(this.engine,this.video);n==="Flat Opaque Textured"?e.flatTexture=r:n==="Phong Opaque Textured"||n==="Foliage"?e.diffuseTexture=r:n==="Background"?e.texture=r:n==="Physical Opaque Textured"?e.albedoTexture=r:console.error("Shader",n,"not supported by video-texture"),"requestVideoFrameCallback"in this.video?this.video.requestVideoFrameCallback(this.updateVideo.bind(this)):this.video.addEventListener("timeupdate",()=>{this.frameUpdateRequested=!0})}update(e){this.loaded&&this.frameUpdateRequested&&(this.texture?this.texture.update():this.applyTexture(),this.frameUpdateRequested=!1)}updateVideo(){this.frameUpdateRequested=!0,this.video.requestVideoFrameCallback(this.updateVideo.bind(this))}};M(Mt,"TypeName","video-texture"),M(Mt,"Properties",{url:{type:S.String},material:{type:S.Material},loop:{type:S.Bool,default:!0},autoplay:{type:S.Bool,default:!0},muted:{type:S.Bool,default:!0}});var At=class extends R{start(){this.components=[],this.getComponents(this.object),this.onXRSessionEnd(),this.engine.onXRSessionStart.push(this.onXRSessionStart.bind(this)),this.engine.onXRSessionEnd.push(this.onXRSessionEnd.bind(this))}getComponents(e){let n=e.getComponents().filter(r=>r.type!=="vr-mode-active-switch");if(this.components=this.components.concat(n),this.affectChildren){let r=e.children;for(let s=0;s<r.length;++s)this.getComponents(r[s])}}setComponentsActive(e){let n=this.components;for(let r=0;r<n.length;++r)n[r].active=e}onXRSessionStart(){this.active&&this.setComponentsActive(this.activateComponents==0)}onXRSessionEnd(){this.active&&this.setComponentsActive(this.activateComponents!=0)}};M(At,"TypeName","vr-mode-active-switch"),M(At,"Properties",{activateComponents:{type:S.Enum,values:["in VR","in non-VR"],default:"in VR"},affectChildren:{type:S.Bool,default:!0}});var __={X:[1,0,0],Y:[0,1,0],Z:[0,0,1]},h_={PositiveX:[1,0,0],NegativeX:[-1,0,0],PositiveY:[0,1,0],NegativeY:[0,-1,0],PositiveZ:[0,0,1],NegativeZ:[0,0,-1]},Tt=class extends R{meta=null;bones={hips:null,spine:null,chest:null,upperChest:null,neck:null,head:null,leftEye:null,rightEye:null,jaw:null,leftUpperLeg:null,leftLowerLeg:null,leftFoot:null,leftToes:null,rightUpperLeg:null,rightLowerLeg:null,rightFoot:null,rightToes:null,leftShoulder:null,leftUpperArm:null,leftLowerArm:null,leftHand:null,rightShoulder:null,rightUpperArm:null,rightLowerArm:null,rightHand:null,leftThumbMetacarpal:null,leftThumbProximal:null,leftThumbDistal:null,leftIndexProximal:null,leftIndexIntermediate:null,leftIndexDistal:null,leftMiddleProximal:null,leftMiddleIntermediate:null,leftMiddleDistal:null,leftRingProximal:null,leftRingIntermediate:null,leftRingDistal:null,leftLittleProximal:null,leftLittleIntermediate:null,leftLittleDistal:null,rightThumbMetacarpal:null,rightThumbProximal:null,rightThumbDistal:null,rightIndexProximal:null,rightIndexIntermediate:null,rightIndexDistal:null,rightMiddleProximal:null,rightMiddleIntermediate:null,rightMiddleDistal:null,rightRingProximal:null,rightRingIntermediate:null,rightRingDistal:null,rightLittleProximal:null,rightLittleIntermediate:null,rightLittleDistal:null};restPose={};_nodeConstraints=[];_springChains=[];_sphereColliders=[];_capsuleColliders=[];_firstPersonAnnotations=[];_lookAt=null;_initialized=!1;init(){this._tempV3=y.create(),this._tempV3A=y.create(),this._tempV3B=y.create(),this._tempQuat=C.create(),this._tempQuatA=C.create(),this._tempQuatB=C.create(),this._tempMat4A=ke.create(),this._tempQuat2=te.create(),this._tailToShape=y.create(),this._headToTail=y.create(),this._inertia=y.create(),this._stiffness=y.create(),this._external=y.create(),this._rightVector=y.set(y.create(),1,0,0),this._upVector=y.set(y.create(),0,1,0),this._forwardVector=y.set(y.create(),0,0,1),this._identityQuat=C.identity(C.create()),this._rad2deg=180/Math.PI}start(){if(!this.src){console.error("vrm: src property not set");return}this.engine.scene.append(this.src,{loadGltfExtensions:!0}).then(({root:e,extensions:n})=>{e.children.forEach(r=>r.parent=this.object),this._initializeVrm(n),e.destroy()})}_initializeVrm(e){if(this._initialized)throw Error("VRM component has already been initialized");let n=e.root.VRMC_vrm;if(!n)throw Error("Missing VRM extensions");if(n.specVersion!=="1.0")throw Error(`Unsupported VRM version, only 1.0 is supported, but encountered '${n.specVersion}'`);this.meta=n.meta,this._parseHumanoid(n.humanoid,e),n.firstPerson&&this._parseFirstPerson(n.firstPerson,e),n.lookAt&&this._parseLookAt(n.lookAt),this._findAndParseNodeConstraints(e);let r=e.root.VRMC_springBone;r&&this._parseAndInitializeSpringBones(r,e),this._initialized=!0}_parseHumanoid(e,n){for(let r in e.humanBones){if(!(r in this.bones)){console.warn(`Unrecognized bone '${r}'`);continue}let s=e.humanBones[r].node,a=n.idMapping[s];this.bones[r]=this.engine.wrapObject(a),this.restPose[r]=C.copy(C.create(),this.bones[r].rotationLocal)}}_parseFirstPerson(e,n){for(let r of e.meshAnnotations){let s={node:this.engine.wrapObject(n.idMapping[r.node]),firstPerson:!0,thirdPerson:!0};switch(r.type){case"firstPersonOnly":s.thirdPerson=!1;break;case"thirdPersonOnly":s.firstPerson=!1;break;case"both":break;case"auto":console.warn("First person mesh annotation type 'auto' is not supported, treating as 'both'!");break;default:console.error(`Invalid mesh annotation type '${r.type}'`);break}this._firstPersonAnnotations.push(s)}}_parseLookAt(e){if(e.type!=="bone"){console.warn(`Unsupported lookAt type '${e.type}', only 'bone' is supported`);return}let n=r=>({inputMaxValue:r.inputMaxValue,outputScale:r.outputScale});this._lookAt={offsetFromHeadBone:e.offsetFromHeadBone||[0,0,0],horizontalInner:n(e.rangeMapHorizontalInner),horizontalOuter:n(e.rangeMapHorizontalOuter),verticalDown:n(e.rangeMapVerticalDown),verticalUp:n(e.rangeMapVerticalUp)}}_findAndParseNodeConstraints(e){let n=r=>{let s=e.node[r.objectId];if(s&&"VRMC_node_constraint"in s){let l=s.VRMC_node_constraint.constraint,c,h;if("roll"in l?(c="roll",h=__[l.roll.rollAxis]):"aim"in l?(c="aim",h=h_[l.aim.aimAxis]):"rotation"in l&&(c="rotation"),c){let d=this.engine.wrapObject(e.idMapping[l[c].source]);this._nodeConstraints.push({type:c,source:d,destination:r,axis:h,weight:l[c].weight,destinationRestLocalRotation:C.copy(C.create(),r.rotationLocal),sourceRestLocalRotation:C.copy(C.create(),d.rotationLocal),sourceRestLocalRotationInv:C.invert(C.create(),d.rotationLocal)})}else console.warn("Unrecognized or invalid VRMC_node_constraint, ignoring it")}for(let a of r.children)n(a)};n(this.object)}_parseAndInitializeSpringBones(e,n){let r=(e.colliders||[]).map((a,l)=>{let c="capsule"in a.shape?"capsule":"sphere";return{id:l,object:this.engine.wrapObject(n.idMapping[a.node]),shape:{isCapsule:c==="capsule",radius:a.shape[c].radius,offset:a.shape[c].offset,tail:a.shape[c].tail},cache:{head:y.create(),tail:y.create()}}});this._sphereColliders=r.filter(a=>!a.shape.isCapsule),this._capsuleColliders=r.filter(a=>a.shape.isCapsule);let s=(e.colliderGroups||[]).map(a=>({name:a.name,colliders:a.colliders.map(l=>r[l])}));for(let a of e.springs){let l=[];for(let h of a.joints){let d={hitRadius:0,stiffness:1,gravityPower:0,gravityDir:[0,-1,0],dragForce:.5,node:null,state:null};Object.assign(d,h),d.node=this.engine.wrapObject(n.idMapping[d.node]),l.push(d)}let c=(a.colliderGroups||[]).flatMap(h=>s[h].colliders);this._springChains.push({name:a.name,center:a.center?this.engine.wrapObject(n.idMapping[a.center]):null,joints:l,sphereColliders:c.filter(h=>!h.shape.isCapsule),capsuleColliders:c.filter(h=>h.shape.isCapsule)})}for(let a of this._springChains)for(let l=0;l<a.joints.length-1;++l){let c=a.joints[l],h=a.joints[l+1],d=c.node.getTranslationWorld(y.create()),i=h.node.getTranslationWorld(y.create()),o=y.subtract(this._tempV3A,d,i),_={prevTail:i,currentTail:y.copy(y.create(),i),initialLocalRotation:C.copy(C.create(),c.node.rotationLocal),initialLocalTransformInvert:te.invert(te.create(),c.node.transformLocal),boneAxis:y.normalize(y.create(),h.node.getTranslationLocal(this._tempV3)),boneLength:Math.max(.01,y.length(o)),prevTailCenter:null,currentTailCenter:null};a.center&&(_.prevTailCenter=a.center.transformPointInverseWorld(y.create(),i),_.currentTailCenter=y.copy(y.create(),i)),c.state=_}}update(e){this._initialized&&(this._resolveLookAt(),this._resolveConstraints(),this._updateSpringBones(e))}_rangeMap(e,n){let r=e.inputMaxValue,s=e.outputScale;return Math.min(n,r)/r*s}_resolveLookAt(){if(!this._lookAt||!this.lookAtTarget)return;let e=this.bones.head.transformPointWorld(this._tempV3A,this._lookAt.offsetFromHeadBone),n=this.lookAtTarget.getTranslationWorld(this._tempV3B),r=y.sub(this._tempV3A,n,e);y.normalize(r,r),this.bones.head.parent.transformVectorInverseWorld(r);let s=y.dot(r,this._forwardVector),a=y.dot(r,this._rightVector),l=Math.atan2(a,s)*this._rad2deg,c=Math.sqrt(a*a+s*s),h=y.dot(r,this._upVector),d=Math.atan2(-h,c)*this._rad2deg;if(d>0?d=this._rangeMap(this._lookAt.verticalDown,d):d=-this._rangeMap(this._lookAt.verticalUp,-d),this.bones.leftEye){let i=l;i>0?i=this._rangeMap(this._lookAt.horizontalInner,i):i=-this._rangeMap(this._lookAt.horizontalOuter,-i);let o=C.fromEuler(this._tempQuatA,d,i,0);this.bones.leftEye.rotationLocal=C.multiply(o,this.restPose.leftEye,o)}if(this.bones.rightEye){let i=l;i>0?i=this._rangeMap(this._lookAt.horizontalOuter,i):i=-this._rangeMap(this._lookAt.horizontalInner,-i);let o=C.fromEuler(this._tempQuatA,d,i,0);this.bones.rightEye.rotationLocal=C.multiply(o,this.restPose.rightEye,o)}}_resolveConstraints(){for(let e of this._nodeConstraints)this._resolveConstraint(e)}_resolveConstraint(e){let n=e.destinationRestLocalRotation,r=e.sourceRestLocalRotationInv,s=C.identity(this._tempQuatA);switch(e.type){case"roll":{let a=C.multiply(this._tempQuatA,r,e.source.rotationLocal),l=C.multiply(this._tempQuatA,e.sourceRestLocalRotation,a);C.mul(l,l,r);let c=C.invert(this._tempQuatB,n),h=C.multiply(this._tempQuatB,c,l);C.multiply(h,h,n);let d=y.transformQuat(this._tempV3A,e.axis,h),i=C.rotationTo(this._tempQuatA,e.axis,d);C.mul(s,n,C.invert(this._tempQuat,i)),C.mul(s,s,h)}break;case"aim":{let a=e.destination.parent.rotationWorld,l=y.transformQuat(this._tempV3A,e.axis,n);y.transformQuat(l,l,a);let c=e.source.getTranslationWorld(this._tempV3B);y.sub(c,c,e.destination.getTranslationWorld(this._tempV3)),y.normalize(c,c);let h=C.rotationTo(this._tempQuatA,l,c);C.mul(s,C.invert(this._tempQuat,a),h),C.mul(s,s,a),C.mul(s,s,n)}break;case"rotation":{let a=C.mul(s,r,e.source.rotationLocal);C.mul(s,n,a)}break}C.slerp(s,n,s,e.weight),e.destination.rotationLocal=s}_updateSpringBones(e){this._sphereColliders.forEach(({object:n,shape:r,cache:s})=>{let a=y.copy(s.head,r.offset);n.transformVectorWorld(a),y.add(s.head,n.getTranslationWorld(this._tempV3),a)}),this._capsuleColliders.forEach(({object:n,shape:r,cache:s})=>{let a=n.getTranslationWorld(this._tempV3A),l=y.copy(s.head,r.offset);n.transformVectorWorld(l),y.add(s.head,a,l);let c=y.copy(s.tail,r.tail);n.transformVectorWorld(c),y.add(s.tail,a,c)}),this._springChains.forEach(n=>{for(let r=0;r<n.joints.length-1;++r){let s=n.joints[r],a=s.node.parent?s.node.parent.rotationWorld:this._identityQuat,l=this._inertia;n.center?(y.sub(l,s.state.currentTailCenter,s.state.prevTailCenter),n.center.transformVectorWorld(l)):y.sub(l,s.state.currentTail,s.state.prevTail),y.scale(l,l,1-s.dragForce);let c=y.copy(this._stiffness,s.state.boneAxis);y.transformQuat(c,c,s.state.initialLocalRotation),y.transformQuat(c,c,a),y.scale(c,c,e*s.stiffness);let h=y.scale(this._external,s.gravityDir,e*s.gravityPower),d=y.copy(this._tempV3A,s.state.currentTail);y.add(d,d,l),y.add(d,d,c),y.add(d,d,h);let i=s.node.getTranslationWorld(this._tempV3B);y.sub(d,d,i),y.normalize(d,d),y.scaleAndAdd(d,i,d,s.state.boneLength);for(let{shape:m,cache:u}of n.sphereColliders){let g=this._tailToShape,f=u.head;g=y.sub(g,d,f);let w=m.radius+s.hitRadius,v=y.length(g)-w;v<0&&(y.normalize(g,g),y.scaleAndAdd(d,d,g,-v),y.sub(d,d,i),y.normalize(d,d),y.scaleAndAdd(d,i,d,s.state.boneLength))}for(let{shape:m,cache:u}of n.capsuleColliders){let g=this._tailToShape,f=u.head,w=u.tail;g=y.sub(g,d,f);let v=y.sub(this._headToTail,w,f),x=y.dot(v,g);y.squaredLength(v)<=x?y.sub(g,d,w):x>0&&(y.scale(v,v,x/y.squaredLength(v)),y.sub(g,g,v));let T=m.radius+s.hitRadius,A=y.length(g)-T;A<0&&(y.normalize(g,g),y.scaleAndAdd(d,d,g,-A),y.sub(d,d,i),y.normalize(d,d),y.scaleAndAdd(d,i,d,s.state.boneLength))}y.copy(s.state.prevTail,s.state.currentTail),y.copy(s.state.currentTail,d),n.center&&(y.copy(s.state.prevTailCenter,s.state.currentTailCenter),y.copy(s.state.currentTailCenter,d),n.center.transformPointInverseWorld(s.state.currentTailCenter)),s.node.parent.transformPointInverseWorld(d);let o=te.fromTranslation(this._tempQuat2,d);te.multiply(o,s.state.initialLocalTransformInvert,o),te.getTranslation(d,o),y.normalize(d,d);let _=C.rotationTo(this._tempQuatA,s.state.boneAxis,d);s.node.rotationLocal=C.mul(this._tempQuatA,s.state.initialLocalRotation,_)}})}set firstPerson(e){this._firstPersonAnnotations.forEach(n=>{let r=e==n.firstPerson||e!=n.thirdPerson;n.node.getComponents("mesh").forEach(s=>{s.active=r})})}};M(Tt,"TypeName","vrm"),M(Tt,"Properties",{src:{type:S.String},lookAtTarget:{type:S.Object}});var jt=class extends R{init(){this.up=!1,this.right=!1,this.down=!1,this.left=!1,window.addEventListener("keydown",this.press.bind(this)),window.addEventListener("keyup",this.release.bind(this))}start(){this.headObject=this.headObject||this.object}update(){let e=[0,0,0];this.up&&(e[2]-=1),this.down&&(e[2]+=1),this.left&&(e[0]-=1),this.right&&(e[0]+=1),y.normalize(e,e),e[0]*=this.speed,e[2]*=this.speed,y.transformQuat(e,e,this.headObject.transformWorld),this.object.translate(e)}press(e){e.keyCode===38||e.keyCode===87||e.keyCode===90?this.up=!0:e.keyCode===39||e.keyCode===68?this.right=!0:e.keyCode===40||e.keyCode===83?this.down=!0:(e.keyCode===37||e.keyCode===65||e.keyCode===81)&&(this.left=!0)}release(e){e.keyCode===38||e.keyCode===87||e.keyCode===90?this.up=!1:e.keyCode===39||e.keyCode===68?this.right=!1:e.keyCode===40||e.keyCode===83?this.down=!1:(e.keyCode===37||e.keyCode===65||e.keyCode===81)&&(this.left=!1)}};M(jt,"TypeName","wasd-controls"),M(jt,"Properties",{speed:{type:S.Float,default:.1},headObject:{type:S.Object}});WL.registerComponent("expose-banners",{banner1Object:{type:WL.Type.Object},banner2Object:{type:WL.Type.Object},banner3Object:{type:WL.Type.Object},banner4Object:{type:WL.Type.Object},banner5Object:{type:WL.Type.Object},banner6Object:{type:WL.Type.Object},banner7Object:{type:WL.Type.Object},banner8Object:{type:WL.Type.Object},banner9Object:{type:WL.Type.Object}},{start:function(){this.banner1=this.banner1Object.getComponent("zesty-banner"),this.banner2=this.banner2Object.getComponent("zesty-banner"),this.banner3=this.banner3Object.getComponent("zesty-banner"),this.banner4=this.banner4Object.getComponent("zesty-banner"),this.banner5=this.banner5Object.getComponent("zesty-banner"),this.banner6=this.banner6Object.getComponent("zesty-banner"),this.banner7=this.banner7Object.getComponent("zesty-banner"),this.banner8=this.banner8Object.getComponent("zesty-banner"),this.banner9=this.banner9Object.getComponent("zesty-banner"),window.testBanners=[this.banner1,this.banner2,this.banner3,this.banner4,this.banner5,this.banner6,this.banner7,this.banner8,this.banner9]}});var Rt=tt(Br(),1);var Ee="https://zesty-storage-prod.s3.amazonaws.com/images/zesty",Zt={tall:{width:.75,height:1,style:{standard:`${Ee}/zesty-banner-tall.png`,minimal:`${Ee}/zesty-banner-tall-minimal.png`,transparent:`${Ee}/zesty-banner-tall-transparent.png`}},wide:{width:4,height:1,style:{standard:`${Ee}/zesty-banner-wide.png`,minimal:`${Ee}/zesty-banner-wide-minimal.png`,transparent:`${Ee}/zesty-banner-wide-transparent.png`}},square:{width:1,height:1,style:{standard:`${Ee}/zesty-banner-square.png`,minimal:`${Ee}/zesty-banner-square-minimal.png`,transparent:`${Ee}/zesty-banner-square-transparent.png`}}};var mh=tt(Br(),1);var Wr=()=>{let t=window.XRHand!=null&&window.XRMediaBinding!=null,e=navigator.userAgent.includes("OculusBrowser"),n=t&&e?"Full":t||e?"Partial":"None";return{match:n!=="None",confidence:n}},Xr=()=>{let t=window.mozInnerScreenX!=null&&window.speechSynthesis==null,e=navigator.userAgent.includes("Mobile VR")&&!navigator.userAgent.includes("OculusBrowser"),n=t&&e?"Full":t||e?"Partial":"None";return{match:n!=="None",confidence:n}},ua=async()=>{let t=navigator.xr&&await navigator.xr.isSessionSupported("immersive-vr")&&await navigator.xr.isSessionSupported("immersive-ar"),e=navigator.userAgent.includes("Pico Neo 3 Link"),n=t&&e?"Full":t||e?"Partial":"None";return{match:n!=="None",confidence:n}},ga=()=>{let t=navigator.maxTouchPoints===0||navigator.msMaxTouchPoints===0,e=!navigator.userAgent.includes("Android")&&!navigator.userAgent.includes("Mobile"),n=t&&e?"Full":t||e?"Partial":"None";return{match:n!=="None",confidence:n}},Yr=async()=>{let t={platform:"",confidence:""};return Wr().match?t={platform:"Oculus",confidence:Wr().confidence}:Xr().match?t={platform:"Wolvic",confidence:Xr().confidence}:await ua().match?t={platform:"Pico",confidence:await ua().confidence}:ga().match?t={platform:"Desktop",confidence:ga().confidence}:t={platform:"Unknown",confidence:"None"},t},wa=t=>{if(t){if(Wr().match){if(t.includes("https://www.oculus.com/experiences/quest/")){setTimeout(()=>{window.open(t,"_blank")},1e3);return}}else if(Xr().match){let e=document.createElement("div"),n=document.createElement("div"),r=document.createElement("p"),s=document.createElement("button"),a=document.createElement("button");e.style.backgroundColor="rgb(0, 0, 0, 0.75)",e.style.color="white",e.style.textAlign="center",e.style.position="fixed",e.style.top="50%",e.style.left="50%",e.style.padding="5%",e.style.borderRadius="5%",e.style.transform="translate(-50%, -50%)",r.innerHTML=`<b>This billboard leads to ${t}. Continue?</b>`,s.innerText="Move cursor back into window.",s.style.width="100vw",s.style.height="100vh",s.onmouseenter=()=>{s.style.width="auto",s.style.height="auto",s.innerText="Yes"},s.onclick=()=>{window.open(t,"_blank"),e.remove()},a.innerText="No",a.onclick=()=>{e.remove()},e.append(n),n.append(r),n.append(s),n.append(a),document.body.append(e);return}window.open(t,"_blank")}};var va="https://beacon.zesty.market",xa="https://beacon2.zesty.market/zgraphql",fh="https://api.zesty.market/api";var ya=async(t,e="tall",n="standard")=>{try{let r=encodeURI(window.top.location.href).replace(/\/$/,"");return(await Rt.default.get(`${fh}/ad?ad_unit_id=${t}&url=${r}`)).data}catch{return console.warn("No active campaign banner could be located. Displaying default banner."),{Ads:[{asset_url:Zt[e].style[n],cta_url:"https://www.zesty.market"}],CampaignId:"TestCampaign"}}},ba=async(t,e=null)=>{let{platform:n,confidence:r}=await Yr();try{let s=va+`/api/v1/space/${t}`;await Rt.default.put(s),await Rt.default.post(xa,{query:`mutation { increment(eventType: visits, spaceId: "${t}", campaignId: "${e}", platform: { name: ${n}, confidence: ${r} }) { message } }`},{headers:{"Content-Type":"application/json"}})}catch(s){console.log("Failed to emit onload event",s.message)}},Ma=async(t,e=null)=>{let{platform:n,confidence:r}=await Yr();try{let s=va+`/api/v1/space/click/${t}`;await Rt.default.put(s),await Rt.default.post(xa,{query:`mutation { increment(eventType: clicks, spaceId: "${t}", campaignId: "${e}", platform: { name: ${n}, confidence: ${r} }) { message } }`},{headers:{"Content-Type":"application/json"}})}catch(s){console.log("Failed to emit onclick event",s.message)}};var Aa="2.0.1";var P;(function(t){t[t.Native=1]="Native",t[t.Bool=2]="Bool",t[t.Int=4]="Int",t[t.Float=8]="Float",t[t.String=16]="String",t[t.Enum=32]="Enum",t[t.Object=64]="Object",t[t.Mesh=128]="Mesh",t[t.Texture=256]="Texture",t[t.Material=512]="Material",t[t.Animation=1024]="Animation",t[t.Skin=2048]="Skin",t[t.Color=4096]="Color"})(P||(P={}));var oe={bool(t=!1){return{type:P.Bool,default:t}},int(t=0){return{type:P.Int,default:t}},float(t=0){return{type:P.Float,default:t}},string(t=""){return{type:P.String,default:t}},enum(t,e){return{type:P.Enum,values:t,default:e}},object(){return{type:P.Object,default:null}},mesh(){return{type:P.Mesh,default:null}},texture(){return{type:P.Texture,default:null}},material(){return{type:P.Material,default:null}},animation(){return{type:P.Animation,default:null}},skin(){return{type:P.Skin,default:null}},color(t=0,e=0,n=0,r=1){return{type:P.Color,default:[t,e,n,r]}}};function Ta(t){return function(e,n){let r=e.constructor;r.Properties=r.Properties??{},r.Properties[n]=t}}function Ct(){return function(t,e,n){n.enumerable=!0}}function W(){return function(t,e,n){Ct()(t,e,n),Ta({type:P.Native})(t,e)}}var ve={};for(let t in oe)ve[t]=(...e)=>{let n=oe[t];return Ta(n(...e))};function Fn(t){return t===""?!0:t&&(typeof t=="string"||t.constructor===String)}function ja(t){return t==null?!1:typeof t=="number"||t.constructor===Number}var xe=class{_listeners=[];_event=void 0;_autoResolve;constructor(e=!1){this._autoResolve=e}add(e,n={}){let{once:r=!1,id:s=void 0}=n;return this._event!==void 0&&(e(...this._event),r)?this:(this._listeners.push({id:s,once:r,callback:e}),this)}push(...e){for(let n of e)this.add(n);return this}once(e){return this.add(e,{once:!0})}remove(e){let n=this._find(e);return n!==null&&this._listeners.splice(n,1),this}has(e){return this._find(e)!==null}notify(...e){let n=this._listeners;this._autoResolve&&(this._event=e);for(let r=0;r<n.length;++r){let s=n[r];s.once&&n.splice(r--,1);try{s.callback(...e)}catch(a){console.error(a)}}}notifyUnsafe(...e){let n=this._listeners;this._autoResolve&&(this._event=e);for(let r=0;r<n.length;++r){let s=n[r];s.once&&n.splice(r--,1),s.callback(...e)}}promise(){return new Promise((e,n)=>{this.once((...r)=>{r.length>1?e(r):e(r[0])})})}_find(e){let n=this._listeners;if(Fn(e)){for(let r=0;r<n.length;++r)if(n[r].id===e)return r;return null}for(let r=0;r<n.length;++r)if(n[r].callback===e)return r;return null}};var N=function(t,e,n,r){var s=arguments.length,a=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(l=t[c])&&(a=(s<3?l(a):s>3?l(e,n,a):l(e,n))||a);return s>3&&a&&Object.defineProperty(e,n,a),a},In;(function(t){t[t.Sphere=0]="Sphere",t[t.AxisAlignedBox=1]="AxisAlignedBox",t[t.Box=2]="Box"})(In||(In={}));var Sa;(function(t){t[t.Left=0]="Left",t[t.Center=1]="Center",t[t.Right=2]="Right"})(Sa||(Sa={}));var Pa;(function(t){t[t.Line=0]="Line",t[t.Middle=1]="Middle",t[t.Top=2]="Top",t[t.Bottom=3]="Bottom"})(Pa||(Pa={}));var Ea;(function(t){t[t.None=0]="None",t[t.Outline=1]="Outline"})(Ea||(Ea={}));var ze;(function(t){t[t.Head=0]="Head",t[t.EyeLeft=1]="EyeLeft",t[t.EyeRight=2]="EyeRight",t[t.ControllerLeft=3]="ControllerLeft",t[t.ControllerRight=4]="ControllerRight",t[t.RayLeft=5]="RayLeft",t[t.RayRight=6]="RayRight"})(ze||(ze={}));var Fa;(function(t){t[t.Point=0]="Point",t[t.Spot=1]="Spot",t[t.Sun=2]="Sun"})(Fa||(Fa={}));var Ia;(function(t){t[t.Playing=0]="Playing",t[t.Paused=1]="Paused",t[t.Stopped=2]="Stopped"})(Ia||(Ia={}));var Rn;(function(t){t[t.Force=0]="Force",t[t.Impulse=1]="Impulse",t[t.VelocityChange=2]="VelocityChange",t[t.Acceleration=3]="Acceleration"})(Rn||(Rn={}));var Ra;(function(t){t[t.Touch=0]="Touch",t[t.TouchLost=1]="TouchLost",t[t.TriggerTouch=2]="TriggerTouch",t[t.TriggerTouchLost=3]="TriggerTouchLost"})(Ra||(Ra={}));var Cn;(function(t){t[t.None=0]="None",t[t.Sphere=1]="Sphere",t[t.Capsule=2]="Capsule",t[t.Box=3]="Box",t[t.Plane=4]="Plane",t[t.ConvexMesh=5]="ConvexMesh",t[t.TriangleMesh=6]="TriangleMesh"})(Cn||(Cn={}));var Je;(function(t){t[t.Position=0]="Position",t[t.Tangent=1]="Tangent",t[t.Normal=2]="Normal",t[t.TextureCoordinate=3]="TextureCoordinate",t[t.Color=4]="Color",t[t.JointId=5]="JointId",t[t.JointWeight=6]="JointWeight"})(Je||(Je={}));var ye;(function(t){t[t.UnsignedInt=0]="UnsignedInt",t[t.Int=1]="Int",t[t.Float=2]="Float",t[t.Sampler=3]="Sampler",t[t.Font=4]="Font"})(ye||(ye={}));function Ca(t){return t===Cn.ConvexMesh||t===Cn.TriangleMesh}var O=class{_manager;_id;_object;_engine;constructor(e,n=-1,r=-1){this._engine=e,this._manager=n,this._id=r,this._object=null}get engine(){return this._engine}get type(){return this.constructor.TypeName??this._engine.wasm._typeNameFor(this._manager)}get object(){if(!this._object){let e=this._engine.wasm._wl_component_get_object(this._manager,this._id);this._object=this._engine.wrapObject(e)}return this._object}set active(e){this._engine.wasm._wl_component_setActive(this._manager,this._id,e)}get active(){return this._engine.wasm._wl_component_isActive(this._manager,this._id)!=0}destroy(){this._engine.wasm._wl_component_remove(this._manager,this._id),this._manager=-1,this._id=-1}equals(e){return e?this._manager==e._manager&&this._id==e._id:!1}};M(O,"TypeName"),M(O,"Properties"),M(O,"Dependencies");var Qr=class extends O{get collider(){return this._engine.wasm._wl_collision_component_get_collider(this._id)}set collider(e){this._engine.wasm._wl_collision_component_set_collider(this._id,e)}get extents(){let e=this._engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_collision_component_get_extents(this._id),3)}set extents(e){this.extents.set(e)}get group(){return this._engine.wasm._wl_collision_component_get_group(this._id)}set group(e){this._engine.wasm._wl_collision_component_set_group(this._id,e)}queryOverlaps(){let e=this._engine.wasm._wl_collision_component_query_overlaps(this._id,this._engine.wasm._tempMem,this._engine.wasm._tempMemSize>>1),n=new Array(e);for(let r=0;r<e;++r)n[r]=new Qr(this._engine,this._manager,this._engine.wasm._tempMemUint16[r]);return n}},Te=Qr;M(Te,"TypeName","collision");N([W()],Te.prototype,"collider",null);N([W()],Te.prototype,"extents",null);N([W()],Te.prototype,"group",null);var Me=class extends O{get alignment(){return this._engine.wasm._wl_text_component_get_horizontal_alignment(this._id)}set alignment(e){this._engine.wasm._wl_text_component_set_horizontal_alignment(this._id,e)}get justification(){return this._engine.wasm._wl_text_component_get_vertical_alignment(this._id)}set justification(e){this._engine.wasm._wl_text_component_set_vertical_alignment(this._id,e)}get characterSpacing(){return this._engine.wasm._wl_text_component_get_character_spacing(this._id)}set characterSpacing(e){this._engine.wasm._wl_text_component_set_character_spacing(this._id,e)}get lineSpacing(){return this._engine.wasm._wl_text_component_get_line_spacing(this._id)}set lineSpacing(e){this._engine.wasm._wl_text_component_set_line_spacing(this._id,e)}get effect(){return this._engine.wasm._wl_text_component_get_effect(this._id)}set effect(e){this._engine.wasm._wl_text_component_set_effect(this._id,e)}get text(){let e=this._engine.wasm,n=e._wl_text_component_get_text(this._id);return e.UTF8ToString(n)}set text(e){let n=this._engine.wasm;n._wl_text_component_set_text(this._id,n.tempUTF8(e))}set material(e){let n=e?e._index:0;this._engine.wasm._wl_text_component_set_material(this._id,n)}get material(){let e=this._engine.wasm._wl_text_component_get_material(this._id);return e>0?new Ue(this._engine,e):null}};M(Me,"TypeName","text");N([W()],Me.prototype,"alignment",null);N([W()],Me.prototype,"justification",null);N([W()],Me.prototype,"characterSpacing",null);N([W()],Me.prototype,"lineSpacing",null);N([W()],Me.prototype,"effect",null);N([W()],Me.prototype,"text",null);N([W()],Me.prototype,"material",null);var je=class extends O{get projectionMatrix(){let e=this._engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_view_component_get_projection_matrix(this._id),16)}get near(){return this._engine.wasm._wl_view_component_get_near(this._id)}set near(e){this._engine.wasm._wl_view_component_set_near(this._id,e)}get far(){return this._engine.wasm._wl_view_component_get_far(this._id)}set far(e){this._engine.wasm._wl_view_component_set_far(this._id,e)}get fov(){return this._engine.wasm._wl_view_component_get_fov(this._id)}set fov(e){this._engine.wasm._wl_view_component_set_fov(this._id,e)}};M(je,"TypeName","view");N([Ct()],je.prototype,"projectionMatrix",null);N([W()],je.prototype,"near",null);N([W()],je.prototype,"far",null);N([W()],je.prototype,"fov",null);var Ze=class extends O{get inputType(){return this._engine.wasm._wl_input_component_get_type(this._id)}set inputType(e){this._engine.wasm._wl_input_component_set_type(this._id,e)}get xrInputSource(){let e=this._engine.xrSession;if(e){for(let n of e.inputSources)if(n.handedness==this.handedness)return n}return null}get handedness(){let e=this.inputType;return e==ze.ControllerRight||e==ze.RayRight||e==ze.EyeRight?"right":e==ze.ControllerLeft||e==ze.RayLeft||e==ze.EyeLeft?"left":null}};M(Ze,"TypeName","input");N([W()],Ze.prototype,"inputType",null);N([Ct()],Ze.prototype,"xrInputSource",null);N([Ct()],Ze.prototype,"handedness",null);var Lt=class extends O{get color(){let e=this._engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_light_component_get_color(this._id),4)}set color(e){this.color.set(e)}get lightType(){return this._engine.wasm._wl_light_component_get_type(this._id)}set lightType(e){this._engine.wasm._wl_light_component_set_type(this._id,e)}};M(Lt,"TypeName","light");N([W()],Lt.prototype,"color",null);N([W()],Lt.prototype,"lightType",null);var He=class extends O{set animation(e){this._engine.wasm._wl_animation_component_set_animation(this._id,e?e._index:0)}get animation(){let e=this._engine.wasm._wl_animation_component_get_animation(this._id);return e>0?new Ke(this._engine,e):null}set playCount(e){this._engine.wasm._wl_animation_component_set_playCount(this._id,e)}get playCount(){return this._engine.wasm._wl_animation_component_get_playCount(this._id)}set speed(e){this._engine.wasm._wl_animation_component_set_speed(this._id,e)}get speed(){return this._engine.wasm._wl_animation_component_get_speed(this._id)}get state(){return this._engine.wasm._wl_animation_component_state(this._id)}play(){this._engine.wasm._wl_animation_component_play(this._id)}stop(){this._engine.wasm._wl_animation_component_stop(this._id)}pause(){this._engine.wasm._wl_animation_component_pause(this._id)}};M(He,"TypeName","animation");N([W()],He.prototype,"animation",null);N([W()],He.prototype,"playCount",null);N([W()],He.prototype,"speed",null);N([Ct()],He.prototype,"state",null);var Fe=class extends O{set material(e){this._engine.wasm._wl_mesh_component_set_material(this._id,e?e._index:0)}get material(){let e=this._engine.wasm._wl_mesh_component_get_material(this._id);return e>0?new Ue(this._engine,e):null}get mesh(){let e=this._engine.wasm._wl_mesh_component_get_mesh(this._id);return e>0?new kt(this._engine,e):null}set mesh(e){this._engine.wasm._wl_mesh_component_set_mesh(this._id,e?e._index:0)}get skin(){let e=this._engine.wasm._wl_mesh_component_get_skin(this._id);return e>0?new Kt(this._engine,e):null}set skin(e){this._engine.wasm._wl_mesh_component_set_skin(this._id,e?e._index:0)}};M(Fe,"TypeName","mesh");N([W()],Fe.prototype,"material",null);N([W()],Fe.prototype,"mesh",null);N([W()],Fe.prototype,"skin",null);var Oa;(function(t){t[t.None=0]="None",t[t.X=1]="X",t[t.Y=2]="Y",t[t.Z=4]="Z"})(Oa||(Oa={}));var Z=class extends O{set static(e){this._engine.wasm._wl_physx_component_set_static(this._id,e)}get static(){return!!this._engine.wasm._wl_physx_component_get_static(this._id)}set kinematic(e){this._engine.wasm._wl_physx_component_set_kinematic(this._id,e)}get kinematic(){return!!this._engine.wasm._wl_physx_component_get_kinematic(this._id)}set gravity(e){this._engine.wasm._wl_physx_component_set_gravity(this._id,e)}get gravity(){return!!this._engine.wasm._wl_physx_component_get_gravity(this._id)}set simulate(e){this._engine.wasm._wl_physx_component_set_simulate(this._id,e)}get simulate(){return!!this._engine.wasm._wl_physx_component_get_simulate(this._id)}set allowSimulation(e){this._engine.wasm._wl_physx_component_set_allowSimulation(this._id,e)}get allowSimulation(){return!!this._engine.wasm._wl_physx_component_get_allowSimulation(this._id)}set allowQuery(e){this._engine.wasm._wl_physx_component_set_allowQuery(this._id,e)}get allowQuery(){return!!this._engine.wasm._wl_physx_component_get_allowQuery(this._id)}set trigger(e){this._engine.wasm._wl_physx_component_set_trigger(this._id,e)}get trigger(){return!!this._engine.wasm._wl_physx_component_get_trigger(this._id)}set shape(e){this._engine.wasm._wl_physx_component_set_shape(this._id,e)}get shape(){return this._engine.wasm._wl_physx_component_get_shape(this._id)}set shapeData(e){e==null||!Ca(this.shape)||this._engine.wasm._wl_physx_component_set_shape_data(this._id,e.index)}get shapeData(){return Ca(this.shape)?{index:this._engine.wasm._wl_physx_component_get_shape_data(this._id)}:null}set extents(e){this.extents.set(e)}get extents(){let e=this._engine.wasm,n=e._wl_physx_component_get_extents(this._id);return new Float32Array(e.HEAPF32.buffer,n,3)}get staticFriction(){return this._engine.wasm._wl_physx_component_get_staticFriction(this._id)}set staticFriction(e){this._engine.wasm._wl_physx_component_set_staticFriction(this._id,e)}get dynamicFriction(){return this._engine.wasm._wl_physx_component_get_dynamicFriction(this._id)}set dynamicFriction(e){this._engine.wasm._wl_physx_component_set_dynamicFriction(this._id,e)}get bounciness(){return this._engine.wasm._wl_physx_component_get_bounciness(this._id)}set bounciness(e){this._engine.wasm._wl_physx_component_set_bounciness(this._id,e)}get linearDamping(){return this._engine.wasm._wl_physx_component_get_linearDamping(this._id)}set linearDamping(e){this._engine.wasm._wl_physx_component_set_linearDamping(this._id,e)}get angularDamping(){return this._engine.wasm._wl_physx_component_get_angularDamping(this._id)}set angularDamping(e){this._engine.wasm._wl_physx_component_set_angularDamping(this._id,e)}set linearVelocity(e){this._engine.wasm._wl_physx_component_set_linearVelocity(this._id,e[0],e[1],e[2])}get linearVelocity(){let e=this._engine.wasm;return e._wl_physx_component_get_linearVelocity(this._id,e._tempMem),new Float32Array(e.HEAPF32.buffer,e._tempMem,3)}set angularVelocity(e){this._engine.wasm._wl_physx_component_set_angularVelocity(this._id,e[0],e[1],e[2])}get angularVelocity(){let e=this._engine.wasm;return e._wl_physx_component_get_angularVelocity(this._id,e._tempMem),new Float32Array(e.HEAPF32.buffer,e._tempMem,3)}set groupsMask(e){this._engine.wasm._wl_physx_component_set_groupsMask(this._id,e)}get groupsMask(){return this._engine.wasm._wl_physx_component_get_groupsMask(this._id)}set blocksMask(e){this._engine.wasm._wl_physx_component_set_blocksMask(this._id,e)}get blocksMask(){return this._engine.wasm._wl_physx_component_get_blocksMask(this._id)}set linearLockAxis(e){this._engine.wasm._wl_physx_component_set_linearLockAxis(this._id,e)}get linearLockAxis(){return this._engine.wasm._wl_physx_component_get_linearLockAxis(this._id)}set angularLockAxis(e){this._engine.wasm._wl_physx_component_set_angularLockAxis(this._id,e)}get angularLockAxis(){return this._engine.wasm._wl_physx_component_get_angularLockAxis(this._id)}set mass(e){this._engine.wasm._wl_physx_component_set_mass(this._id,e)}get mass(){return this._engine.wasm._wl_physx_component_get_mass(this._id)}set massSpaceInteriaTensor(e){this._engine.wasm._wl_physx_component_set_massSpaceInertiaTensor(this._id,e[0],e[1],e[2])}addForce(e,n=Rn.Force,r=!1,s,a=!1){let l=this._engine.wasm;if(!s){l._wl_physx_component_addForce(this._id,e[0],e[1],e[2],n,r);return}l._wl_physx_component_addForceAt(this._id,e[0],e[1],e[2],n,r,s[0],s[1],s[2],a)}addTorque(e,n=Rn.Force){this._engine.wasm._wl_physx_component_addTorque(this._id,e[0],e[1],e[2],n)}onCollision(e){return this.onCollisionWith(this,e)}onCollisionWith(e,n){let r=this._engine.physics;return r._callbacks[this._id]=r._callbacks[this._id]||[],r._callbacks[this._id].push(n),this._engine.wasm._wl_physx_component_addCallback(this._id,e._id||this._id)}removeCollisionCallback(e){let n=this._engine.physics,r=this._engine.wasm._wl_physx_component_removeCallback(this._id,e);r&&n._callbacks[this._id].splice(-r)}};M(Z,"TypeName","physx");N([W()],Z.prototype,"static",null);N([W()],Z.prototype,"kinematic",null);N([W()],Z.prototype,"gravity",null);N([W()],Z.prototype,"simulate",null);N([W()],Z.prototype,"allowSimulation",null);N([W()],Z.prototype,"allowQuery",null);N([W()],Z.prototype,"trigger",null);N([W()],Z.prototype,"shape",null);N([W()],Z.prototype,"shapeData",null);N([W()],Z.prototype,"extents",null);N([W()],Z.prototype,"staticFriction",null);N([W()],Z.prototype,"dynamicFriction",null);N([W()],Z.prototype,"bounciness",null);N([W()],Z.prototype,"linearDamping",null);N([W()],Z.prototype,"angularDamping",null);N([W()],Z.prototype,"linearVelocity",null);N([W()],Z.prototype,"angularVelocity",null);N([W()],Z.prototype,"groupsMask",null);N([W()],Z.prototype,"blocksMask",null);N([W()],Z.prototype,"linearLockAxis",null);N([W()],Z.prototype,"angularLockAxis",null);N([W()],Z.prototype,"mass",null);var be;(function(t){t[t.UnsignedByte=1]="UnsignedByte",t[t.UnsignedShort=2]="UnsignedShort",t[t.UnsignedInt=4]="UnsignedInt"})(be||(be={}));var kt=class{_index=-1;_engine;constructor(e,n){if(this._engine=e??WL,this._index=-1,ja(n)){this._index=n;return}if(!n.vertexCount)throw new Error("Missing parameter 'vertexCount'");let r=this._engine.wasm,s=0,a=0,l=0;if(n.indexData)switch(a=n.indexType||be.UnsignedShort,l=n.indexData.length*a,s=r._malloc(l),a){case be.UnsignedByte:r.HEAPU8.set(n.indexData,s);break;case be.UnsignedShort:r.HEAPU16.set(n.indexData,s>>1);break;case be.UnsignedInt:r.HEAPU32.set(n.indexData,s>>2);break}let{skinned:c=!1}=n;this._index=r._wl_mesh_create(s,l,a,n.vertexCount,c)}get vertexCount(){return this._engine.wasm._wl_mesh_get_vertexCount(this._index)}get indexData(){let e=this._engine.wasm,n=e._tempMem,r=e._wl_mesh_get_indexData(this._index,n,n+4);if(r===null)return null;let s=e.HEAPU32[n/4];switch(e.HEAPU32[n/4+1]){case be.UnsignedByte:return new Uint8Array(e.HEAPU8.buffer,r,s);case be.UnsignedShort:return new Uint16Array(e.HEAPU16.buffer,r,s);case be.UnsignedInt:return new Uint32Array(e.HEAPU32.buffer,r,s)}return null}get engine(){return this._engine}update(){this._engine.wasm._wl_mesh_update(this._index)}getBoundingSphere(e=new Float32Array(4)){let n=this._engine.wasm._tempMemFloat;return this._engine.wasm._wl_mesh_get_boundingSphere(this._index,this._engine.wasm._tempMem),e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e}attribute(e){if(typeof e!="number")throw new TypeError("Expected number, but got "+typeof e);let n=this._engine.wasm._tempMemUint32;if(this._engine.wasm._wl_mesh_get_attribute(this._index,e,this._engine.wasm._tempMem),n[0]==255)return null;let r=n[5];return new Gr(this._engine,{attribute:n[0],offset:n[1],stride:n[2],formatSize:n[3],componentCount:n[4],arraySize:r||1,length:this.vertexCount,bufferType:e!==Je.JointId?Float32Array:Uint16Array})}destroy(){this._engine.wasm._wl_mesh_destroy(this._index)}equals(e){return e?this._index===e._index:!1}},Gr=class{length=0;_engine;_attribute=-1;_offset=0;_stride=0;_formatSize=0;_componentCount=0;_arraySize=1;_bufferType;_tempBufferGetter;constructor(e,n){this._engine=e;let r=this._engine.wasm;this._attribute=n.attribute,this._offset=n.offset,this._stride=n.stride,this._formatSize=n.formatSize,this._componentCount=n.componentCount,this._arraySize=n.arraySize,this._bufferType=n.bufferType,this.length=n.length,this._tempBufferGetter=this._bufferType===Float32Array?r.getTempBufferF32.bind(r):r.getTempBufferU16.bind(r)}createArray(e=1){return e=e>this.length?this.length:e,new this._bufferType(e*this._componentCount*this._arraySize)}get(e,n=this.createArray()){if(n.length%this._componentCount!==0)throw new Error(`out.length, ${n.length} is not a multiple of the attribute vector components, ${this._componentCount}`);let r=this._tempBufferGetter(n.length),s=this._bufferType.BYTES_PER_ELEMENT,a=s*n.length,l=this._formatSize*this._arraySize,c=this._componentCount*s*this._arraySize;this._engine.wasm._wl_mesh_get_attribute_values(this._attribute,l,this._offset+e*this._stride,this._stride,c,r.byteOffset,a);for(let h=0;h<n.length;++h)n[h]=r[h];return n}set(e,n){if(n.length%this._componentCount!==0)throw new Error(`out.length, ${n.length} is not a multiple of the attribute vector components, ${this._componentCount}`);let r=this._bufferType.BYTES_PER_ELEMENT,s=r*n.length,a=this._componentCount*r*this._arraySize,l=this._formatSize*this._arraySize,c=this._engine.wasm;if(n.buffer!=c.HEAPU8.buffer){let h=this._tempBufferGetter(n.length);h.set(n),n=h}return c._wl_mesh_set_attribute_values(this._attribute,a,n.byteOffset,s,l,this._offset+e*this._stride,this._stride),this}},Ue=class{_index;_definition;_engine;constructor(e,n){if(this._engine=e,typeof n!="number"){if(!n?.pipeline)throw new Error("Missing parameter 'pipeline'");let r=this._engine.wasm,s=n.pipeline;if(this._index=r._wl_material_create(r.tempUTF8(s)),this._index<0)throw new Error(`No such pipeline '${s}'`)}else this._index=n;if(this._definition=this._engine.wasm._wl_material_get_definition(this._index),!this._engine.wasm._materialDefinitions[this._definition])throw new Error(`Material Definition ${this._definition} not found for material with index ${this._index}`);return new Proxy(this,{get(r,s){let a=e.wasm,c=a._materialDefinitions[r._definition].get(s);if(!c)return r[s];if(a._wl_material_get_param_value(r._index,c.index,a._tempMem)){let h=c.type;switch(h.type){case ye.UnsignedInt:return h.componentCount==1?a._tempMemUint32[0]:new Uint32Array(a.HEAPU32.buffer,a._tempMem,h.componentCount);case ye.Int:return h.componentCount==1?a._tempMemInt[0]:new Int32Array(a.HEAP32.buffer,a._tempMem,h.componentCount);case ye.Float:return h.componentCount==1?a._tempMemFloat[0]:new Float32Array(a.HEAPF32.buffer,a._tempMem,h.componentCount);case ye.Sampler:return e.textures.wrap(a._tempMemInt[0]);default:throw new Error(`Invalid type ${h} on parameter ${c.index} for material ${r._index}`)}}},set(r,s,a){let l=e.wasm,h=l._materialDefinitions[r._definition].get(s);if(!h)return r[s]=a,!0;switch(h.type.type){case ye.UnsignedInt:case ye.Int:case ye.Sampler:let i=a.id??a;l._wl_material_set_param_value_uint(r._index,h.index,i);break;case ye.Float:let o=1;if(typeof a=="number")l._tempMemFloat[0]=a;else{o=a.length;for(let _=0;_<o;++_)l._tempMemFloat[_]=a[_]}l._wl_material_set_param_value_float(r._index,h.index,l._tempMem,o);break;case ye.Font:throw new Error("Setting font properties is currently unsupported.")}return!0}})}get shader(){return this.pipeline}get pipeline(){let e=this._engine.wasm;return e.UTF8ToString(e._wl_material_get_pipeline(this._index))}get engine(){return this._engine}clone(){let e=this._engine.wasm._wl_material_clone(this._index);return e>0?new Ue(this._engine,e):null}equals(e){return e?this._index===e._index:!1}static wrap(e,n){return n>0?new Ue(e,n):null}},Ot=null,Jt=class{_engine;_id=0;_imageIndex=null;constructor(e,n){this._engine=e??WL;let r=e.wasm;if(n instanceof HTMLImageElement||n instanceof HTMLVideoElement||n instanceof HTMLCanvasElement){let s=r._images.length;r._images.push(n),this._imageIndex=s,this._id=this._engine.wasm._wl_renderer_addImage(s)}else this._id=n;this._engine.textures._set(this)}get valid(){return this._id>=0}get id(){return this._id}update(){!this.valid||this._imageIndex===null||this._engine.wasm._wl_renderer_updateImage(this._id,this._imageIndex)}get width(){return this._engine.wasm._wl_texture_width(this._id)}get height(){return this._engine.wasm._wl_texture_height(this._id)}get engine(){return this._engine}updateSubImage(e,n,r,s){if(!this.valid||this._imageIndex===null)return;if(!Ot){let h=document.createElement("canvas"),d=h.getContext("2d");if(!d)throw new Error("Texture.updateSubImage(): Failed to obtain CanvasRenderingContext2D.");Ot={canvas:h,ctx:d}}let a=this._engine.wasm,l=a._images[this._imageIndex];if(!l)return;Ot.canvas.width=r,Ot.canvas.height=s,Ot.ctx.drawImage(l,e,n,r,s,0,0,r,s);let c=(l.videoHeight??l.height)-n-s;a._images[this._imageIndex]=Ot.canvas,a._wl_renderer_updateImage(this._id,this._imageIndex,e,c),a._images[this._imageIndex]=l}destroy(){this.engine.textures._destroy(this),this._id=-1,this._imageIndex=null}equals(e){return e?this._id===e._id:!1}},Ke=class{_index;_engine;constructor(e=WL,n){this._engine=e,this._index=n}get duration(){return this._engine.wasm._wl_animation_get_duration(this._index)}get trackCount(){return this._engine.wasm._wl_animation_get_trackCount(this._index)}retarget(e){let n=this._engine.wasm;if(e instanceof Kt){let a=n._wl_animation_retargetToSkin(this._index,e._index);return new Ke(this._engine,a)}if(e.length!=this.trackCount)throw Error("Expected "+this.trackCount.toString()+" targets, but got "+e.length.toString());let r=n._malloc(2*e.length);for(let a=0;a<e.length;++a)n.HEAPU16[r>>1+a]=e[a].objectId;let s=n._wl_animation_retarget(this._index,r);return n._free(r),new Ke(this._engine,s)}equals(e){return e?this._index===e._index:!1}};var Kt=class{_index;_engine;constructor(e,n){this._engine=e,this._index=n}get jointCount(){return this._engine.wasm._wl_skin_get_joint_count(this._index)}get jointIds(){let e=this._engine.wasm;return new Uint16Array(e.HEAPU16.buffer,e._wl_skin_joint_ids(this._index),this.jointCount)}get inverseBindTransforms(){let e=this._engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_skin_inverse_bind_transforms(this._index),8*this.jointCount)}get inverseBindScalings(){let e=this._engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_skin_inverse_bind_scalings(this._index),3*this.jointCount)}equals(e){return e?this._index===e._index:!1}};var ng=new Map([[P.Bool,!1],[P.Int,0],[P.Float,0],[P.String,""],[P.Enum,void 0],[P.Object,null],[P.Mesh,null],[P.Texture,null],[P.Material,null],[P.Animation,null],[P.Skin,null],[P.Color,[0,0,0,1]]]);var On=class extends O{name="wonderland-engine-8thwall-camera";started=!1;view=null;position=[0,0,0];rotation=[0,0,0,-1];glTextureRenderer=null;promptForDeviceMotion(){return new Promise(async(e,n)=>{window.dispatchEvent(new Event("8thwall-request-user-interaction")),window.addEventListener("8thwall-safe-to-request-permissions",async()=>{try{let r=await DeviceMotionEvent.requestPermission();e(r)}catch(r){n(r)}})})}async getPermissions(){if(DeviceMotionEvent&&DeviceMotionEvent.requestPermission)try{if(await DeviceMotionEvent.requestPermission()!=="granted")throw new Error("MotionEvent")}catch(e){if(e.name==="NotAllowedError"){if(await this.promptForDeviceMotion()!=="granted")throw new Error("MotionEvent")}else throw new Error("MotionEvent")}try{(await navigator.mediaDevices.getUserMedia({video:!0,audio:!0})).getTracks().forEach(n=>{n.stop()})}catch{throw new Error("Camera")}}init(){this.view=this.object.getComponent("view"),this.onUpdate=this.onUpdate.bind(this),this.onAttach=this.onAttach.bind(this),this.onException=this.onException.bind(this),this.onCameraStatusChange=this.onCameraStatusChange.bind(this)}async start(){this.view=this.object.getComponent("view"),this.useCustomUIOverlays||gh.init();try{await this.getPermissions()}catch(n){window.dispatchEvent(new CustomEvent("8thwall-permission-fail",{detail:n}));return}await this.waitForXR8(),XR8.XrController.configure({disableWorldTracking:!1}),this.glTextureRenderer=XR8.GlTextureRenderer.pipelineModule(),XR8.addCameraPipelineModules([this.glTextureRenderer,XR8.XrController.pipelineModule(),this]);let e={cameraConfig:{direction:XR8.XrConfig.camera().BACK},canvas:Module.canvas,allowedDevices:XR8.XrConfig.device().ANY,ownRunLoop:!1};XR8.run(e)}onAttach(e){this.started=!0,this.engine.scene.colorClearEnabled=!1;let n=Module.ctx,r=this.object.rotationWorld,s=this.object.getTranslationWorld([]);this.position=Array.from(s),this.rotation=Array.from(r),XR8.XrController.updateCameraProjectionMatrix({origin:{x:s[0],y:s[1],z:s[2]},facing:{x:r[0],y:r[1],z:r[2],w:r[3]},cam:{pixelRectWidth:Module.canvas.width,pixelRectHeight:Module.canvas.height,nearClipPlane:this.view.near,farClipPlane:this.view.far}}),this.engine.scene.onPreRender.push(()=>{n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),XR8.runPreRender(Date.now()),XR8.runRender()}),this.engine.scene.onPostRender.push(()=>{XR8.runPostRender(Date.now())})}onCameraStatusChange(e){e&&e.status==="failed"&&this.onException(new Error(`Camera failed with status: ${e.status}`))}onUpdate(e){if(!e.processCpuResult.reality)return;let{rotation:n,position:r,intrinsics:s}=e.processCpuResult.reality;if(this.rotation[0]=n.x,this.rotation[1]=n.y,this.rotation[2]=n.z,this.rotation[3]=n.w,this.position[0]=r.x,this.position[1]=r.y,this.position[2]=r.z,s){let a=this.view.projectionMatrix;for(let l=0;l<16;l++)Number.isFinite(s[l])&&(a[l]=s[l])}r&&n&&(this.object.rotationWorld=this.rotation,this.object.setTranslationWorld(this.position))}onException(e){console.error("8thwall exception:",e),window.dispatchEvent(new CustomEvent("8thwall-error",{detail:e}))}waitForXR8(){return new Promise((e,n)=>{window.XR8?e():window.addEventListener("xrloaded",()=>e())})}};M(On,"TypeName","8thwall-camera"),M(On,"Properties",{useCustomUIOverlays:{type:P.Bool,default:!1}});var gh={init:function(){this.handleRequestUserInteraction=this.handleRequestUserInteraction.bind(this),this.handlePermissionFail=this.handlePermissionFail.bind(this),this.handleError=this.handleError.bind(this),window.addEventListener("8thwall-request-user-interaction",this.handleRequestUserInteraction),window.addEventListener("8thwall-permission-fail",this.handlePermissionFail),window.addEventListener("8thwall-error",this.handleError)},handleRequestUserInteraction:function(){let t=this.showOverlay(wh);window.addEventListener("8thwall-safe-to-request-permissions",()=>{t.remove()})},handlePermissionFail:function(t){this.showOverlay(vh)},handleError:function(t){this.showOverlay(xh)},showOverlay:function(t){let e=document.createElement("div");return e.innerHTML=t,document.body.appendChild(e),e}},wh=`
<style>
  #request-permission-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 999;
    color: #fff;
    background-color: rgba(0, 0, 0, 0.5);
    text-align: center;
    font-family: sans-serif;
  }

  .request-permission-overlay_title {
    margin: 30px;
    font-size: 32px;
  }

  .request-permission-overlay_button {
    background-color: #e80086;
    font-size: 22px;
    padding: 10px 30px;
    color: #fff;
    border-radius: 15px;
    border: none;
  }
</style>

<div id="request-permission-overlay">
  <div class="request-permission-overlay_title">This app requires to use your camera and motion sensors</div>

  <button class="request-permission-overlay_button" onclick="window.dispatchEvent(new Event('8thwall-safe-to-request-permissions'))">OK</button>
</div>`,vh=`
<style>
  #failed-permission-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 999;
    color: #fff;
    background-color: rgba(0, 0, 0, 0.5);
    text-align: center;
    font-family: sans-serif;
  }

  .failed-permission-overlay_title {
    margin: 30px;
    font-size: 32px;
  }

  .failed-permission-overlay_button {
    background-color: #e80086;
    font-size: 22px;
    padding: 10px 30px;
    color: #fff;
    border-radius: 15px;
    border: none;
  }
</style>

<div id="failed-permission-overlay">
  <div class="failed-permission-overlay_title">Failed to grant permissions. Reset the the permissions and refresh the page.</div>

  <button class="failed-permission-overlay_button" onclick="window.location.reload()">Refresh the page</button>
</div>`,xh=`
<style>
  #wall-error-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 999;
    color: #fff;
    background-color: rgba(0, 0, 0, 0.5);
    text-align: center;
    font-family: sans-serif;
  }

  .wall-error-overlay_title {
    margin: 30px;
    font-size: 32px;
  }

  .wall-error-overlay_button {
    background-color: #e80086;
    font-size: 22px;
    padding: 10px 30px;
    color: #fff;
    border-radius: 15px;
    border: none;
  }
</style>

<div id="wall-error-overlay">
  <div class="wall-error-overlay_title">Error has occurred. Please reload the page</div>

  <button class="wall-error-overlay_button" onclick="window.location.reload()">Reload</button>
</div>`;var ie=class extends O{onHover=new xe;onUnhover=new xe;onClick=new xe;onMove=new xe;onDown=new xe;onUp=new xe;addHoverFunction(e){this.onHover.add(e)}removeHoverFunction(e){this.onHover.remove(e)}addUnHoverFunction(e){this.onUnhover.add(e)}removeUnHoverFunction(e){this.onUnhover.remove(e)}addClickFunction(e){this.onClick.add(e)}removeClickFunction(e){this.onClick.remove(e)}addMoveFunction(e){this.onMove.add(e)}removeMoveFunction(e){this.onMove.remove(e)}addDownFunction(e){this.onDown.add(e)}removeDownFunction(e){this.onDown.remove(e)}addUpFunction(e){this.onUp.add(e)}removeUpFunction(e){this.onUp.remove(e)}};M(ie,"TypeName","cursor-target"),M(ie,"Properties",{});var X=1e-6,Q=typeof Float32Array<"u"?Float32Array:Array,Ne=Math.random;var Ag=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function La(){var t=new Q(9);return Q!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}var qe={};Ie(qe,{add:()=>rp,adjoint:()=>Eh,clone:()=>Mh,copy:()=>Ah,create:()=>bh,determinant:()=>Fh,equals:()=>op,exactEquals:()=>ap,frob:()=>np,fromQuat:()=>Xh,fromQuat2:()=>Vh,fromRotation:()=>Hh,fromRotationTranslation:()=>za,fromRotationTranslationScale:()=>Bh,fromRotationTranslationScaleOrigin:()=>Wh,fromScaling:()=>zh,fromTranslation:()=>Dh,fromValues:()=>Th,fromXRotation:()=>Uh,fromYRotation:()=>Nh,fromZRotation:()=>qh,frustum:()=>Yh,getRotation:()=>Zr,getScaling:()=>Ha,getTranslation:()=>$r,identity:()=>ka,invert:()=>Ph,lookAt:()=>Kh,mul:()=>lp,multiply:()=>Da,multiplyScalar:()=>ip,multiplyScalarAndAdd:()=>sp,ortho:()=>Zh,orthoNO:()=>Na,orthoZO:()=>Jh,perspective:()=>Gh,perspectiveFromFieldOfView:()=>$h,perspectiveNO:()=>Ua,perspectiveZO:()=>Qh,rotate:()=>Ch,rotateX:()=>Oh,rotateY:()=>Lh,rotateZ:()=>kh,scale:()=>Rh,set:()=>jh,str:()=>tp,sub:()=>cp,subtract:()=>qa,targetTo:()=>ep,translate:()=>Ih,transpose:()=>Sh});function bh(){var t=new Q(16);return Q!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Mh(t){var e=new Q(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Ah(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Th(t,e,n,r,s,a,l,c,h,d,i,o,_,m,u,g){var f=new Q(16);return f[0]=t,f[1]=e,f[2]=n,f[3]=r,f[4]=s,f[5]=a,f[6]=l,f[7]=c,f[8]=h,f[9]=d,f[10]=i,f[11]=o,f[12]=_,f[13]=m,f[14]=u,f[15]=g,f}function jh(t,e,n,r,s,a,l,c,h,d,i,o,_,m,u,g,f){return t[0]=e,t[1]=n,t[2]=r,t[3]=s,t[4]=a,t[5]=l,t[6]=c,t[7]=h,t[8]=d,t[9]=i,t[10]=o,t[11]=_,t[12]=m,t[13]=u,t[14]=g,t[15]=f,t}function ka(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Sh(t,e){if(t===e){var n=e[1],r=e[2],s=e[3],a=e[6],l=e[7],c=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=a,t[11]=e[14],t[12]=s,t[13]=l,t[14]=c}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Ph(t,e){var n=e[0],r=e[1],s=e[2],a=e[3],l=e[4],c=e[5],h=e[6],d=e[7],i=e[8],o=e[9],_=e[10],m=e[11],u=e[12],g=e[13],f=e[14],w=e[15],v=n*c-r*l,x=n*h-s*l,T=n*d-a*l,A=r*h-s*c,j=r*d-a*c,I=s*d-a*h,E=i*g-o*u,D=i*f-_*u,z=i*w-m*u,q=o*f-_*g,H=o*w-m*g,k=_*w-m*f,F=v*k-x*H+T*q+A*z-j*D+I*E;return F?(F=1/F,t[0]=(c*k-h*H+d*q)*F,t[1]=(s*H-r*k-a*q)*F,t[2]=(g*I-f*j+w*A)*F,t[3]=(_*j-o*I-m*A)*F,t[4]=(h*z-l*k-d*D)*F,t[5]=(n*k-s*z+a*D)*F,t[6]=(f*T-u*I-w*x)*F,t[7]=(i*I-_*T+m*x)*F,t[8]=(l*H-c*z+d*E)*F,t[9]=(r*z-n*H-a*E)*F,t[10]=(u*j-g*T+w*v)*F,t[11]=(o*T-i*j-m*v)*F,t[12]=(c*D-l*q-h*E)*F,t[13]=(n*q-r*D+s*E)*F,t[14]=(g*x-u*A-f*v)*F,t[15]=(i*A-o*x+_*v)*F,t):null}function Eh(t,e){var n=e[0],r=e[1],s=e[2],a=e[3],l=e[4],c=e[5],h=e[6],d=e[7],i=e[8],o=e[9],_=e[10],m=e[11],u=e[12],g=e[13],f=e[14],w=e[15];return t[0]=c*(_*w-m*f)-o*(h*w-d*f)+g*(h*m-d*_),t[1]=-(r*(_*w-m*f)-o*(s*w-a*f)+g*(s*m-a*_)),t[2]=r*(h*w-d*f)-c*(s*w-a*f)+g*(s*d-a*h),t[3]=-(r*(h*m-d*_)-c*(s*m-a*_)+o*(s*d-a*h)),t[4]=-(l*(_*w-m*f)-i*(h*w-d*f)+u*(h*m-d*_)),t[5]=n*(_*w-m*f)-i*(s*w-a*f)+u*(s*m-a*_),t[6]=-(n*(h*w-d*f)-l*(s*w-a*f)+u*(s*d-a*h)),t[7]=n*(h*m-d*_)-l*(s*m-a*_)+i*(s*d-a*h),t[8]=l*(o*w-m*g)-i*(c*w-d*g)+u*(c*m-d*o),t[9]=-(n*(o*w-m*g)-i*(r*w-a*g)+u*(r*m-a*o)),t[10]=n*(c*w-d*g)-l*(r*w-a*g)+u*(r*d-a*c),t[11]=-(n*(c*m-d*o)-l*(r*m-a*o)+i*(r*d-a*c)),t[12]=-(l*(o*f-_*g)-i*(c*f-h*g)+u*(c*_-h*o)),t[13]=n*(o*f-_*g)-i*(r*f-s*g)+u*(r*_-s*o),t[14]=-(n*(c*f-h*g)-l*(r*f-s*g)+u*(r*h-s*c)),t[15]=n*(c*_-h*o)-l*(r*_-s*o)+i*(r*h-s*c),t}function Fh(t){var e=t[0],n=t[1],r=t[2],s=t[3],a=t[4],l=t[5],c=t[6],h=t[7],d=t[8],i=t[9],o=t[10],_=t[11],m=t[12],u=t[13],g=t[14],f=t[15],w=e*l-n*a,v=e*c-r*a,x=e*h-s*a,T=n*c-r*l,A=n*h-s*l,j=r*h-s*c,I=d*u-i*m,E=d*g-o*m,D=d*f-_*m,z=i*g-o*u,q=i*f-_*u,H=o*f-_*g;return w*H-v*q+x*z+T*D-A*E+j*I}function Da(t,e,n){var r=e[0],s=e[1],a=e[2],l=e[3],c=e[4],h=e[5],d=e[6],i=e[7],o=e[8],_=e[9],m=e[10],u=e[11],g=e[12],f=e[13],w=e[14],v=e[15],x=n[0],T=n[1],A=n[2],j=n[3];return t[0]=x*r+T*c+A*o+j*g,t[1]=x*s+T*h+A*_+j*f,t[2]=x*a+T*d+A*m+j*w,t[3]=x*l+T*i+A*u+j*v,x=n[4],T=n[5],A=n[6],j=n[7],t[4]=x*r+T*c+A*o+j*g,t[5]=x*s+T*h+A*_+j*f,t[6]=x*a+T*d+A*m+j*w,t[7]=x*l+T*i+A*u+j*v,x=n[8],T=n[9],A=n[10],j=n[11],t[8]=x*r+T*c+A*o+j*g,t[9]=x*s+T*h+A*_+j*f,t[10]=x*a+T*d+A*m+j*w,t[11]=x*l+T*i+A*u+j*v,x=n[12],T=n[13],A=n[14],j=n[15],t[12]=x*r+T*c+A*o+j*g,t[13]=x*s+T*h+A*_+j*f,t[14]=x*a+T*d+A*m+j*w,t[15]=x*l+T*i+A*u+j*v,t}function Ih(t,e,n){var r=n[0],s=n[1],a=n[2],l,c,h,d,i,o,_,m,u,g,f,w;return e===t?(t[12]=e[0]*r+e[4]*s+e[8]*a+e[12],t[13]=e[1]*r+e[5]*s+e[9]*a+e[13],t[14]=e[2]*r+e[6]*s+e[10]*a+e[14],t[15]=e[3]*r+e[7]*s+e[11]*a+e[15]):(l=e[0],c=e[1],h=e[2],d=e[3],i=e[4],o=e[5],_=e[6],m=e[7],u=e[8],g=e[9],f=e[10],w=e[11],t[0]=l,t[1]=c,t[2]=h,t[3]=d,t[4]=i,t[5]=o,t[6]=_,t[7]=m,t[8]=u,t[9]=g,t[10]=f,t[11]=w,t[12]=l*r+i*s+u*a+e[12],t[13]=c*r+o*s+g*a+e[13],t[14]=h*r+_*s+f*a+e[14],t[15]=d*r+m*s+w*a+e[15]),t}function Rh(t,e,n){var r=n[0],s=n[1],a=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*s,t[5]=e[5]*s,t[6]=e[6]*s,t[7]=e[7]*s,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Ch(t,e,n,r){var s=r[0],a=r[1],l=r[2],c=Math.hypot(s,a,l),h,d,i,o,_,m,u,g,f,w,v,x,T,A,j,I,E,D,z,q,H,k,F,J;return c<X?null:(c=1/c,s*=c,a*=c,l*=c,h=Math.sin(n),d=Math.cos(n),i=1-d,o=e[0],_=e[1],m=e[2],u=e[3],g=e[4],f=e[5],w=e[6],v=e[7],x=e[8],T=e[9],A=e[10],j=e[11],I=s*s*i+d,E=a*s*i+l*h,D=l*s*i-a*h,z=s*a*i-l*h,q=a*a*i+d,H=l*a*i+s*h,k=s*l*i+a*h,F=a*l*i-s*h,J=l*l*i+d,t[0]=o*I+g*E+x*D,t[1]=_*I+f*E+T*D,t[2]=m*I+w*E+A*D,t[3]=u*I+v*E+j*D,t[4]=o*z+g*q+x*H,t[5]=_*z+f*q+T*H,t[6]=m*z+w*q+A*H,t[7]=u*z+v*q+j*H,t[8]=o*k+g*F+x*J,t[9]=_*k+f*F+T*J,t[10]=m*k+w*F+A*J,t[11]=u*k+v*F+j*J,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function Oh(t,e,n){var r=Math.sin(n),s=Math.cos(n),a=e[4],l=e[5],c=e[6],h=e[7],d=e[8],i=e[9],o=e[10],_=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*s+d*r,t[5]=l*s+i*r,t[6]=c*s+o*r,t[7]=h*s+_*r,t[8]=d*s-a*r,t[9]=i*s-l*r,t[10]=o*s-c*r,t[11]=_*s-h*r,t}function Lh(t,e,n){var r=Math.sin(n),s=Math.cos(n),a=e[0],l=e[1],c=e[2],h=e[3],d=e[8],i=e[9],o=e[10],_=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*s-d*r,t[1]=l*s-i*r,t[2]=c*s-o*r,t[3]=h*s-_*r,t[8]=a*r+d*s,t[9]=l*r+i*s,t[10]=c*r+o*s,t[11]=h*r+_*s,t}function kh(t,e,n){var r=Math.sin(n),s=Math.cos(n),a=e[0],l=e[1],c=e[2],h=e[3],d=e[4],i=e[5],o=e[6],_=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*s+d*r,t[1]=l*s+i*r,t[2]=c*s+o*r,t[3]=h*s+_*r,t[4]=d*s-a*r,t[5]=i*s-l*r,t[6]=o*s-c*r,t[7]=_*s-h*r,t}function Dh(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function zh(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Hh(t,e,n){var r=n[0],s=n[1],a=n[2],l=Math.hypot(r,s,a),c,h,d;return l<X?null:(l=1/l,r*=l,s*=l,a*=l,c=Math.sin(e),h=Math.cos(e),d=1-h,t[0]=r*r*d+h,t[1]=s*r*d+a*c,t[2]=a*r*d-s*c,t[3]=0,t[4]=r*s*d-a*c,t[5]=s*s*d+h,t[6]=a*s*d+r*c,t[7]=0,t[8]=r*a*d+s*c,t[9]=s*a*d-r*c,t[10]=a*a*d+h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function Uh(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Nh(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function qh(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function za(t,e,n){var r=e[0],s=e[1],a=e[2],l=e[3],c=r+r,h=s+s,d=a+a,i=r*c,o=r*h,_=r*d,m=s*h,u=s*d,g=a*d,f=l*c,w=l*h,v=l*d;return t[0]=1-(m+g),t[1]=o+v,t[2]=_-w,t[3]=0,t[4]=o-v,t[5]=1-(i+g),t[6]=u+f,t[7]=0,t[8]=_+w,t[9]=u-f,t[10]=1-(i+m),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function Vh(t,e){var n=new Q(3),r=-e[0],s=-e[1],a=-e[2],l=e[3],c=e[4],h=e[5],d=e[6],i=e[7],o=r*r+s*s+a*a+l*l;return o>0?(n[0]=(c*l+i*r+h*a-d*s)*2/o,n[1]=(h*l+i*s+d*r-c*a)*2/o,n[2]=(d*l+i*a+c*s-h*r)*2/o):(n[0]=(c*l+i*r+h*a-d*s)*2,n[1]=(h*l+i*s+d*r-c*a)*2,n[2]=(d*l+i*a+c*s-h*r)*2),za(t,e,n),t}function $r(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function Ha(t,e){var n=e[0],r=e[1],s=e[2],a=e[4],l=e[5],c=e[6],h=e[8],d=e[9],i=e[10];return t[0]=Math.hypot(n,r,s),t[1]=Math.hypot(a,l,c),t[2]=Math.hypot(h,d,i),t}function Zr(t,e){var n=new Q(3);Ha(n,e);var r=1/n[0],s=1/n[1],a=1/n[2],l=e[0]*r,c=e[1]*s,h=e[2]*a,d=e[4]*r,i=e[5]*s,o=e[6]*a,_=e[8]*r,m=e[9]*s,u=e[10]*a,g=l+i+u,f=0;return g>0?(f=Math.sqrt(g+1)*2,t[3]=.25*f,t[0]=(o-m)/f,t[1]=(_-h)/f,t[2]=(c-d)/f):l>i&&l>u?(f=Math.sqrt(1+l-i-u)*2,t[3]=(o-m)/f,t[0]=.25*f,t[1]=(c+d)/f,t[2]=(_+h)/f):i>u?(f=Math.sqrt(1+i-l-u)*2,t[3]=(_-h)/f,t[0]=(c+d)/f,t[1]=.25*f,t[2]=(o+m)/f):(f=Math.sqrt(1+u-l-i)*2,t[3]=(c-d)/f,t[0]=(_+h)/f,t[1]=(o+m)/f,t[2]=.25*f),t}function Bh(t,e,n,r){var s=e[0],a=e[1],l=e[2],c=e[3],h=s+s,d=a+a,i=l+l,o=s*h,_=s*d,m=s*i,u=a*d,g=a*i,f=l*i,w=c*h,v=c*d,x=c*i,T=r[0],A=r[1],j=r[2];return t[0]=(1-(u+f))*T,t[1]=(_+x)*T,t[2]=(m-v)*T,t[3]=0,t[4]=(_-x)*A,t[5]=(1-(o+f))*A,t[6]=(g+w)*A,t[7]=0,t[8]=(m+v)*j,t[9]=(g-w)*j,t[10]=(1-(o+u))*j,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function Wh(t,e,n,r,s){var a=e[0],l=e[1],c=e[2],h=e[3],d=a+a,i=l+l,o=c+c,_=a*d,m=a*i,u=a*o,g=l*i,f=l*o,w=c*o,v=h*d,x=h*i,T=h*o,A=r[0],j=r[1],I=r[2],E=s[0],D=s[1],z=s[2],q=(1-(g+w))*A,H=(m+T)*A,k=(u-x)*A,F=(m-T)*j,J=(1-(_+w))*j,he=(f+v)*j,pe=(u+x)*I,Ht=(f-v)*I,Ut=(1-(_+g))*I;return t[0]=q,t[1]=H,t[2]=k,t[3]=0,t[4]=F,t[5]=J,t[6]=he,t[7]=0,t[8]=pe,t[9]=Ht,t[10]=Ut,t[11]=0,t[12]=n[0]+E-(q*E+F*D+pe*z),t[13]=n[1]+D-(H*E+J*D+Ht*z),t[14]=n[2]+z-(k*E+he*D+Ut*z),t[15]=1,t}function Xh(t,e){var n=e[0],r=e[1],s=e[2],a=e[3],l=n+n,c=r+r,h=s+s,d=n*l,i=r*l,o=r*c,_=s*l,m=s*c,u=s*h,g=a*l,f=a*c,w=a*h;return t[0]=1-o-u,t[1]=i+w,t[2]=_-f,t[3]=0,t[4]=i-w,t[5]=1-d-u,t[6]=m+g,t[7]=0,t[8]=_+f,t[9]=m-g,t[10]=1-d-o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Yh(t,e,n,r,s,a,l){var c=1/(n-e),h=1/(s-r),d=1/(a-l);return t[0]=a*2*c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a*2*h,t[6]=0,t[7]=0,t[8]=(n+e)*c,t[9]=(s+r)*h,t[10]=(l+a)*d,t[11]=-1,t[12]=0,t[13]=0,t[14]=l*a*2*d,t[15]=0,t}function Ua(t,e,n,r,s){var a=1/Math.tan(e/2),l;return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==1/0?(l=1/(r-s),t[10]=(s+r)*l,t[14]=2*s*r*l):(t[10]=-1,t[14]=-2*r),t}var Gh=Ua;function Qh(t,e,n,r,s){var a=1/Math.tan(e/2),l;return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,s!=null&&s!==1/0?(l=1/(r-s),t[10]=s*l,t[14]=s*r*l):(t[10]=-1,t[14]=-r),t}function $h(t,e,n,r){var s=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),l=Math.tan(e.leftDegrees*Math.PI/180),c=Math.tan(e.rightDegrees*Math.PI/180),h=2/(l+c),d=2/(s+a);return t[0]=h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=d,t[6]=0,t[7]=0,t[8]=-((l-c)*h*.5),t[9]=(s-a)*d*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t}function Na(t,e,n,r,s,a,l){var c=1/(e-n),h=1/(r-s),d=1/(a-l);return t[0]=-2*c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*d,t[11]=0,t[12]=(e+n)*c,t[13]=(s+r)*h,t[14]=(l+a)*d,t[15]=1,t}var Zh=Na;function Jh(t,e,n,r,s,a,l){var c=1/(e-n),h=1/(r-s),d=1/(a-l);return t[0]=-2*c,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=d,t[11]=0,t[12]=(e+n)*c,t[13]=(s+r)*h,t[14]=a*d,t[15]=1,t}function Kh(t,e,n,r){var s,a,l,c,h,d,i,o,_,m,u=e[0],g=e[1],f=e[2],w=r[0],v=r[1],x=r[2],T=n[0],A=n[1],j=n[2];return Math.abs(u-T)<X&&Math.abs(g-A)<X&&Math.abs(f-j)<X?ka(t):(i=u-T,o=g-A,_=f-j,m=1/Math.hypot(i,o,_),i*=m,o*=m,_*=m,s=v*_-x*o,a=x*i-w*_,l=w*o-v*i,m=Math.hypot(s,a,l),m?(m=1/m,s*=m,a*=m,l*=m):(s=0,a=0,l=0),c=o*l-_*a,h=_*s-i*l,d=i*a-o*s,m=Math.hypot(c,h,d),m?(m=1/m,c*=m,h*=m,d*=m):(c=0,h=0,d=0),t[0]=s,t[1]=c,t[2]=i,t[3]=0,t[4]=a,t[5]=h,t[6]=o,t[7]=0,t[8]=l,t[9]=d,t[10]=_,t[11]=0,t[12]=-(s*u+a*g+l*f),t[13]=-(c*u+h*g+d*f),t[14]=-(i*u+o*g+_*f),t[15]=1,t)}function ep(t,e,n,r){var s=e[0],a=e[1],l=e[2],c=r[0],h=r[1],d=r[2],i=s-n[0],o=a-n[1],_=l-n[2],m=i*i+o*o+_*_;m>0&&(m=1/Math.sqrt(m),i*=m,o*=m,_*=m);var u=h*_-d*o,g=d*i-c*_,f=c*o-h*i;return m=u*u+g*g+f*f,m>0&&(m=1/Math.sqrt(m),u*=m,g*=m,f*=m),t[0]=u,t[1]=g,t[2]=f,t[3]=0,t[4]=o*f-_*g,t[5]=_*u-i*f,t[6]=i*g-o*u,t[7]=0,t[8]=i,t[9]=o,t[10]=_,t[11]=0,t[12]=s,t[13]=a,t[14]=l,t[15]=1,t}function tp(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function np(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function rp(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function qa(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function ip(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function sp(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t}function ap(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function op(t,e){var n=t[0],r=t[1],s=t[2],a=t[3],l=t[4],c=t[5],h=t[6],d=t[7],i=t[8],o=t[9],_=t[10],m=t[11],u=t[12],g=t[13],f=t[14],w=t[15],v=e[0],x=e[1],T=e[2],A=e[3],j=e[4],I=e[5],E=e[6],D=e[7],z=e[8],q=e[9],H=e[10],k=e[11],F=e[12],J=e[13],he=e[14],pe=e[15];return Math.abs(n-v)<=X*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(r-x)<=X*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(s-T)<=X*Math.max(1,Math.abs(s),Math.abs(T))&&Math.abs(a-A)<=X*Math.max(1,Math.abs(a),Math.abs(A))&&Math.abs(l-j)<=X*Math.max(1,Math.abs(l),Math.abs(j))&&Math.abs(c-I)<=X*Math.max(1,Math.abs(c),Math.abs(I))&&Math.abs(h-E)<=X*Math.max(1,Math.abs(h),Math.abs(E))&&Math.abs(d-D)<=X*Math.max(1,Math.abs(d),Math.abs(D))&&Math.abs(i-z)<=X*Math.max(1,Math.abs(i),Math.abs(z))&&Math.abs(o-q)<=X*Math.max(1,Math.abs(o),Math.abs(q))&&Math.abs(_-H)<=X*Math.max(1,Math.abs(_),Math.abs(H))&&Math.abs(m-k)<=X*Math.max(1,Math.abs(m),Math.abs(k))&&Math.abs(u-F)<=X*Math.max(1,Math.abs(u),Math.abs(F))&&Math.abs(g-J)<=X*Math.max(1,Math.abs(g),Math.abs(J))&&Math.abs(f-he)<=X*Math.max(1,Math.abs(f),Math.abs(he))&&Math.abs(w-pe)<=X*Math.max(1,Math.abs(w),Math.abs(pe))}var lp=Da,cp=qa;var L={};Ie(L,{add:()=>ad,calculateW:()=>$p,clone:()=>rd,conjugate:()=>ed,copy:()=>Hn,create:()=>tn,dot:()=>Un,equals:()=>pd,exactEquals:()=>hd,exp:()=>ho,fromEuler:()=>td,fromMat3:()=>mo,fromValues:()=>id,getAngle:()=>Qp,getAxisAngle:()=>Gp,identity:()=>Yp,invert:()=>Kp,len:()=>cd,length:()=>Nn,lerp:()=>ld,ln:()=>po,mul:()=>od,multiply:()=>_o,normalize:()=>ri,pow:()=>Zp,random:()=>Jp,rotateX:()=>ei,rotateY:()=>ti,rotateZ:()=>ni,rotationTo:()=>dd,scale:()=>fo,set:()=>sd,setAxes:()=>fd,setAxisAngle:()=>co,slerp:()=>zn,sqlerp:()=>md,sqrLen:()=>_d,squaredLength:()=>qn,str:()=>nd});var b={};Ie(b,{add:()=>dp,angle:()=>Cp,bezier:()=>Tp,ceil:()=>mp,clone:()=>_p,copy:()=>hp,create:()=>Ln,cross:()=>en,dist:()=>Np,distance:()=>Ya,div:()=>Up,divide:()=>Xa,dot:()=>Dn,equals:()=>Dp,exactEquals:()=>kp,floor:()=>fp,forEach:()=>Bp,fromValues:()=>kn,hermite:()=>Ap,inverse:()=>bp,len:()=>Kr,length:()=>Va,lerp:()=>Mp,max:()=>gp,min:()=>up,mul:()=>Hp,multiply:()=>Wa,negate:()=>yp,normalize:()=>Jr,random:()=>jp,rotateX:()=>Fp,rotateY:()=>Ip,rotateZ:()=>Rp,round:()=>wp,scale:()=>vp,scaleAndAdd:()=>xp,set:()=>pp,sqrDist:()=>qp,sqrLen:()=>Vp,squaredDistance:()=>Ga,squaredLength:()=>Qa,str:()=>Lp,sub:()=>zp,subtract:()=>Ba,transformMat3:()=>Pp,transformMat4:()=>Sp,transformQuat:()=>Ep,zero:()=>Op});function Ln(){var t=new Q(3);return Q!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function _p(t){var e=new Q(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Va(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function kn(t,e,n){var r=new Q(3);return r[0]=t,r[1]=e,r[2]=n,r}function hp(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function pp(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}function dp(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Ba(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Wa(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function Xa(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function mp(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function fp(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function up(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function gp(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function wp(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function vp(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function xp(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}function Ya(t,e){var n=e[0]-t[0],r=e[1]-t[1],s=e[2]-t[2];return Math.hypot(n,r,s)}function Ga(t,e){var n=e[0]-t[0],r=e[1]-t[1],s=e[2]-t[2];return n*n+r*r+s*s}function Qa(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function yp(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function bp(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function Jr(t,e){var n=e[0],r=e[1],s=e[2],a=n*n+r*r+s*s;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}function Dn(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function en(t,e,n){var r=e[0],s=e[1],a=e[2],l=n[0],c=n[1],h=n[2];return t[0]=s*h-a*c,t[1]=a*l-r*h,t[2]=r*c-s*l,t}function Mp(t,e,n,r){var s=e[0],a=e[1],l=e[2];return t[0]=s+r*(n[0]-s),t[1]=a+r*(n[1]-a),t[2]=l+r*(n[2]-l),t}function Ap(t,e,n,r,s,a){var l=a*a,c=l*(2*a-3)+1,h=l*(a-2)+a,d=l*(a-1),i=l*(3-2*a);return t[0]=e[0]*c+n[0]*h+r[0]*d+s[0]*i,t[1]=e[1]*c+n[1]*h+r[1]*d+s[1]*i,t[2]=e[2]*c+n[2]*h+r[2]*d+s[2]*i,t}function Tp(t,e,n,r,s,a){var l=1-a,c=l*l,h=a*a,d=c*l,i=3*a*c,o=3*h*l,_=h*a;return t[0]=e[0]*d+n[0]*i+r[0]*o+s[0]*_,t[1]=e[1]*d+n[1]*i+r[1]*o+s[1]*_,t[2]=e[2]*d+n[2]*i+r[2]*o+s[2]*_,t}function jp(t,e){e=e||1;var n=Ne()*2*Math.PI,r=Ne()*2-1,s=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*s,t[1]=Math.sin(n)*s,t[2]=r*e,t}function Sp(t,e,n){var r=e[0],s=e[1],a=e[2],l=n[3]*r+n[7]*s+n[11]*a+n[15];return l=l||1,t[0]=(n[0]*r+n[4]*s+n[8]*a+n[12])/l,t[1]=(n[1]*r+n[5]*s+n[9]*a+n[13])/l,t[2]=(n[2]*r+n[6]*s+n[10]*a+n[14])/l,t}function Pp(t,e,n){var r=e[0],s=e[1],a=e[2];return t[0]=r*n[0]+s*n[3]+a*n[6],t[1]=r*n[1]+s*n[4]+a*n[7],t[2]=r*n[2]+s*n[5]+a*n[8],t}function Ep(t,e,n){var r=n[0],s=n[1],a=n[2],l=n[3],c=e[0],h=e[1],d=e[2],i=s*d-a*h,o=a*c-r*d,_=r*h-s*c,m=s*_-a*o,u=a*i-r*_,g=r*o-s*i,f=l*2;return i*=f,o*=f,_*=f,m*=2,u*=2,g*=2,t[0]=c+i+m,t[1]=h+o+u,t[2]=d+_+g,t}function Fp(t,e,n,r){var s=[],a=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],a[0]=s[0],a[1]=s[1]*Math.cos(r)-s[2]*Math.sin(r),a[2]=s[1]*Math.sin(r)+s[2]*Math.cos(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function Ip(t,e,n,r){var s=[],a=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],a[0]=s[2]*Math.sin(r)+s[0]*Math.cos(r),a[1]=s[1],a[2]=s[2]*Math.cos(r)-s[0]*Math.sin(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function Rp(t,e,n,r){var s=[],a=[];return s[0]=e[0]-n[0],s[1]=e[1]-n[1],s[2]=e[2]-n[2],a[0]=s[0]*Math.cos(r)-s[1]*Math.sin(r),a[1]=s[0]*Math.sin(r)+s[1]*Math.cos(r),a[2]=s[2],t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function Cp(t,e){var n=t[0],r=t[1],s=t[2],a=e[0],l=e[1],c=e[2],h=Math.sqrt(n*n+r*r+s*s),d=Math.sqrt(a*a+l*l+c*c),i=h*d,o=i&&Dn(t,e)/i;return Math.acos(Math.min(Math.max(o,-1),1))}function Op(t){return t[0]=0,t[1]=0,t[2]=0,t}function Lp(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function kp(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function Dp(t,e){var n=t[0],r=t[1],s=t[2],a=e[0],l=e[1],c=e[2];return Math.abs(n-a)<=X*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(r-l)<=X*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(s-c)<=X*Math.max(1,Math.abs(s),Math.abs(c))}var zp=Ba,Hp=Wa,Up=Xa,Np=Ya,qp=Ga,Kr=Va,Vp=Qa,Bp=function(){var t=Ln();return function(e,n,r,s,a,l){var c,h;for(n||(n=3),r||(r=0),s?h=Math.min(s*n+r,e.length):h=e.length,c=r;c<h;c+=n)t[0]=e[c],t[1]=e[c+1],t[2]=e[c+2],a(t,t,l),e[c]=t[0],e[c+1]=t[1],e[c+2]=t[2];return e}}();function Wp(){var t=new Q(4);return Q!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function $a(t){var e=new Q(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function Za(t,e,n,r){var s=new Q(4);return s[0]=t,s[1]=e,s[2]=n,s[3]=r,s}function Ja(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Ka(t,e,n,r,s){return t[0]=e,t[1]=n,t[2]=r,t[3]=s,t}function eo(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function to(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function no(t){var e=t[0],n=t[1],r=t[2],s=t[3];return Math.hypot(e,n,r,s)}function ro(t){var e=t[0],n=t[1],r=t[2],s=t[3];return e*e+n*n+r*r+s*s}function io(t,e){var n=e[0],r=e[1],s=e[2],a=e[3],l=n*n+r*r+s*s+a*a;return l>0&&(l=1/Math.sqrt(l)),t[0]=n*l,t[1]=r*l,t[2]=s*l,t[3]=a*l,t}function so(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function ao(t,e,n,r){var s=e[0],a=e[1],l=e[2],c=e[3];return t[0]=s+r*(n[0]-s),t[1]=a+r*(n[1]-a),t[2]=l+r*(n[2]-l),t[3]=c+r*(n[3]-c),t}function oo(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function lo(t,e){var n=t[0],r=t[1],s=t[2],a=t[3],l=e[0],c=e[1],h=e[2],d=e[3];return Math.abs(n-l)<=X*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(r-c)<=X*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(s-h)<=X*Math.max(1,Math.abs(s),Math.abs(h))&&Math.abs(a-d)<=X*Math.max(1,Math.abs(a),Math.abs(d))}var Tg=function(){var t=Wp();return function(e,n,r,s,a,l){var c,h;for(n||(n=4),r||(r=0),s?h=Math.min(s*n+r,e.length):h=e.length,c=r;c<h;c+=n)t[0]=e[c],t[1]=e[c+1],t[2]=e[c+2],t[3]=e[c+3],a(t,t,l),e[c]=t[0],e[c+1]=t[1],e[c+2]=t[2],e[c+3]=t[3];return e}}();function tn(){var t=new Q(4);return Q!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Yp(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function co(t,e,n){n=n*.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function Gp(t,e){var n=Math.acos(e[3])*2,r=Math.sin(n/2);return r>X?(t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r):(t[0]=1,t[1]=0,t[2]=0),n}function Qp(t,e){var n=Un(t,e);return Math.acos(2*n*n-1)}function _o(t,e,n){var r=e[0],s=e[1],a=e[2],l=e[3],c=n[0],h=n[1],d=n[2],i=n[3];return t[0]=r*i+l*c+s*d-a*h,t[1]=s*i+l*h+a*c-r*d,t[2]=a*i+l*d+r*h-s*c,t[3]=l*i-r*c-s*h-a*d,t}function ei(t,e,n){n*=.5;var r=e[0],s=e[1],a=e[2],l=e[3],c=Math.sin(n),h=Math.cos(n);return t[0]=r*h+l*c,t[1]=s*h+a*c,t[2]=a*h-s*c,t[3]=l*h-r*c,t}function ti(t,e,n){n*=.5;var r=e[0],s=e[1],a=e[2],l=e[3],c=Math.sin(n),h=Math.cos(n);return t[0]=r*h-a*c,t[1]=s*h+l*c,t[2]=a*h+r*c,t[3]=l*h-s*c,t}function ni(t,e,n){n*=.5;var r=e[0],s=e[1],a=e[2],l=e[3],c=Math.sin(n),h=Math.cos(n);return t[0]=r*h+s*c,t[1]=s*h-r*c,t[2]=a*h+l*c,t[3]=l*h-a*c,t}function $p(t,e){var n=e[0],r=e[1],s=e[2];return t[0]=n,t[1]=r,t[2]=s,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-s*s)),t}function ho(t,e){var n=e[0],r=e[1],s=e[2],a=e[3],l=Math.sqrt(n*n+r*r+s*s),c=Math.exp(a),h=l>0?c*Math.sin(l)/l:0;return t[0]=n*h,t[1]=r*h,t[2]=s*h,t[3]=c*Math.cos(l),t}function po(t,e){var n=e[0],r=e[1],s=e[2],a=e[3],l=Math.sqrt(n*n+r*r+s*s),c=l>0?Math.atan2(l,a)/l:0;return t[0]=n*c,t[1]=r*c,t[2]=s*c,t[3]=.5*Math.log(n*n+r*r+s*s+a*a),t}function Zp(t,e,n){return po(t,e),fo(t,t,n),ho(t,t),t}function zn(t,e,n,r){var s=e[0],a=e[1],l=e[2],c=e[3],h=n[0],d=n[1],i=n[2],o=n[3],_,m,u,g,f;return m=s*h+a*d+l*i+c*o,m<0&&(m=-m,h=-h,d=-d,i=-i,o=-o),1-m>X?(_=Math.acos(m),u=Math.sin(_),g=Math.sin((1-r)*_)/u,f=Math.sin(r*_)/u):(g=1-r,f=r),t[0]=g*s+f*h,t[1]=g*a+f*d,t[2]=g*l+f*i,t[3]=g*c+f*o,t}function Jp(t){var e=Ne(),n=Ne(),r=Ne(),s=Math.sqrt(1-e),a=Math.sqrt(e);return t[0]=s*Math.sin(2*Math.PI*n),t[1]=s*Math.cos(2*Math.PI*n),t[2]=a*Math.sin(2*Math.PI*r),t[3]=a*Math.cos(2*Math.PI*r),t}function Kp(t,e){var n=e[0],r=e[1],s=e[2],a=e[3],l=n*n+r*r+s*s+a*a,c=l?1/l:0;return t[0]=-n*c,t[1]=-r*c,t[2]=-s*c,t[3]=a*c,t}function ed(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function mo(t,e){var n=e[0]+e[4]+e[8],r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var s=0;e[4]>e[0]&&(s=1),e[8]>e[s*3+s]&&(s=2);var a=(s+1)%3,l=(s+2)%3;r=Math.sqrt(e[s*3+s]-e[a*3+a]-e[l*3+l]+1),t[s]=.5*r,r=.5/r,t[3]=(e[a*3+l]-e[l*3+a])*r,t[a]=(e[a*3+s]+e[s*3+a])*r,t[l]=(e[l*3+s]+e[s*3+l])*r}return t}function td(t,e,n,r){var s=.5*Math.PI/180;e*=s,n*=s,r*=s;var a=Math.sin(e),l=Math.cos(e),c=Math.sin(n),h=Math.cos(n),d=Math.sin(r),i=Math.cos(r);return t[0]=a*h*i-l*c*d,t[1]=l*c*i+a*h*d,t[2]=l*h*d-a*c*i,t[3]=l*h*i+a*c*d,t}function nd(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var rd=$a,id=Za,Hn=Ja,sd=Ka,ad=eo,od=_o,fo=to,Un=so,ld=ao,Nn=no,cd=Nn,qn=ro,_d=qn,ri=io,hd=oo,pd=lo,dd=function(){var t=Ln(),e=kn(1,0,0),n=kn(0,1,0);return function(r,s,a){var l=Dn(s,a);return l<-.999999?(en(t,e,s),Kr(t)<1e-6&&en(t,n,s),Jr(t,t),co(r,t,Math.PI),r):l>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(en(t,s,a),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+l,ri(r,r))}}(),md=function(){var t=tn(),e=tn();return function(n,r,s,a,l,c){return zn(t,r,l,c),zn(e,s,a,c),zn(n,t,e,2*c*(1-c)),n}}(),fd=function(){var t=La();return function(e,n,r,s){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=s[0],t[4]=s[1],t[7]=s[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],ri(e,mo(e,t))}}();var ne={};Ie(ne,{add:()=>Dd,clone:()=>gd,conjugate:()=>qd,copy:()=>go,create:()=>ud,dot:()=>vo,equals:()=>Gd,exactEquals:()=>Yd,fromMat4:()=>bd,fromRotation:()=>yd,fromRotationTranslation:()=>uo,fromRotationTranslationValues:()=>vd,fromTranslation:()=>xd,fromValues:()=>wd,getDual:()=>jd,getReal:()=>Td,getTranslation:()=>Ed,identity:()=>Md,invert:()=>Nd,len:()=>Vd,length:()=>xo,lerp:()=>Ud,mul:()=>zd,multiply:()=>wo,normalize:()=>Wd,rotateAroundAxis:()=>kd,rotateByQuatAppend:()=>Od,rotateByQuatPrepend:()=>Ld,rotateX:()=>Id,rotateY:()=>Rd,rotateZ:()=>Cd,scale:()=>Hd,set:()=>Ad,setDual:()=>Pd,setReal:()=>Sd,sqrLen:()=>Bd,squaredLength:()=>Vn,str:()=>Xd,translate:()=>Fd});function ud(){var t=new Q(8);return Q!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t}function gd(t){var e=new Q(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function wd(t,e,n,r,s,a,l,c){var h=new Q(8);return h[0]=t,h[1]=e,h[2]=n,h[3]=r,h[4]=s,h[5]=a,h[6]=l,h[7]=c,h}function vd(t,e,n,r,s,a,l){var c=new Q(8);c[0]=t,c[1]=e,c[2]=n,c[3]=r;var h=s*.5,d=a*.5,i=l*.5;return c[4]=h*r+d*n-i*e,c[5]=d*r+i*t-h*n,c[6]=i*r+h*e-d*t,c[7]=-h*t-d*e-i*n,c}function uo(t,e,n){var r=n[0]*.5,s=n[1]*.5,a=n[2]*.5,l=e[0],c=e[1],h=e[2],d=e[3];return t[0]=l,t[1]=c,t[2]=h,t[3]=d,t[4]=r*d+s*h-a*c,t[5]=s*d+a*l-r*h,t[6]=a*d+r*c-s*l,t[7]=-r*l-s*c-a*h,t}function xd(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0]*.5,t[5]=e[1]*.5,t[6]=e[2]*.5,t[7]=0,t}function yd(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function bd(t,e){var n=tn();Zr(n,e);var r=new Q(3);return $r(r,e),uo(t,n,r),t}function go(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function Md(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function Ad(t,e,n,r,s,a,l,c,h){return t[0]=e,t[1]=n,t[2]=r,t[3]=s,t[4]=a,t[5]=l,t[6]=c,t[7]=h,t}var Td=Hn;function jd(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t}var Sd=Hn;function Pd(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t}function Ed(t,e){var n=e[4],r=e[5],s=e[6],a=e[7],l=-e[0],c=-e[1],h=-e[2],d=e[3];return t[0]=(n*d+a*l+r*h-s*c)*2,t[1]=(r*d+a*c+s*l-n*h)*2,t[2]=(s*d+a*h+n*c-r*l)*2,t}function Fd(t,e,n){var r=e[0],s=e[1],a=e[2],l=e[3],c=n[0]*.5,h=n[1]*.5,d=n[2]*.5,i=e[4],o=e[5],_=e[6],m=e[7];return t[0]=r,t[1]=s,t[2]=a,t[3]=l,t[4]=l*c+s*d-a*h+i,t[5]=l*h+a*c-r*d+o,t[6]=l*d+r*h-s*c+_,t[7]=-r*c-s*h-a*d+m,t}function Id(t,e,n){var r=-e[0],s=-e[1],a=-e[2],l=e[3],c=e[4],h=e[5],d=e[6],i=e[7],o=c*l+i*r+h*a-d*s,_=h*l+i*s+d*r-c*a,m=d*l+i*a+c*s-h*r,u=i*l-c*r-h*s-d*a;return ei(t,e,n),r=t[0],s=t[1],a=t[2],l=t[3],t[4]=o*l+u*r+_*a-m*s,t[5]=_*l+u*s+m*r-o*a,t[6]=m*l+u*a+o*s-_*r,t[7]=u*l-o*r-_*s-m*a,t}function Rd(t,e,n){var r=-e[0],s=-e[1],a=-e[2],l=e[3],c=e[4],h=e[5],d=e[6],i=e[7],o=c*l+i*r+h*a-d*s,_=h*l+i*s+d*r-c*a,m=d*l+i*a+c*s-h*r,u=i*l-c*r-h*s-d*a;return ti(t,e,n),r=t[0],s=t[1],a=t[2],l=t[3],t[4]=o*l+u*r+_*a-m*s,t[5]=_*l+u*s+m*r-o*a,t[6]=m*l+u*a+o*s-_*r,t[7]=u*l-o*r-_*s-m*a,t}function Cd(t,e,n){var r=-e[0],s=-e[1],a=-e[2],l=e[3],c=e[4],h=e[5],d=e[6],i=e[7],o=c*l+i*r+h*a-d*s,_=h*l+i*s+d*r-c*a,m=d*l+i*a+c*s-h*r,u=i*l-c*r-h*s-d*a;return ni(t,e,n),r=t[0],s=t[1],a=t[2],l=t[3],t[4]=o*l+u*r+_*a-m*s,t[5]=_*l+u*s+m*r-o*a,t[6]=m*l+u*a+o*s-_*r,t[7]=u*l-o*r-_*s-m*a,t}function Od(t,e,n){var r=n[0],s=n[1],a=n[2],l=n[3],c=e[0],h=e[1],d=e[2],i=e[3];return t[0]=c*l+i*r+h*a-d*s,t[1]=h*l+i*s+d*r-c*a,t[2]=d*l+i*a+c*s-h*r,t[3]=i*l-c*r-h*s-d*a,c=e[4],h=e[5],d=e[6],i=e[7],t[4]=c*l+i*r+h*a-d*s,t[5]=h*l+i*s+d*r-c*a,t[6]=d*l+i*a+c*s-h*r,t[7]=i*l-c*r-h*s-d*a,t}function Ld(t,e,n){var r=e[0],s=e[1],a=e[2],l=e[3],c=n[0],h=n[1],d=n[2],i=n[3];return t[0]=r*i+l*c+s*d-a*h,t[1]=s*i+l*h+a*c-r*d,t[2]=a*i+l*d+r*h-s*c,t[3]=l*i-r*c-s*h-a*d,c=n[4],h=n[5],d=n[6],i=n[7],t[4]=r*i+l*c+s*d-a*h,t[5]=s*i+l*h+a*c-r*d,t[6]=a*i+l*d+r*h-s*c,t[7]=l*i-r*c-s*h-a*d,t}function kd(t,e,n,r){if(Math.abs(r)<X)return go(t,e);var s=Math.hypot(n[0],n[1],n[2]);r=r*.5;var a=Math.sin(r),l=a*n[0]/s,c=a*n[1]/s,h=a*n[2]/s,d=Math.cos(r),i=e[0],o=e[1],_=e[2],m=e[3];t[0]=i*d+m*l+o*h-_*c,t[1]=o*d+m*c+_*l-i*h,t[2]=_*d+m*h+i*c-o*l,t[3]=m*d-i*l-o*c-_*h;var u=e[4],g=e[5],f=e[6],w=e[7];return t[4]=u*d+w*l+g*h-f*c,t[5]=g*d+w*c+f*l-u*h,t[6]=f*d+w*h+u*c-g*l,t[7]=w*d-u*l-g*c-f*h,t}function Dd(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t}function wo(t,e,n){var r=e[0],s=e[1],a=e[2],l=e[3],c=n[4],h=n[5],d=n[6],i=n[7],o=e[4],_=e[5],m=e[6],u=e[7],g=n[0],f=n[1],w=n[2],v=n[3];return t[0]=r*v+l*g+s*w-a*f,t[1]=s*v+l*f+a*g-r*w,t[2]=a*v+l*w+r*f-s*g,t[3]=l*v-r*g-s*f-a*w,t[4]=r*i+l*c+s*d-a*h+o*v+u*g+_*w-m*f,t[5]=s*i+l*h+a*c-r*d+_*v+u*f+m*g-o*w,t[6]=a*i+l*d+r*h-s*c+m*v+u*w+o*f-_*g,t[7]=l*i-r*c-s*h-a*d+u*v-o*g-_*f-m*w,t}var zd=wo;function Hd(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t}var vo=Un;function Ud(t,e,n,r){var s=1-r;return vo(e,n)<0&&(r=-r),t[0]=e[0]*s+n[0]*r,t[1]=e[1]*s+n[1]*r,t[2]=e[2]*s+n[2]*r,t[3]=e[3]*s+n[3]*r,t[4]=e[4]*s+n[4]*r,t[5]=e[5]*s+n[5]*r,t[6]=e[6]*s+n[6]*r,t[7]=e[7]*s+n[7]*r,t}function Nd(t,e){var n=Vn(e);return t[0]=-e[0]/n,t[1]=-e[1]/n,t[2]=-e[2]/n,t[3]=e[3]/n,t[4]=-e[4]/n,t[5]=-e[5]/n,t[6]=-e[6]/n,t[7]=e[7]/n,t}function qd(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t}var xo=Nn,Vd=xo,Vn=qn,Bd=Vn;function Wd(t,e){var n=Vn(e);if(n>0){n=Math.sqrt(n);var r=e[0]/n,s=e[1]/n,a=e[2]/n,l=e[3]/n,c=e[4],h=e[5],d=e[6],i=e[7],o=r*c+s*h+a*d+l*i;t[0]=r,t[1]=s,t[2]=a,t[3]=l,t[4]=(c-r*o)/n,t[5]=(h-s*o)/n,t[6]=(d-a*o)/n,t[7]=(i-l*o)/n}return t}function Xd(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function Yd(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]}function Gd(t,e){var n=t[0],r=t[1],s=t[2],a=t[3],l=t[4],c=t[5],h=t[6],d=t[7],i=e[0],o=e[1],_=e[2],m=e[3],u=e[4],g=e[5],f=e[6],w=e[7];return Math.abs(n-i)<=X*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(r-o)<=X*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(s-_)<=X*Math.max(1,Math.abs(s),Math.abs(_))&&Math.abs(a-m)<=X*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(l-u)<=X*Math.max(1,Math.abs(l),Math.abs(u))&&Math.abs(c-g)<=X*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(h-f)<=X*Math.max(1,Math.abs(h),Math.abs(f))&&Math.abs(d-w)<=X*Math.max(1,Math.abs(d),Math.abs(w))}var et=function(t,e,n,r){var s=arguments.length,a=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(l=t[c])&&(a=(s<3?l(a):s>3?l(e,n,a):l(e,n))||a);return s>3&&a&&Object.defineProperty(e,n,a),a},Se=class extends O{collisionMask=0;maxDistance=100;onDestroyCallbacks=[];input=null;origin=new Float32Array(3);cursorObjScale=new Float32Array(3);direction=new Float32Array(3);tempVec=new Float32Array(3);projectionMatrix=new Float32Array(16);viewComponent=null;visible=!0;isDown=!1;lastIsDown=!1;arTouchDown=!1;lastCursorPosOnTarget=new Float32Array(3);hoveringObject=null;hoveringObjectTarget=null;cursorRayScale=new Float32Array(3);globalTarget=new ie(this.engine);cursorPos=new Float32Array(3);collisionGroup=1;cursorRayObject=null;cursorRayScalingAxis=2;cursorObject=null;handedness=0;rayCastMode=0;styleCursor=!0;start(){if(this.collisionMask=1<<this.collisionGroup,this.handedness==0){let n=this.object.getComponent("input");n?(this.handedness=n.handedness||"none",this.input=n):console.warn("cursor component on object",this.object.name,'was configured with handedness "input component", but object has no input component.')}else this.handedness=["left","right","none"][this.handedness-1];if(this.viewComponent=this.object.getComponent(je),this.viewComponent!=null){let n=this.onClick.bind(this);this.engine.canvas.addEventListener("click",n);let r=this.onPointerMove.bind(this);this.engine.canvas.addEventListener("pointermove",r);let s=this.onPointerDown.bind(this);this.engine.canvas.addEventListener("pointerdown",s);let a=this.onPointerUp.bind(this);this.engine.canvas.addEventListener("pointerup",a),qe.invert(this.projectionMatrix,this.viewComponent.projectionMatrix);let l=this.onViewportResize.bind(this);window.addEventListener("resize",l),this.onDestroyCallbacks.push(()=>{this.engine.canvas.removeEventListener("click",n),this.engine.canvas.removeEventListener("pointermove",r),this.engine.canvas.removeEventListener("pointerdown",s),this.engine.canvas.removeEventListener("pointerup",a),window.removeEventListener("resize",l)})}let e=this.setupVREvents.bind(this);this.engine.onXRSessionStart.add(e),this.onDestroyCallbacks.push(()=>{this.engine.onXRSessionStart.remove(e)}),this.cursorRayObject&&(this.cursorRayScale.set(this.cursorRayObject.scalingLocal),this.object.getTranslationWorld(this.origin),this.object.getForward(this.direction),this._setCursorRayTransform(b.add(this.tempVec,this.origin,this.direction)))}onViewportResize(){this.viewComponent&&qe.invert(this.projectionMatrix,this.viewComponent.projectionMatrix)}_setCursorRayTransform(e){if(!this.cursorRayObject)return;let n=b.dist(this.origin,e);this.cursorRayObject.setTranslationLocal([0,0,-n/2]),this.cursorRayScalingAxis!=4&&(this.cursorRayObject.resetScaling(),this.cursorRayScale[this.cursorRayScalingAxis]=n/2,this.cursorRayObject.scale(this.cursorRayScale))}_setCursorVisibility(e){this.visible!=e&&(this.visible=e,this.cursorObject&&(e?(this.cursorObject.resetScaling(),this.cursorObject.scale(this.cursorObjScale)):(this.cursorObjScale.set(this.cursorObject.scalingLocal),this.cursorObject.scale([0,0,0]))))}update(){this.doUpdate(!1)}doUpdate(e){if(this.engine.xrSession)if(this.arTouchDown&&this.input&&this.engine.xrSession.inputSources[0].handedness==="none"&&this.engine.xrSession.inputSources[0].gamepad){let r=this.engine.xrSession.inputSources[0].gamepad.axes;this.direction[0]=r[0],this.direction[1]=-r[1],this.direction[2]=-1,this.updateDirection()}else this.object.getTranslationWorld(this.origin),this.object.getForward(this.direction);let n=this.rayCastMode==0?this.engine.scene.rayCast(this.origin,this.direction,this.collisionMask):this.engine.physics.rayCast(this.origin,this.direction,this.collisionMask,this.maxDistance);n.hitCount>0?this.cursorPos.set(n.locations[0]):this.cursorPos.fill(0),this.hoverBehaviour(n,e),this.cursorObject&&(this.hoveringObject&&(this.cursorPos[0]!=0||this.cursorPos[1]!=0||this.cursorPos[2]!=0)?(this._setCursorVisibility(!0),this.cursorObject.setTranslationWorld(this.cursorPos),this._setCursorRayTransform(this.cursorPos)):this._setCursorVisibility(!1))}hoverBehaviour(e,n){if(e.hitCount>0){if(!this.hoveringObject||!this.hoveringObject.equals(e.objects[0])){if(this.hoveringObject){let a=this.hoveringObject.getComponent(ie);a&&a.onUnhover.notify(this.hoveringObject,this),this.globalTarget.onUnhover.notify(this.hoveringObject,this)}this.hoveringObject=e.objects[0],this.styleCursor&&(this.engine.canvas.style.cursor="pointer");let s=this.hoveringObject.getComponent(ie);s&&(this.hoveringObjectTarget=s,s.onHover.notify(this.hoveringObject,this)),this.globalTarget.onHover.notify(this.hoveringObject,this)}this.hoveringObjectTarget&&(this.hoveringObject.toLocalSpaceTransform(this.tempVec,this.cursorPos),(this.lastCursorPosOnTarget[0]!=this.tempVec[0]||this.lastCursorPosOnTarget[1]!=this.tempVec[1]||this.lastCursorPosOnTarget[2]!=this.tempVec[2])&&(this.hoveringObjectTarget.onMove.notify(this.hoveringObject,this),this.lastCursorPosOnTarget.set(this.tempVec)));let r=this.hoveringObject.getComponent(ie);this.isDown!==this.lastIsDown&&(this.isDown?(r&&r.onDown.notify(this.hoveringObject,this),this.globalTarget.onDown.notify(this.hoveringObject,this)):(r&&r.onUp.notify(this.hoveringObject,this),this.globalTarget.onUp.notify(this.hoveringObject,this))),n&&(r&&r.onClick.notify(this.hoveringObject,this),this.globalTarget.onClick.notify(this.hoveringObject,this))}else if(this.hoveringObject&&e.hitCount==0){let r=this.hoveringObject.getComponent(ie);r&&r.onUnhover.notify(this.hoveringObject,this),this.globalTarget.onUnhover.notify(this.hoveringObject,this),this.hoveringObject=null,this.hoveringObjectTarget=null,this.styleCursor&&(this.engine.canvas.style.cursor="default")}this.lastIsDown=this.isDown}setupVREvents(e){let n=this.onSelect.bind(this);e.addEventListener("select",n);let r=this.onSelectStart.bind(this);e.addEventListener("selectstart",r);let s=this.onSelectEnd.bind(this);e.addEventListener("selectend",s),this.onDestroyCallbacks.push(()=>{this.engine.xrSession&&(e.removeEventListener("select",n),e.removeEventListener("selectstart",r),e.removeEventListener("selectend",s))}),this.onViewportResize()}onSelect(e){e.inputSource.handedness==this.handedness&&this.doUpdate(!0)}onSelectStart(e){this.arTouchDown=!0,e.inputSource.handedness==this.handedness&&(this.isDown=!0)}onSelectEnd(e){this.arTouchDown=!1,e.inputSource.handedness==this.handedness&&(this.isDown=!1)}onPointerMove(e){if(!e.isPrimary)return;let n=this.engine.canvas.getBoundingClientRect(),r=this.updateMousePos(e.clientX,e.clientY,n.width,n.height);this.hoverBehaviour(r,!1)}onClick(e){let n=this.engine.canvas.getBoundingClientRect(),r=this.updateMousePos(e.clientX,e.clientY,n.width,n.height);this.hoverBehaviour(r,!0)}onPointerDown(e){if(!e.isPrimary||e.button!==0)return;let n=this.engine.canvas.getBoundingClientRect(),r=this.updateMousePos(e.clientX,e.clientY,n.width,n.height);this.isDown=!0,this.hoverBehaviour(r,!1)}onPointerUp(e){if(!e.isPrimary||e.button!==0)return;let n=this.engine.canvas.getBoundingClientRect(),r=this.updateMousePos(e.clientX,e.clientY,n.width,n.height);this.isDown=!1,this.hoverBehaviour(r,!1)}updateMousePos(e,n,r,s){let a=e/r,l=n/s;return this.direction[0]=a*2-1,this.direction[1]=-l*2+1,this.direction[2]=-1,this.updateDirection()}updateDirection(){this.object.getTranslationWorld(this.origin),b.transformMat4(this.direction,this.direction,this.projectionMatrix),b.normalize(this.direction,this.direction),b.transformQuat(this.direction,this.direction,this.object.transformWorld);let e=this.rayCastMode==0?this.engine.scene.rayCast(this.origin,this.direction,this.collisionMask):this.engine.physics.rayCast(this.origin,this.direction,this.collisionMask,this.maxDistance);return e.hitCount>0?this.cursorPos.set(e.locations[0]):this.cursorPos.fill(0),e}onDeactivate(){if(this._setCursorVisibility(!1),this.hoveringObject){let e=this.hoveringObject.getComponent(ie);e&&e.onUnhover.notify(this.hoveringObject,this),this.globalTarget.onUnhover.notify(this.hoveringObject,this)}this.cursorRayObject&&this.cursorRayObject.scale([0,0,0])}onActivate(){this._setCursorVisibility(!0)}onDestroy(){for(let e of this.onDestroyCallbacks)e()}};M(Se,"TypeName","cursor");et([ve.int(1)],Se.prototype,"collisionGroup",void 0);et([ve.object()],Se.prototype,"cursorRayObject",void 0);et([ve.enum(["x","y","z","none"],"z")],Se.prototype,"cursorRayScalingAxis",void 0);et([ve.object()],Se.prototype,"cursorObject",void 0);et([ve.enum(["input component","left","right","none"],"input component")],Se.prototype,"handedness",void 0);et([ve.enum(["collision","physx"],"collision")],Se.prototype,"rayCastMode",void 0);et([ve.bool(!0)],Se.prototype,"styleCursor",void 0);var Qd=function(t,e,n,r){var s=arguments.length,a=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,l;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(l=t[c])&&(a=(s<3?l(a):s>3?l(e,n,a):l(e,n))||a);return s>3&&a&&Object.defineProperty(e,n,a),a},Bn=class extends O{obj=null;start(){let e=new Float32Array(3);ne.getTranslation(e,this.object.transformWorld),console.log("Debug object:",this.object.name),console.log("Other object:",this.obj?.name),console.log("	translation",e),console.log("	transformWorld",this.object.transformWorld),console.log("	transformLocal",this.object.transformLocal)}};M(Bn,"TypeName","debug-object");Qd([ve.object()],Bn.prototype,"obj",void 0);var Wn=class extends O{start(){this.engine.xr?this.setFixedFoveation():this.engine.onXRSessionStart.push(this.setFixedFoveation.bind(this))}setFixedFoveation(){this.engine.xr.baseLayer.fixedFoveation=this.fixedFoveation}};M(Wn,"TypeName","fixed-foveation"),M(Wn,"Properties",{fixedFoveation:{type:P.Float,default:.5}});var Xn=new Float32Array(3),nn=new Float32Array(4);function Yn(t,e){let n=e.orientation;nn[0]=n.x,nn[1]=n.y,nn[2]=n.z,nn[3]=n.w;let r=e.position;Xn[0]=r.x,Xn[1]=r.y,Xn[2]=r.z,t.resetTranslationRotation(),t.transformLocal.set(nn),t.translate(Xn)}var rn=["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"],Gn=class extends O{init(){this.handedness=["left","right"][this.handedness]}start(){if(this.joints=[],this.session=null,this.hasPose=!1,this._childrenActive=!0,!("XRHand"in window)){console.warn("WebXR Hand Tracking not supported by this browser."),this.active=!1;return}if(this.handSkin){let n=this.handSkin.jointIds;this.joints[rn[0]]=this.engine.wrapObject(n[0]);for(let r=0;r<n.length;++r){let s=this.engine.wrapObject(n[r]);this.joints[s.name]=s}return}for(let e=0;e<=rn.length;++e){let n=this.engine.scene.addObject(this.object.parent),r=n.addComponent("mesh");r.mesh=this.jointMesh,r.material=this.jointMaterial,this.joints[rn[e]]=n}}update(e){if(this.session||this.engine.xr&&this.setupVREvents(this.engine.xr.session),!!this.session){if(this.hasPose=!1,this.session&&this.session.inputSources)for(let n=0;n<=this.session.inputSources.length;++n){let r=this.session.inputSources[n];if(!r||!r.hand||r.handedness!=this.handedness)continue;if(this.hasPose=!0,r.hand.get("wrist")!==null){let l=Module.webxr_frame.getJointPose(r.hand.get("wrist"),this.engine.xr.currentReferenceSpace);l&&Yn(this.object,l.transform)}let s=new Float32Array(3),a=new Float32Array(4);L.invert(a,this.object.transformLocal),this.object.getTranslationLocal(s);for(let l=0;l<rn.length;++l){let c=rn[l],h=this.joints[c];if(h==null)continue;let d=null;if(r.hand.get(c)!==null&&(d=this.engine.xr.frame.getJointPose(r.hand.get(c),this.engine.xr.currentReferenceSpace)),d!==null)if(this.handSkin)h.resetTranslationRotation(),h.translate([d.transform.position.x-s[0],d.transform.position.y-s[1],d.transform.position.z-s[2]]),h.rotate(a),h.rotateObject([d.transform.orientation.x,d.transform.orientation.y,d.transform.orientation.z,d.transform.orientation.w]);else{Yn(this.object,p.transform);let i=d.radius||.007;h.scale([i,i,i])}else this.handSkin||h.scale([0,0,0])}}!this.hasPose&&this._childrenActive?(this._childrenActive=!1,this.deactivateChildrenWithoutPose&&this.setChildrenActive(!1),this.controllerToDeactivate&&(this.controllerToDeactivate.active=!0,this.setChildrenActive(!0,this.controllerToDeactivate))):this.hasPose&&!this._childrenActive&&(this._childrenActive=!0,this.deactivateChildrenWithoutPose&&this.setChildrenActive(!0),this.controllerToDeactivate&&(this.controllerToDeactivate.active=!1,this.setChildrenActive(!1,this.controllerToDeactivate)))}}setChildrenActive(e,n){n=n||this.object;let r=n.children;for(let s of r)s.active=e,this.setChildrenActive(e,s)}isGrabbing(){let e=[0,0,0];ne.getTranslation(e,this.joints["index-finger-tip"].transformLocal);let n=[0,0,0];return ne.getTranslation(n,this.joints["thumb-tip"].transformLocal),b.sqrDist(n,e)<.001}setupVREvents(e){this.session=e}};M(Gn,"TypeName","hand-tracking"),M(Gn,"Properties",{handedness:{type:P.Enum,default:"left",values:["left","right"]},jointMesh:{type:P.Mesh,default:null},jointMaterial:{type:P.Material,default:null},handSkin:{type:P.Skin,default:null},deactivateChildrenWithoutPose:{type:P.Bool,default:!0},controllerToDeactivate:{type:P.Object}});var s1=tt(ii(),1);var $n=class extends O{init(){this.origin=new Float32Array(3),this.fwd=new Float32Array(3),this.up=new Float32Array(3)}update(){this.spatial&&(this.object.getTranslationWorld(this.origin),this.object.getForward(this.fwd),this.object.getUp(this.up),Howler.pos(this.origin[0],this.origin[1],this.origin[2]),Howler.orientation(this.fwd[0],this.fwd[1],this.fwd[2],this.up[0],this.up[1],this.up[2]))}};M($n,"TypeName","howler-audio-listener"),M($n,"Properties",{spatial:{type:P.Bool,default:!0}});var yo=tt(ii(),1);var Zn=class extends O{start(){this.audio=new yo.Howl({src:[this.src],loop:this.loop,volume:this.volume,autoplay:this.autoplay}),this.lastPlayedAudioId=null,this.origin=new Float32Array(3),this.lastOrigin=new Float32Array(3),this.spatial&&this.autoplay&&(this.updatePosition(),this.play())}update(){!this.spatial||!this.lastPlayedAudioId||(this.object.getTranslationWorld(this.origin),(Math.abs(this.lastOrigin[0]-this.origin[0])>.005||Math.abs(this.lastOrigin[1]-this.origin[1])>.005||Math.abs(this.lastOrigin[2]-this.origin[2])>.005)&&this.updatePosition())}updatePosition(){this.audio.pos(this.origin[0],this.origin[1],this.origin[2],this.lastPlayedAudioId),this.lastOrigin.set(this.origin)}play(){this.lastPlayedAudioId&&this.audio.stop(this.lastPlayedAudioId),this.lastPlayedAudioId=this.audio.play(),this.spatial&&this.updatePosition()}stop(){this.lastPlayedAudioId&&(this.audio.stop(this.lastPlayedAudioId),this.lastPlayedAudioId=null)}onDeactivate(){this.stop()}};M(Zn,"TypeName","howler-audio-source"),M(Zn,"Properties",{volume:{type:P.Float,default:1},spatial:{type:P.Bool,default:!0},loop:{type:P.Bool,default:!1},autoplay:{type:P.Bool,default:!1},src:{type:P.String,default:""}});var Jn=class extends O{start(){if(!this.material)throw Error("image-texture: material property not set");this.engine.textures.load(this.url,"anonymous").then(e=>{let n=this.material,r=n.shader;r==="Flat Opaque Textured"?n.flatTexture=e:r==="Phong Opaque Textured"||r==="Foliage"?n.diffuseTexture=e:r==="Background"?n.texture=e:r==="Physical Opaque Textured"?n.albedoTexture=e:console.error("Shader",r,"not supported by image-texture")}).catch(console.err)}};M(Jn,"TypeName","image-texture"),M(Jn,"Properties",{url:{type:P.String},material:{type:P.Material}});var Kn=class extends O{init(){this.currentRotationY=0,this.currentRotationX=0,this.origin=new Float32Array(3),this.parentOrigin=new Float32Array(3),this.rotationX=0,this.rotationY=0}start(){document.addEventListener("mousemove",n=>{if(this.active&&(this.mouseDown||!this.requireMouseDown)){this.rotationY=-this.sensitity*n.movementX/100,this.rotationX=-this.sensitity*n.movementY/100,this.currentRotationX+=this.rotationX,this.currentRotationY+=this.rotationY,this.currentRotationX=Math.min(1.507,this.currentRotationX),this.currentRotationX=Math.max(-1.507,this.currentRotationX),this.object.getTranslationWorld(this.origin);let r=this.object.parent;r!==null&&(r.getTranslationWorld(this.parentOrigin),b.sub(this.origin,this.origin,this.parentOrigin)),this.object.resetTranslationRotation(),this.object.rotateAxisAngleRad([1,0,0],this.currentRotationX),this.object.rotateAxisAngleRad([0,1,0],this.currentRotationY),this.object.translate(this.origin)}});let e=this.engine.canvas;this.pointerLockOnClick&&e.addEventListener("mousedown",()=>{e.requestPointerLock=e.requestPointerLock||e.mozRequestPointerLock||e.webkitRequestPointerLock,e.requestPointerLock()}),this.requireMouseDown&&(this.mouseButtonIndex==2&&e.addEventListener("contextmenu",n=>{n.preventDefault()},!1),e.addEventListener("mousedown",n=>{if(n.button==this.mouseButtonIndex&&(this.mouseDown=!0,document.body.style.cursor="grabbing",n.button==1))return n.preventDefault(),!1}),e.addEventListener("mouseup",n=>{n.button==this.mouseButtonIndex&&(this.mouseDown=!1,document.body.style.cursor="initial")}))}};M(Kn,"TypeName","mouse-look"),M(Kn,"Properties",{sensitity:{type:P.Float,default:.25},requireMouseDown:{type:P.Bool,default:!0},mouseButtonIndex:{type:P.Int},pointerLockOnClick:{type:P.Bool,default:!1}});var er=class extends O{start(){this.object.resetTranslationRotation(),this.object.translate([0,this.height,0]),this.onSessionStartCallback=this.onXRSessionStart.bind(this),this.onSessionEndCallback=this.onXRSessionEnd.bind(this)}onActivate(){this.engine.onXRSessionStart.add(this.onSessionStartCallback),this.engine.onXRSessionEnd.add(this.onSessionEndCallback)}onDeactivate(){this.engine.onXRSessionStart.remove(this.onSessionStartCallback),this.engine.onXRSessionEnd.remove(this.onSessionEndCallback)}onXRSessionStart(){["local","viewer"].includes(this.engine.xr.currentReferenceSpace)||this.object.resetTranslationRotation()}onXRSessionEnd(){["local","viewer"].includes(this.engine.xr.currentReferenceSpace)||(this.object.resetTranslationRotation(),this.object.translate([0,this.height,0]))}};M(er,"TypeName","player-height"),M(er,"Properties",{height:{type:P.Float,default:1.75}});var tr=class extends O{start(){this.engine.xrSession?this.setTargetFramerate(this.engine.xrSession):this.engine.onXRSessionStart.push(this.setTargetFramerate.bind(this))}setTargetFramerate(e){if(e.supportedFrameRates&&e.updateTargetFrameRate){let n=this.engine.xrSession.supportedFrameRates;n.sort((r,s)=>Math.abs(r-this.framerate)-Math.abs(s-this.framerate)),this.engine.xrSession.updateTargetFrameRate(n[0])}}};M(tr,"TypeName","target-framerate"),M(tr,"Properties",{framerate:{type:P.Float,default:90}});var nr=class extends O{init(){if(this._prevThumbstickAxis=new Float32Array(2),this._tempVec=new Float32Array(3),this._tempVec0=new Float32Array(3),this._currentIndicatorRotation=0,this.input=this.object.getComponent("input"),!this.input){console.error(this.object.name,"generic-teleport-component.js: input component is required on the object");return}if(!this.teleportIndicatorMeshObject){console.error(this.object.name,"generic-teleport-component.js: Teleport indicator mesh is missing");return}if(!this.camRoot){console.error(this.object.name,"generic-teleport-component.js: camRoot not set");return}this.isIndicating=!1,this.indicatorHidden=!0,this.hitSpot=new Float32Array(3),this._hasHit=!1,this._extraRotation=0,this._currentStickAxes=new Float32Array(2)}start(){if(this.cam&&(this.isMouseIndicating=!1,canvas.addEventListener("mousedown",this.onMouseDown.bind(this)),canvas.addEventListener("mouseup",this.onMouseUp.bind(this))),this.handedness==0){let e=this.object.getComponent("input");e?(this.handedness=e.handedness,this.input=e):console.warn("teleport component on object",this.object.name,'was configured with handedness "input component", but object has no input component.')}else this.handedness=["left","right"][this.handedness-1];this.engine.onXRSessionStart.push(this.setupVREvents.bind(this)),this.teleportIndicatorMeshObject.active=!1}_getCamRotation(){return this.eyeLeft.getForward(this._tempVec),this._tempVec[1]=0,b.normalize(this._tempVec,this._tempVec),Math.atan2(this._tempVec[0],this._tempVec[2])}update(){let e=0;if(this.gamepad&&this.gamepad.axes&&(this._currentStickAxes[0]=this.gamepad.axes[2],this._currentStickAxes[1]=this.gamepad.axes[3],e=Math.abs(this._currentStickAxes[0])+Math.abs(this._currentStickAxes[1])),!this.isIndicating&&this._prevThumbstickAxis[1]>=this.thumbstickActivationThreshhold&&this._currentStickAxes[1]<this.thumbstickActivationThreshhold?this.isIndicating=!0:this.isIndicating&&e<this.thumbstickDeactivationThreshhold&&(this.isIndicating=!1,this.teleportIndicatorMeshObject.active=!1,this._hasHit&&this._teleportPlayer(this.hitSpot,this._extraRotation)),this.isIndicating&&this.teleportIndicatorMeshObject&&this.input){let n=this._tempVec0;ne.getTranslation(n,this.object.transformWorld);let r=this.object.getForward(this._tempVec),s=this.rayHit=this.rayCastMode==0?this.engine.scene.rayCast(n,r,1<<this.floorGroup):this.engine.physics.rayCast(n,r,1<<this.floorGroup,this.maxDistance);s.hitCount>0?(this.indicatorHidden=!1,this._extraRotation=Math.PI+Math.atan2(this._currentStickAxes[0],this._currentStickAxes[1]),this._currentIndicatorRotation=this._getCamRotation()+(this._extraRotation-Math.PI),this.teleportIndicatorMeshObject.resetTranslationRotation(),this.teleportIndicatorMeshObject.rotateAxisAngleRad([0,1,0],this._currentIndicatorRotation),this.teleportIndicatorMeshObject.translate(s.locations[0]),this.teleportIndicatorMeshObject.translate([0,this.indicatorYOffset,0]),this.teleportIndicatorMeshObject.active=!0,this.hitSpot.set(s.locations[0]),this._hasHit=!0):(this.indicatorHidden||(this.teleportIndicatorMeshObject.active=!1,this.indicatorHidden=!0),this._hasHit=!1)}else this.teleportIndicatorMeshObject&&this.isMouseIndicating&&this.onMousePressed();this._prevThumbstickAxis.set(this._currentStickAxes)}setupVREvents(e){if(this.session=e,e.addEventListener("end",function(){this.gamepad=null,this.session=null}.bind(this)),e.inputSources&&e.inputSources.length)for(let n=0;n<e.inputSources.length;n++){let r=e.inputSources[n];r.handedness==this.handedness&&(this.gamepad=r.gamepad)}e.addEventListener("inputsourceschange",function(n){if(n.added&&n.added.length)for(let r=0;r<n.added.length;r++){let s=n.added[r];s.handedness==this.handedness&&(this.gamepad=s.gamepad)}}.bind(this))}onMouseDown(){this.isMouseIndicating=!0}onMouseUp(){this.isMouseIndicating=!1,this.teleportIndicatorMeshObject.active=!1,this._hasHit&&this._teleportPlayer(this.hitSpot,0)}onMousePressed(){let e=[0,0,0];ne.getTranslation(e,this.cam.transformWorld);let n=this.cam.getForward(this._tempVec),r=this.rayHit=this.rayCastMode==0?this.engine.scene.rayCast(e,n,1<<this.floorGroup):this.engine.physics.rayCast(e,n,1<<this.floorGroup,this.maxDistance);r.hitCount>0?(this.indicatorHidden=!1,n[1]=0,b.normalize(n,n),this._currentIndicatorRotation=-Math.sign(n[2])*Math.acos(n[0])-Math.PI*.5,this.teleportIndicatorMeshObject.resetTranslationRotation(),this.teleportIndicatorMeshObject.rotateAxisAngleRad([0,1,0],this._currentIndicatorRotation),this.teleportIndicatorMeshObject.translate(r.locations[0]),this.teleportIndicatorMeshObject.active=!0,this.hitSpot=r.locations[0],this._hasHit=!0):(this.indicatorHidden||(this.teleportIndicatorMeshObject.active=!1,this.indicatorHidden=!0),this._hasHit=!1)}_teleportPlayer(e,n){this.camRoot.rotateAxisAngleRad([0,1,0],n);let r=this._tempVec,s=this._tempVec0;this.session?(this.eyeLeft.getTranslationWorld(r),this.eyeRight.getTranslationWorld(s),b.add(r,r,s),b.scale(r,r,.5)):this.cam.getTranslationWorld(r),this.camRoot.getTranslationWorld(s),b.sub(r,s,r),r[0]+=e[0],r[1]=e[1],r[2]+=e[2],this.camRoot.setTranslationWorld(r)}};M(nr,"TypeName","teleport"),M(nr,"Properties",{teleportIndicatorMeshObject:{type:P.Object},camRoot:{type:P.Object},cam:{type:P.Object},eyeLeft:{type:P.Object},eyeRight:{type:P.Object},handedness:{type:P.Enum,values:["input component","left","right","none"],default:"input component"},floorGroup:{type:P.Int,default:1},thumbstickActivationThreshhold:{type:P.Float,default:-.7},thumbstickDeactivationThreshhold:{type:P.Float,default:.3},indicatorYOffset:{type:P.Float,default:.01},rayCastMode:{type:P.Enum,values:["collision","physx"],default:"collision"},maxDistance:{type:P.Float,default:100}});var rr=b.create(),_e=b.create(),sn=b.create(),ir=class extends O{init(){this.points=new Array(this.segments+1);for(let e=0;e<this.points.length;++e)this.points[e]=b.create();this.currentPointOffset=0,this.up=[0,1,0],this.timeTillNext=this.interval}start(){this.trailContainer=this.engine.scene.addObject(),this.meshComp=this.trailContainer.addComponent("mesh"),this.meshComp.material=this.material;let e=2*this.points.length;this.indexData=new Uint32Array(6*this.segments);for(let n=0,r=0;n<e-2;n+=2,r+=6)this.indexData.subarray(r,r+6).set([n+1,n+0,n+2,n+2,n+3,n+1]);this.mesh=new kt(this.engine,{vertexCount:e,indexData:this.indexData,indexType:be.UnsignedInt}),this.meshComp.mesh=this.mesh}updateVertices(){let e=this.mesh.attribute(Je.Position),n=this.mesh.attribute(Je.TextureCoordinate),r=this.mesh.attribute(Je.Normal);b.set(rr,0,0,0);for(let s=0;s<this.points.length;++s){let a=this.points[(this.currentPointIndex+s+1)%this.points.length],l=this.points[(this.currentPointIndex+s+2)%this.points.length];s!==this.points.length-1&&b.sub(rr,l,a),b.cross(_e,this.up,rr),b.normalize(_e,_e);let c=1-this.timeTillNext/this.interval,h=(s-c)/this.segments;b.scale(_e,_e,(this.taper?h:1)*this.width/2),e.set(s*2,[a[0]-_e[0],a[1]-_e[1],a[2]-_e[2]]),e.set(s*2+1,[a[0]+_e[0],a[1]+_e[1],a[2]+_e[2]]),r&&(b.cross(sn,rr,_e),b.normalize(sn,sn),r.set(s*2,sn),r.set(s*2+1,sn)),n&&(n.set(s*2,[0,h]),n.set(s*2+1,[1,h]))}this.mesh.update()}resetTrail(){this.object.getTranslationWorld(this.points[0]);for(let e=1;e<this.points.length;++e)b.copy(this.points[e],this.points[0]);this.currentPointIndex=0,this.timeTillNext=this.interval}update(e){this.timeTillNext-=e,e>this.resetThreshold&&this.resetTrail(),this.timeTillNext<0&&(this.currentPointIndex=(this.currentPointIndex+1)%this.points.length,this.timeTillNext=this.timeTillNext%this.interval+this.interval),this.object.getTranslationWorld(this.points[this.currentPointIndex]),this.updateVertices()}onActivate(){this.resetTrail()}onDestroy(){this.trailContainer.destroy(),this.mesh.destroy()}};M(ir,"TypeName","trail"),M(ir,"Properties",{material:{type:P.Material},segments:{type:P.Int,default:50},interval:{type:P.Float,default:.1},width:{type:P.Float,default:1},taper:{type:P.Bool,default:!0},resetThreshold:{type:P.Float,default:.5}});Math.clamp=function(t,e,n){return Math.max(e,Math.min(t,n))};var $d=function(){let t=new Float32Array(3),e=new Float32Array(3),n=new Float32Array(3),r=new Float32Array(3),s=new Float32Array(3),a=new Float32Array(3),l=new Float32Array(3),c=new Float32Array(4),h=new Float32Array(4),d=new Float32Array(4),i=new Float32Array(4);return function(o,_,m,u,g,f,w,v,x,T){b.sub(n,u,m);let A=b.length(n);b.sub(t,u,g);let j=b.length(t);b.sub(t,f,m);let I=Math.clamp(b.length(t),w,A+j-w);b.sub(e,g,m),b.sub(r,m,u),b.sub(s,g,u),b.normalize(e,e),b.normalize(n,n),b.normalize(r,r),b.normalize(s,s),b.normalize(t,t);let E=Math.acos(Math.clamp(b.dot(e,n),-1,1)),D=Math.acos(Math.clamp(b.dot(r,s),-1,1)),z=Math.acos(Math.clamp(b.dot(e,t),-1,1)),q=Math.acos(Math.clamp((j*j-A*A-I*I)/(-2*A*I),-1,1)),H=Math.acos(Math.clamp((I*I-A*A-j*j)/(-2*A*j),-1,1));b.sub(e,g,m),b.sub(n,u,m),b.sub(t,f,m),b.cross(a,e,n),b.cross(l,e,t),T?(b.sub(n,T,u),b.transformQuat(n,[0,0,-1],x)):b.sub(n,u,m);let k=b.length(a);k==0?a.set([1,0,0]):b.scale(a,a,1/k),b.normalize(l,l),L.conjugate(v,v),L.setAxisAngle(h,b.transformQuat(c,a,v),q-E),L.setAxisAngle(i,b.transformQuat(c,l,v),z),L.mul(o,o,L.mul(c,h,i)),L.normalize(o,o),L.conjugate(x,x),L.setAxisAngle(d,b.transformQuat(c,a,x),H-D),L.mul(_,_,d),L.normalize(_,_)}}(),sr=class extends O{init(){this.pos=new Float32Array(3*7),this.p=[this.pos.subarray(0,3),this.pos.subarray(3,6),this.pos.subarray(6,9),this.pos.subarray(9,12),this.pos.subarray(12,15),this.pos.subarray(15,18),this.pos.subarray(18,21)]}update(){let e=this.p;this.root.getTranslationWorld(e[0]),this.middle.getTranslationWorld(e[1]),this.end.getTranslationWorld(e[2]),this.target.getTranslationWorld(e[3]);let n=e[4],r=e[5];this.root.getTranslationLocal(n),this.middle.getTranslationLocal(r),this.helper&&this.helper.getTranslationWorld(e[6]),$d(this.root.transformLocal,this.middle.transformLocal,e[0],e[1],e[2],e[3],.01,this.root.transformWorld.subarray(0,4),this.middle.transformWorld.subarray(0,4),this.helper?e[6]:null),this.root.setTranslationLocal(n),this.middle.setTranslationLocal(r),this.root.setDirty(),this.middle.setDirty()}};M(sr,"TypeName","two-joint-ik-solver"),M(sr,"Properties",{root:{type:P.Object},middle:{type:P.Object},end:{type:P.Object},target:{type:P.Object},helper:{type:P.Object}});var ar=class extends O{init(){if(!this.material)throw Error("video-texture: material property not set");this.loaded=!1,this.frameUpdateRequested=!0}start(){if(this.video=document.createElement("video"),this.video.src=this.url,this.video.crossOrigin="anonymous",this.video.playsInline=!0,this.video.loop=this.loop,this.video.muted=this.muted,this.video.addEventListener("playing",()=>{this.loaded=!0}),this.autoplay){let e=()=>{this.video.play(),window.removeEventListener("click",e),window.removeEventListener("touchstart",e)};window.addEventListener("click",e),window.addEventListener("touchstart",e)}}applyTexture(){let e=this.material,n=e.shader,r=this.texture=new Jt(this.engine,this.video);n==="Flat Opaque Textured"?e.flatTexture=r:n==="Phong Opaque Textured"||n==="Foliage"?e.diffuseTexture=r:n==="Background"?e.texture=r:n==="Physical Opaque Textured"?e.albedoTexture=r:console.error("Shader",n,"not supported by video-texture"),"requestVideoFrameCallback"in this.video?this.video.requestVideoFrameCallback(this.updateVideo.bind(this)):this.video.addEventListener("timeupdate",()=>{this.frameUpdateRequested=!0})}update(e){this.loaded&&this.frameUpdateRequested&&(this.texture?this.texture.update():this.applyTexture(),this.frameUpdateRequested=!1)}updateVideo(){this.frameUpdateRequested=!0,this.video.requestVideoFrameCallback(this.updateVideo.bind(this))}};M(ar,"TypeName","video-texture"),M(ar,"Properties",{url:{type:P.String},material:{type:P.Material},loop:{type:P.Bool,default:!0},autoplay:{type:P.Bool,default:!0},muted:{type:P.Bool,default:!0}});var or=class extends O{start(){this.components=[],this.getComponents(this.object),this.onXRSessionEnd(),this.engine.onXRSessionStart.push(this.onXRSessionStart.bind(this)),this.engine.onXRSessionEnd.push(this.onXRSessionEnd.bind(this))}getComponents(e){let n=e.getComponents().filter(r=>r.type!=="vr-mode-active-switch");if(this.components=this.components.concat(n),this.affectChildren){let r=e.children;for(let s=0;s<r.length;++s)this.getComponents(r[s])}}setComponentsActive(e){let n=this.components;for(let r=0;r<n.length;++r)n[r].active=e}onXRSessionStart(){this.active&&this.setComponentsActive(this.activateComponents==0)}onXRSessionEnd(){this.active&&this.setComponentsActive(this.activateComponents!=0)}};M(or,"TypeName","vr-mode-active-switch"),M(or,"Properties",{activateComponents:{type:P.Enum,values:["in VR","in non-VR"],default:"in VR"},affectChildren:{type:P.Bool,default:!0}});var Zd={X:[1,0,0],Y:[0,1,0],Z:[0,0,1]},Jd={PositiveX:[1,0,0],NegativeX:[-1,0,0],PositiveY:[0,1,0],NegativeY:[0,-1,0],PositiveZ:[0,0,1],NegativeZ:[0,0,-1]},lr=class extends O{meta=null;bones={hips:null,spine:null,chest:null,upperChest:null,neck:null,head:null,leftEye:null,rightEye:null,jaw:null,leftUpperLeg:null,leftLowerLeg:null,leftFoot:null,leftToes:null,rightUpperLeg:null,rightLowerLeg:null,rightFoot:null,rightToes:null,leftShoulder:null,leftUpperArm:null,leftLowerArm:null,leftHand:null,rightShoulder:null,rightUpperArm:null,rightLowerArm:null,rightHand:null,leftThumbMetacarpal:null,leftThumbProximal:null,leftThumbDistal:null,leftIndexProximal:null,leftIndexIntermediate:null,leftIndexDistal:null,leftMiddleProximal:null,leftMiddleIntermediate:null,leftMiddleDistal:null,leftRingProximal:null,leftRingIntermediate:null,leftRingDistal:null,leftLittleProximal:null,leftLittleIntermediate:null,leftLittleDistal:null,rightThumbMetacarpal:null,rightThumbProximal:null,rightThumbDistal:null,rightIndexProximal:null,rightIndexIntermediate:null,rightIndexDistal:null,rightMiddleProximal:null,rightMiddleIntermediate:null,rightMiddleDistal:null,rightRingProximal:null,rightRingIntermediate:null,rightRingDistal:null,rightLittleProximal:null,rightLittleIntermediate:null,rightLittleDistal:null};restPose={};_nodeConstraints=[];_springChains=[];_sphereColliders=[];_capsuleColliders=[];_firstPersonAnnotations=[];_lookAt=null;_initialized=!1;init(){this._tempV3=b.create(),this._tempV3A=b.create(),this._tempV3B=b.create(),this._tempQuat=L.create(),this._tempQuatA=L.create(),this._tempQuatB=L.create(),this._tempMat4A=qe.create(),this._tempQuat2=ne.create(),this._tailToShape=b.create(),this._headToTail=b.create(),this._inertia=b.create(),this._stiffness=b.create(),this._external=b.create(),this._rightVector=b.set(b.create(),1,0,0),this._upVector=b.set(b.create(),0,1,0),this._forwardVector=b.set(b.create(),0,0,1),this._identityQuat=L.identity(L.create()),this._rad2deg=180/Math.PI}start(){if(!this.src){console.error("vrm: src property not set");return}this.engine.scene.append(this.src,{loadGltfExtensions:!0}).then(({root:e,extensions:n})=>{e.children.forEach(r=>r.parent=this.object),this._initializeVrm(n),e.destroy()})}_initializeVrm(e){if(this._initialized)throw Error("VRM component has already been initialized");let n=e.root.VRMC_vrm;if(!n)throw Error("Missing VRM extensions");if(n.specVersion!=="1.0")throw Error(`Unsupported VRM version, only 1.0 is supported, but encountered '${n.specVersion}'`);this.meta=n.meta,this._parseHumanoid(n.humanoid,e),n.firstPerson&&this._parseFirstPerson(n.firstPerson,e),n.lookAt&&this._parseLookAt(n.lookAt),this._findAndParseNodeConstraints(e);let r=e.root.VRMC_springBone;r&&this._parseAndInitializeSpringBones(r,e),this._initialized=!0}_parseHumanoid(e,n){for(let r in e.humanBones){if(!(r in this.bones)){console.warn(`Unrecognized bone '${r}'`);continue}let s=e.humanBones[r].node,a=n.idMapping[s];this.bones[r]=this.engine.wrapObject(a),this.restPose[r]=L.copy(L.create(),this.bones[r].rotationLocal)}}_parseFirstPerson(e,n){for(let r of e.meshAnnotations){let s={node:this.engine.wrapObject(n.idMapping[r.node]),firstPerson:!0,thirdPerson:!0};switch(r.type){case"firstPersonOnly":s.thirdPerson=!1;break;case"thirdPersonOnly":s.firstPerson=!1;break;case"both":break;case"auto":console.warn("First person mesh annotation type 'auto' is not supported, treating as 'both'!");break;default:console.error(`Invalid mesh annotation type '${r.type}'`);break}this._firstPersonAnnotations.push(s)}}_parseLookAt(e){if(e.type!=="bone"){console.warn(`Unsupported lookAt type '${e.type}', only 'bone' is supported`);return}let n=r=>({inputMaxValue:r.inputMaxValue,outputScale:r.outputScale});this._lookAt={offsetFromHeadBone:e.offsetFromHeadBone||[0,0,0],horizontalInner:n(e.rangeMapHorizontalInner),horizontalOuter:n(e.rangeMapHorizontalOuter),verticalDown:n(e.rangeMapVerticalDown),verticalUp:n(e.rangeMapVerticalUp)}}_findAndParseNodeConstraints(e){let n=r=>{let s=e.node[r.objectId];if(s&&"VRMC_node_constraint"in s){let l=s.VRMC_node_constraint.constraint,c,h;if("roll"in l?(c="roll",h=Zd[l.roll.rollAxis]):"aim"in l?(c="aim",h=Jd[l.aim.aimAxis]):"rotation"in l&&(c="rotation"),c){let d=this.engine.wrapObject(e.idMapping[l[c].source]);this._nodeConstraints.push({type:c,source:d,destination:r,axis:h,weight:l[c].weight,destinationRestLocalRotation:L.copy(L.create(),r.rotationLocal),sourceRestLocalRotation:L.copy(L.create(),d.rotationLocal),sourceRestLocalRotationInv:L.invert(L.create(),d.rotationLocal)})}else console.warn("Unrecognized or invalid VRMC_node_constraint, ignoring it")}for(let a of r.children)n(a)};n(this.object)}_parseAndInitializeSpringBones(e,n){let r=(e.colliders||[]).map((a,l)=>{let c="capsule"in a.shape?"capsule":"sphere";return{id:l,object:this.engine.wrapObject(n.idMapping[a.node]),shape:{isCapsule:c==="capsule",radius:a.shape[c].radius,offset:a.shape[c].offset,tail:a.shape[c].tail},cache:{head:b.create(),tail:b.create()}}});this._sphereColliders=r.filter(a=>!a.shape.isCapsule),this._capsuleColliders=r.filter(a=>a.shape.isCapsule);let s=(e.colliderGroups||[]).map(a=>({name:a.name,colliders:a.colliders.map(l=>r[l])}));for(let a of e.springs){let l=[];for(let h of a.joints){let d={hitRadius:0,stiffness:1,gravityPower:0,gravityDir:[0,-1,0],dragForce:.5,node:null,state:null};Object.assign(d,h),d.node=this.engine.wrapObject(n.idMapping[d.node]),l.push(d)}let c=(a.colliderGroups||[]).flatMap(h=>s[h].colliders);this._springChains.push({name:a.name,center:a.center?this.engine.wrapObject(n.idMapping[a.center]):null,joints:l,sphereColliders:c.filter(h=>!h.shape.isCapsule),capsuleColliders:c.filter(h=>h.shape.isCapsule)})}for(let a of this._springChains)for(let l=0;l<a.joints.length-1;++l){let c=a.joints[l],h=a.joints[l+1],d=c.node.getTranslationWorld(b.create()),i=h.node.getTranslationWorld(b.create()),o=b.subtract(this._tempV3A,d,i),_={prevTail:i,currentTail:b.copy(b.create(),i),initialLocalRotation:L.copy(L.create(),c.node.rotationLocal),initialLocalTransformInvert:ne.invert(ne.create(),c.node.transformLocal),boneAxis:b.normalize(b.create(),h.node.getTranslationLocal(this._tempV3)),boneLength:Math.max(.01,b.length(o)),prevTailCenter:null,currentTailCenter:null};a.center&&(_.prevTailCenter=a.center.transformPointInverseWorld(b.create(),i),_.currentTailCenter=b.copy(b.create(),i)),c.state=_}}update(e){this._initialized&&(this._resolveLookAt(),this._resolveConstraints(),this._updateSpringBones(e))}_rangeMap(e,n){let r=e.inputMaxValue,s=e.outputScale;return Math.min(n,r)/r*s}_resolveLookAt(){if(!this._lookAt||!this.lookAtTarget)return;let e=this.bones.head.transformPointWorld(this._tempV3A,this._lookAt.offsetFromHeadBone),n=this.lookAtTarget.getTranslationWorld(this._tempV3B),r=b.sub(this._tempV3A,n,e);b.normalize(r,r),this.bones.head.parent.transformVectorInverseWorld(r);let s=b.dot(r,this._forwardVector),a=b.dot(r,this._rightVector),l=Math.atan2(a,s)*this._rad2deg,c=Math.sqrt(a*a+s*s),h=b.dot(r,this._upVector),d=Math.atan2(-h,c)*this._rad2deg;if(d>0?d=this._rangeMap(this._lookAt.verticalDown,d):d=-this._rangeMap(this._lookAt.verticalUp,-d),this.bones.leftEye){let i=l;i>0?i=this._rangeMap(this._lookAt.horizontalInner,i):i=-this._rangeMap(this._lookAt.horizontalOuter,-i);let o=L.fromEuler(this._tempQuatA,d,i,0);this.bones.leftEye.rotationLocal=L.multiply(o,this.restPose.leftEye,o)}if(this.bones.rightEye){let i=l;i>0?i=this._rangeMap(this._lookAt.horizontalOuter,i):i=-this._rangeMap(this._lookAt.horizontalInner,-i);let o=L.fromEuler(this._tempQuatA,d,i,0);this.bones.rightEye.rotationLocal=L.multiply(o,this.restPose.rightEye,o)}}_resolveConstraints(){for(let e of this._nodeConstraints)this._resolveConstraint(e)}_resolveConstraint(e){let n=e.destinationRestLocalRotation,r=e.sourceRestLocalRotationInv,s=L.identity(this._tempQuatA);switch(e.type){case"roll":{let a=L.multiply(this._tempQuatA,r,e.source.rotationLocal),l=L.multiply(this._tempQuatA,e.sourceRestLocalRotation,a);L.mul(l,l,r);let c=L.invert(this._tempQuatB,n),h=L.multiply(this._tempQuatB,c,l);L.multiply(h,h,n);let d=b.transformQuat(this._tempV3A,e.axis,h),i=L.rotationTo(this._tempQuatA,e.axis,d);L.mul(s,n,L.invert(this._tempQuat,i)),L.mul(s,s,h)}break;case"aim":{let a=e.destination.parent.rotationWorld,l=b.transformQuat(this._tempV3A,e.axis,n);b.transformQuat(l,l,a);let c=e.source.getTranslationWorld(this._tempV3B);b.sub(c,c,e.destination.getTranslationWorld(this._tempV3)),b.normalize(c,c);let h=L.rotationTo(this._tempQuatA,l,c);L.mul(s,L.invert(this._tempQuat,a),h),L.mul(s,s,a),L.mul(s,s,n)}break;case"rotation":{let a=L.mul(s,r,e.source.rotationLocal);L.mul(s,n,a)}break}L.slerp(s,n,s,e.weight),e.destination.rotationLocal=s}_updateSpringBones(e){this._sphereColliders.forEach(({object:n,shape:r,cache:s})=>{let a=b.copy(s.head,r.offset);n.transformVectorWorld(a),b.add(s.head,n.getTranslationWorld(this._tempV3),a)}),this._capsuleColliders.forEach(({object:n,shape:r,cache:s})=>{let a=n.getTranslationWorld(this._tempV3A),l=b.copy(s.head,r.offset);n.transformVectorWorld(l),b.add(s.head,a,l);let c=b.copy(s.tail,r.tail);n.transformVectorWorld(c),b.add(s.tail,a,c)}),this._springChains.forEach(n=>{for(let r=0;r<n.joints.length-1;++r){let s=n.joints[r],a=s.node.parent?s.node.parent.rotationWorld:this._identityQuat,l=this._inertia;n.center?(b.sub(l,s.state.currentTailCenter,s.state.prevTailCenter),n.center.transformVectorWorld(l)):b.sub(l,s.state.currentTail,s.state.prevTail),b.scale(l,l,1-s.dragForce);let c=b.copy(this._stiffness,s.state.boneAxis);b.transformQuat(c,c,s.state.initialLocalRotation),b.transformQuat(c,c,a),b.scale(c,c,e*s.stiffness);let h=b.scale(this._external,s.gravityDir,e*s.gravityPower),d=b.copy(this._tempV3A,s.state.currentTail);b.add(d,d,l),b.add(d,d,c),b.add(d,d,h);let i=s.node.getTranslationWorld(this._tempV3B);b.sub(d,d,i),b.normalize(d,d),b.scaleAndAdd(d,i,d,s.state.boneLength);for(let{shape:m,cache:u}of n.sphereColliders){let g=this._tailToShape,f=u.head;g=b.sub(g,d,f);let w=m.radius+s.hitRadius,v=b.length(g)-w;v<0&&(b.normalize(g,g),b.scaleAndAdd(d,d,g,-v),b.sub(d,d,i),b.normalize(d,d),b.scaleAndAdd(d,i,d,s.state.boneLength))}for(let{shape:m,cache:u}of n.capsuleColliders){let g=this._tailToShape,f=u.head,w=u.tail;g=b.sub(g,d,f);let v=b.sub(this._headToTail,w,f),x=b.dot(v,g);b.squaredLength(v)<=x?b.sub(g,d,w):x>0&&(b.scale(v,v,x/b.squaredLength(v)),b.sub(g,g,v));let T=m.radius+s.hitRadius,A=b.length(g)-T;A<0&&(b.normalize(g,g),b.scaleAndAdd(d,d,g,-A),b.sub(d,d,i),b.normalize(d,d),b.scaleAndAdd(d,i,d,s.state.boneLength))}b.copy(s.state.prevTail,s.state.currentTail),b.copy(s.state.currentTail,d),n.center&&(b.copy(s.state.prevTailCenter,s.state.currentTailCenter),b.copy(s.state.currentTailCenter,d),n.center.transformPointInverseWorld(s.state.currentTailCenter)),s.node.parent.transformPointInverseWorld(d);let o=ne.fromTranslation(this._tempQuat2,d);ne.multiply(o,s.state.initialLocalTransformInvert,o),ne.getTranslation(d,o),b.normalize(d,d);let _=L.rotationTo(this._tempQuatA,s.state.boneAxis,d);s.node.rotationLocal=L.mul(this._tempQuatA,s.state.initialLocalRotation,_)}})}set firstPerson(e){this._firstPersonAnnotations.forEach(n=>{let r=e==n.firstPerson||e!=n.thirdPerson;n.node.getComponents("mesh").forEach(s=>{s.active=r})})}};M(lr,"TypeName","vrm"),M(lr,"Properties",{src:{type:P.String},lookAtTarget:{type:P.Object}});var cr=class extends O{init(){this.up=!1,this.right=!1,this.down=!1,this.left=!1,window.addEventListener("keydown",this.press.bind(this)),window.addEventListener("keyup",this.release.bind(this))}start(){this.headObject=this.headObject||this.object}update(){let e=[0,0,0];this.up&&(e[2]-=1),this.down&&(e[2]+=1),this.left&&(e[0]-=1),this.right&&(e[0]+=1),b.normalize(e,e),e[0]*=this.speed,e[2]*=this.speed,b.transformQuat(e,e,this.headObject.transformWorld),this.object.translate(e)}press(e){e.keyCode===38||e.keyCode===87||e.keyCode===90?this.up=!0:e.keyCode===39||e.keyCode===68?this.right=!0:e.keyCode===40||e.keyCode===83?this.down=!0:(e.keyCode===37||e.keyCode===65||e.keyCode===81)&&(this.left=!0)}release(e){e.keyCode===38||e.keyCode===87||e.keyCode===90?this.up=!1:e.keyCode===39||e.keyCode===68?this.right=!1:e.keyCode===40||e.keyCode===83?this.down=!1:(e.keyCode===37||e.keyCode===65||e.keyCode===81)&&(this.left=!1)}};M(cr,"TypeName","wasd-controls"),M(cr,"Properties",{speed:{type:P.Float,default:.1},headObject:{type:P.Object}});console.log("Zesty SDK Version: ",Aa);var zt=class extends O{init(){this.formats=Object.values(Zt),this.formatKeys=Object.keys(Zt),this.styleKeys=["standard","minimal","transparent"]}start(){if(this.mesh=this.object.getComponent(Fe),!this.mesh)throw new Error("'zesty-banner ' missing mesh component");if(this.createAutomaticCollision&&(this.collision=this.object.getComponent(Te)||this.object.addComponent(Te,{collider:In.Box,group:2}),this.cursorTarget=this.object.getComponent(ie)||this.object.addComponent(ie),this.cursorTarget.addClickFunction(this.onClick.bind(this))),this.dynamicFormats){let e=document.createElement("script");e.onload=()=>{this.formatsOverride=zestyFormats.formats,this.startLoading()},e.setAttribute("src","https://ipfs.io/ipns/lib.zesty.market/zesty-formats.js"),e.setAttribute("crossorigin","anonymous"),document.body.appendChild(e)}else this.startLoading()}startLoading(){this.loadBanner(this.space,this.formatKeys[this.format],this.styleKeys[this.style]).then(e=>{this.banner=e,this.scaleToRatio&&(this.height=this.object.scalingLocal[1],this.object.resetScaling(),this.createAutomaticCollision&&(this.collision.extents=[this.formats[this.format].width*this.height,this.height,.1]),this.object.scale([this.formats[this.format].width*this.height,this.height,1]));let n=this.mesh.material.clone();if(this.textureProperty==="auto"){let r=n.shader;if(r==="Phong Opaque Textured")n.diffuseTexture=e.texture,n.alphaMaskThreshold=.3;else if(r==="Flat Opaque Textured")n.flatTexture=e.texture,n.alphaMaskThreshold=.8;else throw Error("'zesty-banner' unable to apply banner texture: unsupported pipeline "+r);this.mesh.material=n,this.mesh.material.alphaMaskTexture=e.texture}else this.mesh.material[this.textureProperty]=e.texture,this.mesh.material.alphaMaskTexture=e.texture;this.beacon&&ba(this.space)})}onClick(){this.banner?.url&&(this.engine.xrSession?this.engine.xrSession.end().then(this.executeClick.bind(this)):this.executeClick())}executeClick(){wa(this.banner.url),this.beacon&&Ma(this.space)}async loadBanner(e,n,r){let s=await ya(e,n,r),{asset_url:a,cta_url:l}=s.Ads[0];return this.engine.textures.load(a,"").then(c=>({texture:c,imageSrc:a,url:l,campaignId:s.CampaignId}))}};M(zt,"TypeName","zesty-banner"),M(zt,"Properties",{space:oe.int(),format:oe.enum(["tall","wide","square"],"square"),style:oe.enum(["standard","minimal","transparent"],"transparent"),scaleToRatio:oe.bool(!0),textureProperty:oe.string("auto"),assignAlphaMaskTexture:oe.bool(!0),beacon:oe.bool(!0),dynamicFormats:oe.bool(!0),createAutomaticCollision:oe.bool(!0)});WL.registerComponent(at,le,se,lt,ct,_t,ht,pt,dt,mt,ft,ut,gt,wt,vt,xt,yt,bt,Mt,At,Tt,jt);WL.registerComponent(zt);})();
/*! Bundled license information:

howler/dist/howler.js:
  (*!
   *  howler.js v2.2.3
   *  howlerjs.com
   *
   *  (c) 2013-2020, James Simpson of GoldFire Studios
   *  goldfirestudios.com
   *
   *  MIT License
   *)
  (*!
   *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
   *  
   *  howler.js v2.2.3
   *  howlerjs.com
   *
   *  (c) 2013-2020, James Simpson of GoldFire Studios
   *  goldfirestudios.com
   *
   *  MIT License
   *)

howler/dist/howler.js:
  (*!
   *  howler.js v2.2.3
   *  howlerjs.com
   *
   *  (c) 2013-2020, James Simpson of GoldFire Studios
   *  goldfirestudios.com
   *
   *  MIT License
   *)
  (*!
   *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
   *  
   *  howler.js v2.2.3
   *  howlerjs.com
   *
   *  (c) 2013-2020, James Simpson of GoldFire Studios
   *  goldfirestudios.com
   *
   *  MIT License
   *)
*/
//# sourceMappingURL=Wonderland Test-bundle.js.map
