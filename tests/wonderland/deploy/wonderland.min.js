var WL=(()=>{var ge=Object.defineProperty;var Ae=Object.getOwnPropertyDescriptor;var we=(_,e)=>{for(var n in e)ge(_,n,{get:e[n],enumerable:!0})};var l=(_,e,n,t)=>{for(var r=t>1?void 0:t?Ae(e,n):e,i=_.length-1,s;i>=0;i--)(s=_[i])&&(r=(t?s(e,n,r):s(r))||r);return t&&r&&ge(e,n,r),r};var ye=(_,e,n)=>{if(!e.has(_))throw TypeError("Cannot "+n)};var f=(_,e,n)=>(ye(_,e,"read from private field"),n?n.call(_):e.get(_)),ce=(_,e,n)=>{if(e.has(_))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(_):e.set(_,n)},J=(_,e,n,t)=>(ye(_,e,"write to private field"),t?t.call(_,n):e.set(_,n),n);var z=(_,e,n)=>new Promise((t,r)=>{var i=a=>{try{o(n.next(a))}catch(m){r(m)}},s=a=>{try{o(n.throw(a))}catch(m){r(m)}},o=a=>a.done?t(a.value):Promise.resolve(a.value).then(i,s);o((n=n.apply(_,e)).next())});var Se={};we(Se,{Alignment:()=>ee,Animation:()=>U,AnimationComponent:()=>S,AnimationState:()=>ie,Collider:()=>K,CollisionComponent:()=>I,CollisionEventType:()=>oe,Component:()=>x,Emitter:()=>je,ForceMode:()=>V,I18N:()=>Y,InputComponent:()=>E,InputType:()=>T,Justification:()=>ne,LightComponent:()=>L,LightType:()=>re,LockAxis:()=>se,Material:()=>M,MaterialParamType:()=>v,Mesh:()=>C,MeshAttribute:()=>w,MeshAttributeAccessor:()=>_e,MeshComponent:()=>k,MeshIndexType:()=>F,Object:()=>Q,PhysXComponent:()=>b,Physics:()=>q,RayHit:()=>Z,Scene:()=>G,Shape:()=>P,Skin:()=>O,TextComponent:()=>j,TextEffect:()=>te,Texture:()=>N,Type:()=>g,ViewComponent:()=>A,WASM:()=>le,WonderlandEngine:()=>ae,loadRuntime:()=>Ue,math:()=>pe});var fe=()=>z(void 0,null,function*(){return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]))});var xe=()=>(_=>z(void 0,null,function*(){try{return typeof MessageChannel!="undefined"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(_)}catch(e){return!1}}))(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]));var de={};we(de,{Alignment:()=>ee,Animation:()=>U,AnimationComponent:()=>S,AnimationState:()=>ie,Collider:()=>K,CollisionComponent:()=>I,CollisionEventType:()=>oe,Component:()=>x,ForceMode:()=>V,I18N:()=>Y,InputComponent:()=>E,InputType:()=>T,Justification:()=>ne,LightComponent:()=>L,LightType:()=>re,LockAxis:()=>se,Material:()=>M,MaterialParamType:()=>v,Mesh:()=>C,MeshAttribute:()=>w,MeshAttributeAccessor:()=>_e,MeshComponent:()=>k,MeshIndexType:()=>F,Object:()=>Q,PhysXComponent:()=>b,Physics:()=>q,RayHit:()=>Z,Scene:()=>G,Shape:()=>P,Skin:()=>O,TextComponent:()=>j,TextEffect:()=>te,Texture:()=>N,Type:()=>g,ViewComponent:()=>A,math:()=>pe});function R(_){return _===""?!0:_&&(typeof _=="string"||_.constructor===String)}function X(){return function(_,e,n){n.enumerable=!0}}function u(){return function(_,e,n){var r;X()(_,e,n);let t=_.constructor;t.Properties=(r=t.Properties)!=null?r:{},t.Properties[e]={type:g.Native}}}var Fe="Misaligned pointer: please report a bug",g;(function(c){c[c.Native=1]="Native",c[c.Bool=2]="Bool",c[c.Int=4]="Int",c[c.Float=8]="Float",c[c.String=16]="String",c[c.Enum=32]="Enum",c[c.Object=64]="Object",c[c.Mesh=128]="Mesh",c[c.Texture=256]="Texture",c[c.Material=512]="Material",c[c.Animation=1024]="Animation",c[c.Skin=2048]="Skin",c[c.Color=4096]="Color"})(g||(g={}));var K;(function(t){t[t.Sphere=0]="Sphere",t[t.AxisAlignedBox=1]="AxisAlignedBox",t[t.Box=2]="Box"})(K||(K={}));var ee;(function(t){t[t.Left=1]="Left",t[t.Center=2]="Center",t[t.Right=3]="Right"})(ee||(ee={}));var ne;(function(r){r[r.Line=1]="Line",r[r.Middle=2]="Middle",r[r.Top=3]="Top",r[r.Bottom=4]="Bottom"})(ne||(ne={}));var te;(function(n){n[n.None=0]="None",n[n.Outline=1]="Outline"})(te||(te={}));var T;(function(o){o[o.Head=0]="Head",o[o.EyeLeft=1]="EyeLeft",o[o.EyeRight=2]="EyeRight",o[o.ControllerLeft=3]="ControllerLeft",o[o.ControllerRight=4]="ControllerRight",o[o.RayLeft=5]="RayLeft",o[o.RayRight=6]="RayRight"})(T||(T={}));var re;(function(t){t[t.Point=1]="Point",t[t.Spot=2]="Spot",t[t.Sun=3]="Sun"})(re||(re={}));var ie;(function(t){t[t.Playing=1]="Playing",t[t.Paused=2]="Paused",t[t.Stopped=3]="Stopped"})(ie||(ie={}));var V;(function(r){r[r.Force=0]="Force",r[r.Impulse=1]="Impulse",r[r.VelocityChange=2]="VelocityChange",r[r.Acceleration=3]="Acceleration"})(V||(V={}));var oe;(function(r){r[r.Touch=0]="Touch",r[r.TouchLost=1]="TouchLost",r[r.TriggerTouch=2]="TriggerTouch",r[r.TriggerTouchLost=3]="TriggerTouchLost"})(oe||(oe={}));var P;(function(o){o[o.None=0]="None",o[o.Sphere=1]="Sphere",o[o.Capsule=2]="Capsule",o[o.Box=3]="Box",o[o.Plane=4]="Plane",o[o.ConvexMesh=5]="ConvexMesh",o[o.TriangleMesh=6]="TriangleMesh"})(P||(P={}));var w;(function(m){m[m.Position=0]="Position",m[m.Tangent=1]="Tangent",m[m.Normal=2]="Normal",m[m.TextureCoordinate=3]="TextureCoordinate",m[m.Color=4]="Color",m[m.JointId=5]="JointId",m[m.JointWeight=6]="JointWeight",m[m.SecondaryJointId=7]="SecondaryJointId",m[m.SecondaryJointWeight=8]="SecondaryJointWeight"})(w||(w={}));var v;(function(i){i[i.UnsignedInt=0]="UnsignedInt",i[i.Int=1]="Int",i[i.Float=2]="Float",i[i.Sampler=3]="Sampler",i[i.Font=4]="Font"})(v||(v={}));var Te=[0,1,0],G=class{constructor(e){this._engine=e,this._rayHit=e.wasm._malloc(4*(3*4+3*4+4+2)+4),this._hit=new Z(this._engine,this._rayHit),this.onPreRender=[],this.onPostRender=[]}get activeViews(){let e=this._engine.wasm,n=e._wl_scene_get_active_views(this._engine.wasm._tempMem,16),t=[],r=e._typeIndexFor("view");for(let i=0;i<n;++i)t.push(new A(this._engine,r,this._engine.wasm._tempMemInt[i]));return t}rayCast(e,n,t){return this._engine.wasm._wl_scene_ray_cast(e[0],e[1],e[2],n[0],n[1],n[2],t,this._rayHit),this._hit}addObject(e){let n=e?e.objectId:0,t=this._engine.wasm._wl_scene_add_object(n);return this._engine.wrapObject(t)}addObjects(e,n,t){let r=n?n.objectId:0;this._engine.wasm.requireTempMem(e*2);let i=this._engine.wasm._wl_scene_add_objects(r,e,t||0,this._engine.wasm._tempMem,this._engine.wasm._tempMemSize>>1),s=this._engine.wasm._tempMemUint16.subarray(0,i),o=this._engine.wrapObject.bind(this._engine);return Array.from(s,o)}reserveObjects(e,n){let t=this._engine.wasm;n=n||{};let r=t._typeIndexFor("js"),i=t._tempMemInt.subarray();i.fill(0);for(let s of Object.entries(n)){let o=t._typeIndexFor(s[0]);i[o<0?r:o]+=s[1]}t._wl_scene_reserve_objects(e,t._tempMem)}set clearColor(e){this._engine.wasm._wl_scene_set_clearColor(e[0],e[1],e[2],e[3])}set colorClearEnabled(e){this._engine.wasm._wl_scene_enableColorClear(e)}load(e){let n=this._engine.wasm,t=n.lengthBytesUTF8(e)+1,r=n._tempMem;n.stringToUTF8(e,r,t),n._wl_load_scene(r)}append(e,n){n=n||{};let t=!!n.loadGltfExtensions,r=this._engine.wasm,i=r.lengthBytesUTF8(e)+1,s=r._tempMem;r.stringToUTF8(e,s,i);let o=r._sceneLoadedCallback.length,a=new Promise((m,d)=>{r._sceneLoadedCallback[o]={success:(p,h)=>{let c=this._engine.wrapObject(p);m(h?{root:c,extensions:h}:c)},error:()=>d()}});return r._wl_append_scene(s,t,o),a}_unmarshallGltfExtensions(e){let n={root:{},mesh:{},node:{},idMapping:{}},t=0,r=()=>{let d=e[t++],p=e[t++];return this._engine.wasm.UTF8ViewToString(d,d+p)},i=e[t++],s=new Array(i);for(let d=0;d<i;++d)s[d]=e[t++];n.idMapping=s;let o=e[t++];for(let d=0;d<o;++d){let p=e[t++];n.mesh[s[p]]=JSON.parse(r())}let a=e[t++];for(let d=0;d<a;++d){let p=e[t++];n.node[s[p]]=JSON.parse(r())}let m=r();return m&&(n.root=JSON.parse(m)),n}reset(){this._engine.wasm._wl_scene_reset()}},x=class{constructor(e,n=-1,t=-1){this._engine=e,this._manager=n,this._id=t,this._object=null,this._type=null}get engine(){return this._engine}get type(){return this._type||this._engine.wasm._typeNameFor(this._manager)}get object(){if(!this._object){let e=this._engine.wasm._wl_component_get_object(this._manager,this._id);this._object=this._engine.wrapObject(e)}return this._object}set active(e){this._engine.wasm._wl_component_setActive(this._manager,this._id,e)}get active(){return this._engine.wasm._wl_component_isActive(this._manager,this._id)!=0}destroy(){this._engine.wasm._wl_component_remove(this._manager,this._id),this._manager=void 0,this._id=void 0}equals(e){return e?this._manager==e._manager&&this._id==e._id:!1}},be=class extends x{get collider(){return this._engine.wasm._wl_collision_component_get_collider(this._id)}set collider(e){this._engine.wasm._wl_collision_component_set_collider(this._id,e)}get extents(){let e=this._engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_collision_component_get_extents(this._id),3)}set extents(e){this.extents.set(e)}get group(){return this._engine.wasm._wl_collision_component_get_group(this._id)}set group(e){this._engine.wasm._wl_collision_component_set_group(this._id,e)}queryOverlaps(){let e=this._engine.wasm._wl_collision_component_query_overlaps(this._id,this._engine.wasm._tempMem,this._engine.wasm._tempMemSize>>1),n=new Array(e);for(let t=0;t<e;++t)n[t]=new be(this._engine,this._manager,this._engine.wasm._tempMemUint16[t]);return n}},I=be;I.TypeName="collision",l([u()],I.prototype,"collider",1),l([u()],I.prototype,"extents",1),l([u()],I.prototype,"group",1);var j=class extends x{get alignment(){return this._engine.wasm._wl_text_component_get_horizontal_alignment(this._id)}set alignment(e){this._engine.wasm._wl_text_component_set_horizontal_alignment(this._id,e)}get justification(){return this._engine.wasm._wl_text_component_get_vertical_alignment(this._id)}set justification(e){this._engine.wasm._wl_text_component_set_vertical_alignment(this._id,e)}get characterSpacing(){return this._engine.wasm._wl_text_component_get_character_spacing(this._id)}set characterSpacing(e){this._engine.wasm._wl_text_component_set_character_spacing(this._id,e)}get lineSpacing(){return this._engine.wasm._wl_text_component_get_line_spacing(this._id)}set lineSpacing(e){this._engine.wasm._wl_text_component_set_line_spacing(this._id,e)}get effect(){return this._engine.wasm._wl_text_component_get_effect(this._id)}set effect(e){this._engine.wasm._wl_text_component_set_effect(this._id,e)}get text(){let e=this._engine.wasm,n=e._wl_text_component_get_text(this._id);return e.UTF8ToString(n)}set text(e){let n=this._engine.wasm,t=n.lengthBytesUTF8(e)+1;n.requireTempMem(t);let r=n._tempMem;n.stringToUTF8(e,r,t),n._wl_text_component_set_text(this._id,r)}set material(e){let n=e?e._index:0;this._engine.wasm._wl_text_component_set_material(this._id,n)}get material(){let e=this._engine.wasm._wl_text_component_get_material(this._id);return e>0?new M(this._engine,e):null}};j.TypeName="text",l([u()],j.prototype,"alignment",1),l([u()],j.prototype,"justification",1),l([u()],j.prototype,"characterSpacing",1),l([u()],j.prototype,"lineSpacing",1),l([u()],j.prototype,"effect",1),l([u()],j.prototype,"text",1),l([u()],j.prototype,"material",1);var A=class extends x{get projectionMatrix(){let e=this._engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_view_component_get_projection_matrix(this._id),16)}get near(){return this._engine.wasm._wl_view_component_get_near(this._id)}set near(e){this._engine.wasm._wl_view_component_set_near(this._id,e)}get far(){return this._engine.wasm._wl_view_component_get_far(this._id)}set far(e){this._engine.wasm._wl_view_component_set_far(this._id,e)}get fov(){return this._engine.wasm._wl_view_component_get_fov(this._id)}set fov(e){this._engine.wasm._wl_view_component_set_fov(this._id,e)}};A.TypeName="view",l([X()],A.prototype,"projectionMatrix",1),l([u()],A.prototype,"near",1),l([u()],A.prototype,"far",1),l([u()],A.prototype,"fov",1);var E=class extends x{get inputType(){return this._engine.wasm._wl_input_component_get_type(this._id)}set inputType(e){this._engine.wasm._wl_input_component_set_type(this._id,e)}get xrInputSource(){let e=this._engine.xrSession;if(e){for(let n of e.inputSources)if(n.handedness==this.handedness)return n}return null}get handedness(){let e=this.inputType;return e==4||e==6||e==2?"right":e==3||e==5||e==1?"left":null}};E.TypeName="input",l([u()],E.prototype,"inputType",1),l([X()],E.prototype,"xrInputSource",1),l([X()],E.prototype,"handedness",1);var L=class extends x{get color(){let e=this._engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_light_component_get_color(this._id),4)}set color(e){this.color.set(e)}get lightType(){return this._engine.wasm._wl_light_component_get_type(this._id)}set lightType(e){this._engine.wasm._wl_light_component_set_type(this._id,e)}};L.TypeName="light",l([u()],L.prototype,"color",1),l([u()],L.prototype,"lightType",1);var S=class extends x{set animation(e){this._engine.wasm._wl_animation_component_set_animation(this._id,e?e._index:0)}get animation(){let e=this._engine.wasm._wl_animation_component_get_animation(this._id);return e>0?new U(this._engine,e):null}set playCount(e){this._engine.wasm._wl_animation_component_set_playCount(this._id,e)}get playCount(){return this._engine.wasm._wl_animation_component_get_playCount(this._id)}set speed(e){this._engine.wasm._wl_animation_component_set_speed(this._id,e)}get speed(){return this._engine.wasm._wl_animation_component_get_speed(this._id)}get state(){return this._engine.wasm._wl_animation_component_state(this._id)}play(){this._engine.wasm._wl_animation_component_play(this._id)}stop(){this._engine.wasm._wl_animation_component_stop(this._id)}pause(){this._engine.wasm._wl_animation_component_pause(this._id)}};S.TypeName="animation",l([u()],S.prototype,"animation",1),l([u()],S.prototype,"playCount",1),l([u()],S.prototype,"speed",1),l([X()],S.prototype,"state",1);var k=class extends x{set material(e){this._engine.wasm._wl_mesh_component_set_material(this._id,e?e._index:0)}get material(){let e=this._engine.wasm._wl_mesh_component_get_material(this._id);return e>0?new M(this._engine,e):null}get mesh(){let e=this._engine.wasm._wl_mesh_component_get_mesh(this._id);return e>0?new C(this._engine,e):null}set mesh(e){this._engine.wasm._wl_mesh_component_set_mesh(this._id,e?e._index:0)}get skin(){let e=this._engine.wasm._wl_mesh_component_get_skin(this._id);return e>0?new O(this._engine,e):null}set skin(e){this._engine.wasm._wl_mesh_component_set_skin(this._id,e?e._index:0)}};k.TypeName="mesh",l([u()],k.prototype,"material",1),l([u()],k.prototype,"mesh",1),l([u()],k.prototype,"skin",1);var se;(function(r){r[r.None=0]="None",r[r.X=1]="X",r[r.Y=2]="Y",r[r.Z=4]="Z"})(se||(se={}));var b=class extends x{set static(e){this._engine.wasm._wl_physx_component_set_static(this._id,e)}get static(){return!!this._engine.wasm._wl_physx_component_get_static(this._id)}set kinematic(e){this._engine.wasm._wl_physx_component_set_kinematic(this._id,e)}get kinematic(){return!!this._engine.wasm._wl_physx_component_get_kinematic(this._id)}set gravity(e){this._engine.wasm._wl_physx_component_set_gravity(this._id,e)}get gravity(){return!!this._engine.wasm._wl_physx_component_get_gravity(this._id)}set simulate(e){this._engine.wasm._wl_physx_component_set_simulate(this._id,e)}get simulate(){return!!this._engine.wasm._wl_physx_component_get_simulate(this._id)}set allowSimulation(e){this._engine.wasm._wl_physx_component_set_allowSimulation(this._id,e)}get allowSimulation(){return!!this._engine.wasm._wl_physx_component_get_allowSimulation(this._id)}set allowQuery(e){this._engine.wasm._wl_physx_component_set_allowQuery(this._id,e)}get allowQuery(){return!!this._engine.wasm._wl_physx_component_get_allowQuery(this._id)}set trigger(e){this._engine.wasm._wl_physx_component_set_trigger(this._id,e)}get trigger(){return!!this._engine.wasm._wl_physx_component_get_trigger(this._id)}set shape(e){this._engine.wasm._wl_physx_component_set_shape(this._id,e)}get shape(){return this._engine.wasm._wl_physx_component_get_shape(this._id)}set shapeData(e){e==null||![6,5].includes(this.shape)||this._engine.wasm._wl_physx_component_set_shape_data(this._id,e.index)}get shapeData(){return[6,5].includes(this.shape)?{index:this._engine.wasm._wl_physx_component_get_shape_data(this._id)}:null}set extents(e){this.extents.set(e)}get extents(){let e=this._engine.wasm,n=e._wl_physx_component_get_extents(this._id);return new Float32Array(e.HEAPF32.buffer,n,3)}get staticFriction(){return this._engine.wasm._wl_physx_component_get_staticFriction(this._id)}set staticFriction(e){this._engine.wasm._wl_physx_component_set_staticFriction(this._id,e)}get dynamicFriction(){return this._engine.wasm._wl_physx_component_get_dynamicFriction(this._id)}set dynamicFriction(e){this._engine.wasm._wl_physx_component_set_dynamicFriction(this._id,e)}get bounciness(){return this._engine.wasm._wl_physx_component_get_bounciness(this._id)}set bounciness(e){this._engine.wasm._wl_physx_component_set_bounciness(this._id,e)}get linearDamping(){return this._engine.wasm._wl_physx_component_get_linearDamping(this._id)}set linearDamping(e){this._engine.wasm._wl_physx_component_set_linearDamping(this._id,e)}get angularDamping(){return this._engine.wasm._wl_physx_component_get_angularDamping(this._id)}set angularDamping(e){this._engine.wasm._wl_physx_component_set_angularDamping(this._id,e)}set linearVelocity(e){this._engine.wasm._wl_physx_component_set_linearVelocity(this._id,e[0],e[1],e[2])}get linearVelocity(){let e=this._engine.wasm;return e._wl_physx_component_get_linearVelocity(this._id,e._tempMem),new Float32Array(e.HEAPF32.buffer,e._tempMem,3)}set angularVelocity(e){this._engine.wasm._wl_physx_component_set_angularVelocity(this._id,e[0],e[1],e[2])}get angularVelocity(){let e=this._engine.wasm;return e._wl_physx_component_get_angularVelocity(this._id,e._tempMem),new Float32Array(e.HEAPF32.buffer,e._tempMem,3)}set groupsMask(e){this._engine.wasm._wl_physx_component_set_groupsMask(this._id,e)}get groupsMask(){return this._engine.wasm._wl_physx_component_get_groupsMask(this._id)}set blocksMask(e){this._engine.wasm._wl_physx_component_set_blocksMask(this._id,e)}get blocksMask(){return this._engine.wasm._wl_physx_component_get_blocksMask(this._id)}set linearLockAxis(e){this._engine.wasm._wl_physx_component_set_linearLockAxis(this._id,e)}get linearLockAxis(){return this._engine.wasm._wl_physx_component_get_linearLockAxis(this._id)}set angularLockAxis(e){this._engine.wasm._wl_physx_component_set_angularLockAxis(this._id,e)}get angularLockAxis(){return this._engine.wasm._wl_physx_component_get_angularLockAxis(this._id)}set mass(e){this._engine.wasm._wl_physx_component_set_mass(this._id,e)}get mass(){return this._engine.wasm._wl_physx_component_get_mass(this._id)}set massSpaceInteriaTensor(e){this._engine.wasm._wl_physx_component_set_massSpaceInertiaTensor(this._id,e[0],e[1],e[2])}addForce(e,n,t,r,i){n=n||0,r?this._engine.wasm._wl_physx_component_addForceAt(this._id,e[0],e[1],e[2],n,!!t,r[0],r[1],r[2],!!i):this._engine.wasm._wl_physx_component_addForce(this._id,e[0],e[1],e[2],n,!!t)}addTorque(e,n=0){this._engine.wasm._wl_physx_component_addTorque(this._id,e[0],e[1],e[2],n)}onCollision(e){return this.onCollisionWith(this,e)}onCollisionWith(e,n){let t=this._engine.physics;return t._callbacks[this._id]=t._callbacks[this._id]||[],t._callbacks[this._id].push(n),this._engine.wasm._wl_physx_component_addCallback(this._id,e._id||this._id)}removeCollisionCallback(e){let n=this._engine.physics,t=this._engine.wasm._wl_physx_component_removeCallback(this._id,e);t&&n._callbacks[this._id].splice(-t)}};b.TypeName="physx",l([u()],b.prototype,"static",1),l([u()],b.prototype,"kinematic",1),l([u()],b.prototype,"gravity",1),l([u()],b.prototype,"simulate",1),l([u()],b.prototype,"allowSimulation",1),l([u()],b.prototype,"allowQuery",1),l([u()],b.prototype,"trigger",1),l([u()],b.prototype,"shape",1),l([u()],b.prototype,"shapeData",1),l([u()],b.prototype,"extents",1),l([u()],b.prototype,"staticFriction",1),l([u()],b.prototype,"dynamicFriction",1),l([u()],b.prototype,"bounciness",1),l([u()],b.prototype,"linearDamping",1),l([u()],b.prototype,"angularDamping",1),l([u()],b.prototype,"linearVelocity",1),l([u()],b.prototype,"angularVelocity",1),l([u()],b.prototype,"groupsMask",1),l([u()],b.prototype,"blocksMask",1),l([u()],b.prototype,"linearLockAxis",1),l([u()],b.prototype,"angularLockAxis",1),l([u()],b.prototype,"mass",1);var q=class{constructor(e){this._engine=e,this._rayHit=e.wasm._malloc(4*(3*4+3*4+4+2)+4),this._hit=new Z(this._engine,this._rayHit),this._callbacks={}}rayCast(e,n,t,r){return typeof r=="undefined"&&(r=100),this._engine.wasm._wl_physx_ray_cast(e[0],e[1],e[2],n[0],n[1],n[2],t,r||100,this._rayHit),this._hit}},F;(function(t){t[t.UnsignedByte=1]="UnsignedByte",t[t.UnsignedShort=2]="UnsignedShort",t[t.UnsignedInt=4]="UnsignedInt"})(F||(F={}));var C=class{static get VERTEX_FLOAT_SIZE(){return 3+3+2}static get VERTEX_SIZE(){return this.VERTEX_FLOAT_SIZE*4}static get POS(){return{X:0,Y:1,Z:2}}static get TEXCOORD(){return{U:3,V:4}}static get NORMAL(){return{X:5,Y:6,Z:7}}constructor(e,n){if(this._engine=e!=null?e:WL,typeof n=="object"){if(!n.vertexCount&&n.vertexData&&(n.vertexCount=n.vertexData.length/C.VERTEX_FLOAT_SIZE),!n.vertexCount)throw new Error("Missing parameter 'vertexCount'");let t=this._engine.wasm,r=0,i=0,s=0;if(n.indexData)switch(i=n.indexType||2,s=n.indexData.length*i,r=t._malloc(s),i){case 1:t.HEAPU8.set(n.indexData,r);break;case 2:t.HEAPU16.set(n.indexData,r>>1);break;case 4:t.HEAPU32.set(n.indexData,r>>2);break}let{skinned:o=!1}=n;if(this._index=t._wl_mesh_create(r,s,i,n.vertexCount,o),n.vertexData){let a=this.attribute(0),m=this.attribute(2),d=this.attribute(3);for(let p=0;p<n.vertexCount;++p){let h=p*C.VERTEX_FLOAT_SIZE;a.set(p,n.vertexData.subarray(h,h+3)),d==null||d.set(p,n.vertexData.subarray(h+3,h+5)),m==null||m.set(p,n.vertexData.subarray(h+5,h+8))}}}else this._index=n}get vertexData(){let e=this._engine.wasm,n=e._wl_mesh_get_vertexData(this._index,this._engine.wasm._tempMem);return new Float32Array(e.HEAPF32.buffer,n,C.VERTEX_FLOAT_SIZE*e.HEAPU32[this._engine.wasm._tempMem/4])}get vertexCount(){return this._engine.wasm._wl_mesh_get_vertexCount(this._index)}get indexData(){let e=this._engine.wasm,n=e._tempMem,t=e._wl_mesh_get_indexData(this._index,n,n+4);if(t===null)return null;let r=e.HEAPU32[n/4];switch(e.HEAPU32[n/4+1]){case 1:return new Uint8Array(e.HEAPU8.buffer,t,r);case 2:return new Uint16Array(e.HEAPU16.buffer,t,r);case 4:return new Uint32Array(e.HEAPU32.buffer,t,r)}return null}update(){this._engine.wasm._wl_mesh_update(this._index)}getBoundingSphere(e=new Float32Array(4)){let n=this._engine.wasm._tempMemFloat;return this._engine.wasm._wl_mesh_get_boundingSphere(this._index,this._engine.wasm._tempMem),e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e}attribute(e){if(typeof e!="number")throw new TypeError("Expected number, but got "+typeof e);let n=this._engine.wasm._tempMemUint32;if(this._engine.wasm._wl_mesh_get_attribute(this._index,e,this._engine.wasm._tempMem),n[0]==255)return null;let t=new _e(this._engine,e);t._attribute=n[0],t._offset=n[1],t._stride=n[2],t._formatSize=n[3],t._componentCount=n[4];let r=n[5];return t._arraySize=r||1,t.length=this.vertexCount,t}destroy(){this._engine.wasm._wl_mesh_destroy(this._index)}equals(e){return e?this._index===e._index:!1}},_e=class{constructor(e,n=0){this._attribute=-1;this._offset=0;this._stride=0;this._formatSize=0;this._componentCount=0;this._arraySize=1;this.length=0;this._engine=e;let t=this._engine.wasm;switch(n){case 0:case 2:case 3:case 1:case 4:case 6:this._bufferType=Float32Array,this._tempBufferGetter=t.getTempBufferF32.bind(t);break;case 5:this._bufferType=Uint16Array,this._tempBufferGetter=t.getTempBufferU16.bind(t);break;case 8:case 7:console.error(`Deprecated attribute accessor type: ${n}`);default:throw new Error(`Invalid attribute accessor type: ${n}`)}}createArray(e=1){return e=e>this.length?this.length:e,new this._bufferType(e*this._componentCount*this._arraySize)}get(e,n=this.createArray()){if(n.length%this._componentCount!=0)throw new Error(`out.length, ${n.length} is not a multiple of the attribute vector components, ${this._componentCount}`);let t=this._tempBufferGetter(n.length),r=this._bufferType.BYTES_PER_ELEMENT,i=r*n.length,s=this._formatSize*this._arraySize,o=this._componentCount*r*this._arraySize;this._engine.wasm._wl_mesh_get_attribute_values(this._attribute,s,this._offset+e*this._stride,this._stride,o,t.byteOffset,i);for(let a=0;a<n.length;++a)n[a]=t[a];return n}set(e,n){if(n.length%this._componentCount!=0)throw new Error(`out.length, ${n.length} is not a multiple of the attribute vector components, ${this._componentCount}`);let t=this._bufferType.BYTES_PER_ELEMENT,r=t*n.length,i=this._componentCount*t*this._arraySize,s=this._formatSize*this._arraySize,o=this._engine.wasm;if(n.buffer!=o.HEAPU8.buffer){let a=this._tempBufferGetter(n.length);a.set(n),n=a}return o._wl_mesh_set_attribute_values(this._attribute,i,n.byteOffset,r,s,this._offset+e*this._stride,this._stride),this}},M=class{constructor(e,n){if(this._engine=e,typeof n!="number"){if(!(n==null?void 0:n.pipeline))throw new Error("Missing parameter 'pipeline'");let t=this._engine.wasm,r=n.pipeline,i=t.lengthBytesUTF8(r)+1;if(t.stringToUTF8(r,t._tempMem,i),this._index=t._wl_material_create(t._tempMem),this._index<0)throw new Error(`No such pipeline '${r}'`)}else this._index=n;if(this._definition=this._engine.wasm._wl_material_get_definition(this._index),!this._engine.wasm._materialDefinitions[this._definition])throw new Error(`Material Definition ${this._definition} not found for material with index ${this._index}`);return new Proxy(this,{get(t,r){let i=e.wasm,o=i._materialDefinitions[t._definition].get(r);if(!o)return t[r];if(i._wl_material_get_param_value(t._index,o.index,i._tempMem)){let a=o.type;switch(a.type){case 0:return a.componentCount==1?i._tempMemUint32[0]:new Uint32Array(i.HEAPU32.buffer,i._tempMem,a.componentCount);case 1:return a.componentCount==1?i._tempMemInt[0]:new Int32Array(i.HEAP32.buffer,i._tempMem,a.componentCount);case 2:return a.componentCount==1?i._tempMemFloat[0]:new Float32Array(i.HEAPF32.buffer,i._tempMem,a.componentCount);case 3:return new N(e,i._tempMemInt[0]);default:throw new Error(`Invalid type ${a} on parameter ${o.index} for material ${t._index}`)}}},set(t,r,i){var d;let s=e.wasm,a=s._materialDefinitions[t._definition].get(r);if(!a)return t[r]=i,!0;switch(a.type.type){case 0:case 1:case 3:let p=(d=i.id)!=null?d:i;s._wl_material_set_param_value_uint(t._index,a.index,p);break;case 2:let h=1;if(typeof i=="number")s._tempMemFloat[0]=i;else{h=i.length;for(let c=0;c<h;++c)s._tempMemFloat[c]=i[c]}s._wl_material_set_param_value_float(t._index,a.index,s._tempMem,h);break;case 4:throw new Error("Setting font properties is currently unsupported.")}return!0}})}get shader(){let e=this._engine.wasm;return e.UTF8ToString(e._wl_material_get_shader(this._index))}clone(){let e=this._engine.wasm._wl_material_clone(this._index);return e>0?new M(this._engine,e):null}equals(e){return e?this._index===e._index:!1}static wrap(e,n){return n>0?new M(e,n):null}},B=null,N=class{constructor(e,n){this._id=0;this._imageIndex=void 0;this._engine=e!=null?e:WL;let t=e.wasm;if(n instanceof HTMLImageElement||n instanceof HTMLVideoElement||n instanceof HTMLCanvasElement){let r=t._images.length;t._images.push(n),this._imageIndex=r,this._id=this._engine.wasm._wl_renderer_addImage(r)}else this._id=n;this._engine.textures[this._id]=this}get valid(){return this._id>=0}get id(){return this._id}update(){!this.valid||this._engine.wasm._wl_renderer_updateImage(this._id,this._imageIndex)}get width(){return this._engine.wasm._wl_texture_width(this._id)}get height(){return this._engine.wasm._wl_texture_height(this._id)}updateSubImage(e,n,t,r){var o;if(!this.valid)return;B||(B=document.createElement("canvas"));let i=this._engine.wasm,s=i._images[this._imageIndex];if(!!s){B.width=t,B.height=r,(o=B.getContext("2d"))==null||o.drawImage(s,e,n,t,r,0,0,t,r),i._images[this._imageIndex]=B;try{i._wl_renderer_updateImage(this._id,this._imageIndex,e,(s.videoHeight||s.height)-n-r)}finally{i._images[this._imageIndex]=s}}}destroy(){this._engine.wasm._wl_texture_destroy(this._id),this._imageIndex&&(this._engine.wasm._images[this._imageIndex]=null,this._imageIndex=void 0)}equals(e){return e?this._id===e._id:!1}},U=class{constructor(e=WL,n){this._engine=e,this._index=n}get duration(){return this._engine.wasm._wl_animation_get_duration(this._index)}get trackCount(){return this._engine.wasm._wl_animation_get_trackCount(this._index)}retarget(e){let n=this._engine.wasm;if(e instanceof O){let i=n._wl_animation_retargetToSkin(this._index,e._index);return new U(this._engine,i)}if(e.length!=this.trackCount)throw Error("Expected "+this.trackCount.toString()+" targets, but got "+e.length.toString());let t=n._malloc(2*e.length);for(let i=0;i<e.length;++i)n.HEAPU16[t>>1+i]=e[i].objectId;let r=n._wl_animation_retarget(this._index,t);return n._free(t),new U(this._engine,r)}equals(e){return e?this._index===e._index:!1}},Q=class{constructor(e,n){this.objectId=n,this._engine=e}get name(){let e=this._engine.wasm;return e.UTF8ToString(e._wl_object_name(this.objectId))}set name(e){let n=this._engine.wasm,t=n.lengthBytesUTF8(e)+1,r=n._tempMem;n.stringToUTF8(e,r,t),n._wl_object_set_name(this.objectId,r)}get parent(){let e=this._engine.wasm._wl_object_parent(this.objectId);return e===0?null:this._engine.wrapObject(e)}get children(){let e=this._engine.wasm._wl_object_get_children_count(this.objectId);if(e===0)return[];let n=this._engine.wasm;n.requireTempMem(e*2),this._engine.wasm._wl_object_get_children(this.objectId,n._tempMem,n._tempMemSize>>1);let t=new Array(e);for(let r=0;r<e;++r)t[r]=this._engine.wrapObject(n._tempMemUint16[r]);return t}set parent(e){this._engine.wasm._wl_object_set_parent(this.objectId,e==null?0:e.objectId)}resetTransform(){this._engine.wasm._wl_object_reset_translation_rotation(this.objectId),this._engine.wasm._wl_object_reset_scaling(this.objectId)}resetTranslationRotation(){this._engine.wasm._wl_object_reset_translation_rotation(this.objectId)}resetRotation(){this._engine.wasm._wl_object_reset_rotation(this.objectId)}resetTranslation(){this._engine.wasm._wl_object_reset_translation(this.objectId)}resetScaling(){this._engine.wasm._wl_object_reset_scaling(this.objectId)}translate(e){this._engine.wasm._wl_object_translate(this.objectId,e[0],e[1],e[2])}translateObject(e){this._engine.wasm._wl_object_translate_obj(this.objectId,e[0],e[1],e[2])}translateWorld(e){this._engine.wasm._wl_object_translate_world(this.objectId,e[0],e[1],e[2])}rotateAxisAngleDeg(e,n){this._engine.wasm._wl_object_rotate_axis_angle(this.objectId,e[0],e[1],e[2],n)}rotateAxisAngleRad(e,n){this._engine.wasm._wl_object_rotate_axis_angle_rad(this.objectId,e[0],e[1],e[2],n)}rotateAxisAngleDegObject(e,n){this._engine.wasm._wl_object_rotate_axis_angle_obj(this.objectId,e[0],e[1],e[2],n)}rotateAxisAngleRadObject(e,n){this._engine.wasm._wl_object_rotate_axis_angle_rad_obj(this.objectId,e[0],e[1],e[2],n)}rotate(e){this._engine.wasm._wl_object_rotate_quat(this.objectId,e[0],e[1],e[2],e[3])}rotateObject(e){this._engine.wasm._wl_object_rotate_quat_obj(this.objectId,e[0],e[1],e[2],e[3])}scale(e){this._engine.wasm._wl_object_scale(this.objectId,e[0],e[1],e[2])}get transformLocal(){let e=this._engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_object_trans_local(this.objectId),8)}set transformLocal(e){this.transformLocal.set(e),this.setDirty()}getTranslationLocal(e){let n=this._engine.wasm;return n._wl_object_get_translation_local(this.objectId,n._tempMem),e[0]=n._tempMemFloat[0],e[1]=n._tempMemFloat[1],e[2]=n._tempMemFloat[2],e}getTranslationWorld(e){let n=this._engine.wasm;return n._wl_object_get_translation_world(this.objectId,n._tempMem),e[0]=n._tempMemFloat[0],e[1]=n._tempMemFloat[1],e[2]=n._tempMemFloat[2],e}setTranslationLocal(e){this._engine.wasm._wl_object_set_translation_local(this.objectId,e[0],e[1],e[2])}setTranslationWorld(e){this._engine.wasm._wl_object_set_translation_world(this.objectId,e[0],e[1],e[2])}get transformWorld(){let e=this._engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_object_trans_world(this.objectId),8)}set transformWorld(e){this.transformWorld.set(e),this._engine.wasm._wl_object_trans_world_to_local(this.objectId)}get scalingLocal(){let e=this._engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_object_scaling_local(this.objectId),3)}set scalingLocal(e){this.scalingLocal.set(e),this.setDirty()}get scalingWorld(){let e=this._engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_object_scaling_world(this.objectId),3)}set scalingWorld(e){this.scalingWorld.set(e),this._engine.wasm._wl_object_scaling_world_to_local(this.objectId)}get rotationLocal(){return this.transformLocal.subarray(0,4)}get rotationWorld(){return this.transformWorld.subarray(0,4)}set rotationLocal(e){this._engine.wasm._wl_object_set_rotation_local(this.objectId,e[0],e[1],e[2],e[3])}set rotationWorld(e){this._engine.wasm._wl_object_set_rotation_world(this.objectId,e[0],e[1],e[2],e[3])}getForward(e){return e[0]=0,e[1]=0,e[2]=-1,this.transformVectorWorld(e),e}getUp(e){return e[0]=0,e[1]=1,e[2]=0,this.transformVectorWorld(e),e}getRight(e){return e[0]=1,e[1]=0,e[2]=0,this.transformVectorWorld(e),e}transformVectorWorld(e,n){n=n||e;let t=this._engine.wasm;return t._tempMemFloat[0]=n[0],t._tempMemFloat[1]=n[1],t._tempMemFloat[2]=n[2],t._wl_object_transformVectorWorld(this.objectId,t._tempMem),e[0]=t._tempMemFloat[0],e[1]=t._tempMemFloat[1],e[2]=t._tempMemFloat[2],e}transformVectorLocal(e,n){n=n||e;let t=this._engine.wasm;return t._tempMemFloat[0]=n[0],t._tempMemFloat[1]=n[1],t._tempMemFloat[2]=n[2],t._wl_object_transformVectorLocal(this.objectId,t._tempMem),e[0]=t._tempMemFloat[0],e[1]=t._tempMemFloat[1],e[2]=t._tempMemFloat[2],e}transformPointWorld(e,n){n=n||e;let t=this._engine.wasm;return t._tempMemFloat[0]=n[0],t._tempMemFloat[1]=n[1],t._tempMemFloat[2]=n[2],t._wl_object_transformPointWorld(this.objectId,t._tempMem),e[0]=t._tempMemFloat[0],e[1]=t._tempMemFloat[1],e[2]=t._tempMemFloat[2],e}transformPointLocal(e,n){n=n||e;let t=this._engine.wasm;return t._tempMemFloat[0]=n[0],t._tempMemFloat[1]=n[1],t._tempMemFloat[2]=n[2],t._wl_object_transformPointLocal(this.objectId,t._tempMem),e[0]=t._tempMemFloat[0],e[1]=t._tempMemFloat[1],e[2]=t._tempMemFloat[2],e}transformVectorInverseWorld(e,n){n=n||e;let t=this._engine.wasm;return t._tempMemFloat[0]=n[0],t._tempMemFloat[1]=n[1],t._tempMemFloat[2]=n[2],t._wl_object_transformVectorInverseWorld(this.objectId,t._tempMem),e[0]=t._tempMemFloat[0],e[1]=t._tempMemFloat[1],e[2]=t._tempMemFloat[2],e}transformVectorInverseLocal(e,n){n=n||e;let t=this._engine.wasm;return t._tempMemFloat[0]=n[0],t._tempMemFloat[1]=n[1],t._tempMemFloat[2]=n[2],t._wl_object_transformVectorInverseLocal(this.objectId,t._tempMem),e[0]=t._tempMemFloat[0],e[1]=t._tempMemFloat[1],e[2]=t._tempMemFloat[2],e}transformPointInverseWorld(e,n){n=n||e;let t=this._engine.wasm;return t._tempMemFloat[0]=n[0],t._tempMemFloat[1]=n[1],t._tempMemFloat[2]=n[2],t._wl_object_transformPointInverseWorld(this.objectId,t._tempMem),e[0]=t._tempMemFloat[0],e[1]=t._tempMemFloat[1],e[2]=t._tempMemFloat[2],e}transformPointInverseLocal(e,n){n=n||e;let t=this._engine.wasm;return t._tempMemFloat.set(n),t._wl_object_transformPointInverseLocal(this.objectId,t._tempMem),e[0]=t._tempMemFloat[0],e[1]=t._tempMemFloat[1],e[2]=t._tempMemFloat[2],e}toWorldSpaceTransform(e,n){n=n||e;let t=this._engine.wasm;return t._tempMemFloat.set(n),t._wl_object_toWorldSpaceTransform(this.objectId,t._tempMem),e[0]=t._tempMemFloat[0],e[1]=t._tempMemFloat[1],e[2]=t._tempMemFloat[2],e[3]=t._tempMemFloat[3],e[4]=t._tempMemFloat[4],e[5]=t._tempMemFloat[5],e[6]=t._tempMemFloat[6],e[7]=t._tempMemFloat[7],e}toLocalSpaceTransform(e,n){let t=this.parent;return n=n||e,t?t.toObjectSpaceTransform(n):e!==n&&(e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7]),e}toObjectSpaceTransform(e,n){n=n||e;let t=this._engine.wasm;return t._tempMemFloat.set(n),t._wl_object_toObjectSpaceTransform(this.objectId,t._tempMem),e[0]=t._tempMemFloat[0],e[1]=t._tempMemFloat[1],e[2]=t._tempMemFloat[2],e[3]=t._tempMemFloat[3],e[4]=t._tempMemFloat[4],e[5]=t._tempMemFloat[5],e[6]=t._tempMemFloat[6],e[7]=t._tempMemFloat[7],e}lookAt(e,n=Te){this._engine.wasm._wl_object_lookAt(this.objectId,e[0],e[1],e[2],n[0],n[1],n[2])}destroy(){this._engine.wasm._wl_scene_remove_object(this.objectId),this.objectId=null}setDirty(){this._engine.wasm._wl_object_set_dirty(this.objectId)}set active(e){let n=this.getComponents();for(let t of n)t.active=e}getComponent(e,n){let t=R(e)?e:e.TypeName,r=this._engine.wasm,i=r.lengthBytesUTF8(t)+1,s=r._tempMem;r.stringToUTF8(t,s,i);let o=this._engine.wasm._wl_get_component_manager_index(s);if(o<0){let m=this._engine.wasm._componentTypeIndices[t],d=this._engine.wasm._wl_get_js_component_index(this.objectId,m,n||0);return d<0?null:this._engine.wasm._components[d]}let a=this._engine.wasm._wl_get_component_id(this.objectId,o,n||0);return this._engine._wrapComponent(t,o,a)}getComponents(e){let n=this._engine.wasm,t=null,r=null;e&&(r=R(e)?e:e.TypeName,t=n._typeIndexFor(r));let i=[],s=Math.floor(n._tempMemSize/3*2),o=n._wl_object_get_components(this.objectId,n._tempMem,s),a=2*o;n._wl_object_get_component_types(this.objectId,n._tempMem+a,s);let m=n._typeIndexFor("js");for(let d=0;d<o;++d){let p=n._tempMemUint8[d+a],h=n._tempMemUint16[d];if(p==m){let c=n._wl_get_js_component_index_for_id(h),H=n._components[c];(t===null||H.type==r)&&i.push(H);continue}if(t===null){let c=n._typeNameFor(p);i.push(this._engine._wrapComponent(c,p,h))}else p==t&&i.push(this._engine._wrapComponent(r,t,h))}return i}addComponent(e,n){let t=this._engine.wasm,r=R(e)?e:e.TypeName,i=t._typeIndexFor(r),s=null,o=null;if(i<0){if(!(r in t._componentTypeIndices))throw new TypeError("Unknown component type '"+r+"'");let a=t._wl_object_add_js_component(this.objectId,t._componentTypeIndices[r]);o=t._wl_get_js_component_index_for_id(a),s=t._components[o]}else{let a=t._wl_object_add_component(this.objectId,i);s=this._engine._wrapComponent(r,i,a)}if(n!==void 0){let a=s.constructor;for(let m in n)m in a.Properties&&(s[m]=n[m])}return i<0&&t.__wljs_component_init(o),(!n||!("active"in n&&!n.active))&&(s.active=!0),s}get changed(){return!!this._engine.wasm._wl_object_is_changed(this.objectId)}equals(e){return e?this.objectId==e.objectId:!1}},O=class{constructor(e,n){this._engine=e,this._index=n}get jointCount(){return this._engine.wasm._wl_skin_get_joint_count(this._index)}get jointIds(){let e=this._engine.wasm;return new Uint16Array(e.HEAPU16.buffer,e._wl_skin_joint_ids(this._index),this.jointCount)}get inverseBindTransforms(){let e=this._engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_skin_inverse_bind_transforms(this._index),8*this.jointCount)}get inverseBindScalings(){let e=this._engine.wasm;return new Float32Array(e.HEAPF32.buffer,e._wl_skin_inverse_bind_scalings(this._index),3*this.jointCount)}equals(e){return e?this._index===e._index:!1}};var Z=class{constructor(e,n){if((n&3)!=0)throw new Error(Fe);this._engine=e,this._ptr=n}get locations(){let e=this._ptr,n=[];for(let t=0;t<this.hitCount;++t)n.push(new Float32Array(this._engine.wasm.HEAPF32.buffer,e+12*t,3));return n}get normals(){let e=this._ptr+48,n=[];for(let t=0;t<this.hitCount;++t)n.push(new Float32Array(this._engine.wasm.HEAPF32.buffer,e+12*t,3));return n}get distances(){let e=this._ptr+48*2;return new Float32Array(this._engine.wasm.HEAPF32.buffer,e,this.hitCount)}get objects(){let e=this._ptr+(48*2+16),n=new Uint16Array(this._engine.wasm.HEAPU16.buffer,e,this.hitCount);return[n[0]<=0?null:this._engine.wrapObject(n[0]),n[1]<=0?null:this._engine.wrapObject(n[1]),n[2]<=0?null:this._engine.wrapObject(n[2]),n[3]<=0?null:this._engine.wrapObject(n[3])]}get hitCount(){return Math.min(this._engine.wasm.HEAPU32[this._ptr/4+30],4)}},pe=class{static cubicHermite(e,n,t,r,i,s,o=WL){let a=o.wasm;a._tempMemFloat.subarray(0).set(n),a._tempMemFloat.subarray(4).set(t),a._tempMemFloat.subarray(8).set(r),a._tempMemFloat.subarray(12).set(i);let m=n.length==4;return a._wl_math_cubicHermite(a._tempMem+4*16,a._tempMem+4*0,a._tempMem+4*4,a._tempMem+4*8,a._tempMem+4*12,s,m),e[0]=a._tempMemFloat[16],e[1]=a._tempMemFloat[17],e[2]=a._tempMemFloat[18],m&&(e[3]=a._tempMemFloat[19]),e}};var Y=class{constructor(e){this.onLanguageChanged=[];this._engine=e}set language(e){let n=this._engine.wasm;if(e==null)return;let t=n.lengthBytesUTF8(e)+1;n.stringToUTF8(e,n._tempMem,t),n._wl_i18n_setLanguage(n._tempMem)}get language(){let e=this._engine.wasm,n=e._wl_i18n_currentLanguage();return n===0?null:e.UTF8ToString(n)}translate(e){let n=this._engine.wasm,t=n.lengthBytesUTF8(e)+1;n.stringToUTF8(e,n._tempMem,t);let r=n._wl_i18n_translate(n._tempMem);return r===0?null:n.UTF8ToString(r)}languageCount(){return this._engine.wasm._wl_i18n_languageCount()}languageIndex(e){let n=this._engine.wasm,t=n.lengthBytesUTF8(e)+1;return n.stringToUTF8(e,n._tempMem,t),n._wl_i18n_languageIndex(n._tempMem)}languageCode(e){let n=this._engine.wasm,t=n._wl_i18n_languageCode(e);return t===0?null:n.UTF8ToString(t)}languageName(e){let n=this._engine.wasm,t=n._wl_i18n_languageName(e);return t===0?null:n.UTF8ToString(t)}};var Me=new Map([[g.Bool,!1],[g.Int,0],[g.Float,0],[g.String,""],[g.Enum,void 0],[g.Object,null],[g.Mesh,null],[g.Texture,null],[g.Material,null],[g.Animation,null],[g.Skin,null],[g.Color,[0,0,0,1]]]);function ve(_){var e,n;for(let t in _.Properties){let r=_.Properties[t];r.type===g.Enum&&typeof r.default!="number"?((e=r.values)==null?void 0:e.length)?r.default=Math.max(r.values.indexOf(r.default),0):r.default=void 0:r.default=(n=r.default)!=null?n:Me.get(r.type),_.prototype[t]=r.default}}var y,$,ae=class{constructor(e){this.onXRSessionStart=[];this.onXRSessionEnd=[];this.arSupported=!1;this.vrSupported=!1;this.onSceneLoaded=[];this.scene=null;this.canvas=null;this._componentCache={};this._objectCache=[];ce(this,y,void 0);ce(this,$,null);J(this,y,e),f(this,y)._setEngine(this),this.textures={load:(n,t)=>{let r=new Image;return t!==void 0&&(r.crossOrigin=t),r.src=n,new Promise((i,s)=>{r.onload=()=>{let o=new N(this,r);o.valid||s("Failed to add image "+r.src+" to texture atlas. Probably incompatible format."),i(o)},r.onerror=function(){s("Failed to load image. Not found or no read access")}})}},this.i18n=new Y(this),this._componentCache={},this._objectCache.length=0}start(){this.wasm._wl_application_start()}registerComponent(...e){if(R(e[0])){let n=this.wasm._registerComponentLegacy(e[0],e[1],e[2]),t=this.wasm._componentTypes[n];ve(t);return}for(let n of e){let t=this.wasm._registerComponent(n),r=this.wasm._componentTypes[t];ve(r)}}requestXRSession(e,n,t){if(!navigator.xr){let r=location.hostname==="localhost"||location.hostname==="127.0.0.1",i=location.protocol!=="https:"&&!r;return Promise.reject(i?"WebXR is only supported with HTTPS or on localhost!":"WebXR unsupported in this browser.")}return f(this,y).webxr_request_session_func(e,n,t!=null?t:[])}wrapObject(e){let n=this._objectCache,t=n[e]||(n[e]=new Q(this,e));return t.objectId=e,t}get wasm(){return f(this,y)}get xrSession(){return f(this,y).webxr_session}get xrFrame(){return f(this,y).webxr_frame}get xrBaseLayer(){return f(this,y).webxr_baseLayer}get xrFramebuffer(){return Array.isArray(this.wasm.webxr_fbo)?this.wasm.GL.framebuffers[this.wasm.webxr_fbo[0]]:this.wasm.GL.framebuffers[this.wasm.webxr_fbo]}get physics(){return f(this,$)}_init(){if(this.scene=new G(this),this.canvas=typeof document=="undefined"?null:document.getElementById("canvas"),f(this,y)._wl_set_error_callback(f(this,y).addFunction(e=>{throw new Error(f(this,y).UTF8ToString(e))},"vi")),J(this,$,null),f(this,y).withPhysX){let e=new q(this);f(this,y)._wl_physx_set_collision_callback(f(this,y).addFunction((n,t,r,i)=>{let s=e._callbacks[n][t],o=new b(this,this.wasm._typeIndexFor("physx"),i);s(r,o)},"viiii")),J(this,$,e)}}_reset(){this._componentCache={},this._objectCache.length=0,this.scene.reset(),this.wasm.reset()}_wrapComponent(e,n,t){if(t<0)return null;let r=this._componentCache[n]||(this._componentCache[n]=[]);if(r[t])return r[t];let i;if(e=="collision")i=new I(this,n,t);else if(e=="text")i=new j(this,n,t);else if(e=="view")i=new A(this,n,t);else if(e=="mesh")i=new k(this,n,t);else if(e=="input")i=new E(this,n,t);else if(e=="light")i=new L(this,n,t);else if(e=="animation")i=new S(this,n,t);else if(e=="physx")i=new b(this,n,t);else{let s=this.wasm._componentTypeIndices[e],o=this.wasm._componentTypes[s];i=new o(this)}return i._engine=this,i._manager=n,i._id=t,r[t]=i,i}};y=new WeakMap,$=new WeakMap;var le=class{constructor(e){this.worker="";this.wasm=null;this.webxr_session=null;this.webxr_request_session_func=null;this.webxr_frame=null;this.webxr_baseLayer=null;this.webxr_fbo=-1;this._deactivate_component_on_error=!1;this._tempMem=null;this._tempMemSize=0;this._tempMemFloat=null;this._tempMemInt=null;this._tempMemUint8=null;this._tempMemUint32=null;this._tempMemUint16=null;this._sceneLoadedCallback=[];this._materialDefinitions=[];this._images=[];this._components=[];this._componentTypes=[];this._componentTypeIndices={};this._engine=null;this._withPhysX=!1;this._utf8Decoder=new TextDecoder("utf8");this.HEAP8=null;this.HEAPU8=null;this.HEAPU16=null;this.HEAPU32=null;this.HEAP32=null;this.HEAPF32=null;this.GL=null;this.assert=null;this._free=null;this._malloc=null;this.lengthBytesUTF8=null;this.stringToUTF8=null;this.UTF8ToString=null;this.addFunction=null;this._wl_set_error_callback=null;this._wl_application_start=null;this._wl_scene_get_active_views=null;this._wl_scene_ray_cast=null;this._wl_scene_add_object=null;this._wl_scene_add_objects=null;this._wl_scene_reserve_objects=null;this._wl_scene_set_clearColor=null;this._wl_scene_enableColorClear=null;this._wl_load_scene=null;this._wl_append_scene=null;this._wl_scene_reset=null;this._wl_component_get_object=null;this._wl_component_setActive=null;this._wl_component_isActive=null;this._wl_component_remove=null;this._wl_collision_component_get_collider=null;this._wl_collision_component_set_collider=null;this._wl_collision_component_get_extents=null;this._wl_collision_component_get_group=null;this._wl_collision_component_set_group=null;this._wl_collision_component_query_overlaps=null;this._wl_text_component_get_horizontal_alignment=null;this._wl_text_component_set_horizontal_alignment=null;this._wl_text_component_get_vertical_alignment=null;this._wl_text_component_set_vertical_alignment=null;this._wl_text_component_get_character_spacing=null;this._wl_text_component_set_character_spacing=null;this._wl_text_component_get_line_spacing=null;this._wl_text_component_set_line_spacing=null;this._wl_text_component_get_effect=null;this._wl_text_component_set_effect=null;this._wl_text_component_get_text=null;this._wl_text_component_set_text=null;this._wl_text_component_set_material=null;this._wl_text_component_get_material=null;this._wl_view_component_get_projection_matrix=null;this._wl_view_component_get_near=null;this._wl_view_component_set_near=null;this._wl_view_component_get_far=null;this._wl_view_component_set_far=null;this._wl_view_component_get_fov=null;this._wl_view_component_set_fov=null;this._wl_input_component_get_type=null;this._wl_input_component_set_type=null;this._wl_light_component_get_color=null;this._wl_light_component_get_type=null;this._wl_light_component_set_type=null;this._wl_animation_component_get_animation=null;this._wl_animation_component_set_animation=null;this._wl_animation_component_get_playCount=null;this._wl_animation_component_set_playCount=null;this._wl_animation_component_get_speed=null;this._wl_animation_component_set_speed=null;this._wl_animation_component_play=null;this._wl_animation_component_stop=null;this._wl_animation_component_pause=null;this._wl_animation_component_state=null;this._wl_mesh_component_get_material=null;this._wl_mesh_component_set_material=null;this._wl_mesh_component_get_mesh=null;this._wl_mesh_component_set_mesh=null;this._wl_mesh_component_get_skin=null;this._wl_mesh_component_set_skin=null;this._wl_physx_component_get_static=null;this._wl_physx_component_set_static=null;this._wl_physx_component_get_kinematic=null;this._wl_physx_component_set_kinematic=null;this._wl_physx_component_get_gravity=null;this._wl_physx_component_set_gravity=null;this._wl_physx_component_get_simulate=null;this._wl_physx_component_set_simulate=null;this._wl_physx_component_get_allowSimulation=null;this._wl_physx_component_set_allowSimulation=null;this._wl_physx_component_get_allowQuery=null;this._wl_physx_component_set_allowQuery=null;this._wl_physx_component_get_trigger=null;this._wl_physx_component_set_trigger=null;this._wl_physx_component_get_shape=null;this._wl_physx_component_set_shape=null;this._wl_physx_component_get_shape_data=null;this._wl_physx_component_set_shape_data=null;this._wl_physx_component_get_extents=null;this._wl_physx_component_get_staticFriction=null;this._wl_physx_component_set_staticFriction=null;this._wl_physx_component_get_dynamicFriction=null;this._wl_physx_component_set_dynamicFriction=null;this._wl_physx_component_get_bounciness=null;this._wl_physx_component_set_bounciness=null;this._wl_physx_component_get_linearDamping=null;this._wl_physx_component_set_linearDamping=null;this._wl_physx_component_get_angularDamping=null;this._wl_physx_component_set_angularDamping=null;this._wl_physx_component_get_linearVelocity=null;this._wl_physx_component_set_linearVelocity=null;this._wl_physx_component_get_angularVelocity=null;this._wl_physx_component_set_angularVelocity=null;this._wl_physx_component_get_groupsMask=null;this._wl_physx_component_set_groupsMask=null;this._wl_physx_component_get_blocksMask=null;this._wl_physx_component_set_blocksMask=null;this._wl_physx_component_get_linearLockAxis=null;this._wl_physx_component_set_linearLockAxis=null;this._wl_physx_component_get_angularLockAxis=null;this._wl_physx_component_set_angularLockAxis=null;this._wl_physx_component_get_mass=null;this._wl_physx_component_set_mass=null;this._wl_physx_component_set_massSpaceInertiaTensor=null;this._wl_physx_component_addForce=null;this._wl_physx_component_addForceAt=null;this._wl_physx_component_addTorque=null;this._wl_physx_component_addCallback=null;this._wl_physx_component_removeCallback=null;this._wl_physx_update=null;this._wl_physx_update_global_pose=null;this._wl_physx_ray_cast=null;this._wl_physx_set_collision_callback=null;this._wl_mesh_create=null;this._wl_mesh_get_vertexData=null;this._wl_mesh_get_vertexCount=null;this._wl_mesh_get_indexData=null;this._wl_mesh_update=null;this._wl_mesh_get_boundingSphere=null;this._wl_mesh_get_attribute=null;this._wl_mesh_destroy=null;this._wl_mesh_get_attribute_values=null;this._wl_mesh_set_attribute_values=null;this._wl_material_create=null;this._wl_material_get_definition=null;this._wl_material_definition_get_count=null;this._wl_material_definition_get_param_name=null;this._wl_material_definition_get_param_type=null;this._wl_material_get_shader=null;this._wl_material_clone=null;this._wl_material_get_param_index=null;this._wl_material_get_param_type=null;this._wl_material_get_param_value=null;this._wl_material_set_param_value_uint=null;this._wl_material_set_param_value_float=null;this._wl_renderer_addImage=null;this._wl_texture_width=null;this._wl_texture_height=null;this._wl_renderer_updateImage=null;this._wl_texture_destroy=null;this._wl_animation_get_duration=null;this._wl_animation_get_trackCount=null;this._wl_animation_retargetToSkin=null;this._wl_animation_retarget=null;this._wl_object_name=null;this._wl_object_set_name=null;this._wl_object_parent=null;this._wl_object_get_children_count=null;this._wl_object_get_children=null;this._wl_object_set_parent=null;this._wl_object_reset_scaling=null;this._wl_object_reset_translation_rotation=null;this._wl_object_reset_rotation=null;this._wl_object_reset_translation=null;this._wl_object_translate=null;this._wl_object_translate_obj=null;this._wl_object_translate_world=null;this._wl_object_rotate_axis_angle=null;this._wl_object_rotate_axis_angle_rad=null;this._wl_object_rotate_axis_angle_obj=null;this._wl_object_rotate_axis_angle_rad_obj=null;this._wl_object_rotate_quat=null;this._wl_object_rotate_quat_obj=null;this._wl_object_scale=null;this._wl_object_trans_local=null;this._wl_object_get_translation_local=null;this._wl_object_set_translation_local=null;this._wl_object_get_translation_world=null;this._wl_object_set_translation_world=null;this._wl_object_trans_world=null;this._wl_object_trans_world_to_local=null;this._wl_object_scaling_local=null;this._wl_object_scaling_world=null;this._wl_object_scaling_world_to_local=null;this._wl_object_set_rotation_local=null;this._wl_object_set_rotation_world=null;this._wl_object_transformVectorWorld=null;this._wl_object_transformVectorLocal=null;this._wl_object_transformPointWorld=null;this._wl_object_transformPointLocal=null;this._wl_object_transformVectorInverseWorld=null;this._wl_object_transformVectorInverseLocal=null;this._wl_object_transformPointInverseWorld=null;this._wl_object_transformPointInverseLocal=null;this._wl_object_toWorldSpaceTransform=null;this._wl_object_toObjectSpaceTransform=null;this._wl_object_lookAt=null;this._wl_scene_remove_object=null;this._wl_object_set_dirty=null;this._wl_get_component_manager_index=null;this._wl_get_js_component_index=null;this._wl_get_js_component_index_for_id=null;this._wl_get_component_id=null;this._wl_object_get_components=null;this._wl_object_get_component_types=null;this._wl_object_add_js_component=null;this._wl_object_add_component=null;this._wl_object_is_changed=null;this._wl_component_manager_name=null;this._wl_skin_get_joint_count=null;this._wl_skin_joint_ids=null;this._wl_skin_inverse_bind_transforms=null;this._wl_skin_inverse_bind_scalings=null;this._wl_math_cubicHermite=null;this._wl_i18n_setLanguage=null;this._wl_i18n_currentLanguage=null;this._wl_i18n_translate=null;this._wl_i18n_languageCount=null;this._wl_i18n_languageIndex=null;this._wl_i18n_languageCode=null;this._wl_i18n_languageName=null;if(e){this.UTF8ViewToString=(n,t)=>n?this._utf8Decoder.decode(this.HEAPU8.slice(n,t)):"";return}this.UTF8ViewToString=(n,t)=>n?this._utf8Decoder.decode(this.HEAPU8.subarray(n,t)):""}reset(){this._materialDefinitions=[],this._images=[],this._components=[],this._componentTypes=[],this._componentTypeIndices={}}_registerComponentLegacy(e,n,t){let r=class extends x{};return r.TypeName=e,r.Properties=n,Object.assign(r.prototype,t),this._registerComponent(r)}_registerComponent(e){if(!e.TypeName)throw new Error("no name provided for component.");let n=e.TypeName in this._componentTypeIndices?this._componentTypeIndices[e.TypeName]:this._componentTypes.length;return this._componentTypes[n]=e,this._componentTypeIndices[e.TypeName]=n,console.log("WL: registered component",e.TypeName,"with index",n),n}allocateTempMemory(e){console.log("Allocating temp mem:",e),this._tempMemSize=e,this._tempMem&&this._free(this._tempMem),this._tempMem=this._malloc(this._tempMemSize),this.updateTempMemory()}requireTempMem(e){this._tempMemSize>=e||this.allocateTempMemory(Math.ceil(e/1024)*1024)}updateTempMemory(){this._tempMemFloat=new Float32Array(this.HEAP8.buffer,this._tempMem,this._tempMemSize>>2),this._tempMemInt=new Int32Array(this.HEAP8.buffer,this._tempMem,this._tempMemSize>>2),this._tempMemUint32=new Uint32Array(this.HEAP8.buffer,this._tempMem,this._tempMemSize>>2),this._tempMemUint16=new Uint16Array(this.HEAP8.buffer,this._tempMem,this._tempMemSize>>1),this._tempMemUint8=new Uint8Array(this.HEAP8.buffer,this._tempMem,this._tempMemSize)}getTempBufferU8(e){return this.requireTempMem(e),this._tempMemUint8}getTempBufferU16(e){return this.requireTempMem(e*2),this._tempMemUint16}getTempBufferU32(e){return this.requireTempMem(e*4),this._tempMemUint32}getTempBufferI32(e){return this.requireTempMem(e*4),this._tempMemInt}getTempBufferF32(e){return this.requireTempMem(e*4),this._tempMemFloat}_typeIndexFor(e){let n=this.lengthBytesUTF8(e)+1,t=this._malloc(n);this.stringToUTF8(e,t,n);let r=this._engine.wasm._wl_get_component_manager_index(t);return this._free(t),r}_typeNameFor(e){return this.UTF8ToString(this._wl_component_manager_name(e))}_notifySceneLoaded(){for(let e of this._engine.onSceneLoaded)try{e()}catch(n){console.error("Exception during onSceneLoaded callback"),console.error(n)}}_notifyLanguageChanged(e,n){for(let t of this._engine.i18n.onLanguageChanged)try{t(e,n)}catch(r){console.error("Exception during onLanguageChanged callback"),console.error(r)}}get withPhysX(){return this._withPhysX}_setEngine(e){this._engine=e}__wljs_xr_session_start(e){for(let n of this._engine.onXRSessionStart)try{n(this.webxr_session,e)}catch(t){console.error("Exception during onXRSessionStart callback:"),console.error(t)}}__wljs_xr_session_end(){for(let e of this._engine.onXRSessionEnd)try{e()}catch(n){console.error("Exception during onXRSessionEnd callback:"),console.error(n)}}__wljs_xr_disable(){this._engine.arSupported=!1,this._engine.vrSupported=!1}__wljs_engine_pre_render(){let e=this._engine.scene;for(let n of e.onPreRender)n()}__wljs_engine_post_render(){let e=this._engine.scene;for(let n of e.onPostRender)n()}__wljs_allocate(e){this._components=new Array(e)}__wljs_init(e){this._withPhysX=e,this.allocateTempMemory(1024)}__wljs_reallocate(e){e>this._components.length&&(this._components.length=e)}__wljs_scene_add_material_definition(e){let n=new Map,t=this._wl_material_definition_get_count(e);for(let r=0;r<t;++r){let i=this.UTF8ToString(this._wl_material_definition_get_param_name(e,r)),s=this._wl_material_definition_get_param_type(e,r);n.set(i,{index:r,type:{type:s&255,componentCount:s>>8&255,metaType:s>>16&255}})}this._materialDefinitions[e]=n}__wljs_set_component_param_bool(e,n,t,r){let i=this.UTF8ViewToString(n,t);this._components[e][i]=r!==0}__wljs_set_component_param_int(e,n,t,r){let i=this.UTF8ViewToString(n,t);this._components[e][i]=r}__wljs_set_component_param_float(e,n,t,r){let i=this.UTF8ViewToString(n,t);this._components[e][i]=r}__wljs_set_component_param_string(e,n,t,r,i){let s=this.UTF8ViewToString(n,t),o=this.UTF8ViewToString(r,i);this._components[e][s]=o}__wljs_set_component_param_color(e,n,t,r){let i=this.UTF8ViewToString(n,t);this._components[e][i]=new Float32Array([0,8,16,24].map(s=>(r>>>s&255)/255))}__wljs_set_component_param_object(e,n,t,r){let i=this.UTF8ViewToString(n,t);this._components[e][i]=r>0?this._engine.wrapObject(r):null}__wljs_set_component_param_mesh(e,n,t,r){let i=this.UTF8ViewToString(n,t);this._components[e][i]=r>0?new C(this._engine,r):null}__wljs_set_component_param_texture(e,n,t,r){let i=this.UTF8ViewToString(n,t);this._components[e][i]=r>0?new N(this._engine,r):null}__wljs_set_component_param_material(e,n,t,r){let i=this.UTF8ViewToString(n,t);this._components[e][i]=r>0?new M(this._engine,r):null}__wljs_set_component_param_animation(e,n,t,r){let i=this.UTF8ViewToString(n,t);this._components[e][i]=r>0?new U(this._engine,r):null}__wljs_set_component_param_skin(e,n,t,r){let i=this.UTF8ViewToString(n,t);this._components[e][i]=r>0?new O(this._engine,r):null}__wljs_get_component_type_index(e){return this._componentTypeIndices[this.UTF8ToString(e)]}__wljs_component_create(e,n,t,r,i){let s=this._componentTypes[r],o=new s;return o._engine=this._engine,o._manager=e,o._id=t,o._object=this._engine.wrapObject(i),o._type=s.TypeName,this._components[n]=o,o}__wljs_component_init(e){let n=this._components[e];if(n.init)try{n.init()}catch(t){console.error(`Exception during ${n.type} init() on object ${n.object.name}`),console.error(t)}if(n.start){let t=n.onActivate;n.onActivate=function(){try{this.start&&this.start()}catch(r){console.error(`Exception during ${this.type} start() on object ${this.object.name}`),console.error(r)}if(this.onActivate=t,this.onActivate)try{this.onActivate()}catch(r){console.error(`Exception during ${this.type} onActivate() on object ${this.object.name}`),console.error(r)}}}}__wljs_component_update(e,n){let t=this._components[e];if(!t){console.warn("WL: component was undefined:",e),this._components[e]=new x(this._engine);return}if(!!t.update)try{t.update(n)}catch(r){console.error(`Exception during ${t.type} update() on object ${t.object.name}`),console.error(r),this._deactivate_component_on_error&&(t.active=!1)}}__wljs_component_onActivate(e){let n=this._components[e];if(!(!n||!n.onActivate))try{n.onActivate()}catch(t){console.error(`Exception during ${n.type} onActivate() on object ${n.object.name}`),console.error(t)}}__wljs_component_onDeactivate(e){let n=this._components[e];if(!!n.onDeactivate)try{n.onDeactivate()}catch(t){console.error(`Exception during ${n.type} onDeactivate() on object ${n.object.name}`),console.error(t)}}__wljs_component_onDestroy(e){let n=this._components[e];if(!!n.onDestroy)try{n.onDestroy()}catch(t){console.error(`Exception during ${n.type} onDestroy() on object ${n.object.name}`),console.error(t)}}__wljs_swap(e,n){let t=this._components[e];this._components[e]=this._components[n],this._components[n]=t}};var je=class{constructor(e=!1){this._listeners=[];this._event=void 0;this._autoResolve=e}add(e,n={}){let{once:t=!1,id:r=void 0}=n;return this._event!==void 0&&(e(...this._event),t)?this:(this._listeners.push({id:r,once:t,callback:e}),this)}push(...e){for(let n of e)this.add(n);return this}once(e){return this.add(e,{once:!0})}remove(e){let n=this._find(e);return n!==null&&this._listeners.splice(n,1),this}has(e){return this._find(e)!==null}notify(...e){let n=this._listeners;this._autoResolve&&(this._event=e);for(let t=0;t<n.length;++t){let r=n[t];r.once&&n.splice(t--,1),r.callback(...e)}}promise(){return new Promise((e,n)=>{this.once((...t)=>{t.length>1?e(t):e(t[0])})})}_find(e){let n=this._listeners;if(R(e)){for(let t=0;t<n.length;++t)if(n[t].id===e)return t;return null}for(let t=0;t<n.length;++t)if(n[t].callback===e)return t;return null}};function Ce(_){return new Promise((e,n)=>{let t=document.createElement("script"),r=document.body.appendChild(t);t.onload=()=>{document.body.removeChild(r),e()},t.onerror=i=>{document.body.removeChild(r),n(i)},t.src=_})}function Ie(){return z(this,null,function*(){let[_,e]=yield Promise.all([fe(),xe()]);return _?console.log("WASM SIMD is supported"):console.warn("WASM SIMD is not supported"),e?self.crossOriginIsolated?console.log("WASM Threads is supported"):console.warn("WASM Threads is supported, but the page is not crossOriginIsolated, therefore thread support is disabled."):console.warn("WASM Threads is not supported"),e=e&&self.crossOriginIsolated,{simdSupported:_,threadsSupported:e}})}var W={ar:null,vr:null};function Ee(){if(typeof navigator=="undefined"||!navigator.xr)return W.vr=!1,W.ar=!1,Promise.resolve(W);let _=W.vr!==null?Promise.resolve():navigator.xr.isSessionSupported("immersive-vr").then(n=>W.vr=n),e=W.ar!==null?Promise.resolve():navigator.xr.isSessionSupported("immersive-ar").then(n=>W.ar=n);return Promise.all([_,e]).then(()=>W)}function Ue(n){return z(this,arguments,function*(_,e={}){let t=Ee(),{simdSupported:r,threadsSupported:i}=yield Ie(),{simd:s=r,threads:o=i,physx:a=!1,loader:m=!1}=e,d=[];m&&d.push("loader"),a&&d.push("physx"),s&&d.push("simd"),o&&d.push("threads");let p=d.join("-"),h=_;p&&(h=`${h}-${p}`);let c=yield fetch(h+".wasm");if(!c.ok)return Promise.reject("Failed to fetch runtime .wasm file");let H=new le(o);H.worker=`${h}.worker.js`,H.wasm=yield c.arrayBuffer();let D=new ae(H);window._WL||(window._WL={runtimes:{}});let me=window._WL.runtimes,ue=p||"default";me[ue]||(yield Ce(`${h}.js`),me[ue]=window.instantiateWonderlandRuntime,window.instantiateWonderlandRuntime=void 0),yield me[ue](H),D._init();let he=yield t;return D.arSupported=he.ar,D.vrSupported=he.vr,D.start(),Object.assign(D,de),window.WL=D,D})}return Se;})();
//# sourceMappingURL=wonderland.min.js.map
